(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var en=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function F3(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Vw(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var VN={exports:{}},bg={},$N={exports:{}},ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zd=Symbol.for("react.element"),z3=Symbol.for("react.portal"),B3=Symbol.for("react.fragment"),j3=Symbol.for("react.strict_mode"),U3=Symbol.for("react.profiler"),W3=Symbol.for("react.provider"),V3=Symbol.for("react.context"),$3=Symbol.for("react.forward_ref"),H3=Symbol.for("react.suspense"),G3=Symbol.for("react.memo"),q3=Symbol.for("react.lazy"),jC=Symbol.iterator;function K3(n){return n===null||typeof n!="object"?null:(n=jC&&n[jC]||n["@@iterator"],typeof n=="function"?n:null)}var HN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GN=Object.assign,qN={};function gc(n,e,t){this.props=n,this.context=e,this.refs=qN,this.updater=t||HN}gc.prototype.isReactComponent={};gc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};gc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function KN(){}KN.prototype=gc.prototype;function $w(n,e,t){this.props=n,this.context=e,this.refs=qN,this.updater=t||HN}var Hw=$w.prototype=new KN;Hw.constructor=$w;GN(Hw,gc.prototype);Hw.isPureReactComponent=!0;var UC=Array.isArray,XN=Object.prototype.hasOwnProperty,Gw={current:null},YN={key:!0,ref:!0,__self:!0,__source:!0};function QN(n,e,t){var r,i={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)XN.call(e,r)&&!YN.hasOwnProperty(r)&&(i[r]=e[r]);var s=arguments.length-2;if(s===1)i.children=t;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];i.children=u}if(n&&n.defaultProps)for(r in s=n.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:zd,type:n,key:o,ref:a,props:i,_owner:Gw.current}}function X3(n,e){return{$$typeof:zd,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function qw(n){return typeof n=="object"&&n!==null&&n.$$typeof===zd}function Y3(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var WC=/\/+/g;function fy(n,e){return typeof n=="object"&&n!==null&&n.key!=null?Y3(""+n.key):e.toString(36)}function Ip(n,e,t,r,i){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case zd:case z3:a=!0}}if(a)return a=n,i=i(a),n=r===""?"."+fy(a,0):r,UC(i)?(t="",n!=null&&(t=n.replace(WC,"$&/")+"/"),Ip(i,e,t,"",function(l){return l})):i!=null&&(qw(i)&&(i=X3(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(WC,"$&/")+"/")+n)),e.push(i)),1;if(a=0,r=r===""?".":r+":",UC(n))for(var s=0;s<n.length;s++){o=n[s];var u=r+fy(o,s);a+=Ip(o,e,t,u,i)}else if(u=K3(n),typeof u=="function")for(n=u.call(n),s=0;!(o=n.next()).done;)o=o.value,u=r+fy(o,s++),a+=Ip(o,e,t,u,i);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Vf(n,e,t){if(n==null)return n;var r=[],i=0;return Ip(n,r,"","",function(o){return e.call(t,o,i++)}),r}function Q3(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var wr={current:null},Np={transition:null},J3={ReactCurrentDispatcher:wr,ReactCurrentBatchConfig:Np,ReactCurrentOwner:Gw};function JN(){throw Error("act(...) is not supported in production builds of React.")}ut.Children={map:Vf,forEach:function(n,e,t){Vf(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Vf(n,function(){e++}),e},toArray:function(n){return Vf(n,function(e){return e})||[]},only:function(n){if(!qw(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ut.Component=gc;ut.Fragment=B3;ut.Profiler=U3;ut.PureComponent=$w;ut.StrictMode=j3;ut.Suspense=H3;ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J3;ut.act=JN;ut.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=GN({},n.props),i=n.key,o=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=Gw.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var s=n.type.defaultProps;for(u in e)XN.call(e,u)&&!YN.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&s!==void 0?s[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=t;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:zd,type:n.type,key:i,ref:o,props:r,_owner:a}};ut.createContext=function(n){return n={$$typeof:V3,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:W3,_context:n},n.Consumer=n};ut.createElement=QN;ut.createFactory=function(n){var e=QN.bind(null,n);return e.type=n,e};ut.createRef=function(){return{current:null}};ut.forwardRef=function(n){return{$$typeof:$3,render:n}};ut.isValidElement=qw;ut.lazy=function(n){return{$$typeof:q3,_payload:{_status:-1,_result:n},_init:Q3}};ut.memo=function(n,e){return{$$typeof:G3,type:n,compare:e===void 0?null:e}};ut.startTransition=function(n){var e=Np.transition;Np.transition={};try{n()}finally{Np.transition=e}};ut.unstable_act=JN;ut.useCallback=function(n,e){return wr.current.useCallback(n,e)};ut.useContext=function(n){return wr.current.useContext(n)};ut.useDebugValue=function(){};ut.useDeferredValue=function(n){return wr.current.useDeferredValue(n)};ut.useEffect=function(n,e){return wr.current.useEffect(n,e)};ut.useId=function(){return wr.current.useId()};ut.useImperativeHandle=function(n,e,t){return wr.current.useImperativeHandle(n,e,t)};ut.useInsertionEffect=function(n,e){return wr.current.useInsertionEffect(n,e)};ut.useLayoutEffect=function(n,e){return wr.current.useLayoutEffect(n,e)};ut.useMemo=function(n,e){return wr.current.useMemo(n,e)};ut.useReducer=function(n,e,t){return wr.current.useReducer(n,e,t)};ut.useRef=function(n){return wr.current.useRef(n)};ut.useState=function(n){return wr.current.useState(n)};ut.useSyncExternalStore=function(n,e,t){return wr.current.useSyncExternalStore(n,e,t)};ut.useTransition=function(){return wr.current.useTransition()};ut.version="18.3.1";$N.exports=ut;var X=$N.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z3=X,e4=Symbol.for("react.element"),t4=Symbol.for("react.fragment"),n4=Object.prototype.hasOwnProperty,r4=Z3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i4={key:!0,ref:!0,__self:!0,__source:!0};function ZN(n,e,t){var r,i={},o=null,a=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)n4.call(e,r)&&!i4.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:e4,type:n,key:o,ref:a,props:i,_owner:r4.current}}bg.Fragment=t4;bg.jsx=ZN;bg.jsxs=ZN;VN.exports=bg;var O=VN.exports,eT={exports:{}},Jr={},tT={exports:{}},nT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(z,q){var F=z.length;z.push(q);e:for(;0<F;){var oe=F-1>>>1,Q=z[oe];if(0<i(Q,q))z[oe]=q,z[F]=Q,F=oe;else break e}}function t(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var q=z[0],F=z.pop();if(F!==q){z[0]=F;e:for(var oe=0,Q=z.length,ae=Q>>>1;oe<ae;){var me=2*(oe+1)-1,fe=z[me],pe=me+1,Ce=z[pe];if(0>i(fe,F))pe<Q&&0>i(Ce,fe)?(z[oe]=Ce,z[pe]=F,oe=pe):(z[oe]=fe,z[me]=F,oe=me);else if(pe<Q&&0>i(Ce,F))z[oe]=Ce,z[pe]=F,oe=pe;else break e}}return q}function i(z,q){var F=z.sortIndex-q.sortIndex;return F!==0?F:z.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();n.unstable_now=function(){return a.now()-s}}var u=[],l=[],c=1,h=null,d=3,f=!1,m=!1,v=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(z){for(var q=t(l);q!==null;){if(q.callback===null)r(l);else if(q.startTime<=z)r(l),q.sortIndex=q.expirationTime,e(u,q);else break;q=t(l)}}function S(z){if(v=!1,b(z),!m)if(t(u)!==null)m=!0,j(E);else{var q=t(l);q!==null&&H(S,q.startTime-z)}}function E(z,q){m=!1,v&&(v=!1,g(x),x=-1),f=!0;var F=d;try{for(b(q),h=t(u);h!==null&&(!(h.expirationTime>q)||z&&!R());){var oe=h.callback;if(typeof oe=="function"){h.callback=null,d=h.priorityLevel;var Q=oe(h.expirationTime<=q);q=n.unstable_now(),typeof Q=="function"?h.callback=Q:h===t(u)&&r(u),b(q)}else r(u);h=t(u)}if(h!==null)var ae=!0;else{var me=t(l);me!==null&&H(S,me.startTime-q),ae=!1}return ae}finally{h=null,d=F,f=!1}}var T=!1,_=null,x=-1,C=5,N=-1;function R(){return!(n.unstable_now()-N<C)}function k(){if(_!==null){var z=n.unstable_now();N=z;var q=!0;try{q=_(!0,z)}finally{q?D():(T=!1,_=null)}}else T=!1}var D;if(typeof w=="function")D=function(){w(k)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,U=W.port2;W.port1.onmessage=k,D=function(){U.postMessage(null)}}else D=function(){y(k,0)};function j(z){_=z,T||(T=!0,D())}function H(z,q){x=y(function(){z(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(z){z.callback=null},n.unstable_continueExecution=function(){m||f||(m=!0,j(E))},n.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<z?Math.floor(1e3/z):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(z){switch(d){case 1:case 2:case 3:var q=3;break;default:q=d}var F=d;d=q;try{return z()}finally{d=F}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(z,q){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var F=d;d=z;try{return q()}finally{d=F}},n.unstable_scheduleCallback=function(z,q,F){var oe=n.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?oe+F:oe):F=oe,z){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=F+Q,z={id:c++,callback:q,priorityLevel:z,startTime:F,expirationTime:Q,sortIndex:-1},F>oe?(z.sortIndex=F,e(l,z),t(u)===null&&z===t(l)&&(v?(g(x),x=-1):v=!0,H(S,F-oe))):(z.sortIndex=Q,e(u,z),m||f||(m=!0,j(E))),z},n.unstable_shouldYield=R,n.unstable_wrapCallback=function(z){var q=d;return function(){var F=d;d=q;try{return z.apply(this,arguments)}finally{d=F}}}})(nT);tT.exports=nT;var o4=tT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a4=X,qr=o4;function he(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rT=new Set,Gh={};function Du(n,e){Wl(n,e),Wl(n+"Capture",e)}function Wl(n,e){for(Gh[n]=e,n=0;n<e.length;n++)rT.add(e[n])}var Yo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),O0=Object.prototype.hasOwnProperty,s4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,VC={},$C={};function u4(n){return O0.call($C,n)?!0:O0.call(VC,n)?!1:s4.test(n)?$C[n]=!0:(VC[n]=!0,!1)}function l4(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function c4(n,e,t,r){if(e===null||typeof e>"u"||l4(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function br(n,e,t,r,i,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var Qn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Qn[n]=new br(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Qn[e]=new br(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Qn[n]=new br(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Qn[n]=new br(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Qn[n]=new br(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Qn[n]=new br(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Qn[n]=new br(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Qn[n]=new br(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Qn[n]=new br(n,5,!1,n.toLowerCase(),null,!1,!1)});var Kw=/[\-:]([a-z])/g;function Xw(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Kw,Xw);Qn[e]=new br(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Kw,Xw);Qn[e]=new br(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Kw,Xw);Qn[e]=new br(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Qn[n]=new br(n,1,!1,n.toLowerCase(),null,!1,!1)});Qn.xlinkHref=new br("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Qn[n]=new br(n,1,!1,n.toLowerCase(),null,!0,!0)});function Yw(n,e,t,r){var i=Qn.hasOwnProperty(e)?Qn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(c4(e,t,i,r)&&(t=null),r||i===null?u4(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var aa=a4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$f=Symbol.for("react.element"),dl=Symbol.for("react.portal"),fl=Symbol.for("react.fragment"),Qw=Symbol.for("react.strict_mode"),P0=Symbol.for("react.profiler"),iT=Symbol.for("react.provider"),oT=Symbol.for("react.context"),Jw=Symbol.for("react.forward_ref"),M0=Symbol.for("react.suspense"),L0=Symbol.for("react.suspense_list"),Zw=Symbol.for("react.memo"),ka=Symbol.for("react.lazy"),aT=Symbol.for("react.offscreen"),HC=Symbol.iterator;function Gc(n){return n===null||typeof n!="object"?null:(n=HC&&n[HC]||n["@@iterator"],typeof n=="function"?n:null)}var nn=Object.assign,py;function fh(n){if(py===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);py=e&&e[1]||""}return`
`+py+n}var my=!1;function gy(n,e){if(!n||my)return"";my=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(n,[],e)}else{try{e.call()}catch(l){r=l}n.call(e.prototype)}else{try{throw Error()}catch(l){r=l}n()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=r.stack.split(`
`),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(a!==1||s!==1)do if(a--,s--,0>s||i[a]!==o[s]){var u=`
`+i[a].replace(" at new "," at ");return n.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",n.displayName)),u}while(1<=a&&0<=s);break}}}finally{my=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?fh(n):""}function h4(n){switch(n.tag){case 5:return fh(n.type);case 16:return fh("Lazy");case 13:return fh("Suspense");case 19:return fh("SuspenseList");case 0:case 2:case 15:return n=gy(n.type,!1),n;case 11:return n=gy(n.type.render,!1),n;case 1:return n=gy(n.type,!0),n;default:return""}}function F0(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case fl:return"Fragment";case dl:return"Portal";case P0:return"Profiler";case Qw:return"StrictMode";case M0:return"Suspense";case L0:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case oT:return(n.displayName||"Context")+".Consumer";case iT:return(n._context.displayName||"Context")+".Provider";case Jw:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Zw:return e=n.displayName||null,e!==null?e:F0(n.type)||"Memo";case ka:e=n._payload,n=n._init;try{return F0(n(e))}catch{}}return null}function d4(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F0(e);case 8:return e===Qw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function us(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function sT(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function f4(n){var e=sT(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Hf(n){n._valueTracker||(n._valueTracker=f4(n))}function uT(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=sT(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function nm(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function z0(n,e){var t=e.checked;return nn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function GC(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=us(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function lT(n,e){e=e.checked,e!=null&&Yw(n,"checked",e,!1)}function B0(n,e){lT(n,e);var t=us(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?j0(n,e.type,t):e.hasOwnProperty("defaultValue")&&j0(n,e.type,us(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function qC(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function j0(n,e,t){(e!=="number"||nm(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var ph=Array.isArray;function Nl(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+us(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function U0(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(he(91));return nn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function KC(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(he(92));if(ph(t)){if(1<t.length)throw Error(he(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:us(t)}}function cT(n,e){var t=us(e.value),r=us(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function XC(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function hT(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function W0(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?hT(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Gf,dT=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Gf=Gf||document.createElement("div"),Gf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gf.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function qh(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Sh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},p4=["Webkit","ms","Moz","O"];Object.keys(Sh).forEach(function(n){p4.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Sh[e]=Sh[n]})});function fT(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Sh.hasOwnProperty(n)&&Sh[n]?(""+e).trim():e+"px"}function pT(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=fT(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var m4=nn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function V0(n,e){if(e){if(m4[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(he(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(he(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(he(61))}if(e.style!=null&&typeof e.style!="object")throw Error(he(62))}}function $0(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var H0=null;function eb(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var G0=null,Tl=null,kl=null;function YC(n){if(n=Ud(n)){if(typeof G0!="function")throw Error(he(280));var e=n.stateNode;e&&(e=Sg(e),G0(n.stateNode,n.type,e))}}function mT(n){Tl?kl?kl.push(n):kl=[n]:Tl=n}function gT(){if(Tl){var n=Tl,e=kl;if(kl=Tl=null,YC(n),e)for(n=0;n<e.length;n++)YC(e[n])}}function vT(n,e){return n(e)}function yT(){}var vy=!1;function wT(n,e,t){if(vy)return n(e,t);vy=!0;try{return vT(n,e,t)}finally{vy=!1,(Tl!==null||kl!==null)&&(yT(),gT())}}function Kh(n,e){var t=n.stateNode;if(t===null)return null;var r=Sg(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(he(231,e,typeof t));return t}var q0=!1;if(Yo)try{var qc={};Object.defineProperty(qc,"passive",{get:function(){q0=!0}}),window.addEventListener("test",qc,qc),window.removeEventListener("test",qc,qc)}catch{q0=!1}function g4(n,e,t,r,i,o,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{e.apply(t,l)}catch(c){this.onError(c)}}var Ih=!1,rm=null,im=!1,K0=null,v4={onError:function(n){Ih=!0,rm=n}};function y4(n,e,t,r,i,o,a,s,u){Ih=!1,rm=null,g4.apply(v4,arguments)}function w4(n,e,t,r,i,o,a,s,u){if(y4.apply(this,arguments),Ih){if(Ih){var l=rm;Ih=!1,rm=null}else throw Error(he(198));im||(im=!0,K0=l)}}function Ou(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function bT(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function QC(n){if(Ou(n)!==n)throw Error(he(188))}function b4(n){var e=n.alternate;if(!e){if(e=Ou(n),e===null)throw Error(he(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===t)return QC(i),n;if(o===r)return QC(i),e;o=o.sibling}throw Error(he(188))}if(t.return!==r.return)t=i,r=o;else{for(var a=!1,s=i.child;s;){if(s===t){a=!0,t=i,r=o;break}if(s===r){a=!0,r=i,t=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===t){a=!0,t=o,r=i;break}if(s===r){a=!0,r=o,t=i;break}s=s.sibling}if(!a)throw Error(he(189))}}if(t.alternate!==r)throw Error(he(190))}if(t.tag!==3)throw Error(he(188));return t.stateNode.current===t?n:e}function xT(n){return n=b4(n),n!==null?_T(n):null}function _T(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=_T(n);if(e!==null)return e;n=n.sibling}return null}var ET=qr.unstable_scheduleCallback,JC=qr.unstable_cancelCallback,x4=qr.unstable_shouldYield,_4=qr.unstable_requestPaint,vn=qr.unstable_now,E4=qr.unstable_getCurrentPriorityLevel,tb=qr.unstable_ImmediatePriority,CT=qr.unstable_UserBlockingPriority,om=qr.unstable_NormalPriority,C4=qr.unstable_LowPriority,ST=qr.unstable_IdlePriority,xg=null,io=null;function S4(n){if(io&&typeof io.onCommitFiberRoot=="function")try{io.onCommitFiberRoot(xg,n,void 0,(n.current.flags&128)===128)}catch{}}var Pi=Math.clz32?Math.clz32:T4,I4=Math.log,N4=Math.LN2;function T4(n){return n>>>=0,n===0?32:31-(I4(n)/N4|0)|0}var qf=64,Kf=4194304;function mh(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function am(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,o=n.pingedLanes,a=t&268435455;if(a!==0){var s=a&~i;s!==0?r=mh(s):(o&=a,o!==0&&(r=mh(o)))}else a=t&~i,a!==0?r=mh(a):o!==0&&(r=mh(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Pi(e),i=1<<t,r|=n[t],e&=~i;return r}function k4(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R4(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,o=n.pendingLanes;0<o;){var a=31-Pi(o),s=1<<a,u=i[a];u===-1?(!(s&t)||s&r)&&(i[a]=k4(s,e)):u<=e&&(n.expiredLanes|=s),o&=~s}}function X0(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function IT(){var n=qf;return qf<<=1,!(qf&4194240)&&(qf=64),n}function yy(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Bd(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Pi(e),n[e]=t}function A4(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Pi(t),o=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~o}}function nb(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Pi(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var Tt=0;function NT(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var TT,rb,kT,RT,AT,Y0=!1,Xf=[],Ga=null,qa=null,Ka=null,Xh=new Map,Yh=new Map,Da=[],D4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ZC(n,e){switch(n){case"focusin":case"focusout":Ga=null;break;case"dragenter":case"dragleave":qa=null;break;case"mouseover":case"mouseout":Ka=null;break;case"pointerover":case"pointerout":Xh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yh.delete(e.pointerId)}}function Kc(n,e,t,r,i,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Ud(e),e!==null&&rb(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function O4(n,e,t,r,i){switch(e){case"focusin":return Ga=Kc(Ga,n,e,t,r,i),!0;case"dragenter":return qa=Kc(qa,n,e,t,r,i),!0;case"mouseover":return Ka=Kc(Ka,n,e,t,r,i),!0;case"pointerover":var o=i.pointerId;return Xh.set(o,Kc(Xh.get(o)||null,n,e,t,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Yh.set(o,Kc(Yh.get(o)||null,n,e,t,r,i)),!0}return!1}function DT(n){var e=Qs(n.target);if(e!==null){var t=Ou(e);if(t!==null){if(e=t.tag,e===13){if(e=bT(t),e!==null){n.blockedOn=e,AT(n.priority,function(){kT(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Tp(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Q0(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);H0=r,t.target.dispatchEvent(r),H0=null}else return e=Ud(t),e!==null&&rb(e),n.blockedOn=t,!1;e.shift()}return!0}function eS(n,e,t){Tp(n)&&t.delete(e)}function P4(){Y0=!1,Ga!==null&&Tp(Ga)&&(Ga=null),qa!==null&&Tp(qa)&&(qa=null),Ka!==null&&Tp(Ka)&&(Ka=null),Xh.forEach(eS),Yh.forEach(eS)}function Xc(n,e){n.blockedOn===e&&(n.blockedOn=null,Y0||(Y0=!0,qr.unstable_scheduleCallback(qr.unstable_NormalPriority,P4)))}function Qh(n){function e(i){return Xc(i,n)}if(0<Xf.length){Xc(Xf[0],n);for(var t=1;t<Xf.length;t++){var r=Xf[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Ga!==null&&Xc(Ga,n),qa!==null&&Xc(qa,n),Ka!==null&&Xc(Ka,n),Xh.forEach(e),Yh.forEach(e),t=0;t<Da.length;t++)r=Da[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Da.length&&(t=Da[0],t.blockedOn===null);)DT(t),t.blockedOn===null&&Da.shift()}var Rl=aa.ReactCurrentBatchConfig,sm=!0;function M4(n,e,t,r){var i=Tt,o=Rl.transition;Rl.transition=null;try{Tt=1,ib(n,e,t,r)}finally{Tt=i,Rl.transition=o}}function L4(n,e,t,r){var i=Tt,o=Rl.transition;Rl.transition=null;try{Tt=4,ib(n,e,t,r)}finally{Tt=i,Rl.transition=o}}function ib(n,e,t,r){if(sm){var i=Q0(n,e,t,r);if(i===null)Ty(n,e,r,um,t),ZC(n,r);else if(O4(i,n,e,t,r))r.stopPropagation();else if(ZC(n,r),e&4&&-1<D4.indexOf(n)){for(;i!==null;){var o=Ud(i);if(o!==null&&TT(o),o=Q0(n,e,t,r),o===null&&Ty(n,e,r,um,t),o===i)break;i=o}i!==null&&r.stopPropagation()}else Ty(n,e,r,null,t)}}var um=null;function Q0(n,e,t,r){if(um=null,n=eb(r),n=Qs(n),n!==null)if(e=Ou(n),e===null)n=null;else if(t=e.tag,t===13){if(n=bT(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return um=n,null}function OT(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(E4()){case tb:return 1;case CT:return 4;case om:case C4:return 16;case ST:return 536870912;default:return 16}default:return 16}}var ja=null,ob=null,kp=null;function PT(){if(kp)return kp;var n,e=ob,t=e.length,r,i="value"in ja?ja.value:ja.textContent,o=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(r=1;r<=a&&e[t-r]===i[o-r];r++);return kp=i.slice(n,1<r?1-r:void 0)}function Rp(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Yf(){return!0}function tS(){return!1}function Zr(n){function e(t,r,i,o,a){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var s in n)n.hasOwnProperty(s)&&(t=n[s],this[s]=t?t(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Yf:tS,this.isPropagationStopped=tS,this}return nn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Yf)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Yf)},persist:function(){},isPersistent:Yf}),e}var vc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ab=Zr(vc),jd=nn({},vc,{view:0,detail:0}),F4=Zr(jd),wy,by,Yc,_g=nn({},jd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sb,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Yc&&(Yc&&n.type==="mousemove"?(wy=n.screenX-Yc.screenX,by=n.screenY-Yc.screenY):by=wy=0,Yc=n),wy)},movementY:function(n){return"movementY"in n?n.movementY:by}}),nS=Zr(_g),z4=nn({},_g,{dataTransfer:0}),B4=Zr(z4),j4=nn({},jd,{relatedTarget:0}),xy=Zr(j4),U4=nn({},vc,{animationName:0,elapsedTime:0,pseudoElement:0}),W4=Zr(U4),V4=nn({},vc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),$4=Zr(V4),H4=nn({},vc,{data:0}),rS=Zr(H4),G4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},K4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function X4(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=K4[n])?!!e[n]:!1}function sb(){return X4}var Y4=nn({},jd,{key:function(n){if(n.key){var e=G4[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Rp(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?q4[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sb,charCode:function(n){return n.type==="keypress"?Rp(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Rp(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Q4=Zr(Y4),J4=nn({},_g,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),iS=Zr(J4),Z4=nn({},jd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sb}),ez=Zr(Z4),tz=nn({},vc,{propertyName:0,elapsedTime:0,pseudoElement:0}),nz=Zr(tz),rz=nn({},_g,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),iz=Zr(rz),oz=[9,13,27,32],ub=Yo&&"CompositionEvent"in window,Nh=null;Yo&&"documentMode"in document&&(Nh=document.documentMode);var az=Yo&&"TextEvent"in window&&!Nh,MT=Yo&&(!ub||Nh&&8<Nh&&11>=Nh),oS=" ",aS=!1;function LT(n,e){switch(n){case"keyup":return oz.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FT(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var pl=!1;function sz(n,e){switch(n){case"compositionend":return FT(e);case"keypress":return e.which!==32?null:(aS=!0,oS);case"textInput":return n=e.data,n===oS&&aS?null:n;default:return null}}function uz(n,e){if(pl)return n==="compositionend"||!ub&&LT(n,e)?(n=PT(),kp=ob=ja=null,pl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return MT&&e.locale!=="ko"?null:e.data;default:return null}}var lz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sS(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!lz[n.type]:e==="textarea"}function zT(n,e,t,r){mT(r),e=lm(e,"onChange"),0<e.length&&(t=new ab("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Th=null,Jh=null;function cz(n){XT(n,0)}function Eg(n){var e=vl(n);if(uT(e))return n}function hz(n,e){if(n==="change")return e}var BT=!1;if(Yo){var _y;if(Yo){var Ey="oninput"in document;if(!Ey){var uS=document.createElement("div");uS.setAttribute("oninput","return;"),Ey=typeof uS.oninput=="function"}_y=Ey}else _y=!1;BT=_y&&(!document.documentMode||9<document.documentMode)}function lS(){Th&&(Th.detachEvent("onpropertychange",jT),Jh=Th=null)}function jT(n){if(n.propertyName==="value"&&Eg(Jh)){var e=[];zT(e,Jh,n,eb(n)),wT(cz,e)}}function dz(n,e,t){n==="focusin"?(lS(),Th=e,Jh=t,Th.attachEvent("onpropertychange",jT)):n==="focusout"&&lS()}function fz(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Eg(Jh)}function pz(n,e){if(n==="click")return Eg(e)}function mz(n,e){if(n==="input"||n==="change")return Eg(e)}function gz(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var zi=typeof Object.is=="function"?Object.is:gz;function Zh(n,e){if(zi(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!O0.call(e,i)||!zi(n[i],e[i]))return!1}return!0}function cS(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function hS(n,e){var t=cS(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=cS(t)}}function UT(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?UT(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function WT(){for(var n=window,e=nm();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=nm(n.document)}return e}function lb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function vz(n){var e=WT(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&UT(t.ownerDocument.documentElement,t)){if(r!==null&&lb(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!n.extend&&o>r&&(i=r,r=o,o=i),i=hS(t,o);var a=hS(t,r);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),o>r?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var yz=Yo&&"documentMode"in document&&11>=document.documentMode,ml=null,J0=null,kh=null,Z0=!1;function dS(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Z0||ml==null||ml!==nm(r)||(r=ml,"selectionStart"in r&&lb(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),kh&&Zh(kh,r)||(kh=r,r=lm(J0,"onSelect"),0<r.length&&(e=new ab("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=ml)))}function Qf(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var gl={animationend:Qf("Animation","AnimationEnd"),animationiteration:Qf("Animation","AnimationIteration"),animationstart:Qf("Animation","AnimationStart"),transitionend:Qf("Transition","TransitionEnd")},Cy={},VT={};Yo&&(VT=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function Cg(n){if(Cy[n])return Cy[n];if(!gl[n])return n;var e=gl[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in VT)return Cy[n]=e[t];return n}var $T=Cg("animationend"),HT=Cg("animationiteration"),GT=Cg("animationstart"),qT=Cg("transitionend"),KT=new Map,fS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bs(n,e){KT.set(n,e),Du(e,[n])}for(var Sy=0;Sy<fS.length;Sy++){var Iy=fS[Sy],wz=Iy.toLowerCase(),bz=Iy[0].toUpperCase()+Iy.slice(1);bs(wz,"on"+bz)}bs($T,"onAnimationEnd");bs(HT,"onAnimationIteration");bs(GT,"onAnimationStart");bs("dblclick","onDoubleClick");bs("focusin","onFocus");bs("focusout","onBlur");bs(qT,"onTransitionEnd");Wl("onMouseEnter",["mouseout","mouseover"]);Wl("onMouseLeave",["mouseout","mouseover"]);Wl("onPointerEnter",["pointerout","pointerover"]);Wl("onPointerLeave",["pointerout","pointerover"]);Du("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Du("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Du("onBeforeInput",["compositionend","keypress","textInput","paste"]);Du("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Du("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Du("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xz=new Set("cancel close invalid load scroll toggle".split(" ").concat(gh));function pS(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,w4(r,e,void 0,n),n.currentTarget=null}function XT(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==o&&i.isPropagationStopped())break e;pS(i,s,l),o=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,l=s.currentTarget,s=s.listener,u!==o&&i.isPropagationStopped())break e;pS(i,s,l),o=u}}}if(im)throw n=K0,im=!1,K0=null,n}function $t(n,e){var t=e[i1];t===void 0&&(t=e[i1]=new Set);var r=n+"__bubble";t.has(r)||(YT(e,n,2,!1),t.add(r))}function Ny(n,e,t){var r=0;e&&(r|=4),YT(t,n,r,e)}var Jf="_reactListening"+Math.random().toString(36).slice(2);function ed(n){if(!n[Jf]){n[Jf]=!0,rT.forEach(function(t){t!=="selectionchange"&&(xz.has(t)||Ny(t,!1,n),Ny(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Jf]||(e[Jf]=!0,Ny("selectionchange",!1,e))}}function YT(n,e,t,r){switch(OT(e)){case 1:var i=M4;break;case 4:i=L4;break;default:i=ib}t=i.bind(null,e,t,n),i=void 0,!q0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Ty(n,e,t,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;a=a.return}for(;s!==null;){if(a=Qs(s),a===null)return;if(u=a.tag,u===5||u===6){r=o=a;continue e}s=s.parentNode}}r=r.return}wT(function(){var l=o,c=eb(t),h=[];e:{var d=KT.get(n);if(d!==void 0){var f=ab,m=n;switch(n){case"keypress":if(Rp(t)===0)break e;case"keydown":case"keyup":f=Q4;break;case"focusin":m="focus",f=xy;break;case"focusout":m="blur",f=xy;break;case"beforeblur":case"afterblur":f=xy;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=nS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=B4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=ez;break;case $T:case HT:case GT:f=W4;break;case qT:f=nz;break;case"scroll":f=F4;break;case"wheel":f=iz;break;case"copy":case"cut":case"paste":f=$4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=iS}var v=(e&4)!==0,y=!v&&n==="scroll",g=v?d!==null?d+"Capture":null:d;v=[];for(var w=l,b;w!==null;){b=w;var S=b.stateNode;if(b.tag===5&&S!==null&&(b=S,g!==null&&(S=Kh(w,g),S!=null&&v.push(td(w,S,b)))),y)break;w=w.return}0<v.length&&(d=new f(d,m,null,t,c),h.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",f=n==="mouseout"||n==="pointerout",d&&t!==H0&&(m=t.relatedTarget||t.fromElement)&&(Qs(m)||m[Qo]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(m=t.relatedTarget||t.toElement,f=l,m=m?Qs(m):null,m!==null&&(y=Ou(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=l),f!==m)){if(v=nS,S="onMouseLeave",g="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(v=iS,S="onPointerLeave",g="onPointerEnter",w="pointer"),y=f==null?d:vl(f),b=m==null?d:vl(m),d=new v(S,w+"leave",f,t,c),d.target=y,d.relatedTarget=b,S=null,Qs(c)===l&&(v=new v(g,w+"enter",m,t,c),v.target=b,v.relatedTarget=y,S=v),y=S,f&&m)t:{for(v=f,g=m,w=0,b=v;b;b=nl(b))w++;for(b=0,S=g;S;S=nl(S))b++;for(;0<w-b;)v=nl(v),w--;for(;0<b-w;)g=nl(g),b--;for(;w--;){if(v===g||g!==null&&v===g.alternate)break t;v=nl(v),g=nl(g)}v=null}else v=null;f!==null&&mS(h,d,f,v,!1),m!==null&&y!==null&&mS(h,y,m,v,!0)}}e:{if(d=l?vl(l):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var E=hz;else if(sS(d))if(BT)E=mz;else{E=fz;var T=dz}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(E=pz);if(E&&(E=E(n,l))){zT(h,E,t,c);break e}T&&T(n,d,l),n==="focusout"&&(T=d._wrapperState)&&T.controlled&&d.type==="number"&&j0(d,"number",d.value)}switch(T=l?vl(l):window,n){case"focusin":(sS(T)||T.contentEditable==="true")&&(ml=T,J0=l,kh=null);break;case"focusout":kh=J0=ml=null;break;case"mousedown":Z0=!0;break;case"contextmenu":case"mouseup":case"dragend":Z0=!1,dS(h,t,c);break;case"selectionchange":if(yz)break;case"keydown":case"keyup":dS(h,t,c)}var _;if(ub)e:{switch(n){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else pl?LT(n,t)&&(x="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(x="onCompositionStart");x&&(MT&&t.locale!=="ko"&&(pl||x!=="onCompositionStart"?x==="onCompositionEnd"&&pl&&(_=PT()):(ja=c,ob="value"in ja?ja.value:ja.textContent,pl=!0)),T=lm(l,x),0<T.length&&(x=new rS(x,n,null,t,c),h.push({event:x,listeners:T}),_?x.data=_:(_=FT(t),_!==null&&(x.data=_)))),(_=az?sz(n,t):uz(n,t))&&(l=lm(l,"onBeforeInput"),0<l.length&&(c=new rS("onBeforeInput","beforeinput",null,t,c),h.push({event:c,listeners:l}),c.data=_))}XT(h,e)})}function td(n,e,t){return{instance:n,listener:e,currentTarget:t}}function lm(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Kh(n,t),o!=null&&r.unshift(td(n,o,i)),o=Kh(n,e),o!=null&&r.push(td(n,o,i))),n=n.return}return r}function nl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function mS(n,e,t,r,i){for(var o=e._reactName,a=[];t!==null&&t!==r;){var s=t,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,i?(u=Kh(t,o),u!=null&&a.unshift(td(t,u,s))):i||(u=Kh(t,o),u!=null&&a.push(td(t,u,s)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var _z=/\r\n?/g,Ez=/\u0000|\uFFFD/g;function gS(n){return(typeof n=="string"?n:""+n).replace(_z,`
`).replace(Ez,"")}function Zf(n,e,t){if(e=gS(e),gS(n)!==e&&t)throw Error(he(425))}function cm(){}var e1=null,t1=null;function n1(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var r1=typeof setTimeout=="function"?setTimeout:void 0,Cz=typeof clearTimeout=="function"?clearTimeout:void 0,vS=typeof Promise=="function"?Promise:void 0,Sz=typeof queueMicrotask=="function"?queueMicrotask:typeof vS<"u"?function(n){return vS.resolve(null).then(n).catch(Iz)}:r1;function Iz(n){setTimeout(function(){throw n})}function ky(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Qh(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Qh(e)}function Xa(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function yS(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var yc=Math.random().toString(36).slice(2),eo="__reactFiber$"+yc,nd="__reactProps$"+yc,Qo="__reactContainer$"+yc,i1="__reactEvents$"+yc,Nz="__reactListeners$"+yc,Tz="__reactHandles$"+yc;function Qs(n){var e=n[eo];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Qo]||t[eo]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=yS(n);n!==null;){if(t=n[eo])return t;n=yS(n)}return e}n=t,t=n.parentNode}return null}function Ud(n){return n=n[eo]||n[Qo],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function vl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(he(33))}function Sg(n){return n[nd]||null}var o1=[],yl=-1;function xs(n){return{current:n}}function Ht(n){0>yl||(n.current=o1[yl],o1[yl]=null,yl--)}function Bt(n,e){yl++,o1[yl]=n.current,n.current=e}var ls={},or=xs(ls),Rr=xs(!1),pu=ls;function Vl(n,e){var t=n.type.contextTypes;if(!t)return ls;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in t)i[o]=e[o];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Ar(n){return n=n.childContextTypes,n!=null}function hm(){Ht(Rr),Ht(or)}function wS(n,e,t){if(or.current!==ls)throw Error(he(168));Bt(or,e),Bt(Rr,t)}function QT(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(he(108,d4(n)||"Unknown",i));return nn({},t,r)}function dm(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ls,pu=or.current,Bt(or,n),Bt(Rr,Rr.current),!0}function bS(n,e,t){var r=n.stateNode;if(!r)throw Error(he(169));t?(n=QT(n,e,pu),r.__reactInternalMemoizedMergedChildContext=n,Ht(Rr),Ht(or),Bt(or,n)):Ht(Rr),Bt(Rr,t)}var Po=null,Ig=!1,Ry=!1;function JT(n){Po===null?Po=[n]:Po.push(n)}function kz(n){Ig=!0,JT(n)}function _s(){if(!Ry&&Po!==null){Ry=!0;var n=0,e=Tt;try{var t=Po;for(Tt=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Po=null,Ig=!1}catch(i){throw Po!==null&&(Po=Po.slice(n+1)),ET(tb,_s),i}finally{Tt=e,Ry=!1}}return null}var wl=[],bl=0,fm=null,pm=0,si=[],ui=0,mu=null,Fo=1,zo="";function js(n,e){wl[bl++]=pm,wl[bl++]=fm,fm=n,pm=e}function ZT(n,e,t){si[ui++]=Fo,si[ui++]=zo,si[ui++]=mu,mu=n;var r=Fo;n=zo;var i=32-Pi(r)-1;r&=~(1<<i),t+=1;var o=32-Pi(e)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Fo=1<<32-Pi(e)+i|t<<i|r,zo=o+n}else Fo=1<<o|t<<i|r,zo=n}function cb(n){n.return!==null&&(js(n,1),ZT(n,1,0))}function hb(n){for(;n===fm;)fm=wl[--bl],wl[bl]=null,pm=wl[--bl],wl[bl]=null;for(;n===mu;)mu=si[--ui],si[ui]=null,zo=si[--ui],si[ui]=null,Fo=si[--ui],si[ui]=null}var Gr=null,Vr=null,Xt=!1,Ci=null;function ek(n,e){var t=ci(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function xS(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Gr=n,Vr=Xa(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Gr=n,Vr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=mu!==null?{id:Fo,overflow:zo}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ci(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Gr=n,Vr=null,!0):!1;default:return!1}}function a1(n){return(n.mode&1)!==0&&(n.flags&128)===0}function s1(n){if(Xt){var e=Vr;if(e){var t=e;if(!xS(n,e)){if(a1(n))throw Error(he(418));e=Xa(t.nextSibling);var r=Gr;e&&xS(n,e)?ek(r,t):(n.flags=n.flags&-4097|2,Xt=!1,Gr=n)}}else{if(a1(n))throw Error(he(418));n.flags=n.flags&-4097|2,Xt=!1,Gr=n}}}function _S(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Gr=n}function ep(n){if(n!==Gr)return!1;if(!Xt)return _S(n),Xt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!n1(n.type,n.memoizedProps)),e&&(e=Vr)){if(a1(n))throw tk(),Error(he(418));for(;e;)ek(n,e),e=Xa(e.nextSibling)}if(_S(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(he(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Vr=Xa(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Vr=null}}else Vr=Gr?Xa(n.stateNode.nextSibling):null;return!0}function tk(){for(var n=Vr;n;)n=Xa(n.nextSibling)}function $l(){Vr=Gr=null,Xt=!1}function db(n){Ci===null?Ci=[n]:Ci.push(n)}var Rz=aa.ReactCurrentBatchConfig;function Qc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(he(309));var r=t.stateNode}if(!r)throw Error(he(147,n));var i=r,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var s=i.refs;a===null?delete s[o]:s[o]=a},e._stringRef=o,e)}if(typeof n!="string")throw Error(he(284));if(!t._owner)throw Error(he(290,n))}return n}function tp(n,e){throw n=Object.prototype.toString.call(e),Error(he(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ES(n){var e=n._init;return e(n._payload)}function nk(n){function e(g,w){if(n){var b=g.deletions;b===null?(g.deletions=[w],g.flags|=16):b.push(w)}}function t(g,w){if(!n)return null;for(;w!==null;)e(g,w),w=w.sibling;return null}function r(g,w){for(g=new Map;w!==null;)w.key!==null?g.set(w.key,w):g.set(w.index,w),w=w.sibling;return g}function i(g,w){return g=Za(g,w),g.index=0,g.sibling=null,g}function o(g,w,b){return g.index=b,n?(b=g.alternate,b!==null?(b=b.index,b<w?(g.flags|=2,w):b):(g.flags|=2,w)):(g.flags|=1048576,w)}function a(g){return n&&g.alternate===null&&(g.flags|=2),g}function s(g,w,b,S){return w===null||w.tag!==6?(w=Fy(b,g.mode,S),w.return=g,w):(w=i(w,b),w.return=g,w)}function u(g,w,b,S){var E=b.type;return E===fl?c(g,w,b.props.children,S,b.key):w!==null&&(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===ka&&ES(E)===w.type)?(S=i(w,b.props),S.ref=Qc(g,w,b),S.return=g,S):(S=Fp(b.type,b.key,b.props,null,g.mode,S),S.ref=Qc(g,w,b),S.return=g,S)}function l(g,w,b,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=zy(b,g.mode,S),w.return=g,w):(w=i(w,b.children||[]),w.return=g,w)}function c(g,w,b,S,E){return w===null||w.tag!==7?(w=uu(b,g.mode,S,E),w.return=g,w):(w=i(w,b),w.return=g,w)}function h(g,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Fy(""+w,g.mode,b),w.return=g,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case $f:return b=Fp(w.type,w.key,w.props,null,g.mode,b),b.ref=Qc(g,null,w),b.return=g,b;case dl:return w=zy(w,g.mode,b),w.return=g,w;case ka:var S=w._init;return h(g,S(w._payload),b)}if(ph(w)||Gc(w))return w=uu(w,g.mode,b,null),w.return=g,w;tp(g,w)}return null}function d(g,w,b,S){var E=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return E!==null?null:s(g,w,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case $f:return b.key===E?u(g,w,b,S):null;case dl:return b.key===E?l(g,w,b,S):null;case ka:return E=b._init,d(g,w,E(b._payload),S)}if(ph(b)||Gc(b))return E!==null?null:c(g,w,b,S,null);tp(g,b)}return null}function f(g,w,b,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return g=g.get(b)||null,s(w,g,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case $f:return g=g.get(S.key===null?b:S.key)||null,u(w,g,S,E);case dl:return g=g.get(S.key===null?b:S.key)||null,l(w,g,S,E);case ka:var T=S._init;return f(g,w,b,T(S._payload),E)}if(ph(S)||Gc(S))return g=g.get(b)||null,c(w,g,S,E,null);tp(w,S)}return null}function m(g,w,b,S){for(var E=null,T=null,_=w,x=w=0,C=null;_!==null&&x<b.length;x++){_.index>x?(C=_,_=null):C=_.sibling;var N=d(g,_,b[x],S);if(N===null){_===null&&(_=C);break}n&&_&&N.alternate===null&&e(g,_),w=o(N,w,x),T===null?E=N:T.sibling=N,T=N,_=C}if(x===b.length)return t(g,_),Xt&&js(g,x),E;if(_===null){for(;x<b.length;x++)_=h(g,b[x],S),_!==null&&(w=o(_,w,x),T===null?E=_:T.sibling=_,T=_);return Xt&&js(g,x),E}for(_=r(g,_);x<b.length;x++)C=f(_,g,x,b[x],S),C!==null&&(n&&C.alternate!==null&&_.delete(C.key===null?x:C.key),w=o(C,w,x),T===null?E=C:T.sibling=C,T=C);return n&&_.forEach(function(R){return e(g,R)}),Xt&&js(g,x),E}function v(g,w,b,S){var E=Gc(b);if(typeof E!="function")throw Error(he(150));if(b=E.call(b),b==null)throw Error(he(151));for(var T=E=null,_=w,x=w=0,C=null,N=b.next();_!==null&&!N.done;x++,N=b.next()){_.index>x?(C=_,_=null):C=_.sibling;var R=d(g,_,N.value,S);if(R===null){_===null&&(_=C);break}n&&_&&R.alternate===null&&e(g,_),w=o(R,w,x),T===null?E=R:T.sibling=R,T=R,_=C}if(N.done)return t(g,_),Xt&&js(g,x),E;if(_===null){for(;!N.done;x++,N=b.next())N=h(g,N.value,S),N!==null&&(w=o(N,w,x),T===null?E=N:T.sibling=N,T=N);return Xt&&js(g,x),E}for(_=r(g,_);!N.done;x++,N=b.next())N=f(_,g,x,N.value,S),N!==null&&(n&&N.alternate!==null&&_.delete(N.key===null?x:N.key),w=o(N,w,x),T===null?E=N:T.sibling=N,T=N);return n&&_.forEach(function(k){return e(g,k)}),Xt&&js(g,x),E}function y(g,w,b,S){if(typeof b=="object"&&b!==null&&b.type===fl&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case $f:e:{for(var E=b.key,T=w;T!==null;){if(T.key===E){if(E=b.type,E===fl){if(T.tag===7){t(g,T.sibling),w=i(T,b.props.children),w.return=g,g=w;break e}}else if(T.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===ka&&ES(E)===T.type){t(g,T.sibling),w=i(T,b.props),w.ref=Qc(g,T,b),w.return=g,g=w;break e}t(g,T);break}else e(g,T);T=T.sibling}b.type===fl?(w=uu(b.props.children,g.mode,S,b.key),w.return=g,g=w):(S=Fp(b.type,b.key,b.props,null,g.mode,S),S.ref=Qc(g,w,b),S.return=g,g=S)}return a(g);case dl:e:{for(T=b.key;w!==null;){if(w.key===T)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){t(g,w.sibling),w=i(w,b.children||[]),w.return=g,g=w;break e}else{t(g,w);break}else e(g,w);w=w.sibling}w=zy(b,g.mode,S),w.return=g,g=w}return a(g);case ka:return T=b._init,y(g,w,T(b._payload),S)}if(ph(b))return m(g,w,b,S);if(Gc(b))return v(g,w,b,S);tp(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(t(g,w.sibling),w=i(w,b),w.return=g,g=w):(t(g,w),w=Fy(b,g.mode,S),w.return=g,g=w),a(g)):t(g,w)}return y}var Hl=nk(!0),rk=nk(!1),mm=xs(null),gm=null,xl=null,fb=null;function pb(){fb=xl=gm=null}function mb(n){var e=mm.current;Ht(mm),n._currentValue=e}function u1(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Al(n,e){gm=n,fb=xl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Tr=!0),n.firstContext=null)}function fi(n){var e=n._currentValue;if(fb!==n)if(n={context:n,memoizedValue:e,next:null},xl===null){if(gm===null)throw Error(he(308));xl=n,gm.dependencies={lanes:0,firstContext:n}}else xl=xl.next=n;return e}var Js=null;function gb(n){Js===null?Js=[n]:Js.push(n)}function ik(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,gb(e)):(t.next=i.next,i.next=t),e.interleaved=t,Jo(n,r)}function Jo(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ra=!1;function vb(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ok(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Vo(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Ya(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,gt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Jo(n,t)}return i=r.interleaved,i===null?(e.next=e,gb(r)):(e.next=i.next,i.next=e),r.interleaved=e,Jo(n,t)}function Ap(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,nb(n,t)}}function CS(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?i=o=a:o=o.next=a,t=t.next}while(t!==null);o===null?i=o=e:o=o.next=e}else i=o=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function vm(n,e,t,r){var i=n.updateQueue;Ra=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var u=s,l=u.next;u.next=null,a===null?o=l:a.next=l,a=u;var c=n.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(o!==null){var h=i.baseState;a=0,c=l=u=null,s=o;do{var d=s.lane,f=s.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var m=n,v=s;switch(d=e,f=t,v.tag){case 1:if(m=v.payload,typeof m=="function"){h=m.call(f,h,d);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,d=typeof m=="function"?m.call(f,h,d):m,d==null)break e;h=nn({},h,d);break e;case 2:Ra=!0}}s.callback!==null&&s.lane!==0&&(n.flags|=64,d=i.effects,d===null?i.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=f,u=h):c=c.next=f,a|=d;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;d=s,s=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(u=h),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);vu|=a,n.lanes=a,n.memoizedState=h}}function SS(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(he(191,i));i.call(r)}}}var Wd={},oo=xs(Wd),rd=xs(Wd),id=xs(Wd);function Zs(n){if(n===Wd)throw Error(he(174));return n}function yb(n,e){switch(Bt(id,e),Bt(rd,n),Bt(oo,Wd),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:W0(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=W0(e,n)}Ht(oo),Bt(oo,e)}function Gl(){Ht(oo),Ht(rd),Ht(id)}function ak(n){Zs(id.current);var e=Zs(oo.current),t=W0(e,n.type);e!==t&&(Bt(rd,n),Bt(oo,t))}function wb(n){rd.current===n&&(Ht(oo),Ht(rd))}var Zt=xs(0);function ym(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ay=[];function bb(){for(var n=0;n<Ay.length;n++)Ay[n]._workInProgressVersionPrimary=null;Ay.length=0}var Dp=aa.ReactCurrentDispatcher,Dy=aa.ReactCurrentBatchConfig,gu=0,tn=null,kn=null,Mn=null,wm=!1,Rh=!1,od=0,Az=0;function tr(){throw Error(he(321))}function xb(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!zi(n[t],e[t]))return!1;return!0}function _b(n,e,t,r,i,o){if(gu=o,tn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Dp.current=n===null||n.memoizedState===null?Mz:Lz,n=t(r,i),Rh){o=0;do{if(Rh=!1,od=0,25<=o)throw Error(he(301));o+=1,Mn=kn=null,e.updateQueue=null,Dp.current=Fz,n=t(r,i)}while(Rh)}if(Dp.current=bm,e=kn!==null&&kn.next!==null,gu=0,Mn=kn=tn=null,wm=!1,e)throw Error(he(300));return n}function Eb(){var n=od!==0;return od=0,n}function Ji(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mn===null?tn.memoizedState=Mn=n:Mn=Mn.next=n,Mn}function pi(){if(kn===null){var n=tn.alternate;n=n!==null?n.memoizedState:null}else n=kn.next;var e=Mn===null?tn.memoizedState:Mn.next;if(e!==null)Mn=e,kn=n;else{if(n===null)throw Error(he(310));kn=n,n={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},Mn===null?tn.memoizedState=Mn=n:Mn=Mn.next=n}return Mn}function ad(n,e){return typeof e=="function"?e(n):e}function Oy(n){var e=pi(),t=e.queue;if(t===null)throw Error(he(311));t.lastRenderedReducer=n;var r=kn,i=r.baseQueue,o=t.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,t.pending=null}if(i!==null){o=i.next,r=r.baseState;var s=a=null,u=null,l=o;do{var c=l.lane;if((gu&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:n(r,l.action);else{var h={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=h,a=r):u=u.next=h,tn.lanes|=c,vu|=c}l=l.next}while(l!==null&&l!==o);u===null?a=r:u.next=s,zi(r,e.memoizedState)||(Tr=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do o=i.lane,tn.lanes|=o,vu|=o,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Py(n){var e=pi(),t=e.queue;if(t===null)throw Error(he(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,o=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do o=n(o,a.action),a=a.next;while(a!==i);zi(o,e.memoizedState)||(Tr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,r]}function sk(){}function uk(n,e){var t=tn,r=pi(),i=e(),o=!zi(r.memoizedState,i);if(o&&(r.memoizedState=i,Tr=!0),r=r.queue,Cb(hk.bind(null,t,r,n),[n]),r.getSnapshot!==e||o||Mn!==null&&Mn.memoizedState.tag&1){if(t.flags|=2048,sd(9,ck.bind(null,t,r,i,e),void 0,null),zn===null)throw Error(he(349));gu&30||lk(t,e,i)}return i}function lk(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=tn.updateQueue,e===null?(e={lastEffect:null,stores:null},tn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function ck(n,e,t,r){e.value=t,e.getSnapshot=r,dk(e)&&fk(n)}function hk(n,e,t){return t(function(){dk(e)&&fk(n)})}function dk(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!zi(n,t)}catch{return!0}}function fk(n){var e=Jo(n,1);e!==null&&Mi(e,n,1,-1)}function IS(n){var e=Ji();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ad,lastRenderedState:n},e.queue=n,n=n.dispatch=Pz.bind(null,tn,n),[e.memoizedState,n]}function sd(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=tn.updateQueue,e===null?(e={lastEffect:null,stores:null},tn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function pk(){return pi().memoizedState}function Op(n,e,t,r){var i=Ji();tn.flags|=n,i.memoizedState=sd(1|e,t,void 0,r===void 0?null:r)}function Ng(n,e,t,r){var i=pi();r=r===void 0?null:r;var o=void 0;if(kn!==null){var a=kn.memoizedState;if(o=a.destroy,r!==null&&xb(r,a.deps)){i.memoizedState=sd(e,t,o,r);return}}tn.flags|=n,i.memoizedState=sd(1|e,t,o,r)}function NS(n,e){return Op(8390656,8,n,e)}function Cb(n,e){return Ng(2048,8,n,e)}function mk(n,e){return Ng(4,2,n,e)}function gk(n,e){return Ng(4,4,n,e)}function vk(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function yk(n,e,t){return t=t!=null?t.concat([n]):null,Ng(4,4,vk.bind(null,e,n),t)}function Sb(){}function wk(n,e){var t=pi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&xb(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function bk(n,e){var t=pi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&xb(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function xk(n,e,t){return gu&21?(zi(t,e)||(t=IT(),tn.lanes|=t,vu|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Tr=!0),n.memoizedState=t)}function Dz(n,e){var t=Tt;Tt=t!==0&&4>t?t:4,n(!0);var r=Dy.transition;Dy.transition={};try{n(!1),e()}finally{Tt=t,Dy.transition=r}}function _k(){return pi().memoizedState}function Oz(n,e,t){var r=Ja(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},Ek(n))Ck(e,t);else if(t=ik(n,e,t,r),t!==null){var i=fr();Mi(t,n,r,i),Sk(t,e,r)}}function Pz(n,e,t){var r=Ja(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(Ek(n))Ck(e,i);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,s=o(a,t);if(i.hasEagerState=!0,i.eagerState=s,zi(s,a)){var u=e.interleaved;u===null?(i.next=i,gb(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}t=ik(n,e,i,r),t!==null&&(i=fr(),Mi(t,n,r,i),Sk(t,e,r))}}function Ek(n){var e=n.alternate;return n===tn||e!==null&&e===tn}function Ck(n,e){Rh=wm=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Sk(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,nb(n,t)}}var bm={readContext:fi,useCallback:tr,useContext:tr,useEffect:tr,useImperativeHandle:tr,useInsertionEffect:tr,useLayoutEffect:tr,useMemo:tr,useReducer:tr,useRef:tr,useState:tr,useDebugValue:tr,useDeferredValue:tr,useTransition:tr,useMutableSource:tr,useSyncExternalStore:tr,useId:tr,unstable_isNewReconciler:!1},Mz={readContext:fi,useCallback:function(n,e){return Ji().memoizedState=[n,e===void 0?null:e],n},useContext:fi,useEffect:NS,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Op(4194308,4,vk.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Op(4194308,4,n,e)},useInsertionEffect:function(n,e){return Op(4,2,n,e)},useMemo:function(n,e){var t=Ji();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Ji();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=Oz.bind(null,tn,n),[r.memoizedState,n]},useRef:function(n){var e=Ji();return n={current:n},e.memoizedState=n},useState:IS,useDebugValue:Sb,useDeferredValue:function(n){return Ji().memoizedState=n},useTransition:function(){var n=IS(!1),e=n[0];return n=Dz.bind(null,n[1]),Ji().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=tn,i=Ji();if(Xt){if(t===void 0)throw Error(he(407));t=t()}else{if(t=e(),zn===null)throw Error(he(349));gu&30||lk(r,e,t)}i.memoizedState=t;var o={value:t,getSnapshot:e};return i.queue=o,NS(hk.bind(null,r,o,n),[n]),r.flags|=2048,sd(9,ck.bind(null,r,o,t,e),void 0,null),t},useId:function(){var n=Ji(),e=zn.identifierPrefix;if(Xt){var t=zo,r=Fo;t=(r&~(1<<32-Pi(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=od++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Az++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Lz={readContext:fi,useCallback:wk,useContext:fi,useEffect:Cb,useImperativeHandle:yk,useInsertionEffect:mk,useLayoutEffect:gk,useMemo:bk,useReducer:Oy,useRef:pk,useState:function(){return Oy(ad)},useDebugValue:Sb,useDeferredValue:function(n){var e=pi();return xk(e,kn.memoizedState,n)},useTransition:function(){var n=Oy(ad)[0],e=pi().memoizedState;return[n,e]},useMutableSource:sk,useSyncExternalStore:uk,useId:_k,unstable_isNewReconciler:!1},Fz={readContext:fi,useCallback:wk,useContext:fi,useEffect:Cb,useImperativeHandle:yk,useInsertionEffect:mk,useLayoutEffect:gk,useMemo:bk,useReducer:Py,useRef:pk,useState:function(){return Py(ad)},useDebugValue:Sb,useDeferredValue:function(n){var e=pi();return kn===null?e.memoizedState=n:xk(e,kn.memoizedState,n)},useTransition:function(){var n=Py(ad)[0],e=pi().memoizedState;return[n,e]},useMutableSource:sk,useSyncExternalStore:uk,useId:_k,unstable_isNewReconciler:!1};function xi(n,e){if(n&&n.defaultProps){e=nn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function l1(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:nn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Tg={isMounted:function(n){return(n=n._reactInternals)?Ou(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=fr(),i=Ja(n),o=Vo(r,i);o.payload=e,t!=null&&(o.callback=t),e=Ya(n,o,i),e!==null&&(Mi(e,n,i,r),Ap(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=fr(),i=Ja(n),o=Vo(r,i);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=Ya(n,o,i),e!==null&&(Mi(e,n,i,r),Ap(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=fr(),r=Ja(n),i=Vo(t,r);i.tag=2,e!=null&&(i.callback=e),e=Ya(n,i,r),e!==null&&(Mi(e,n,r,t),Ap(e,n,r))}};function TS(n,e,t,r,i,o,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!Zh(t,r)||!Zh(i,o):!0}function Ik(n,e,t){var r=!1,i=ls,o=e.contextType;return typeof o=="object"&&o!==null?o=fi(o):(i=Ar(e)?pu:or.current,r=e.contextTypes,o=(r=r!=null)?Vl(n,i):ls),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Tg,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=o),e}function kS(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Tg.enqueueReplaceState(e,e.state,null)}function c1(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},vb(n);var o=e.contextType;typeof o=="object"&&o!==null?i.context=fi(o):(o=Ar(e)?pu:or.current,i.context=Vl(n,o)),i.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(l1(n,e,o,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Tg.enqueueReplaceState(i,i.state,null),vm(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function ql(n,e){try{var t="",r=e;do t+=h4(r),r=r.return;while(r);var i=t}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:i,digest:null}}function My(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function h1(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var zz=typeof WeakMap=="function"?WeakMap:Map;function Nk(n,e,t){t=Vo(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){_m||(_m=!0,x1=r),h1(n,e)},t}function Tk(n,e,t){t=Vo(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){h1(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){h1(n,e),typeof r!="function"&&(Qa===null?Qa=new Set([this]):Qa.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function RS(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new zz;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=Jz.bind(null,n,e,t),e.then(n,n))}function AS(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function DS(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Vo(-1,1),e.tag=2,Ya(t,e,1))),t.lanes|=1),n)}var Bz=aa.ReactCurrentOwner,Tr=!1;function lr(n,e,t,r){e.child=n===null?rk(e,null,t,r):Hl(e,n.child,t,r)}function OS(n,e,t,r,i){t=t.render;var o=e.ref;return Al(e,i),r=_b(n,e,t,r,o,i),t=Eb(),n!==null&&!Tr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Zo(n,e,i)):(Xt&&t&&cb(e),e.flags|=1,lr(n,e,r,i),e.child)}function PS(n,e,t,r,i){if(n===null){var o=t.type;return typeof o=="function"&&!Ob(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,kk(n,e,o,r,i)):(n=Fp(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,!(n.lanes&i)){var a=o.memoizedProps;if(t=t.compare,t=t!==null?t:Zh,t(a,r)&&n.ref===e.ref)return Zo(n,e,i)}return e.flags|=1,n=Za(o,r),n.ref=e.ref,n.return=e,e.child=n}function kk(n,e,t,r,i){if(n!==null){var o=n.memoizedProps;if(Zh(o,r)&&n.ref===e.ref)if(Tr=!1,e.pendingProps=r=o,(n.lanes&i)!==0)n.flags&131072&&(Tr=!0);else return e.lanes=n.lanes,Zo(n,e,i)}return d1(n,e,t,r,i)}function Rk(n,e,t){var r=e.pendingProps,i=r.children,o=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bt(El,Fr),Fr|=t;else{if(!(t&1073741824))return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Bt(El,Fr),Fr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:t,Bt(El,Fr),Fr|=r}else o!==null?(r=o.baseLanes|t,e.memoizedState=null):r=t,Bt(El,Fr),Fr|=r;return lr(n,e,i,t),e.child}function Ak(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function d1(n,e,t,r,i){var o=Ar(t)?pu:or.current;return o=Vl(e,o),Al(e,i),t=_b(n,e,t,r,o,i),r=Eb(),n!==null&&!Tr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Zo(n,e,i)):(Xt&&r&&cb(e),e.flags|=1,lr(n,e,t,i),e.child)}function MS(n,e,t,r,i){if(Ar(t)){var o=!0;dm(e)}else o=!1;if(Al(e,i),e.stateNode===null)Pp(n,e),Ik(e,t,r),c1(e,t,r,i),r=!0;else if(n===null){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,l=t.contextType;typeof l=="object"&&l!==null?l=fi(l):(l=Ar(t)?pu:or.current,l=Vl(e,l));var c=t.getDerivedStateFromProps,h=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==l)&&kS(e,a,r,l),Ra=!1;var d=e.memoizedState;a.state=d,vm(e,r,a,i),u=e.memoizedState,s!==r||d!==u||Rr.current||Ra?(typeof c=="function"&&(l1(e,t,c,r),u=e.memoizedState),(s=Ra||TS(e,t,s,r,d,u,l))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,ok(n,e),s=e.memoizedProps,l=e.type===e.elementType?s:xi(e.type,s),a.props=l,h=e.pendingProps,d=a.context,u=t.contextType,typeof u=="object"&&u!==null?u=fi(u):(u=Ar(t)?pu:or.current,u=Vl(e,u));var f=t.getDerivedStateFromProps;(c=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==h||d!==u)&&kS(e,a,r,u),Ra=!1,d=e.memoizedState,a.state=d,vm(e,r,a,i);var m=e.memoizedState;s!==h||d!==m||Rr.current||Ra?(typeof f=="function"&&(l1(e,t,f,r),m=e.memoizedState),(l=Ra||TS(e,t,l,r,d,m,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),a.props=r,a.state=m,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||s===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return f1(n,e,t,r,o,i)}function f1(n,e,t,r,i,o){Ak(n,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&bS(e,t,!1),Zo(n,e,o);r=e.stateNode,Bz.current=e;var s=a&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&a?(e.child=Hl(e,n.child,null,o),e.child=Hl(e,null,s,o)):lr(n,e,s,o),e.memoizedState=r.state,i&&bS(e,t,!0),e.child}function Dk(n){var e=n.stateNode;e.pendingContext?wS(n,e.pendingContext,e.pendingContext!==e.context):e.context&&wS(n,e.context,!1),yb(n,e.containerInfo)}function LS(n,e,t,r,i){return $l(),db(i),e.flags|=256,lr(n,e,t,r),e.child}var p1={dehydrated:null,treeContext:null,retryLane:0};function m1(n){return{baseLanes:n,cachePool:null,transitions:null}}function Ok(n,e,t){var r=e.pendingProps,i=Zt.current,o=!1,a=(e.flags&128)!==0,s;if((s=a)||(s=n!==null&&n.memoizedState===null?!1:(i&2)!==0),s?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Bt(Zt,i&1),n===null)return s1(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,n=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Ag(a,r,0,null),n=uu(n,r,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=m1(t),e.memoizedState=p1,n):Ib(e,a));if(i=n.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return jz(n,e,a,r,s,i,t);if(o){o=r.fallback,a=e.mode,i=n.child,s=i.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Za(i,u),r.subtreeFlags=i.subtreeFlags&14680064),s!==null?o=Za(s,o):(o=uu(o,a,t,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=n.child.memoizedState,a=a===null?m1(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=n.childLanes&~t,e.memoizedState=p1,r}return o=n.child,n=o.sibling,r=Za(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Ib(n,e){return e=Ag({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function np(n,e,t,r){return r!==null&&db(r),Hl(e,n.child,null,t),n=Ib(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function jz(n,e,t,r,i,o,a){if(t)return e.flags&256?(e.flags&=-257,r=My(Error(he(422))),np(n,e,a,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Ag({mode:"visible",children:r.children},i,0,null),o=uu(o,i,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Hl(e,n.child,null,a),e.child.memoizedState=m1(a),e.memoizedState=p1,o);if(!(e.mode&1))return np(n,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var s=r.dgst;return r=s,o=Error(he(419)),r=My(o,r,void 0),np(n,e,a,r)}if(s=(a&n.childLanes)!==0,Tr||s){if(r=zn,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Jo(n,i),Mi(r,n,i,-1))}return Db(),r=My(Error(he(421))),np(n,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=Zz.bind(null,n),i._reactRetry=e,null):(n=o.treeContext,Vr=Xa(i.nextSibling),Gr=e,Xt=!0,Ci=null,n!==null&&(si[ui++]=Fo,si[ui++]=zo,si[ui++]=mu,Fo=n.id,zo=n.overflow,mu=e),e=Ib(e,r.children),e.flags|=4096,e)}function FS(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),u1(n.return,e,t)}function Ly(n,e,t,r,i){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=t,o.tailMode=i)}function Pk(n,e,t){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(lr(n,e,r.children,t),r=Zt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&FS(n,t,e);else if(n.tag===19)FS(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Bt(Zt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&ym(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),Ly(e,!1,i,t,o);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&ym(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}Ly(e,!0,t,null,o);break;case"together":Ly(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Pp(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Zo(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),vu|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(he(153));if(e.child!==null){for(n=e.child,t=Za(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Za(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Uz(n,e,t){switch(e.tag){case 3:Dk(e),$l();break;case 5:ak(e);break;case 1:Ar(e.type)&&dm(e);break;case 4:yb(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Bt(mm,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Bt(Zt,Zt.current&1),e.flags|=128,null):t&e.child.childLanes?Ok(n,e,t):(Bt(Zt,Zt.current&1),n=Zo(n,e,t),n!==null?n.sibling:null);Bt(Zt,Zt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return Pk(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Bt(Zt,Zt.current),r)break;return null;case 22:case 23:return e.lanes=0,Rk(n,e,t)}return Zo(n,e,t)}var Mk,g1,Lk,Fk;Mk=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};g1=function(){};Lk=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Zs(oo.current);var o=null;switch(t){case"input":i=z0(n,i),r=z0(n,r),o=[];break;case"select":i=nn({},i,{value:void 0}),r=nn({},r,{value:void 0}),o=[];break;case"textarea":i=U0(n,i),r=U0(n,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=cm)}V0(t,r);var a;t=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var s=i[l];for(a in s)s.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Gh.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var u=r[l];if(s=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(t||(t={}),t[a]=u[a])}else t||(o||(o=[]),o.push(l,t)),t=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(o=o||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Gh.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&$t("scroll",n),o||s===u||(o=[])):(o=o||[]).push(l,u))}t&&(o=o||[]).push("style",t);var l=o;(e.updateQueue=l)&&(e.flags|=4)}};Fk=function(n,e,t,r){t!==r&&(e.flags|=4)};function Jc(n,e){if(!Xt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function nr(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function Wz(n,e,t){var r=e.pendingProps;switch(hb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(e),null;case 1:return Ar(e.type)&&hm(),nr(e),null;case 3:return r=e.stateNode,Gl(),Ht(Rr),Ht(or),bb(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(ep(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ci!==null&&(C1(Ci),Ci=null))),g1(n,e),nr(e),null;case 5:wb(e);var i=Zs(id.current);if(t=e.type,n!==null&&e.stateNode!=null)Lk(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(he(166));return nr(e),null}if(n=Zs(oo.current),ep(e)){r=e.stateNode,t=e.type;var o=e.memoizedProps;switch(r[eo]=e,r[nd]=o,n=(e.mode&1)!==0,t){case"dialog":$t("cancel",r),$t("close",r);break;case"iframe":case"object":case"embed":$t("load",r);break;case"video":case"audio":for(i=0;i<gh.length;i++)$t(gh[i],r);break;case"source":$t("error",r);break;case"img":case"image":case"link":$t("error",r),$t("load",r);break;case"details":$t("toggle",r);break;case"input":GC(r,o),$t("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},$t("invalid",r);break;case"textarea":KC(r,o),$t("invalid",r)}V0(t,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];a==="children"?typeof s=="string"?r.textContent!==s&&(o.suppressHydrationWarning!==!0&&Zf(r.textContent,s,n),i=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&Zf(r.textContent,s,n),i=["children",""+s]):Gh.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&$t("scroll",r)}switch(t){case"input":Hf(r),qC(r,o,!0);break;case"textarea":Hf(r),XC(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=cm)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=hT(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=a.createElement(t,{is:r.is}):(n=a.createElement(t),t==="select"&&(a=n,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):n=a.createElementNS(n,t),n[eo]=e,n[nd]=r,Mk(n,e,!1,!1),e.stateNode=n;e:{switch(a=$0(t,r),t){case"dialog":$t("cancel",n),$t("close",n),i=r;break;case"iframe":case"object":case"embed":$t("load",n),i=r;break;case"video":case"audio":for(i=0;i<gh.length;i++)$t(gh[i],n);i=r;break;case"source":$t("error",n),i=r;break;case"img":case"image":case"link":$t("error",n),$t("load",n),i=r;break;case"details":$t("toggle",n),i=r;break;case"input":GC(n,r),i=z0(n,r),$t("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=nn({},r,{value:void 0}),$t("invalid",n);break;case"textarea":KC(n,r),i=U0(n,r),$t("invalid",n);break;default:i=r}V0(t,i),s=i;for(o in s)if(s.hasOwnProperty(o)){var u=s[o];o==="style"?pT(n,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&dT(n,u)):o==="children"?typeof u=="string"?(t!=="textarea"||u!=="")&&qh(n,u):typeof u=="number"&&qh(n,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Gh.hasOwnProperty(o)?u!=null&&o==="onScroll"&&$t("scroll",n):u!=null&&Yw(n,o,u,a))}switch(t){case"input":Hf(n),qC(n,r,!1);break;case"textarea":Hf(n),XC(n);break;case"option":r.value!=null&&n.setAttribute("value",""+us(r.value));break;case"select":n.multiple=!!r.multiple,o=r.value,o!=null?Nl(n,!!r.multiple,o,!1):r.defaultValue!=null&&Nl(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=cm)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nr(e),null;case 6:if(n&&e.stateNode!=null)Fk(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(he(166));if(t=Zs(id.current),Zs(oo.current),ep(e)){if(r=e.stateNode,t=e.memoizedProps,r[eo]=e,(o=r.nodeValue!==t)&&(n=Gr,n!==null))switch(n.tag){case 3:Zf(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Zf(r.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[eo]=e,e.stateNode=r}return nr(e),null;case 13:if(Ht(Zt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Xt&&Vr!==null&&e.mode&1&&!(e.flags&128))tk(),$l(),e.flags|=98560,o=!1;else if(o=ep(e),r!==null&&r.dehydrated!==null){if(n===null){if(!o)throw Error(he(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(he(317));o[eo]=e}else $l(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nr(e),o=!1}else Ci!==null&&(C1(Ci),Ci=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Zt.current&1?Dn===0&&(Dn=3):Db())),e.updateQueue!==null&&(e.flags|=4),nr(e),null);case 4:return Gl(),g1(n,e),n===null&&ed(e.stateNode.containerInfo),nr(e),null;case 10:return mb(e.type._context),nr(e),null;case 17:return Ar(e.type)&&hm(),nr(e),null;case 19:if(Ht(Zt),o=e.memoizedState,o===null)return nr(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)Jc(o,!1);else{if(Dn!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=ym(n),a!==null){for(e.flags|=128,Jc(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)o=t,n=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,n=a.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Bt(Zt,Zt.current&1|2),e.child}n=n.sibling}o.tail!==null&&vn()>Kl&&(e.flags|=128,r=!0,Jc(o,!1),e.lanes=4194304)}else{if(!r)if(n=ym(a),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Jc(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Xt)return nr(e),null}else 2*vn()-o.renderingStartTime>Kl&&t!==1073741824&&(e.flags|=128,r=!0,Jc(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(t=o.last,t!==null?t.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=vn(),e.sibling=null,t=Zt.current,Bt(Zt,r?t&1|2:t&1),e):(nr(e),null);case 22:case 23:return Ab(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Fr&1073741824&&(nr(e),e.subtreeFlags&6&&(e.flags|=8192)):nr(e),null;case 24:return null;case 25:return null}throw Error(he(156,e.tag))}function Vz(n,e){switch(hb(e),e.tag){case 1:return Ar(e.type)&&hm(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Gl(),Ht(Rr),Ht(or),bb(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return wb(e),null;case 13:if(Ht(Zt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(he(340));$l()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Ht(Zt),null;case 4:return Gl(),null;case 10:return mb(e.type._context),null;case 22:case 23:return Ab(),null;case 24:return null;default:return null}}var rp=!1,rr=!1,$z=typeof WeakSet=="function"?WeakSet:Set,xe=null;function _l(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){un(n,e,r)}else t.current=null}function v1(n,e,t){try{t()}catch(r){un(n,e,r)}}var zS=!1;function Hz(n,e){if(e1=sm,n=WT(),lb(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var a=0,s=-1,u=-1,l=0,c=0,h=n,d=null;t:for(;;){for(var f;h!==t||i!==0&&h.nodeType!==3||(s=a+i),h!==o||r!==0&&h.nodeType!==3||(u=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===n)break t;if(d===t&&++l===i&&(s=a),d===o&&++c===r&&(u=a),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}t=s===-1||u===-1?null:{start:s,end:u}}else t=null}t=t||{start:0,end:0}}else t=null;for(t1={focusedElem:n,selectionRange:t},sm=!1,xe=e;xe!==null;)if(e=xe,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,xe=n;else for(;xe!==null;){e=xe;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,y=m.memoizedState,g=e.stateNode,w=g.getSnapshotBeforeUpdate(e.elementType===e.type?v:xi(e.type,v),y);g.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(S){un(e,e.return,S)}if(n=e.sibling,n!==null){n.return=e.return,xe=n;break}xe=e.return}return m=zS,zS=!1,m}function Ah(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var o=i.destroy;i.destroy=void 0,o!==void 0&&v1(e,t,o)}i=i.next}while(i!==r)}}function kg(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function y1(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function zk(n){var e=n.alternate;e!==null&&(n.alternate=null,zk(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[eo],delete e[nd],delete e[i1],delete e[Nz],delete e[Tz])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Bk(n){return n.tag===5||n.tag===3||n.tag===4}function BS(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Bk(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function w1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=cm));else if(r!==4&&(n=n.child,n!==null))for(w1(n,e,t),n=n.sibling;n!==null;)w1(n,e,t),n=n.sibling}function b1(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(b1(n,e,t),n=n.sibling;n!==null;)b1(n,e,t),n=n.sibling}var Hn=null,_i=!1;function Ea(n,e,t){for(t=t.child;t!==null;)jk(n,e,t),t=t.sibling}function jk(n,e,t){if(io&&typeof io.onCommitFiberUnmount=="function")try{io.onCommitFiberUnmount(xg,t)}catch{}switch(t.tag){case 5:rr||_l(t,e);case 6:var r=Hn,i=_i;Hn=null,Ea(n,e,t),Hn=r,_i=i,Hn!==null&&(_i?(n=Hn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Hn.removeChild(t.stateNode));break;case 18:Hn!==null&&(_i?(n=Hn,t=t.stateNode,n.nodeType===8?ky(n.parentNode,t):n.nodeType===1&&ky(n,t),Qh(n)):ky(Hn,t.stateNode));break;case 4:r=Hn,i=_i,Hn=t.stateNode.containerInfo,_i=!0,Ea(n,e,t),Hn=r,_i=i;break;case 0:case 11:case 14:case 15:if(!rr&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&v1(t,e,a),i=i.next}while(i!==r)}Ea(n,e,t);break;case 1:if(!rr&&(_l(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(s){un(t,e,s)}Ea(n,e,t);break;case 21:Ea(n,e,t);break;case 22:t.mode&1?(rr=(r=rr)||t.memoizedState!==null,Ea(n,e,t),rr=r):Ea(n,e,t);break;default:Ea(n,e,t)}}function jS(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new $z),e.forEach(function(r){var i=eB.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function bi(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var o=n,a=e,s=a;e:for(;s!==null;){switch(s.tag){case 5:Hn=s.stateNode,_i=!1;break e;case 3:Hn=s.stateNode.containerInfo,_i=!0;break e;case 4:Hn=s.stateNode.containerInfo,_i=!0;break e}s=s.return}if(Hn===null)throw Error(he(160));jk(o,a,i),Hn=null,_i=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(l){un(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Uk(e,n),e=e.sibling}function Uk(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(bi(e,n),Qi(n),r&4){try{Ah(3,n,n.return),kg(3,n)}catch(v){un(n,n.return,v)}try{Ah(5,n,n.return)}catch(v){un(n,n.return,v)}}break;case 1:bi(e,n),Qi(n),r&512&&t!==null&&_l(t,t.return);break;case 5:if(bi(e,n),Qi(n),r&512&&t!==null&&_l(t,t.return),n.flags&32){var i=n.stateNode;try{qh(i,"")}catch(v){un(n,n.return,v)}}if(r&4&&(i=n.stateNode,i!=null)){var o=n.memoizedProps,a=t!==null?t.memoizedProps:o,s=n.type,u=n.updateQueue;if(n.updateQueue=null,u!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&lT(i,o),$0(s,a);var l=$0(s,o);for(a=0;a<u.length;a+=2){var c=u[a],h=u[a+1];c==="style"?pT(i,h):c==="dangerouslySetInnerHTML"?dT(i,h):c==="children"?qh(i,h):Yw(i,c,h,l)}switch(s){case"input":B0(i,o);break;case"textarea":cT(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?Nl(i,!!o.multiple,f,!1):d!==!!o.multiple&&(o.defaultValue!=null?Nl(i,!!o.multiple,o.defaultValue,!0):Nl(i,!!o.multiple,o.multiple?[]:"",!1))}i[nd]=o}catch(v){un(n,n.return,v)}}break;case 6:if(bi(e,n),Qi(n),r&4){if(n.stateNode===null)throw Error(he(162));i=n.stateNode,o=n.memoizedProps;try{i.nodeValue=o}catch(v){un(n,n.return,v)}}break;case 3:if(bi(e,n),Qi(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Qh(e.containerInfo)}catch(v){un(n,n.return,v)}break;case 4:bi(e,n),Qi(n);break;case 13:bi(e,n),Qi(n),i=n.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(kb=vn())),r&4&&jS(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(rr=(l=rr)||c,bi(e,n),rr=l):bi(e,n),Qi(n),r&8192){if(l=n.memoizedState!==null,(n.stateNode.isHidden=l)&&!c&&n.mode&1)for(xe=n,c=n.child;c!==null;){for(h=xe=c;xe!==null;){switch(d=xe,f=d.child,d.tag){case 0:case 11:case 14:case 15:Ah(4,d,d.return);break;case 1:_l(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(v){un(r,t,v)}}break;case 5:_l(d,d.return);break;case 22:if(d.memoizedState!==null){WS(h);continue}}f!==null?(f.return=d,xe=f):WS(h)}c=c.sibling}e:for(c=null,h=n;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=h.stateNode,u=h.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=fT("display",a))}catch(v){un(n,n.return,v)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(v){un(n,n.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:bi(e,n),Qi(n),r&4&&jS(n);break;case 21:break;default:bi(e,n),Qi(n)}}function Qi(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Bk(t)){var r=t;break e}t=t.return}throw Error(he(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(qh(i,""),r.flags&=-33);var o=BS(n);b1(n,o,i);break;case 3:case 4:var a=r.stateNode.containerInfo,s=BS(n);w1(n,s,a);break;default:throw Error(he(161))}}catch(u){un(n,n.return,u)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Gz(n,e,t){xe=n,Wk(n)}function Wk(n,e,t){for(var r=(n.mode&1)!==0;xe!==null;){var i=xe,o=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||rp;if(!a){var s=i.alternate,u=s!==null&&s.memoizedState!==null||rr;s=rp;var l=rr;if(rp=a,(rr=u)&&!l)for(xe=i;xe!==null;)a=xe,u=a.child,a.tag===22&&a.memoizedState!==null?VS(i):u!==null?(u.return=a,xe=u):VS(i);for(;o!==null;)xe=o,Wk(o),o=o.sibling;xe=i,rp=s,rr=l}US(n)}else i.subtreeFlags&8772&&o!==null?(o.return=i,xe=o):US(n)}}function US(n){for(;xe!==null;){var e=xe;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:rr||kg(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!rr)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:xi(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&SS(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}SS(e,a,t)}break;case 5:var s=e.stateNode;if(t===null&&e.flags&4){t=s;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&t.focus();break;case"img":u.src&&(t.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Qh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}rr||e.flags&512&&y1(e)}catch(d){un(e,e.return,d)}}if(e===n){xe=null;break}if(t=e.sibling,t!==null){t.return=e.return,xe=t;break}xe=e.return}}function WS(n){for(;xe!==null;){var e=xe;if(e===n){xe=null;break}var t=e.sibling;if(t!==null){t.return=e.return,xe=t;break}xe=e.return}}function VS(n){for(;xe!==null;){var e=xe;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{kg(4,e)}catch(u){un(e,t,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){un(e,i,u)}}var o=e.return;try{y1(e)}catch(u){un(e,o,u)}break;case 5:var a=e.return;try{y1(e)}catch(u){un(e,a,u)}}}catch(u){un(e,e.return,u)}if(e===n){xe=null;break}var s=e.sibling;if(s!==null){s.return=e.return,xe=s;break}xe=e.return}}var qz=Math.ceil,xm=aa.ReactCurrentDispatcher,Nb=aa.ReactCurrentOwner,di=aa.ReactCurrentBatchConfig,gt=0,zn=null,bn=null,Yn=0,Fr=0,El=xs(0),Dn=0,ud=null,vu=0,Rg=0,Tb=0,Dh=null,Sr=null,kb=0,Kl=1/0,Do=null,_m=!1,x1=null,Qa=null,ip=!1,Ua=null,Em=0,Oh=0,_1=null,Mp=-1,Lp=0;function fr(){return gt&6?vn():Mp!==-1?Mp:Mp=vn()}function Ja(n){return n.mode&1?gt&2&&Yn!==0?Yn&-Yn:Rz.transition!==null?(Lp===0&&(Lp=IT()),Lp):(n=Tt,n!==0||(n=window.event,n=n===void 0?16:OT(n.type)),n):1}function Mi(n,e,t,r){if(50<Oh)throw Oh=0,_1=null,Error(he(185));Bd(n,t,r),(!(gt&2)||n!==zn)&&(n===zn&&(!(gt&2)&&(Rg|=t),Dn===4&&Oa(n,Yn)),Dr(n,r),t===1&&gt===0&&!(e.mode&1)&&(Kl=vn()+500,Ig&&_s()))}function Dr(n,e){var t=n.callbackNode;R4(n,e);var r=am(n,n===zn?Yn:0);if(r===0)t!==null&&JC(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&JC(t),e===1)n.tag===0?kz($S.bind(null,n)):JT($S.bind(null,n)),Sz(function(){!(gt&6)&&_s()}),t=null;else{switch(NT(r)){case 1:t=tb;break;case 4:t=CT;break;case 16:t=om;break;case 536870912:t=ST;break;default:t=om}t=Yk(t,Vk.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Vk(n,e){if(Mp=-1,Lp=0,gt&6)throw Error(he(327));var t=n.callbackNode;if(Dl()&&n.callbackNode!==t)return null;var r=am(n,n===zn?Yn:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Cm(n,r);else{e=r;var i=gt;gt|=2;var o=Hk();(zn!==n||Yn!==e)&&(Do=null,Kl=vn()+500,su(n,e));do try{Yz();break}catch(s){$k(n,s)}while(!0);pb(),xm.current=o,gt=i,bn!==null?e=0:(zn=null,Yn=0,e=Dn)}if(e!==0){if(e===2&&(i=X0(n),i!==0&&(r=i,e=E1(n,i))),e===1)throw t=ud,su(n,0),Oa(n,r),Dr(n,vn()),t;if(e===6)Oa(n,r);else{if(i=n.current.alternate,!(r&30)&&!Kz(i)&&(e=Cm(n,r),e===2&&(o=X0(n),o!==0&&(r=o,e=E1(n,o))),e===1))throw t=ud,su(n,0),Oa(n,r),Dr(n,vn()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(he(345));case 2:Us(n,Sr,Do);break;case 3:if(Oa(n,r),(r&130023424)===r&&(e=kb+500-vn(),10<e)){if(am(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){fr(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=r1(Us.bind(null,n,Sr,Do),e);break}Us(n,Sr,Do);break;case 4:if(Oa(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var a=31-Pi(r);o=1<<a,a=e[a],a>i&&(i=a),r&=~o}if(r=i,r=vn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*qz(r/1960))-r,10<r){n.timeoutHandle=r1(Us.bind(null,n,Sr,Do),r);break}Us(n,Sr,Do);break;case 5:Us(n,Sr,Do);break;default:throw Error(he(329))}}}return Dr(n,vn()),n.callbackNode===t?Vk.bind(null,n):null}function E1(n,e){var t=Dh;return n.current.memoizedState.isDehydrated&&(su(n,e).flags|=256),n=Cm(n,e),n!==2&&(e=Sr,Sr=t,e!==null&&C1(e)),n}function C1(n){Sr===null?Sr=n:Sr.push.apply(Sr,n)}function Kz(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],o=i.getSnapshot;i=i.value;try{if(!zi(o(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Oa(n,e){for(e&=~Tb,e&=~Rg,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Pi(e),r=1<<t;n[t]=-1,e&=~r}}function $S(n){if(gt&6)throw Error(he(327));Dl();var e=am(n,0);if(!(e&1))return Dr(n,vn()),null;var t=Cm(n,e);if(n.tag!==0&&t===2){var r=X0(n);r!==0&&(e=r,t=E1(n,r))}if(t===1)throw t=ud,su(n,0),Oa(n,e),Dr(n,vn()),t;if(t===6)throw Error(he(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Us(n,Sr,Do),Dr(n,vn()),null}function Rb(n,e){var t=gt;gt|=1;try{return n(e)}finally{gt=t,gt===0&&(Kl=vn()+500,Ig&&_s())}}function yu(n){Ua!==null&&Ua.tag===0&&!(gt&6)&&Dl();var e=gt;gt|=1;var t=di.transition,r=Tt;try{if(di.transition=null,Tt=1,n)return n()}finally{Tt=r,di.transition=t,gt=e,!(gt&6)&&_s()}}function Ab(){Fr=El.current,Ht(El)}function su(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Cz(t)),bn!==null)for(t=bn.return;t!==null;){var r=t;switch(hb(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hm();break;case 3:Gl(),Ht(Rr),Ht(or),bb();break;case 5:wb(r);break;case 4:Gl();break;case 13:Ht(Zt);break;case 19:Ht(Zt);break;case 10:mb(r.type._context);break;case 22:case 23:Ab()}t=t.return}if(zn=n,bn=n=Za(n.current,null),Yn=Fr=e,Dn=0,ud=null,Tb=Rg=vu=0,Sr=Dh=null,Js!==null){for(e=0;e<Js.length;e++)if(t=Js[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,o=t.pending;if(o!==null){var a=o.next;o.next=i,r.next=a}t.pending=r}Js=null}return n}function $k(n,e){do{var t=bn;try{if(pb(),Dp.current=bm,wm){for(var r=tn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}wm=!1}if(gu=0,Mn=kn=tn=null,Rh=!1,od=0,Nb.current=null,t===null||t.return===null){Dn=1,ud=e,bn=null;break}e:{var o=n,a=t.return,s=t,u=e;if(e=Yn,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=AS(a);if(f!==null){f.flags&=-257,DS(f,a,s,o,e),f.mode&1&&RS(o,l,e),e=f,u=l;var m=e.updateQueue;if(m===null){var v=new Set;v.add(u),e.updateQueue=v}else m.add(u);break e}else{if(!(e&1)){RS(o,l,e),Db();break e}u=Error(he(426))}}else if(Xt&&s.mode&1){var y=AS(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),DS(y,a,s,o,e),db(ql(u,s));break e}}o=u=ql(u,s),Dn!==4&&(Dn=2),Dh===null?Dh=[o]:Dh.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=Nk(o,u,e);CS(o,g);break e;case 1:s=u;var w=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Qa===null||!Qa.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var S=Tk(o,s,e);CS(o,S);break e}}o=o.return}while(o!==null)}qk(t)}catch(E){e=E,bn===t&&t!==null&&(bn=t=t.return);continue}break}while(!0)}function Hk(){var n=xm.current;return xm.current=bm,n===null?bm:n}function Db(){(Dn===0||Dn===3||Dn===2)&&(Dn=4),zn===null||!(vu&268435455)&&!(Rg&268435455)||Oa(zn,Yn)}function Cm(n,e){var t=gt;gt|=2;var r=Hk();(zn!==n||Yn!==e)&&(Do=null,su(n,e));do try{Xz();break}catch(i){$k(n,i)}while(!0);if(pb(),gt=t,xm.current=r,bn!==null)throw Error(he(261));return zn=null,Yn=0,Dn}function Xz(){for(;bn!==null;)Gk(bn)}function Yz(){for(;bn!==null&&!x4();)Gk(bn)}function Gk(n){var e=Xk(n.alternate,n,Fr);n.memoizedProps=n.pendingProps,e===null?qk(n):bn=e,Nb.current=null}function qk(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Vz(t,e),t!==null){t.flags&=32767,bn=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Dn=6,bn=null;return}}else if(t=Wz(t,e,Fr),t!==null){bn=t;return}if(e=e.sibling,e!==null){bn=e;return}bn=e=n}while(e!==null);Dn===0&&(Dn=5)}function Us(n,e,t){var r=Tt,i=di.transition;try{di.transition=null,Tt=1,Qz(n,e,t,r)}finally{di.transition=i,Tt=r}return null}function Qz(n,e,t,r){do Dl();while(Ua!==null);if(gt&6)throw Error(he(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(he(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(A4(n,o),n===zn&&(bn=zn=null,Yn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||ip||(ip=!0,Yk(om,function(){return Dl(),null})),o=(t.flags&15990)!==0,t.subtreeFlags&15990||o){o=di.transition,di.transition=null;var a=Tt;Tt=1;var s=gt;gt|=4,Nb.current=null,Hz(n,t),Uk(t,n),vz(t1),sm=!!e1,t1=e1=null,n.current=t,Gz(t),_4(),gt=s,Tt=a,di.transition=o}else n.current=t;if(ip&&(ip=!1,Ua=n,Em=i),o=n.pendingLanes,o===0&&(Qa=null),S4(t.stateNode),Dr(n,vn()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(_m)throw _m=!1,n=x1,x1=null,n;return Em&1&&n.tag!==0&&Dl(),o=n.pendingLanes,o&1?n===_1?Oh++:(Oh=0,_1=n):Oh=0,_s(),null}function Dl(){if(Ua!==null){var n=NT(Em),e=di.transition,t=Tt;try{if(di.transition=null,Tt=16>n?16:n,Ua===null)var r=!1;else{if(n=Ua,Ua=null,Em=0,gt&6)throw Error(he(331));var i=gt;for(gt|=4,xe=n.current;xe!==null;){var o=xe,a=o.child;if(xe.flags&16){var s=o.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(xe=l;xe!==null;){var c=xe;switch(c.tag){case 0:case 11:case 15:Ah(8,c,o)}var h=c.child;if(h!==null)h.return=c,xe=h;else for(;xe!==null;){c=xe;var d=c.sibling,f=c.return;if(zk(c),c===l){xe=null;break}if(d!==null){d.return=f,xe=d;break}xe=f}}}var m=o.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var y=v.sibling;v.sibling=null,v=y}while(v!==null)}}xe=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,xe=a;else e:for(;xe!==null;){if(o=xe,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ah(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,xe=g;break e}xe=o.return}}var w=n.current;for(xe=w;xe!==null;){a=xe;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,xe=b;else e:for(a=w;xe!==null;){if(s=xe,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:kg(9,s)}}catch(E){un(s,s.return,E)}if(s===a){xe=null;break e}var S=s.sibling;if(S!==null){S.return=s.return,xe=S;break e}xe=s.return}}if(gt=i,_s(),io&&typeof io.onPostCommitFiberRoot=="function")try{io.onPostCommitFiberRoot(xg,n)}catch{}r=!0}return r}finally{Tt=t,di.transition=e}}return!1}function HS(n,e,t){e=ql(t,e),e=Nk(n,e,1),n=Ya(n,e,1),e=fr(),n!==null&&(Bd(n,1,e),Dr(n,e))}function un(n,e,t){if(n.tag===3)HS(n,n,t);else for(;e!==null;){if(e.tag===3){HS(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Qa===null||!Qa.has(r))){n=ql(t,n),n=Tk(e,n,1),e=Ya(e,n,1),n=fr(),e!==null&&(Bd(e,1,n),Dr(e,n));break}}e=e.return}}function Jz(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=fr(),n.pingedLanes|=n.suspendedLanes&t,zn===n&&(Yn&t)===t&&(Dn===4||Dn===3&&(Yn&130023424)===Yn&&500>vn()-kb?su(n,0):Tb|=t),Dr(n,e)}function Kk(n,e){e===0&&(n.mode&1?(e=Kf,Kf<<=1,!(Kf&130023424)&&(Kf=4194304)):e=1);var t=fr();n=Jo(n,e),n!==null&&(Bd(n,e,t),Dr(n,t))}function Zz(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Kk(n,t)}function eB(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(he(314))}r!==null&&r.delete(e),Kk(n,t)}var Xk;Xk=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Rr.current)Tr=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Tr=!1,Uz(n,e,t);Tr=!!(n.flags&131072)}else Tr=!1,Xt&&e.flags&1048576&&ZT(e,pm,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Pp(n,e),n=e.pendingProps;var i=Vl(e,or.current);Al(e,t),i=_b(null,e,r,n,i,t);var o=Eb();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ar(r)?(o=!0,dm(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,vb(e),i.updater=Tg,e.stateNode=i,i._reactInternals=e,c1(e,r,n,t),e=f1(null,e,r,!0,o,t)):(e.tag=0,Xt&&o&&cb(e),lr(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Pp(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=nB(r),n=xi(r,n),i){case 0:e=d1(null,e,r,n,t);break e;case 1:e=MS(null,e,r,n,t);break e;case 11:e=OS(null,e,r,n,t);break e;case 14:e=PS(null,e,r,xi(r.type,n),t);break e}throw Error(he(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:xi(r,i),d1(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:xi(r,i),MS(n,e,r,i,t);case 3:e:{if(Dk(e),n===null)throw Error(he(387));r=e.pendingProps,o=e.memoizedState,i=o.element,ok(n,e),vm(e,r,null,t);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=ql(Error(he(423)),e),e=LS(n,e,r,t,i);break e}else if(r!==i){i=ql(Error(he(424)),e),e=LS(n,e,r,t,i);break e}else for(Vr=Xa(e.stateNode.containerInfo.firstChild),Gr=e,Xt=!0,Ci=null,t=rk(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if($l(),r===i){e=Zo(n,e,t);break e}lr(n,e,r,t)}e=e.child}return e;case 5:return ak(e),n===null&&s1(e),r=e.type,i=e.pendingProps,o=n!==null?n.memoizedProps:null,a=i.children,n1(r,i)?a=null:o!==null&&n1(r,o)&&(e.flags|=32),Ak(n,e),lr(n,e,a,t),e.child;case 6:return n===null&&s1(e),null;case 13:return Ok(n,e,t);case 4:return yb(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Hl(e,null,r,t):lr(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:xi(r,i),OS(n,e,r,i,t);case 7:return lr(n,e,e.pendingProps,t),e.child;case 8:return lr(n,e,e.pendingProps.children,t),e.child;case 12:return lr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,a=i.value,Bt(mm,r._currentValue),r._currentValue=a,o!==null)if(zi(o.value,a)){if(o.children===i.children&&!Rr.current){e=Zo(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var s=o.dependencies;if(s!==null){a=o.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=Vo(-1,t&-t),u.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}o.lanes|=t,u=o.alternate,u!==null&&(u.lanes|=t),u1(o.return,t,e),s.lanes|=t;break}u=u.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(he(341));a.lanes|=t,s=a.alternate,s!==null&&(s.lanes|=t),u1(a,t,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}lr(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Al(e,t),i=fi(i),r=r(i),e.flags|=1,lr(n,e,r,t),e.child;case 14:return r=e.type,i=xi(r,e.pendingProps),i=xi(r.type,i),PS(n,e,r,i,t);case 15:return kk(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:xi(r,i),Pp(n,e),e.tag=1,Ar(r)?(n=!0,dm(e)):n=!1,Al(e,t),Ik(e,r,i),c1(e,r,i,t),f1(null,e,r,!0,n,t);case 19:return Pk(n,e,t);case 22:return Rk(n,e,t)}throw Error(he(156,e.tag))};function Yk(n,e){return ET(n,e)}function tB(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ci(n,e,t,r){return new tB(n,e,t,r)}function Ob(n){return n=n.prototype,!(!n||!n.isReactComponent)}function nB(n){if(typeof n=="function")return Ob(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Jw)return 11;if(n===Zw)return 14}return 2}function Za(n,e){var t=n.alternate;return t===null?(t=ci(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Fp(n,e,t,r,i,o){var a=2;if(r=n,typeof n=="function")Ob(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case fl:return uu(t.children,i,o,e);case Qw:a=8,i|=8;break;case P0:return n=ci(12,t,e,i|2),n.elementType=P0,n.lanes=o,n;case M0:return n=ci(13,t,e,i),n.elementType=M0,n.lanes=o,n;case L0:return n=ci(19,t,e,i),n.elementType=L0,n.lanes=o,n;case aT:return Ag(t,i,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case iT:a=10;break e;case oT:a=9;break e;case Jw:a=11;break e;case Zw:a=14;break e;case ka:a=16,r=null;break e}throw Error(he(130,n==null?n:typeof n,""))}return e=ci(a,t,e,i),e.elementType=n,e.type=r,e.lanes=o,e}function uu(n,e,t,r){return n=ci(7,n,r,e),n.lanes=t,n}function Ag(n,e,t,r){return n=ci(22,n,r,e),n.elementType=aT,n.lanes=t,n.stateNode={isHidden:!1},n}function Fy(n,e,t){return n=ci(6,n,null,e),n.lanes=t,n}function zy(n,e,t){return e=ci(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function rB(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yy(0),this.expirationTimes=yy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yy(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Pb(n,e,t,r,i,o,a,s,u){return n=new rB(n,e,t,s,u),e===1?(e=1,o===!0&&(e|=8)):e=0,o=ci(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},vb(o),n}function iB(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dl,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function Qk(n){if(!n)return ls;n=n._reactInternals;e:{if(Ou(n)!==n||n.tag!==1)throw Error(he(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ar(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(he(171))}if(n.tag===1){var t=n.type;if(Ar(t))return QT(n,t,e)}return e}function Jk(n,e,t,r,i,o,a,s,u){return n=Pb(t,r,!0,n,i,o,a,s,u),n.context=Qk(null),t=n.current,r=fr(),i=Ja(t),o=Vo(r,i),o.callback=e??null,Ya(t,o,i),n.current.lanes=i,Bd(n,i,r),Dr(n,r),n}function Dg(n,e,t,r){var i=e.current,o=fr(),a=Ja(i);return t=Qk(t),e.context===null?e.context=t:e.pendingContext=t,e=Vo(o,a),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Ya(i,e,a),n!==null&&(Mi(n,i,a,o),Ap(n,i,a)),a}function Sm(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function GS(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Mb(n,e){GS(n,e),(n=n.alternate)&&GS(n,e)}function oB(){return null}var Zk=typeof reportError=="function"?reportError:function(n){console.error(n)};function Lb(n){this._internalRoot=n}Og.prototype.render=Lb.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(he(409));Dg(n,e,null,null)};Og.prototype.unmount=Lb.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;yu(function(){Dg(null,n,null,null)}),e[Qo]=null}};function Og(n){this._internalRoot=n}Og.prototype.unstable_scheduleHydration=function(n){if(n){var e=RT();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Da.length&&e!==0&&e<Da[t].priority;t++);Da.splice(t,0,n),t===0&&DT(n)}};function Fb(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Pg(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function qS(){}function aB(n,e,t,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var l=Sm(a);o.call(l)}}var a=Jk(e,r,n,0,null,!1,!1,"",qS);return n._reactRootContainer=a,n[Qo]=a.current,ed(n.nodeType===8?n.parentNode:n),yu(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var s=r;r=function(){var l=Sm(u);s.call(l)}}var u=Pb(n,0,!1,null,null,!1,!1,"",qS);return n._reactRootContainer=u,n[Qo]=u.current,ed(n.nodeType===8?n.parentNode:n),yu(function(){Dg(e,u,t,r)}),u}function Mg(n,e,t,r,i){var o=t._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var s=i;i=function(){var u=Sm(a);s.call(u)}}Dg(e,a,n,i)}else a=aB(t,e,n,i,r);return Sm(a)}TT=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=mh(e.pendingLanes);t!==0&&(nb(e,t|1),Dr(e,vn()),!(gt&6)&&(Kl=vn()+500,_s()))}break;case 13:yu(function(){var r=Jo(n,1);if(r!==null){var i=fr();Mi(r,n,1,i)}}),Mb(n,1)}};rb=function(n){if(n.tag===13){var e=Jo(n,134217728);if(e!==null){var t=fr();Mi(e,n,134217728,t)}Mb(n,134217728)}};kT=function(n){if(n.tag===13){var e=Ja(n),t=Jo(n,e);if(t!==null){var r=fr();Mi(t,n,e,r)}Mb(n,e)}};RT=function(){return Tt};AT=function(n,e){var t=Tt;try{return Tt=n,e()}finally{Tt=t}};G0=function(n,e,t){switch(e){case"input":if(B0(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=Sg(r);if(!i)throw Error(he(90));uT(r),B0(r,i)}}}break;case"textarea":cT(n,t);break;case"select":e=t.value,e!=null&&Nl(n,!!t.multiple,e,!1)}};vT=Rb;yT=yu;var sB={usingClientEntryPoint:!1,Events:[Ud,vl,Sg,mT,gT,Rb]},Zc={findFiberByHostInstance:Qs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uB={bundleType:Zc.bundleType,version:Zc.version,rendererPackageName:Zc.rendererPackageName,rendererConfig:Zc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:aa.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=xT(n),n===null?null:n.stateNode},findFiberByHostInstance:Zc.findFiberByHostInstance||oB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var op=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!op.isDisabled&&op.supportsFiber)try{xg=op.inject(uB),io=op}catch{}}Jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sB;Jr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fb(e))throw Error(he(200));return iB(n,e,null,t)};Jr.createRoot=function(n,e){if(!Fb(n))throw Error(he(299));var t=!1,r="",i=Zk;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Pb(n,1,!1,null,null,t,!1,r,i),n[Qo]=e.current,ed(n.nodeType===8?n.parentNode:n),new Lb(e)};Jr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(he(188)):(n=Object.keys(n).join(","),Error(he(268,n)));return n=xT(e),n=n===null?null:n.stateNode,n};Jr.flushSync=function(n){return yu(n)};Jr.hydrate=function(n,e,t){if(!Pg(e))throw Error(he(200));return Mg(null,n,e,!0,t)};Jr.hydrateRoot=function(n,e,t){if(!Fb(n))throw Error(he(405));var r=t!=null&&t.hydratedSources||null,i=!1,o="",a=Zk;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=Jk(e,null,n,1,t??null,i,!1,o,a),n[Qo]=e.current,ed(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new Og(e)};Jr.render=function(n,e,t){if(!Pg(e))throw Error(he(200));return Mg(null,n,e,!1,t)};Jr.unmountComponentAtNode=function(n){if(!Pg(n))throw Error(he(40));return n._reactRootContainer?(yu(function(){Mg(null,null,n,!1,function(){n._reactRootContainer=null,n[Qo]=null})}),!0):!1};Jr.unstable_batchedUpdates=Rb;Jr.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Pg(t))throw Error(he(200));if(n==null||n._reactInternals===void 0)throw Error(he(38));return Mg(n,e,t,!1,r)};Jr.version="18.3.1-next-f1338f8080-20240426";function eR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(eR)}catch(n){console.error(n)}}eR(),eT.exports=Jr;var tR=eT.exports,nR,KS=tR;nR=KS.createRoot,KS.hydrateRoot;var zb={};Object.defineProperty(zb,"__esModule",{value:!0});zb.parse=mB;zb.serialize=gB;const lB=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,cB=/^[\u0021-\u003A\u003C-\u007E]*$/,hB=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,dB=/^[\u0020-\u003A\u003D-\u007E]*$/,fB=Object.prototype.toString,pB=(()=>{const n=function(){};return n.prototype=Object.create(null),n})();function mB(n,e){const t=new pB,r=n.length;if(r<2)return t;const i=(e==null?void 0:e.decode)||vB;let o=0;do{const a=n.indexOf("=",o);if(a===-1)break;const s=n.indexOf(";",o),u=s===-1?r:s;if(a>u){o=n.lastIndexOf(";",a-1)+1;continue}const l=XS(n,o,a),c=YS(n,a,l),h=n.slice(l,c);if(t[h]===void 0){let d=XS(n,a+1,u),f=YS(n,u,d);const m=i(n.slice(d,f));t[h]=m}o=u+1}while(o<r);return t}function XS(n,e,t){do{const r=n.charCodeAt(e);if(r!==32&&r!==9)return e}while(++e<t);return t}function YS(n,e,t){for(;e>t;){const r=n.charCodeAt(--e);if(r!==32&&r!==9)return e+1}return t}function gB(n,e,t){const r=(t==null?void 0:t.encode)||encodeURIComponent;if(!lB.test(n))throw new TypeError(`argument name is invalid: ${n}`);const i=r(e);if(!cB.test(i))throw new TypeError(`argument val is invalid: ${e}`);let o=n+"="+i;if(!t)return o;if(t.maxAge!==void 0){if(!Number.isInteger(t.maxAge))throw new TypeError(`option maxAge is invalid: ${t.maxAge}`);o+="; Max-Age="+t.maxAge}if(t.domain){if(!hB.test(t.domain))throw new TypeError(`option domain is invalid: ${t.domain}`);o+="; Domain="+t.domain}if(t.path){if(!dB.test(t.path))throw new TypeError(`option path is invalid: ${t.path}`);o+="; Path="+t.path}if(t.expires){if(!yB(t.expires)||!Number.isFinite(t.expires.valueOf()))throw new TypeError(`option expires is invalid: ${t.expires}`);o+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(o+="; HttpOnly"),t.secure&&(o+="; Secure"),t.partitioned&&(o+="; Partitioned"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():void 0){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${t.priority}`)}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:case"strict":o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"none":o+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${t.sameSite}`)}return o}function vB(n){if(n.indexOf("%")===-1)return n;try{return decodeURIComponent(n)}catch{return n}}function yB(n){return fB.call(n)==="[object Date]"}/**
 * react-router v7.0.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var QS="popstate";function wB(n={}){function e(r,i){let{pathname:o,search:a,hash:s}=r.location;return ld("",{pathname:o,search:a,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:cs(i)}return xB(e,t,null,n)}function lt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Bn(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bB(){return Math.random().toString(36).substring(2,10)}function JS(n,e){return{usr:n.state,key:n.key,idx:e}}function ld(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Es(e):e,state:t,key:e&&e.key||r||bB()}}function cs({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Es(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function xB(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,s="POP",u=null,l=c();l==null&&(l=0,a.replaceState({...a.state,idx:l},""));function c(){return(a.state||{idx:null}).idx}function h(){s="POP";let y=c(),g=y==null?null:y-l;l=y,u&&u({action:s,location:v.location,delta:g})}function d(y,g){s="PUSH";let w=ld(v.location,y,g);l=c()+1;let b=JS(w,l),S=v.createHref(w);try{a.pushState(b,"",S)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;i.location.assign(S)}o&&u&&u({action:s,location:v.location,delta:1})}function f(y,g){s="REPLACE";let w=ld(v.location,y,g);l=c();let b=JS(w,l),S=v.createHref(w);a.replaceState(b,"",S),o&&u&&u({action:s,location:v.location,delta:0})}function m(y){let g=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof y=="string"?y:cs(y);return w=w.replace(/ $/,"%20"),lt(g,`No window.location.(origin|href) available to create URL for href: ${w}`),new URL(w,g)}let v={get action(){return s},get location(){return n(i,a)},listen(y){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(QS,h),u=y,()=>{i.removeEventListener(QS,h),u=null}},createHref(y){return e(i,y)},createURL:m,encodeLocation(y){let g=m(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:d,replace:f,go(y){return a.go(y)}};return v}var _B=new Set(["lazy","caseSensitive","path","id","index","children"]);function EB(n){return n.index===!0}function Im(n,e,t=[],r={}){return n.map((i,o)=>{let a=[...t,String(o)],s=typeof i.id=="string"?i.id:a.join("-");if(lt(i.index!==!0||!i.children,"Cannot specify children on an index route"),lt(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),EB(i)){let u={...i,...e(i),id:s};return r[s]=u,u}else{let u={...i,...e(i),id:s,children:void 0};return r[s]=u,i.children&&(u.children=Im(i.children,e,a,r)),u}})}function Pa(n,e,t="/"){return zp(n,e,t,!1)}function zp(n,e,t,r){let i=typeof e=="string"?Es(e):e,o=Bi(i.pathname||"/",t);if(o==null)return null;let a=rR(n);SB(a);let s=null;for(let u=0;s==null&&u<a.length;++u){let l=LB(o);s=PB(a[u],l,r)}return s}function CB(n,e){let{route:t,pathname:r,params:i}=n;return{id:t.id,pathname:r,params:i,data:e[t.id],handle:t.handle}}function rR(n,e=[],t=[],r=""){let i=(o,a,s)=>{let u={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};u.relativePath.startsWith("/")&&(lt(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length));let l=ao([r,u.relativePath]),c=t.concat(u);o.children&&o.children.length>0&&(lt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),rR(o.children,e,c,l)),!(o.path==null&&!o.index)&&e.push({path:l,score:DB(l,o.index),routesMeta:c})};return n.forEach((o,a)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))i(o,a);else for(let u of iR(o.path))i(o,a,u)}),e}function iR(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let a=iR(r.join("/")),s=[];return s.push(...a.map(u=>u===""?o:[o,u].join("/"))),i&&s.push(...a),s.map(u=>n.startsWith("/")&&u===""?"/":u)}function SB(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:OB(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var IB=/^:[\w-]+$/,NB=3,TB=2,kB=1,RB=10,AB=-2,ZS=n=>n==="*";function DB(n,e){let t=n.split("/"),r=t.length;return t.some(ZS)&&(r+=AB),e&&(r+=TB),t.filter(i=>!ZS(i)).reduce((i,o)=>i+(IB.test(o)?NB:o===""?kB:RB),r)}function OB(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function PB(n,e,t=!1){let{routesMeta:r}=n,i={},o="/",a=[];for(let s=0;s<r.length;++s){let u=r[s],l=s===r.length-1,c=o==="/"?e:e.slice(o.length)||"/",h=Nm({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},c),d=u.route;if(!h&&l&&t&&!r[r.length-1].route.index&&(h=Nm({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},c)),!h)return null;Object.assign(i,h.params),a.push({params:i,pathname:ao([o,h.pathname]),pathnameBase:BB(ao([o,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(o=ao([o,h.pathnameBase]))}return a}function Nm(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=MB(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((l,{paramName:c,isOptional:h},d)=>{if(c==="*"){let m=s[d]||"";a=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const f=s[d];return h&&!f?l[c]=void 0:l[c]=(f||"").replace(/%2F/g,"/"),l},{}),pathname:o,pathnameBase:a,pattern:n}}function MB(n,e=!1,t=!0){Bn(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function LB(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Bn(!1,`The URL path "${n}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Bi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function FB(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Es(n):n;return{pathname:t?t.startsWith("/")?t:zB(t,e):e,search:jB(r),hash:UB(i)}}function zB(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function By(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function oR(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Lg(n){let e=oR(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Fg(n,e,t,r=!1){let i;typeof n=="string"?i=Es(n):(i={...n},lt(!i.pathname||!i.pathname.includes("?"),By("?","pathname","search",i)),lt(!i.pathname||!i.pathname.includes("#"),By("#","pathname","hash",i)),lt(!i.search||!i.search.includes("#"),By("#","search","hash",i)));let o=n===""||i.pathname==="",a=o?"/":i.pathname,s;if(a==null)s=t;else{let h=e.length-1;if(!r&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}s=h>=0?e[h]:"/"}let u=FB(i,s),l=a&&a!=="/"&&a.endsWith("/"),c=(o||a===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(l||c)&&(u.pathname+="/"),u}var ao=n=>n.join("/").replace(/\/\/+/g,"/"),BB=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),jB=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,UB=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,Tm=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function zg(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var aR=["POST","PUT","PATCH","DELETE"],WB=new Set(aR),VB=["GET",...aR],$B=new Set(VB),HB=new Set([301,302,303,307,308]),GB=new Set([307,308]),jy={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},qB={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},eh={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Bb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KB=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),sR="remix-router-transitions",uR=Symbol("ResetLoaderData");function XB(n){const e=n.window?n.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u";lt(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=n.mapRouteProperties||KB,i={},o=Im(n.routes,r,void 0,i),a,s=n.basename||"/",u=n.dataStrategy||ej,l=n.patchRoutesOnNavigation,c={...n.future},h=null,d=new Set,f=null,m=null,v=null,y=n.hydrationData!=null,g=Pa(o,n.history.location,s),w=null;if(g==null&&!l){let G=ai(404,{pathname:n.history.location.pathname}),{matches:Y,route:re}=c2(o);g=Y,w={[re.id]:G}}g&&!n.hydrationData&&ya(g,o,n.history.location.pathname).active&&(g=null);let b;if(g)if(g.some(G=>G.route.lazy))b=!1;else if(!g.some(G=>G.route.loader))b=!0;else{let G=n.hydrationData?n.hydrationData.loaderData:null,Y=n.hydrationData?n.hydrationData.errors:null;if(Y){let re=g.findIndex(ue=>Y[ue.route.id]!==void 0);b=g.slice(0,re+1).every(ue=>!I1(ue.route,G,Y))}else b=g.every(re=>!I1(re.route,G,Y))}else{b=!1,g=[];let G=ya(null,o,n.history.location.pathname);G.active&&G.matches&&(g=G.matches)}let S,E={historyAction:n.history.action,location:n.history.location,matches:g,initialized:b,navigation:jy,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||w,fetchers:new Map,blockers:new Map},T="POP",_=!1,x,C=!1,N=new Map,R=null,k=!1,D=!1,W=new Set,U=new Map,j=0,H=-1,z=new Map,q=new Set,F=new Map,oe=new Map,Q=new Set,ae=new Map,me,fe=null;function pe(){if(h=n.history.listen(({action:G,location:Y,delta:re})=>{if(me){me(),me=void 0;return}Bn(ae.size===0||re!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ue=va({currentLocation:E.location,nextLocation:Y,historyAction:G});if(ue&&re!=null){let be=new Promise(ke=>{me=ke});n.history.go(re*-1),Yi(ue,{state:"blocked",location:Y,proceed(){Yi(ue,{state:"proceeding",proceed:void 0,reset:void 0,location:Y}),be.then(()=>n.history.go(re))},reset(){let ke=new Map(E.blockers);ke.set(ue,eh),Te({blockers:ke})}});return}return ze(G,Y)}),t){hj(e,N);let G=()=>dj(e,N);e.addEventListener("pagehide",G),R=()=>e.removeEventListener("pagehide",G)}return E.initialized||ze("POP",E.location,{initialHydration:!0}),S}function Ce(){h&&h(),R&&R(),d.clear(),x&&x.abort(),E.fetchers.forEach((G,Y)=>Jt(Y)),E.blockers.forEach((G,Y)=>ni(Y))}function Me(G){return d.add(G),()=>d.delete(G)}function Te(G,Y={}){E={...E,...G};let re=[],ue=[];E.fetchers.forEach((be,ke)=>{be.state==="idle"&&(Q.has(ke)?re.push(ke):ue.push(ke))}),[...d].forEach(be=>be(E,{deletedFetchers:re,viewTransitionOpts:Y.viewTransitionOpts,flushSync:Y.flushSync===!0})),re.forEach(be=>Jt(be)),ue.forEach(be=>E.fetchers.delete(be))}function Ke(G,Y,{flushSync:re}={}){var ve,Ge;let ue=E.actionData!=null&&E.navigation.formMethod!=null&&Ei(E.navigation.formMethod)&&E.navigation.state==="loading"&&((ve=G.state)==null?void 0:ve._isRedirect)!==!0,be;Y.actionData?Object.keys(Y.actionData).length>0?be=Y.actionData:be=null:ue?be=E.actionData:be=null;let ke=Y.loaderData?u2(E.loaderData,Y.loaderData,Y.matches||[],Y.errors):E.loaderData,Oe=E.blockers;Oe.size>0&&(Oe=new Map(Oe),Oe.forEach((Je,Rt)=>Oe.set(Rt,eh)));let Se=_===!0||E.navigation.formMethod!=null&&Ei(E.navigation.formMethod)&&((Ge=G.state)==null?void 0:Ge._isRedirect)!==!0;a&&(o=a,a=void 0),k||T==="POP"||(T==="PUSH"?n.history.push(G,G.state):T==="REPLACE"&&n.history.replace(G,G.state));let Re;if(T==="POP"){let Je=N.get(E.location.pathname);Je&&Je.has(G.pathname)?Re={currentLocation:E.location,nextLocation:G}:N.has(G.pathname)&&(Re={currentLocation:G,nextLocation:E.location})}else if(C){let Je=N.get(E.location.pathname);Je?Je.add(G.pathname):(Je=new Set([G.pathname]),N.set(E.location.pathname,Je)),Re={currentLocation:E.location,nextLocation:G}}Te({...Y,actionData:be,loaderData:ke,historyAction:T,location:G,initialized:!0,navigation:jy,revalidation:"idle",restoreScrollPosition:Qu(G,Y.matches||E.matches),preventScrollReset:Se,blockers:Oe},{viewTransitionOpts:Re,flushSync:re===!0}),T="POP",_=!1,C=!1,k=!1,D=!1,fe==null||fe.resolve(),fe=null}async function Fe(G,Y){if(typeof G=="number"){n.history.go(G);return}let re=S1(E.location,E.matches,s,G,Y==null?void 0:Y.fromRouteId,Y==null?void 0:Y.relative),{path:ue,submission:be,error:ke}=e2(!1,re,Y),Oe=E.location,Se=ld(E.location,ue,Y&&Y.state);Se={...Se,...n.history.encodeLocation(Se)};let Re=Y&&Y.replace!=null?Y.replace:void 0,ve="PUSH";Re===!0?ve="REPLACE":Re===!1||be!=null&&Ei(be.formMethod)&&be.formAction===E.location.pathname+E.location.search&&(ve="REPLACE");let Ge=Y&&"preventScrollReset"in Y?Y.preventScrollReset===!0:void 0,Je=(Y&&Y.flushSync)===!0,Rt=va({currentLocation:Oe,nextLocation:Se,historyAction:ve});if(Rt){Yi(Rt,{state:"blocked",location:Se,proceed(){Yi(Rt,{state:"proceeding",proceed:void 0,reset:void 0,location:Se}),Fe(G,Y)},reset(){let Nn=new Map(E.blockers);Nn.set(Rt,eh),Te({blockers:Nn})}});return}await ze(ve,Se,{submission:be,pendingError:ke,preventScrollReset:Ge,replace:Y&&Y.replace,enableViewTransition:Y&&Y.viewTransition,flushSync:Je})}function Xe(){fe||(fe=fj()),Qt(),Te({revalidation:"loading"});let G=fe.promise;return E.navigation.state==="submitting"?G:E.navigation.state==="idle"?(ze(E.historyAction,E.location,{startUninterruptedRevalidation:!0}),G):(ze(T||E.historyAction,E.navigation.location,{overrideNavigation:E.navigation,enableViewTransition:C===!0}),G)}async function ze(G,Y,re){x&&x.abort(),x=null,T=G,k=(re&&re.startUninterruptedRevalidation)===!0,Ps(E.location,E.matches),_=(re&&re.preventScrollReset)===!0,C=(re&&re.enableViewTransition)===!0;let ue=a||o,be=re&&re.overrideNavigation,ke=Pa(ue,Y,s),Oe=(re&&re.flushSync)===!0,Se=ya(ke,ue,Y.pathname);if(Se.active&&Se.matches&&(ke=Se.matches),!ke){let{error:Ot,notFoundMatches:Et,route:At}=Os(Y.pathname);Ke(Y,{matches:Et,loaderData:{},errors:{[At.id]:Ot}},{flushSync:Oe});return}if(E.initialized&&!D&&aj(E.location,Y)&&!(re&&re.submission&&Ei(re.submission.formMethod))){Ke(Y,{matches:ke},{flushSync:Oe});return}x=new AbortController;let Re=rl(n.history,Y,x.signal,re&&re.submission),ve;if(re&&re.pendingError)ve=[Xs(ke).route.id,{type:"error",error:re.pendingError}];else if(re&&re.submission&&Ei(re.submission.formMethod)){let Ot=await Be(Re,Y,re.submission,ke,Se.active,{replace:re.replace,flushSync:Oe});if(Ot.shortCircuited)return;if(Ot.pendingActionResult){let[Et,At]=Ot.pendingActionResult;if(Br(At)&&zg(At.error)&&At.error.status===404){x=null,Ke(Y,{matches:Ot.matches,loaderData:{},errors:{[Et]:At.error}});return}}ke=Ot.matches||ke,ve=Ot.pendingActionResult,be=Uy(Y,re.submission),Oe=!1,Se.active=!1,Re=rl(n.history,Re.url,Re.signal)}let{shortCircuited:Ge,matches:Je,loaderData:Rt,errors:Nn}=await dt(Re,Y,ke,Se.active,be,re&&re.submission,re&&re.fetcherSubmission,re&&re.replace,re&&re.initialHydration===!0,Oe,ve);Ge||(x=null,Ke(Y,{matches:Je||ke,...l2(ve),loaderData:Rt,errors:Nn}))}async function Be(G,Y,re,ue,be,ke={}){Qt();let Oe=lj(Y,re);if(Te({navigation:Oe},{flushSync:ke.flushSync===!0}),be){let ve=await yi(ue,Y.pathname,G.signal);if(ve.type==="aborted")return{shortCircuited:!0};if(ve.type==="error"){let Ge=Xs(ve.partialMatches).route.id;return{matches:ve.partialMatches,pendingActionResult:[Ge,{type:"error",error:ve.error}]}}else if(ve.matches)ue=ve.matches;else{let{notFoundMatches:Ge,error:Je,route:Rt}=Os(Y.pathname);return{matches:Ge,pendingActionResult:[Rt.id,{type:"error",error:Je}]}}}let Se,Re=vh(ue,Y);if(!Re.route.action&&!Re.route.lazy)Se={type:"error",error:ai(405,{method:G.method,pathname:Y.pathname,routeId:Re.route.id})};else if(Se=(await Ut("action",E,G,[Re],ue,null))[Re.route.id],G.signal.aborted)return{shortCircuited:!0};if(eu(Se)){let ve;return ke&&ke.replace!=null?ve=ke.replace:ve=o2(Se.response.headers.get("Location"),new URL(G.url),s)===E.location.pathname+E.location.search,await xt(G,Se,!0,{submission:re,replace:ve}),{shortCircuited:!0}}if(Br(Se)){let ve=Xs(ue,Re.route.id);return(ke&&ke.replace)!==!0&&(T="PUSH"),{matches:ue,pendingActionResult:[ve.route.id,Se]}}return{matches:ue,pendingActionResult:[Re.route.id,Se]}}async function dt(G,Y,re,ue,be,ke,Oe,Se,Re,ve,Ge){let Je=be||Uy(Y,ke),Rt=ke||Oe||d2(Je),Nn=!k&&!Re;if(ue){if(Nn){let on=nt(Ge);Te({navigation:Je,...on!==void 0?{actionData:on}:{}},{flushSync:ve})}let Ct=await yi(re,Y.pathname,G.signal);if(Ct.type==="aborted")return{shortCircuited:!0};if(Ct.type==="error"){let on=Xs(Ct.partialMatches).route.id;return{matches:Ct.partialMatches,loaderData:{},errors:{[on]:Ct.error}}}else if(Ct.matches)re=Ct.matches;else{let{error:on,notFoundMatches:ri,route:Co}=Os(Y.pathname);return{matches:ri,loaderData:{},errors:{[Co.id]:on}}}}let Ot=a||o,[Et,At]=n2(n.history,E,re,Rt,Y,Re===!0,D,W,Q,F,q,Ot,s,Ge);if(H=++j,Et.length===0&&At.length===0){let Ct=ti();return Ke(Y,{matches:re,loaderData:{},errors:Ge&&Br(Ge[1])?{[Ge[0]]:Ge[1].error}:null,...l2(Ge),...Ct?{fetchers:new Map(E.fetchers)}:{}},{flushSync:ve}),{shortCircuited:!0}}if(Nn){let Ct={};if(!ue){Ct.navigation=Je;let on=nt(Ge);on!==void 0&&(Ct.actionData=on)}At.length>0&&(Ct.fetchers=rn(At)),Te(Ct,{flushSync:ve})}At.forEach(Ct=>{In(Ct.key),Ct.controller&&U.set(Ct.key,Ct.controller)});let xo=()=>At.forEach(Ct=>In(Ct.key));x&&x.signal.addEventListener("abort",xo);let{loaderResults:wa,fetcherResults:Lr}=await je(E,re,Et,At,G);if(G.signal.aborted)return{shortCircuited:!0};x&&x.signal.removeEventListener("abort",xo),At.forEach(Ct=>U.delete(Ct.key));let _r=ap(wa);if(_r)return await xt(G,_r.result,!0,{replace:Se}),{shortCircuited:!0};if(_r=ap(Lr),_r)return q.add(_r.key),await xt(G,_r.result,!0,{replace:Se}),{shortCircuited:!0};let{loaderData:Ju,errors:ba}=s2(E,re,wa,Ge,At,Lr);Re&&E.errors&&(ba={...E.errors,...ba});let _o=ti(),Eo=bo(H),Ms=_o||Eo||At.length>0;return{matches:re,loaderData:Ju,errors:ba,...Ms?{fetchers:new Map(E.fetchers)}:{}}}function nt(G){if(G&&!Br(G[1]))return{[G[0]]:G[1].data};if(E.actionData)return Object.keys(E.actionData).length===0?null:E.actionData}function rn(G){return G.forEach(Y=>{let re=E.fetchers.get(Y.key),ue=th(void 0,re?re.data:void 0);E.fetchers.set(Y.key,ue)}),new Map(E.fetchers)}async function Sn(G,Y,re,ue){In(G);let be=(ue&&ue.flushSync)===!0,ke=a||o,Oe=S1(E.location,E.matches,s,re,Y,ue==null?void 0:ue.relative),Se=Pa(ke,Oe,s),Re=ya(Se,ke,Oe);if(Re.active&&Re.matches&&(Se=Re.matches),!Se){Ue(G,Y,ai(404,{pathname:Oe}),{flushSync:be});return}let{path:ve,submission:Ge,error:Je}=e2(!0,Oe,ue);if(Je){Ue(G,Y,Je,{flushSync:be});return}let Rt=vh(Se,ve),Nn=(ue&&ue.preventScrollReset)===!0;if(Ge&&Ei(Ge.formMethod)){await Kt(G,Y,ve,Rt,Se,Re.active,be,Nn,Ge);return}F.set(G,{routeId:Y,path:ve}),await pn(G,Y,ve,Rt,Se,Re.active,be,Nn,Ge)}async function Kt(G,Y,re,ue,be,ke,Oe,Se,Re){Qt(),F.delete(G);function ve(an){if(!an.route.action&&!an.route.lazy){let So=ai(405,{method:Re.formMethod,pathname:re,routeId:Y});return Ue(G,Y,So,{flushSync:Oe}),!0}return!1}if(!ke&&ve(ue))return;let Ge=E.fetchers.get(G);mt(G,cj(Re,Ge),{flushSync:Oe});let Je=new AbortController,Rt=rl(n.history,re,Je.signal,Re);if(ke){let an=await yi(be,re,Rt.signal);if(an.type==="aborted")return;if(an.type==="error"){Ue(G,Y,an.error,{flushSync:Oe});return}else if(an.matches){if(be=an.matches,ue=vh(be,re),ve(ue))return}else{Ue(G,Y,ai(404,{pathname:re}),{flushSync:Oe});return}}U.set(G,Je);let Nn=j,Et=(await Ut("action",E,Rt,[ue],be,G))[ue.route.id];if(Rt.signal.aborted){U.get(G)===Je&&U.delete(G);return}if(Q.has(G)){if(eu(Et)||Br(Et)){mt(G,Na(void 0));return}}else{if(eu(Et))if(U.delete(G),H>Nn){mt(G,Na(void 0));return}else return q.add(G),mt(G,th(Re)),xt(Rt,Et,!1,{fetcherSubmission:Re,preventScrollReset:Se});if(Br(Et)){Ue(G,Y,Et.error);return}}let At=E.navigation.location||E.location,xo=rl(n.history,At,Je.signal),wa=a||o,Lr=E.navigation.state!=="idle"?Pa(wa,E.navigation.location,s):E.matches;lt(Lr,"Didn't find any matches after fetcher action");let _r=++j;z.set(G,_r);let Ju=th(Re,Et.data);E.fetchers.set(G,Ju);let[ba,_o]=n2(n.history,E,Lr,Re,At,!1,D,W,Q,F,q,wa,s,[ue.route.id,Et]);_o.filter(an=>an.key!==G).forEach(an=>{let So=an.key,zc=E.fetchers.get(So),Df=th(void 0,zc?zc.data:void 0);E.fetchers.set(So,Df),In(So),an.controller&&U.set(So,an.controller)}),Te({fetchers:new Map(E.fetchers)});let Eo=()=>_o.forEach(an=>In(an.key));Je.signal.addEventListener("abort",Eo);let{loaderResults:Ms,fetcherResults:Ct}=await je(E,Lr,ba,_o,xo);if(Je.signal.aborted)return;Je.signal.removeEventListener("abort",Eo),z.delete(G),U.delete(G),_o.forEach(an=>U.delete(an.key));let on=ap(Ms);if(on)return xt(xo,on.result,!1,{preventScrollReset:Se});if(on=ap(Ct),on)return q.add(on.key),xt(xo,on.result,!1,{preventScrollReset:Se});let{loaderData:ri,errors:Co}=s2(E,Lr,Ms,void 0,_o,Ct);if(E.fetchers.has(G)){let an=Na(Et.data);E.fetchers.set(G,an)}bo(_r),E.navigation.state==="loading"&&_r>H?(lt(T,"Expected pending action"),x&&x.abort(),Ke(E.navigation.location,{matches:Lr,loaderData:ri,errors:Co,fetchers:new Map(E.fetchers)})):(Te({errors:Co,loaderData:u2(E.loaderData,ri,Lr,Co),fetchers:new Map(E.fetchers)}),D=!1)}async function pn(G,Y,re,ue,be,ke,Oe,Se,Re){let ve=E.fetchers.get(G);mt(G,th(Re,ve?ve.data:void 0),{flushSync:Oe});let Ge=new AbortController,Je=rl(n.history,re,Ge.signal);if(ke){let Et=await yi(be,re,Je.signal);if(Et.type==="aborted")return;if(Et.type==="error"){Ue(G,Y,Et.error,{flushSync:Oe});return}else if(Et.matches)be=Et.matches,ue=vh(be,re);else{Ue(G,Y,ai(404,{pathname:re}),{flushSync:Oe});return}}U.set(G,Ge);let Rt=j,Ot=(await Ut("loader",E,Je,[ue],be,G))[ue.route.id];if(U.get(G)===Ge&&U.delete(G),!Je.signal.aborted){if(Q.has(G)){mt(G,Na(void 0));return}if(eu(Ot))if(H>Rt){mt(G,Na(void 0));return}else{q.add(G),await xt(Je,Ot,!1,{preventScrollReset:Se});return}if(Br(Ot)){Ue(G,Y,Ot.error);return}mt(G,Na(Ot.data))}}async function xt(G,Y,re,{submission:ue,fetcherSubmission:be,preventScrollReset:ke,replace:Oe}={}){Y.response.headers.has("X-Remix-Revalidate")&&(D=!0);let Se=Y.response.headers.get("Location");lt(Se,"Expected a Location header on the redirect Response"),Se=o2(Se,new URL(G.url),s);let Re=ld(E.location,Se,{_isRedirect:!0});if(t){let Ot=!1;if(Y.response.headers.has("X-Remix-Reload-Document"))Ot=!0;else if(Bb.test(Se)){const Et=n.history.createURL(Se);Ot=Et.origin!==e.location.origin||Bi(Et.pathname,s)==null}if(Ot){Oe?e.location.replace(Se):e.location.assign(Se);return}}x=null;let ve=Oe===!0||Y.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:Ge,formAction:Je,formEncType:Rt}=E.navigation;!ue&&!be&&Ge&&Je&&Rt&&(ue=d2(E.navigation));let Nn=ue||be;if(GB.has(Y.response.status)&&Nn&&Ei(Nn.formMethod))await ze(ve,Re,{submission:{...Nn,formAction:Se},preventScrollReset:ke||_,enableViewTransition:re?C:void 0});else{let Ot=Uy(Re,ue);await ze(ve,Re,{overrideNavigation:Ot,fetcherSubmission:be,preventScrollReset:ke||_,enableViewTransition:re?C:void 0})}}async function Ut(G,Y,re,ue,be,ke){let Oe,Se={};try{Oe=await tj(u,G,Y,re,ue,be,ke,i,r)}catch(Re){return ue.forEach(ve=>{Se[ve.route.id]={type:"error",error:Re}}),Se}for(let[Re,ve]of Object.entries(Oe))if(sj(ve)){let Ge=ve.result;Se[Re]={type:"redirect",response:ij(Ge,re,Re,be,s)}}else Se[Re]=await rj(ve);return Se}async function je(G,Y,re,ue,be){let ke=Ut("loader",G,be,re,Y,null),Oe=Promise.all(ue.map(async ve=>{if(ve.matches&&ve.match&&ve.controller){let Je=(await Ut("loader",G,rl(n.history,ve.path,ve.controller.signal),[ve.match],ve.matches,ve.key))[ve.match.route.id];return{[ve.key]:Je}}else return Promise.resolve({[ve.key]:{type:"error",error:ai(404,{pathname:ve.path})}})})),Se=await ke,Re=(await Oe).reduce((ve,Ge)=>Object.assign(ve,Ge),{});return{loaderResults:Se,fetcherResults:Re}}function Qt(){D=!0,F.forEach((G,Y)=>{U.has(Y)&&W.add(Y),In(Y)})}function mt(G,Y,re={}){E.fetchers.set(G,Y),Te({fetchers:new Map(E.fetchers)},{flushSync:(re&&re.flushSync)===!0})}function Ue(G,Y,re,ue={}){let be=Xs(E.matches,Y);Jt(G),Te({errors:{[be.route.id]:re},fetchers:new Map(E.fetchers)},{flushSync:(ue&&ue.flushSync)===!0})}function yt(G){return oe.set(G,(oe.get(G)||0)+1),Q.has(G)&&Q.delete(G),E.fetchers.get(G)||qB}function Jt(G){let Y=E.fetchers.get(G);U.has(G)&&!(Y&&Y.state==="loading"&&z.has(G))&&In(G),F.delete(G),z.delete(G),q.delete(G),Q.delete(G),W.delete(G),E.fetchers.delete(G)}function Wt(G){let Y=(oe.get(G)||0)-1;Y<=0?(oe.delete(G),Q.add(G)):oe.set(G,Y),Te({fetchers:new Map(E.fetchers)})}function In(G){let Y=U.get(G);Y&&(Y.abort(),U.delete(G))}function ur(G){for(let Y of G){let re=yt(Y),ue=Na(re.data);E.fetchers.set(Y,ue)}}function ti(){let G=[],Y=!1;for(let re of q){let ue=E.fetchers.get(re);lt(ue,`Expected fetcher: ${re}`),ue.state==="loading"&&(q.delete(re),G.push(re),Y=!0)}return ur(G),Y}function bo(G){let Y=[];for(let[re,ue]of z)if(ue<G){let be=E.fetchers.get(re);lt(be,`Expected fetcher: ${re}`),be.state==="loading"&&(In(re),z.delete(re),Y.push(re))}return ur(Y),Y.length>0}function ga(G,Y){let re=E.blockers.get(G)||eh;return ae.get(G)!==Y&&ae.set(G,Y),re}function ni(G){E.blockers.delete(G),ae.delete(G)}function Yi(G,Y){let re=E.blockers.get(G)||eh;lt(re.state==="unblocked"&&Y.state==="blocked"||re.state==="blocked"&&Y.state==="blocked"||re.state==="blocked"&&Y.state==="proceeding"||re.state==="blocked"&&Y.state==="unblocked"||re.state==="proceeding"&&Y.state==="unblocked",`Invalid blocker state transition: ${re.state} -> ${Y.state}`);let ue=new Map(E.blockers);ue.set(G,Y),Te({blockers:ue})}function va({currentLocation:G,nextLocation:Y,historyAction:re}){if(ae.size===0)return;ae.size>1&&Bn(!1,"A router only supports one blocker at a time");let ue=Array.from(ae.entries()),[be,ke]=ue[ue.length-1],Oe=E.blockers.get(be);if(!(Oe&&Oe.state==="proceeding")&&ke({currentLocation:G,nextLocation:Y,historyAction:re}))return be}function Os(G){let Y=ai(404,{pathname:G}),re=a||o,{matches:ue,route:be}=c2(re);return{notFoundMatches:ue,route:be,error:Y}}function kf(G,Y,re){if(f=G,v=Y,m=re||null,!y&&E.navigation===jy){y=!0;let ue=Qu(E.location,E.matches);ue!=null&&Te({restoreScrollPosition:ue})}return()=>{f=null,v=null,m=null}}function Rf(G,Y){return m&&m(G,Y.map(ue=>CB(ue,E.loaderData)))||G.key}function Ps(G,Y){if(f&&v){let re=Rf(G,Y);f[re]=v()}}function Qu(G,Y){if(f){let re=Rf(G,Y),ue=f[re];if(typeof ue=="number")return ue}return null}function ya(G,Y,re){if(l)if(G){if(Object.keys(G[0].params).length>0)return{active:!0,matches:zp(Y,re,s,!0)}}else return{active:!0,matches:zp(Y,re,s,!0)||[]};return{active:!1,matches:null}}async function yi(G,Y,re){if(!l)return{type:"success",matches:G};let ue=G;for(;;){let be=a==null,ke=a||o,Oe=i;try{await l({path:Y,matches:ue,patch:(ve,Ge)=>{re.aborted||i2(ve,Ge,ke,Oe,r)}})}catch(ve){return{type:"error",error:ve,partialMatches:ue}}finally{be&&!re.aborted&&(o=[...o])}if(re.aborted)return{type:"aborted"};let Se=Pa(ke,Y,s);if(Se)return{type:"success",matches:Se};let Re=zp(ke,Y,s,!0);if(!Re||ue.length===Re.length&&ue.every((ve,Ge)=>ve.route.id===Re[Ge].route.id))return{type:"success",matches:null};ue=Re}}function Af(G){i={},a=Im(G,r,void 0,i)}function Fc(G,Y){let re=a==null;i2(G,Y,a||o,i,r),re&&(o=[...o],Te({}))}return S={get basename(){return s},get future(){return c},get state(){return E},get routes(){return o},get window(){return e},initialize:pe,subscribe:Me,enableScrollRestoration:kf,navigate:Fe,fetch:Sn,revalidate:Xe,createHref:G=>n.history.createHref(G),encodeLocation:G=>n.history.encodeLocation(G),getFetcher:yt,deleteFetcher:Wt,dispose:Ce,getBlocker:ga,deleteBlocker:ni,patchRoutes:Fc,_internalFetchControllers:U,_internalSetRoutes:Af},S}function YB(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function S1(n,e,t,r,i,o){let a,s;if(i){a=[];for(let l of e)if(a.push(l),l.route.id===i){s=l;break}}else a=e,s=e[e.length-1];let u=Fg(r||".",Lg(a),Bi(n.pathname,t)||n.pathname,o==="path");if(r==null&&(u.search=n.search,u.hash=n.hash),(r==null||r===""||r===".")&&s){let l=jb(u.search);if(s.route.index&&!l)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&l){let c=new URLSearchParams(u.search),h=c.getAll("index");c.delete("index"),h.filter(f=>f).forEach(f=>c.append("index",f));let d=c.toString();u.search=d?`?${d}`:""}}return t!=="/"&&(u.pathname=u.pathname==="/"?t:ao([t,u.pathname])),cs(u)}function e2(n,e,t){if(!t||!YB(t))return{path:e};if(t.formMethod&&!uj(t.formMethod))return{path:e,error:ai(405,{method:t.formMethod})};let r=()=>({path:e,error:ai(400,{type:"invalid-body"})}),o=(t.formMethod||"get").toUpperCase(),a=cR(e);if(t.body!==void 0){if(t.formEncType==="text/plain"){if(!Ei(o))return r();let h=typeof t.body=="string"?t.body:t.body instanceof FormData||t.body instanceof URLSearchParams?Array.from(t.body.entries()).reduce((d,[f,m])=>`${d}${f}=${m}
`,""):String(t.body);return{path:e,submission:{formMethod:o,formAction:a,formEncType:t.formEncType,formData:void 0,json:void 0,text:h}}}else if(t.formEncType==="application/json"){if(!Ei(o))return r();try{let h=typeof t.body=="string"?JSON.parse(t.body):t.body;return{path:e,submission:{formMethod:o,formAction:a,formEncType:t.formEncType,formData:void 0,json:h,text:void 0}}}catch{return r()}}}lt(typeof FormData=="function","FormData is not available in this environment");let s,u;if(t.formData)s=N1(t.formData),u=t.formData;else if(t.body instanceof FormData)s=N1(t.body),u=t.body;else if(t.body instanceof URLSearchParams)s=t.body,u=a2(s);else if(t.body==null)s=new URLSearchParams,u=new FormData;else try{s=new URLSearchParams(t.body),u=a2(s)}catch{return r()}let l={formMethod:o,formAction:a,formEncType:t&&t.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(Ei(l.formMethod))return{path:e,submission:l};let c=Es(e);return n&&c.search&&jb(c.search)&&s.append("index",""),c.search=`?${s}`,{path:cs(c),submission:l}}function t2(n,e,t=!1){let r=n.findIndex(i=>i.route.id===e);return r>=0?n.slice(0,t?r+1:r):n}function n2(n,e,t,r,i,o,a,s,u,l,c,h,d,f){let m=f?Br(f[1])?f[1].error:f[1].data:void 0,v=n.createURL(e.location),y=n.createURL(i),g=t;o&&e.errors?g=t2(t,Object.keys(e.errors)[0],!0):f&&Br(f[1])&&(g=t2(t,f[0]));let w=f?f[1].statusCode:void 0,b=w&&w>=400,S=g.filter((T,_)=>{let{route:x}=T;if(x.lazy)return!0;if(x.loader==null)return!1;if(o)return I1(x,e.loaderData,e.errors);if(QB(e.loaderData,e.matches[_],T))return!0;let C=e.matches[_],N=T;return r2(T,{currentUrl:v,currentParams:C.params,nextUrl:y,nextParams:N.params,...r,actionResult:m,actionStatus:w,defaultShouldRevalidate:b?!1:a||v.pathname+v.search===y.pathname+y.search||v.search!==y.search||JB(C,N)})}),E=[];return l.forEach((T,_)=>{if(o||!t.some(k=>k.route.id===T.routeId)||u.has(_))return;let x=Pa(h,T.path,d);if(!x){E.push({key:_,routeId:T.routeId,path:T.path,matches:null,match:null,controller:null});return}let C=e.fetchers.get(_),N=vh(x,T.path),R=!1;c.has(_)?R=!1:s.has(_)?(s.delete(_),R=!0):C&&C.state!=="idle"&&C.data===void 0?R=a:R=r2(N,{currentUrl:v,currentParams:e.matches[e.matches.length-1].params,nextUrl:y,nextParams:t[t.length-1].params,...r,actionResult:m,actionStatus:w,defaultShouldRevalidate:b?!1:a}),R&&E.push({key:_,routeId:T.routeId,path:T.path,matches:x,match:N,controller:new AbortController})}),[S,E]}function I1(n,e,t){if(n.lazy)return!0;if(!n.loader)return!1;let r=e!=null&&e[n.id]!==void 0,i=t!=null&&t[n.id]!==void 0;return!r&&i?!1:typeof n.loader=="function"&&n.loader.hydrate===!0?!0:!r&&!i}function QB(n,e,t){let r=!e||t.route.id!==e.route.id,i=!n.hasOwnProperty(t.route.id);return r||i}function JB(n,e){let t=n.route.path;return n.pathname!==e.pathname||t!=null&&t.endsWith("*")&&n.params["*"]!==e.params["*"]}function r2(n,e){if(n.route.shouldRevalidate){let t=n.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}function i2(n,e,t,r,i){let o;if(n){let u=r[n];lt(u,`No route found to patch children into: routeId = ${n}`),u.children||(u.children=[]),o=u.children}else o=t;let a=e.filter(u=>!o.some(l=>lR(u,l))),s=Im(a,i,[n||"_","patch",String((o==null?void 0:o.length)||"0")],r);o.push(...s)}function lR(n,e){return"id"in n&&"id"in e&&n.id===e.id?!0:n.index===e.index&&n.path===e.path&&n.caseSensitive===e.caseSensitive?(!n.children||n.children.length===0)&&(!e.children||e.children.length===0)?!0:n.children.every((t,r)=>{var i;return(i=e.children)==null?void 0:i.some(o=>lR(t,o))}):!1}async function ZB(n,e,t){if(!n.lazy)return;let r=await n.lazy();if(!n.lazy)return;let i=t[n.id];lt(i,"No route found in manifest");let o={};for(let a in r){let u=i[a]!==void 0&&a!=="hasErrorBoundary";Bn(!u,`Route "${i.id}" has a static property "${a}" defined but its lazy function is also returning a value for this property. The lazy route property "${a}" will be ignored.`),!u&&!_B.has(a)&&(o[a]=r[a])}Object.assign(i,o),Object.assign(i,{...e(i),lazy:void 0})}async function ej({matches:n}){let e=n.filter(r=>r.shouldLoad);return(await Promise.all(e.map(r=>r.resolve()))).reduce((r,i,o)=>Object.assign(r,{[e[o].route.id]:i}),{})}async function tj(n,e,t,r,i,o,a,s,u,l){let c=o.map(f=>f.route.lazy?ZB(f.route,u,s):void 0),h=o.map((f,m)=>{let v=c[m],y=i.some(w=>w.route.id===f.route.id);return{...f,shouldLoad:y,resolve:async w=>(w&&r.method==="GET"&&(f.route.lazy||f.route.loader)&&(y=!0),y?nj(e,r,f,v,w,l):Promise.resolve({type:"data",result:void 0}))}}),d=await n({matches:h,request:r,params:o[0].params,fetcherKey:a,context:l});try{await Promise.all(c)}catch{}return d}async function nj(n,e,t,r,i,o){let a,s,u=l=>{let c,h=new Promise((m,v)=>c=v);s=()=>c(),e.signal.addEventListener("abort",s);let d=m=>typeof l!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${n}" [routeId: ${t.route.id}]`)):l({request:e,params:t.params,context:o},...m!==void 0?[m]:[]),f=(async()=>{try{return{type:"data",result:await(i?i(v=>d(v)):d())}}catch(m){return{type:"error",result:m}}})();return Promise.race([f,h])};try{let l=t.route[n];if(r)if(l){let c,[h]=await Promise.all([u(l).catch(d=>{c=d}),r]);if(c!==void 0)throw c;a=h}else if(await r,l=t.route[n],l)a=await u(l);else if(n==="action"){let c=new URL(e.url),h=c.pathname+c.search;throw ai(405,{method:e.method,pathname:h,routeId:t.route.id})}else return{type:"data",result:void 0};else if(l)a=await u(l);else{let c=new URL(e.url),h=c.pathname+c.search;throw ai(404,{pathname:h})}}catch(l){return{type:"error",result:l}}finally{s&&e.signal.removeEventListener("abort",s)}return a}async function rj(n){var r,i,o,a;let{result:e,type:t}=n;if(hR(e)){let s;try{let u=e.headers.get("Content-Type");u&&/\bapplication\/json\b/.test(u)?e.body==null?s=null:s=await e.json():s=await e.text()}catch(u){return{type:"error",error:u}}return t==="error"?{type:"error",error:new Tm(e.status,e.statusText,s),statusCode:e.status,headers:e.headers}:{type:"data",data:s,statusCode:e.status,headers:e.headers}}if(t==="error"){if(h2(e)){if(e.data instanceof Error)return{type:"error",error:e.data,statusCode:(r=e.init)==null?void 0:r.status};e=new Tm(((i=e.init)==null?void 0:i.status)||500,void 0,e.data)}return{type:"error",error:e,statusCode:zg(e)?e.status:void 0}}return h2(e)?{type:"data",data:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}:{type:"data",data:e}}function ij(n,e,t,r,i){let o=n.headers.get("Location");if(lt(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!Bb.test(o)){let a=r.slice(0,r.findIndex(s=>s.route.id===t)+1);o=S1(new URL(e.url),a,i,o),n.headers.set("Location",o)}return n}function o2(n,e,t){if(Bb.test(n)){let r=n,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),o=Bi(i.pathname,t)!=null;if(i.origin===e.origin&&o)return i.pathname+i.search+i.hash}return n}function rl(n,e,t,r){let i=n.createURL(cR(e)).toString(),o={signal:t};if(r&&Ei(r.formMethod)){let{formMethod:a,formEncType:s}=r;o.method=a.toUpperCase(),s==="application/json"?(o.headers=new Headers({"Content-Type":s}),o.body=JSON.stringify(r.json)):s==="text/plain"?o.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?o.body=N1(r.formData):o.body=r.formData}return new Request(i,o)}function N1(n){let e=new URLSearchParams;for(let[t,r]of n.entries())e.append(t,typeof r=="string"?r:r.name);return e}function a2(n){let e=new FormData;for(let[t,r]of n.entries())e.append(t,r);return e}function oj(n,e,t,r=!1,i=!1){let o={},a=null,s,u=!1,l={},c=t&&Br(t[1])?t[1].error:void 0;return n.forEach(h=>{if(!(h.route.id in e))return;let d=h.route.id,f=e[d];if(lt(!eu(f),"Cannot handle redirect results in processLoaderData"),Br(f)){let m=f.error;if(c!==void 0&&(m=c,c=void 0),a=a||{},i)a[d]=m;else{let v=Xs(n,d);a[v.route.id]==null&&(a[v.route.id]=m)}r||(o[d]=uR),u||(u=!0,s=zg(f.error)?f.error.status:500),f.headers&&(l[d]=f.headers)}else o[d]=f.data,f.statusCode&&f.statusCode!==200&&!u&&(s=f.statusCode),f.headers&&(l[d]=f.headers)}),c!==void 0&&t&&(a={[t[0]]:c},o[t[0]]=void 0),{loaderData:o,errors:a,statusCode:s||200,loaderHeaders:l}}function s2(n,e,t,r,i,o){let{loaderData:a,errors:s}=oj(e,t,r);return i.forEach(u=>{let{key:l,match:c,controller:h}=u,d=o[l];if(lt(d,"Did not find corresponding fetcher result"),!(h&&h.signal.aborted))if(Br(d)){let f=Xs(n.matches,c==null?void 0:c.route.id);s&&s[f.route.id]||(s={...s,[f.route.id]:d.error}),n.fetchers.delete(l)}else if(eu(d))lt(!1,"Unhandled fetcher revalidation redirect");else{let f=Na(d.data);n.fetchers.set(l,f)}}),{loaderData:a,errors:s}}function u2(n,e,t,r){let i=Object.entries(e).filter(([,o])=>o!==uR).reduce((o,[a,s])=>(o[a]=s,o),{});for(let o of t){let a=o.route.id;if(!e.hasOwnProperty(a)&&n.hasOwnProperty(a)&&o.route.loader&&(i[a]=n[a]),r&&r.hasOwnProperty(a))break}return i}function l2(n){return n?Br(n[1])?{actionData:{}}:{actionData:{[n[0]]:n[1].data}}:{}}function Xs(n,e){return(e?n.slice(0,n.findIndex(r=>r.route.id===e)+1):[...n]).reverse().find(r=>r.route.hasErrorBoundary===!0)||n[0]}function c2(n){let e=n.length===1?n[0]:n.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function ai(n,{pathname:e,routeId:t,method:r,type:i,message:o}={}){let a="Unknown Server Error",s="Unknown @remix-run/router error";return n===400?(a="Bad Request",r&&e&&t?s=`You made a ${r} request to "${e}" but did not provide a \`loader\` for route "${t}", so there is no way to handle the request.`:i==="invalid-body"&&(s="Unable to encode submission body")):n===403?(a="Forbidden",s=`Route "${t}" does not match URL "${e}"`):n===404?(a="Not Found",s=`No route matches URL "${e}"`):n===405&&(a="Method Not Allowed",r&&e&&t?s=`You made a ${r.toUpperCase()} request to "${e}" but did not provide an \`action\` for route "${t}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new Tm(n||500,a,new Error(s),!0)}function ap(n){let e=Object.entries(n);for(let t=e.length-1;t>=0;t--){let[r,i]=e[t];if(eu(i))return{key:r,result:i}}}function cR(n){let e=typeof n=="string"?Es(n):n;return cs({...e,hash:""})}function aj(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function sj(n){return hR(n.result)&&HB.has(n.result.status)}function Br(n){return n.type==="error"}function eu(n){return(n&&n.type)==="redirect"}function h2(n){return typeof n=="object"&&n!=null&&"type"in n&&"data"in n&&"init"in n&&n.type==="DataWithResponseInit"}function hR(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function uj(n){return $B.has(n.toUpperCase())}function Ei(n){return WB.has(n.toUpperCase())}function jb(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function vh(n,e){let t=typeof e=="string"?Es(e).search:e.search;if(n[n.length-1].route.index&&jb(t||""))return n[n.length-1];let r=oR(n);return r[r.length-1]}function d2(n){let{formMethod:e,formAction:t,formEncType:r,text:i,formData:o,json:a}=n;if(!(!e||!t||!r)){if(i!=null)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:void 0,text:i};if(o!=null)return{formMethod:e,formAction:t,formEncType:r,formData:o,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:a,text:void 0}}}function Uy(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function lj(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function th(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function cj(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function Na(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function hj(n,e){try{let t=n.sessionStorage.getItem(sR);if(t){let r=JSON.parse(t);for(let[i,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(i,new Set(o||[]))}}catch{}}function dj(n,e){if(e.size>0){let t={};for(let[r,i]of e)t[r]=[...i];try{n.sessionStorage.setItem(sR,JSON.stringify(t))}catch(r){Bn(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function fj(){let n,e,t=new Promise((r,i)=>{n=async o=>{r(o);try{await t}catch{}},e=async o=>{i(o);try{await t}catch{}}});return{promise:t,resolve:n,reject:e}}var Pu=X.createContext(null);Pu.displayName="DataRouter";var Vd=X.createContext(null);Vd.displayName="DataRouterState";var Ub=X.createContext({isTransitioning:!1});Ub.displayName="ViewTransition";var dR=X.createContext(new Map);dR.displayName="Fetchers";var pj=X.createContext(null);pj.displayName="Await";var $i=X.createContext(null);$i.displayName="Navigation";var Bg=X.createContext(null);Bg.displayName="Location";var mo=X.createContext({outlet:null,matches:[],isDataRoute:!1});mo.displayName="Route";var Wb=X.createContext(null);Wb.displayName="RouteError";function mj(n,{relative:e}={}){lt(wc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=X.useContext($i),{hash:i,pathname:o,search:a}=$d(n,{relative:e}),s=o;return t!=="/"&&(s=o==="/"?t:ao([t,o])),r.createHref({pathname:s,search:a,hash:i})}function wc(){return X.useContext(Bg)!=null}function Cs(){return lt(wc(),"useLocation() may be used only in the context of a <Router> component."),X.useContext(Bg).location}var fR="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pR(n){X.useContext($i).static||X.useLayoutEffect(n)}function gi(){let{isDataRoute:n}=X.useContext(mo);return n?Tj():gj()}function gj(){lt(wc(),"useNavigate() may be used only in the context of a <Router> component.");let n=X.useContext(Pu),{basename:e,navigator:t}=X.useContext($i),{matches:r}=X.useContext(mo),{pathname:i}=Cs(),o=JSON.stringify(Lg(r)),a=X.useRef(!1);return pR(()=>{a.current=!0}),X.useCallback((u,l={})=>{if(Bn(a.current,fR),!a.current)return;if(typeof u=="number"){t.go(u);return}let c=Fg(u,JSON.parse(o),i,l.relative==="path");n==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:ao([e,c.pathname])),(l.replace?t.replace:t.push)(c,l.state,l)},[e,t,o,i,n])}X.createContext(null);function $d(n,{relative:e}={}){let{matches:t}=X.useContext(mo),{pathname:r}=Cs(),i=JSON.stringify(Lg(t));return X.useMemo(()=>Fg(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function vj(n,e,t,r){lt(wc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=X.useContext($i),{matches:o}=X.useContext(mo),a=o[o.length-1],s=a?a.params:{},u=a?a.pathname:"/",l=a?a.pathnameBase:"/",c=a&&a.route;{let g=c&&c.path||"";mR(u,!c||g.endsWith("*")||g.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${g}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${g}"> to <Route path="${g==="/"?"*":`${g}/*`}">.`)}let h=Cs(),d;d=h;let f=d.pathname||"/",m=f;if(l!=="/"){let g=l.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(g.length).join("/")}let v=Pa(n,{pathname:m});return Bn(c||v!=null,`No routes matched location "${d.pathname}${d.search}${d.hash}" `),Bn(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${d.pathname}${d.search}${d.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),_j(v&&v.map(g=>Object.assign({},g,{params:Object.assign({},s,g.params),pathname:ao([l,i.encodeLocation?i.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:ao([l,i.encodeLocation?i.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),o,t,r)}function yj(){let n=Nj(),e=zg(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",n),a=X.createElement(X.Fragment,null,X.createElement("p",null,"💿 Hey developer 👋"),X.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",X.createElement("code",{style:o},"ErrorBoundary")," or"," ",X.createElement("code",{style:o},"errorElement")," prop on your route.")),X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},e),t?X.createElement("pre",{style:i},t):null,a)}var wj=X.createElement(yj,null),bj=class extends X.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?X.createElement(mo.Provider,{value:this.props.routeContext},X.createElement(Wb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function xj({routeContext:n,match:e,children:t}){let r=X.useContext(Pu);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),X.createElement(mo.Provider,{value:n},t)}function _j(n,e=[],t=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let i=n,o=t==null?void 0:t.errors;if(o!=null){let u=i.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id])!==void 0);lt(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let a=!1,s=-1;if(t)for(let u=0;u<i.length;u++){let l=i[u];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(s=u),l.route.id){let{loaderData:c,errors:h}=t,d=l.route.loader&&!c.hasOwnProperty(l.route.id)&&(!h||h[l.route.id]===void 0);if(l.route.lazy||d){a=!0,s>=0?i=i.slice(0,s+1):i=[i[0]];break}}}return i.reduceRight((u,l,c)=>{let h,d=!1,f=null,m=null;t&&(h=o&&l.route.id?o[l.route.id]:void 0,f=l.route.errorElement||wj,a&&(s<0&&c===0?(mR("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,m=null):s===c&&(d=!0,m=l.route.hydrateFallbackElement||null)));let v=e.concat(i.slice(0,c+1)),y=()=>{let g;return h?g=f:d?g=m:l.route.Component?g=X.createElement(l.route.Component,null):l.route.element?g=l.route.element:g=u,X.createElement(xj,{match:l,routeContext:{outlet:u,matches:v,isDataRoute:t!=null},children:g})};return t&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?X.createElement(bj,{location:t.location,revalidation:t.revalidation,component:f,error:h,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}function Vb(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ej(n){let e=X.useContext(Pu);return lt(e,Vb(n)),e}function Cj(n){let e=X.useContext(Vd);return lt(e,Vb(n)),e}function Sj(n){let e=X.useContext(mo);return lt(e,Vb(n)),e}function $b(n){let e=Sj(n),t=e.matches[e.matches.length-1];return lt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Ij(){return $b("useRouteId")}function Nj(){var r;let n=X.useContext(Wb),e=Cj("useRouteError"),t=$b("useRouteError");return n!==void 0?n:(r=e.errors)==null?void 0:r[t]}function Tj(){let{router:n}=Ej("useNavigate"),e=$b("useNavigate"),t=X.useRef(!1);return pR(()=>{t.current=!0}),X.useCallback(async(i,o={})=>{Bn(t.current,fR),t.current&&(typeof i=="number"?n.navigate(i):await n.navigate(i,{fromRouteId:e,...o}))},[n,e])}var f2={};function mR(n,e,t){!e&&!f2[n]&&(f2[n]=!0,Bn(!1,t))}var p2={};function m2(n,e){!n&&!p2[e]&&(p2[e]=!0,console.warn(e))}function kj(n){let e={hasErrorBoundary:n.hasErrorBoundary||n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&(n.element&&Bn(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(e,{element:X.createElement(n.Component),Component:void 0})),n.HydrateFallback&&(n.hydrateFallbackElement&&Bn(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(e,{hydrateFallbackElement:X.createElement(n.HydrateFallback),HydrateFallback:void 0})),n.ErrorBoundary&&(n.errorElement&&Bn(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(e,{errorElement:X.createElement(n.ErrorBoundary),ErrorBoundary:void 0})),e}var Rj=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",t(r))}})}};function Aj({router:n,flushSync:e}){let[t,r]=X.useState(n.state),[i,o]=X.useState(),[a,s]=X.useState({isTransitioning:!1}),[u,l]=X.useState(),[c,h]=X.useState(),[d,f]=X.useState(),m=X.useRef(new Map),v=X.useCallback((b,{deletedFetchers:S,flushSync:E,viewTransitionOpts:T})=>{S.forEach(x=>m.current.delete(x)),b.fetchers.forEach((x,C)=>{x.data!==void 0&&m.current.set(C,x.data)}),m2(E===!1||e!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let _=n.window!=null&&n.window.document!=null&&typeof n.window.document.startViewTransition=="function";if(m2(T==null||_,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!T||!_){e&&E?e(()=>r(b)):X.startTransition(()=>r(b));return}if(e&&E){e(()=>{c&&(u&&u.resolve(),c.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:T.currentLocation,nextLocation:T.nextLocation})});let x=n.window.document.startViewTransition(()=>{e(()=>r(b))});x.finished.finally(()=>{e(()=>{l(void 0),h(void 0),o(void 0),s({isTransitioning:!1})})}),e(()=>h(x));return}c?(u&&u.resolve(),c.skipTransition(),f({state:b,currentLocation:T.currentLocation,nextLocation:T.nextLocation})):(o(b),s({isTransitioning:!0,flushSync:!1,currentLocation:T.currentLocation,nextLocation:T.nextLocation}))},[n.window,e,c,u]);X.useLayoutEffect(()=>n.subscribe(v),[n,v]),X.useEffect(()=>{a.isTransitioning&&!a.flushSync&&l(new Rj)},[a]),X.useEffect(()=>{if(u&&i&&n.window){let b=i,S=u.promise,E=n.window.document.startViewTransition(async()=>{X.startTransition(()=>r(b)),await S});E.finished.finally(()=>{l(void 0),h(void 0),o(void 0),s({isTransitioning:!1})}),h(E)}},[i,u,n.window]),X.useEffect(()=>{u&&i&&t.location.key===i.location.key&&u.resolve()},[u,c,t.location,i]),X.useEffect(()=>{!a.isTransitioning&&d&&(o(d.state),s({isTransitioning:!0,flushSync:!1,currentLocation:d.currentLocation,nextLocation:d.nextLocation}),f(void 0))},[a.isTransitioning,d]);let y=X.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:b=>n.navigate(b),push:(b,S,E)=>n.navigate(b,{state:S,preventScrollReset:E==null?void 0:E.preventScrollReset}),replace:(b,S,E)=>n.navigate(b,{replace:!0,state:S,preventScrollReset:E==null?void 0:E.preventScrollReset})}),[n]),g=n.basename||"/",w=X.useMemo(()=>({router:n,navigator:y,static:!1,basename:g}),[n,y,g]);return X.createElement(X.Fragment,null,X.createElement(Pu.Provider,{value:w},X.createElement(Vd.Provider,{value:t},X.createElement(dR.Provider,{value:m.current},X.createElement(Ub.Provider,{value:a},X.createElement(Mj,{basename:g,location:t.location,navigationType:t.historyAction,navigator:y},X.createElement(Dj,{routes:n.routes,future:n.future,state:t})))))),null)}var Dj=X.memo(Oj);function Oj({routes:n,future:e,state:t}){return vj(n,void 0,t,e)}function Pj({to:n,replace:e,state:t,relative:r}){lt(wc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=X.useContext($i);Bn(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=X.useContext(mo),{pathname:a}=Cs(),s=gi(),u=Fg(n,Lg(o),a,r==="path"),l=JSON.stringify(u);return X.useEffect(()=>{s(JSON.parse(l),{replace:e,state:t,relative:r})},[s,l,r,e,t]),null}function Mj({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:o=!1}){lt(!wc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=n.replace(/^\/*/,"/"),s=X.useMemo(()=>({basename:a,navigator:i,static:o,future:{}}),[a,i,o]);typeof t=="string"&&(t=Es(t));let{pathname:u="/",search:l="",hash:c="",state:h=null,key:d="default"}=t,f=X.useMemo(()=>{let m=Bi(u,a);return m==null?null:{location:{pathname:m,search:l,hash:c,state:h,key:d},navigationType:r}},[a,u,l,c,h,d,r]);return Bn(f!=null,`<Router basename="${a}"> is not able to match the URL "${u}${l}${c}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:X.createElement($i.Provider,{value:s},X.createElement(Bg.Provider,{children:e,value:f}))}var Bp="get",jp="application/x-www-form-urlencoded";function jg(n){return n!=null&&typeof n.tagName=="string"}function Lj(n){return jg(n)&&n.tagName.toLowerCase()==="button"}function Fj(n){return jg(n)&&n.tagName.toLowerCase()==="form"}function zj(n){return jg(n)&&n.tagName.toLowerCase()==="input"}function Bj(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function jj(n,e){return n.button===0&&(!e||e==="_self")&&!Bj(n)}var sp=null;function Uj(){if(sp===null)try{new FormData(document.createElement("form"),0),sp=!1}catch{sp=!0}return sp}var Wj=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Wy(n){return n!=null&&!Wj.has(n)?(Bn(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${jp}"`),null):n}function Vj(n,e){let t,r,i,o,a;if(Fj(n)){let s=n.getAttribute("action");r=s?Bi(s,e):null,t=n.getAttribute("method")||Bp,i=Wy(n.getAttribute("enctype"))||jp,o=new FormData(n)}else if(Lj(n)||zj(n)&&(n.type==="submit"||n.type==="image")){let s=n.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||s.getAttribute("action");if(r=u?Bi(u,e):null,t=n.getAttribute("formmethod")||s.getAttribute("method")||Bp,i=Wy(n.getAttribute("formenctype"))||Wy(s.getAttribute("enctype"))||jp,o=new FormData(s,n),!Uj()){let{name:l,type:c,value:h}=n;if(c==="image"){let d=l?`${l}.`:"";o.append(`${d}x`,"0"),o.append(`${d}y`,"0")}else l&&o.append(l,h)}}else{if(jg(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Bp,r=null,i=jp,a=n}return o&&i==="text/plain"&&(a=o,o=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:o,body:a}}function Hb(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function $j(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Hj(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Gj(n,e,t){let r=await Promise.all(n.map(async i=>{let o=e.routes[i.route.id];if(o){let a=await $j(o,t);return a.links?a.links():[]}return[]}));return Yj(r.flat(1).filter(Hj).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function g2(n,e,t,r,i,o){let a=(u,l)=>t[l]?u.route.id!==t[l].route.id:!0,s=(u,l)=>{var c;return t[l].pathname!==u.pathname||((c=t[l].route.path)==null?void 0:c.endsWith("*"))&&t[l].params["*"]!==u.params["*"]};return o==="assets"?e.filter((u,l)=>a(u,l)||s(u,l)):o==="data"?e.filter((u,l)=>{var h;let c=r.routes[u.route.id];if(!c||!c.hasLoader)return!1;if(a(u,l)||s(u,l))return!0;if(u.route.shouldRevalidate){let d=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((h=t[0])==null?void 0:h.params)||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function qj(n,e){return Kj(n.map(t=>{let r=e.routes[t.route.id];if(!r)return[];let i=[r.module];return r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function Kj(n){return[...new Set(n)]}function Xj(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function Yj(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let o=JSON.stringify(Xj(i));return t.has(o)||(t.add(o),r.push({key:o,link:i})),r},[])}function Qj(n){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function Jj(){let n=X.useContext(Pu);return Hb(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function Zj(){let n=X.useContext(Vd);return Hb(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Gb=X.createContext(void 0);Gb.displayName="FrameworkContext";function gR(){let n=X.useContext(Gb);return Hb(n,"You must render this element inside a <HydratedRouter> element"),n}function eU(n,e){let t=X.useContext(Gb),[r,i]=X.useState(!1),[o,a]=X.useState(!1),{onFocus:s,onBlur:u,onMouseEnter:l,onMouseLeave:c,onTouchStart:h}=e,d=X.useRef(null);X.useEffect(()=>{if(n==="render"&&a(!0),n==="viewport"){let v=g=>{g.forEach(w=>{a(w.isIntersecting)})},y=new IntersectionObserver(v,{threshold:.5});return d.current&&y.observe(d.current),()=>{y.disconnect()}}},[n]),X.useEffect(()=>{if(r){let v=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(v)}}},[r]);let f=()=>{i(!0)},m=()=>{i(!1),a(!1)};return t?n!=="intent"?[o,d,{}]:[o,d,{onFocus:nh(s,f),onBlur:nh(u,m),onMouseEnter:nh(l,f),onMouseLeave:nh(c,m),onTouchStart:nh(h,f)}]:[!1,d,{}]}function nh(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function tU({page:n,...e}){let{router:t}=Jj(),r=X.useMemo(()=>Pa(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?X.createElement(rU,{page:n,matches:r,...e}):(console.warn(`Tried to prefetch ${n} but no routes matched.`),null)}function nU(n){let{manifest:e,routeModules:t}=gR(),[r,i]=X.useState([]);return X.useEffect(()=>{let o=!1;return Gj(n,e,t).then(a=>{o||i(a)}),()=>{o=!0}},[n,e,t]),r}function rU({page:n,matches:e,...t}){let r=Cs(),{manifest:i,routeModules:o}=gR(),{loaderData:a,matches:s}=Zj(),u=X.useMemo(()=>g2(n,e,s,i,r,"data"),[n,e,s,i,r]),l=X.useMemo(()=>g2(n,e,s,i,r,"assets"),[n,e,s,i,r]),c=X.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let f=new Set,m=!1;if(e.forEach(y=>{var w;let g=i.routes[y.route.id];!g||!g.hasLoader||(!u.some(b=>b.route.id===y.route.id)&&y.route.id in a&&((w=o[y.route.id])!=null&&w.shouldRevalidate)||g.hasClientLoader?m=!0:f.add(y.route.id))}),f.size===0)return[];let v=Qj(n);return m&&f.size>0&&v.searchParams.set("_routes",e.filter(y=>f.has(y.route.id)).map(y=>y.route.id).join(",")),[v.pathname+v.search]},[a,r,i,u,e,n,o]),h=X.useMemo(()=>qj(l,i),[l,i]),d=nU(l);return X.createElement(X.Fragment,null,c.map(f=>X.createElement("link",{key:f,rel:"prefetch",as:"fetch",href:f,...t})),h.map(f=>X.createElement("link",{key:f,rel:"modulepreload",href:f,...t})),d.map(({key:f,link:m})=>X.createElement("link",{key:f,...m})))}function iU(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var vR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{vR&&(window.__reactRouterVersion="7.0.2")}catch{}function oU(n,e){return XB({basename:e==null?void 0:e.basename,future:e==null?void 0:e.future,history:wB({window:e==null?void 0:e.window}),hydrationData:aU(),routes:n,mapRouteProperties:kj,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function aU(){let n=window==null?void 0:window.__staticRouterHydrationData;return n&&n.errors&&(n={...n,errors:sU(n.errors)}),n}function sU(n){if(!n)return null;let e=Object.entries(n),t={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")t[r]=new Tm(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let o=window[i.__subType];if(typeof o=="function")try{let a=new o(i.message);a.stack="",t[r]=a}catch{}}if(t[r]==null){let o=new Error(i.message);o.stack="",t[r]=o}}else t[r]=i;return t}var yR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cn=X.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:o,replace:a,state:s,target:u,to:l,preventScrollReset:c,viewTransition:h,...d},f){let{basename:m}=X.useContext($i),v=typeof l=="string"&&yR.test(l),y,g=!1;if(typeof l=="string"&&v&&(y=l,vR))try{let C=new URL(window.location.href),N=l.startsWith("//")?new URL(C.protocol+l):new URL(l),R=Bi(N.pathname,m);N.origin===C.origin&&R!=null?l=R+N.search+N.hash:g=!0}catch{Bn(!1,`<Link to="${l}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=mj(l,{relative:i}),[b,S,E]=eU(r,d),T=hU(l,{replace:a,state:s,target:u,preventScrollReset:c,relative:i,viewTransition:h});function _(C){e&&e(C),C.defaultPrevented||T(C)}let x=X.createElement("a",{...d,...E,href:y||w,onClick:g||o?e:_,ref:iU(f,S),target:u,"data-discover":!v&&t==="render"?"true":void 0});return b&&!v?X.createElement(X.Fragment,null,x,X.createElement(tU,{page:w})):x});cn.displayName="Link";var uU=X.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:o,to:a,viewTransition:s,children:u,...l},c){let h=$d(a,{relative:l.relative}),d=Cs(),f=X.useContext(Vd),{navigator:m,basename:v}=X.useContext($i),y=f!=null&&gU(h)&&s===!0,g=m.encodeLocation?m.encodeLocation(h).pathname:h.pathname,w=d.pathname,b=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(w=w.toLowerCase(),b=b?b.toLowerCase():null,g=g.toLowerCase()),b&&v&&(b=Bi(b,v)||b);const S=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let E=w===g||!i&&w.startsWith(g)&&w.charAt(S)==="/",T=b!=null&&(b===g||!i&&b.startsWith(g)&&b.charAt(g.length)==="/"),_={isActive:E,isPending:T,isTransitioning:y},x=E?e:void 0,C;typeof r=="function"?C=r(_):C=[r,E?"active":null,T?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let N=typeof o=="function"?o(_):o;return X.createElement(cn,{...l,"aria-current":x,className:C,ref:c,style:N,to:a,viewTransition:s},typeof u=="function"?u(_):u)});uU.displayName="NavLink";var lU=X.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:o,method:a=Bp,action:s,onSubmit:u,relative:l,preventScrollReset:c,viewTransition:h,...d},f)=>{let m=pU(),v=mU(s,{relative:l}),y=a.toLowerCase()==="get"?"get":"post",g=typeof s=="string"&&yR.test(s),w=b=>{if(u&&u(b),b.defaultPrevented)return;b.preventDefault();let S=b.nativeEvent.submitter,E=(S==null?void 0:S.getAttribute("formmethod"))||a;m(S||b.currentTarget,{fetcherKey:e,method:E,navigate:t,replace:i,state:o,relative:l,preventScrollReset:c,viewTransition:h})};return X.createElement("form",{ref:f,method:y,action:v,onSubmit:r?u:w,...d,"data-discover":!g&&n==="render"?"true":void 0})});lU.displayName="Form";function cU(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wR(n){let e=X.useContext(Pu);return lt(e,cU(n)),e}function hU(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:o,viewTransition:a}={}){let s=gi(),u=Cs(),l=$d(n,{relative:o});return X.useCallback(c=>{if(jj(c,e)){c.preventDefault();let h=t!==void 0?t:cs(u)===cs(l);s(n,{replace:h,state:r,preventScrollReset:i,relative:o,viewTransition:a})}},[u,s,l,t,r,e,n,i,o,a])}var dU=0,fU=()=>`__${String(++dU)}__`;function pU(){let{router:n}=wR("useSubmit"),{basename:e}=X.useContext($i),t=Ij();return X.useCallback(async(r,i={})=>{let{action:o,method:a,encType:s,formData:u,body:l}=Vj(r,e);if(i.navigate===!1){let c=i.fetcherKey||fU();await n.fetch(c,t,i.action||o,{preventScrollReset:i.preventScrollReset,formData:u,body:l,formMethod:i.method||a,formEncType:i.encType||s,flushSync:i.flushSync})}else await n.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:u,body:l,formMethod:i.method||a,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,e,t])}function mU(n,{relative:e}={}){let{basename:t}=X.useContext($i),r=X.useContext(mo);lt(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),o={...$d(n||".",{relative:e})},a=Cs();if(n==null){o.search=a.search;let s=new URLSearchParams(o.search),u=s.getAll("index");if(u.some(c=>c==="")){s.delete("index"),u.filter(h=>h).forEach(h=>s.append("index",h));let c=s.toString();o.search=c?`?${c}`:""}}return(!n||n===".")&&i.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:ao([t,o.pathname])),cs(o)}function gU(n,e={}){let t=X.useContext(Ub);lt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=wR("useViewTransitionState"),i=$d(n,{relative:e.relative});if(!t.isTransitioning)return!1;let o=Bi(t.currentLocation.pathname,r)||t.currentLocation.pathname,a=Bi(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Nm(i.pathname,a)!=null||Nm(i.pathname,o)!=null}new TextEncoder;/**
 * react-router v7.0.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vU(n){return X.createElement(Aj,{flushSync:tR.flushSync,...n})}var v2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const de=function(n,e){if(!n)throw bc(e)},bc=function(n){return new Error("Firebase Database ("+bR.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},yU=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[t++],a=n[t++],s=n[t++],u=((i&7)<<18|(o&63)<<12|(a&63)<<6|s&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},qb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const o=n[i],a=i+1<n.length,s=a?n[i+1]:0,u=i+2<n.length,l=u?n[i+2]:0,c=o>>2,h=(o&3)<<4|s>>4;let d=(s&15)<<2|l>>6,f=l&63;u||(f=64,a||(d=64)),r.push(t[c],t[h],t[d],t[f])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(xR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yU(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const o=t[n.charAt(i++)],s=i<n.length?t[n.charAt(i)]:0;++i;const l=i<n.length?t[n.charAt(i)]:64;++i;const h=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||s==null||l==null||h==null)throw new wU;const d=o<<2|s>>4;if(r.push(d),l!==64){const f=s<<4&240|l>>2;if(r.push(f),h!==64){const m=l<<6&192|h;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class wU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _R=function(n){const e=xR(n);return qb.encodeByteArray(e,!0)},km=function(n){return _R(n).replace(/\./g,"")},Rm=function(n){try{return qb.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bU(n){return ER(void 0,n)}function ER(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!xU(t)||(n[t]=ER(n[t],e[t]));return n}function xU(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _U(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EU=()=>_U().__FIREBASE_DEFAULTS__,CU=()=>{if(typeof process>"u"||typeof v2>"u")return;const n=v2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},SU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Rm(n[1]);return e&&JSON.parse(e)},Kb=()=>{try{return EU()||CU()||SU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},CR=n=>{var e,t;return(t=(e=Kb())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},IU=n=>{const e=CR(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},SR=()=>{var n;return(n=Kb())===null||n===void 0?void 0:n.config},IR=n=>{var e;return(e=Kb())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NU(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[km(JSON.stringify(t)),km(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Xb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mr())}function TU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kU(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function NR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function RU(){const n=mr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function TR(){return bR.NODE_ADMIN===!0}function AU(){try{return typeof indexedDB=="object"}catch{return!1}}function DU(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OU="FirebaseError";class sa extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=OU,Object.setPrototypeOf(this,sa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gd.prototype.create)}}class Gd{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?PU(o,r):"Error",s=`${this.serviceName}: ${a} (${i}).`;return new sa(i,s,r)}}function PU(n,e){return n.replace(MU,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const MU=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(n){return JSON.parse(n)}function An(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR=function(n){let e={},t={},r={},i="";try{const o=n.split(".");e=cd(Rm(o[0])||""),t=cd(Rm(o[1])||""),i=o[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}},LU=function(n){const e=kR(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},FU=function(n){const e=kR(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function go(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Xl(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function T1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Am(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Dm(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const o=n[i],a=e[i];if(y2(o)&&y2(a)){if(!Dm(o,a))return!1}else if(o!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function y2(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function yh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function wh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){const d=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],o=this.chain_[1],a=this.chain_[2],s=this.chain_[3],u=this.chain_[4],l,c;for(let h=0;h<80;h++){h<40?h<20?(l=s^o&(a^s),c=1518500249):(l=o^a^s,c=1859775393):h<60?(l=o&a|s&(o|a),c=2400959708):(l=o^a^s,c=3395469782);const d=(i<<5|i>>>27)+l+u+c+r[h]&4294967295;u=s,s=a,a=(o<<30|o>>>2)&4294967295,o=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+s&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let i=0;const o=this.buf_;let a=this.inbuf_;for(;i<t;){if(a===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(o[a]=e.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(o),a=0;break}}else for(;i<t;)if(o[a]=e[i],++a,++i,a===this.blockSize){this.compress_(o),a=0;break}}this.inbuf_=a,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let o=24;o>=0;o-=8)e[r]=this.chain_[i]>>o&255,++r;return e}}function BU(n,e){const t=new jU(n,e);return t.subscribe.bind(t)}class jU{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");UU(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Vy),i.error===void 0&&(i.error=Vy),i.complete===void 0&&(i.complete=Vy);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function UU(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Vy(){}function Ug(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WU=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const o=i-55296;r++,de(r<n.length,"Surrogate pair missing trail surrogate.");const a=n.charCodeAt(r)-56320;i=65536+(o<<10)+a}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Wg=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xr(n){return n&&n._delegate?n._delegate:n}class hs{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Hd;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HU(e))try{this.getOrInitializeService({instanceIdentifier:Ws})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Ws){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ws){return this.instances.has(e)}getOptions(e=Ws){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,a]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(o);r===s&&a.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);const a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$U(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ws){return this.component?this.component.multipleInstances?e:Ws:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $U(n){return n===Ws?void 0:n}function HU(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new VU(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(It||(It={}));const qU={debug:It.DEBUG,verbose:It.VERBOSE,info:It.INFO,warn:It.WARN,error:It.ERROR,silent:It.SILENT},KU=It.INFO,XU={[It.DEBUG]:"log",[It.VERBOSE]:"log",[It.INFO]:"info",[It.WARN]:"warn",[It.ERROR]:"error"},YU=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=XU[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vg{constructor(e){this.name=e,this._logLevel=KU,this._logHandler=YU,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in It))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,It.DEBUG,...e),this._logHandler(this,It.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,It.VERBOSE,...e),this._logHandler(this,It.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,It.INFO,...e),this._logHandler(this,It.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,It.WARN,...e),this._logHandler(this,It.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,It.ERROR,...e),this._logHandler(this,It.ERROR,...e)}}const QU=(n,e)=>e.some(t=>n instanceof t);let w2,b2;function JU(){return w2||(w2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZU(){return b2||(b2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const RR=new WeakMap,k1=new WeakMap,AR=new WeakMap,$y=new WeakMap,Yb=new WeakMap;function eW(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(es(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&RR.set(t,n)}).catch(()=>{}),Yb.set(e,n),e}function tW(n){if(k1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});k1.set(n,e)}let R1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return k1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||AR.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return es(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function nW(n){R1=n(R1)}function rW(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Hy(this),e,...t);return AR.set(r,e.sort?e.sort():[e]),es(r)}:ZU().includes(n)?function(...e){return n.apply(Hy(this),e),es(RR.get(this))}:function(...e){return es(n.apply(Hy(this),e))}}function iW(n){return typeof n=="function"?rW(n):(n instanceof IDBTransaction&&tW(n),QU(n,JU())?new Proxy(n,R1):n)}function es(n){if(n instanceof IDBRequest)return eW(n);if($y.has(n))return $y.get(n);const e=iW(n);return e!==n&&($y.set(n,e),Yb.set(e,n)),e}const Hy=n=>Yb.get(n);function oW(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(n,e),s=es(a);return r&&a.addEventListener("upgradeneeded",u=>{r(es(a.result),u.oldVersion,u.newVersion,es(a.transaction),u)}),t&&a.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),s.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),s}const aW=["get","getKey","getAll","getAllKeys","count"],sW=["put","add","delete","clear"],Gy=new Map;function x2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Gy.get(e))return Gy.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=sW.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||aW.includes(t)))return;const o=async function(a,...s){const u=this.transaction(a,i?"readwrite":"readonly");let l=u.store;return r&&(l=l.index(s.shift())),(await Promise.all([l[t](...s),i&&u.done]))[0]};return Gy.set(e,o),o}nW(n=>({...n,get:(e,t,r)=>x2(e,t)||n.get(e,t,r),has:(e,t)=>!!x2(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uW{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(lW(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function lW(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const A1="@firebase/app",_2="0.10.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ea=new Vg("@firebase/app"),cW="@firebase/app-compat",hW="@firebase/analytics-compat",dW="@firebase/analytics",fW="@firebase/app-check-compat",pW="@firebase/app-check",mW="@firebase/auth",gW="@firebase/auth-compat",vW="@firebase/database",yW="@firebase/data-connect",wW="@firebase/database-compat",bW="@firebase/functions",xW="@firebase/functions-compat",_W="@firebase/installations",EW="@firebase/installations-compat",CW="@firebase/messaging",SW="@firebase/messaging-compat",IW="@firebase/performance",NW="@firebase/performance-compat",TW="@firebase/remote-config",kW="@firebase/remote-config-compat",RW="@firebase/storage",AW="@firebase/storage-compat",DW="@firebase/firestore",OW="@firebase/vertexai",PW="@firebase/firestore-compat",MW="firebase",LW="11.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="[DEFAULT]",FW={[A1]:"fire-core",[cW]:"fire-core-compat",[dW]:"fire-analytics",[hW]:"fire-analytics-compat",[pW]:"fire-app-check",[fW]:"fire-app-check-compat",[mW]:"fire-auth",[gW]:"fire-auth-compat",[vW]:"fire-rtdb",[yW]:"fire-data-connect",[wW]:"fire-rtdb-compat",[bW]:"fire-fn",[xW]:"fire-fn-compat",[_W]:"fire-iid",[EW]:"fire-iid-compat",[CW]:"fire-fcm",[SW]:"fire-fcm-compat",[IW]:"fire-perf",[NW]:"fire-perf-compat",[TW]:"fire-rc",[kW]:"fire-rc-compat",[RW]:"fire-gcs",[AW]:"fire-gcs-compat",[DW]:"fire-fst",[PW]:"fire-fst-compat",[OW]:"fire-vertex","fire-js":"fire-js",[MW]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om=new Map,zW=new Map,O1=new Map;function E2(n,e){try{n.container.addComponent(e)}catch(t){ea.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function wu(n){const e=n.name;if(O1.has(e))return ea.debug(`There were multiple attempts to register component ${e}.`),!1;O1.set(e,n);for(const t of Om.values())E2(t,n);for(const t of zW.values())E2(t,n);return!0}function Qb(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function no(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BW={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ts=new Gd("app","Firebase",BW);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jW{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new hs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ts.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu=LW;function DR(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:D1,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ts.create("bad-app-name",{appName:String(i)});if(t||(t=SR()),!t)throw ts.create("no-options");const o=Om.get(i);if(o){if(Dm(t,o.options)&&Dm(r,o.config))return o;throw ts.create("duplicate-app",{appName:i})}const a=new GU(i);for(const u of O1.values())a.addComponent(u);const s=new jW(t,r,a);return Om.set(i,s),s}function OR(n=D1){const e=Om.get(n);if(!e&&n===D1&&SR())return DR();if(!e)throw ts.create("no-app",{appName:n});return e}function so(n,e,t){var r;let i=(r=FW[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const s=[`Unable to register library "${i}" with version "${e}":`];o&&s.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&s.push("and"),a&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ea.warn(s.join(" "));return}wu(new hs(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UW="firebase-heartbeat-database",WW=1,hd="firebase-heartbeat-store";let qy=null;function PR(){return qy||(qy=oW(UW,WW,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(hd)}catch(t){console.warn(t)}}}}).catch(n=>{throw ts.create("idb-open",{originalErrorMessage:n.message})})),qy}async function VW(n){try{const t=(await PR()).transaction(hd),r=await t.objectStore(hd).get(MR(n));return await t.done,r}catch(e){if(e instanceof sa)ea.warn(e.message);else{const t=ts.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ea.warn(t.message)}}}async function C2(n,e){try{const r=(await PR()).transaction(hd,"readwrite");await r.objectStore(hd).put(e,MR(n)),await r.done}catch(t){if(t instanceof sa)ea.warn(t.message);else{const r=ts.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ea.warn(r.message)}}}function MR(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $W=1024,HW=30*24*60*60*1e3;class GW{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new KW(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=S2();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const s=new Date(a.date).valueOf();return Date.now()-s<=HW}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ea.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=S2(),{heartbeatsToSend:r,unsentEntries:i}=qW(this._heartbeatsCache.heartbeats),o=km(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ea.warn(t),""}}}function S2(){return new Date().toISOString().substring(0,10)}function qW(n,e=$W){const t=[];let r=n.slice();for(const i of n){const o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),I2(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),I2(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class KW{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return AU()?DU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await VW(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return C2(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return C2(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function I2(n){return km(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XW(n){wu(new hs("platform-logger",e=>new uW(e),"PRIVATE")),wu(new hs("heartbeat",e=>new GW(e),"PRIVATE")),so(A1,_2,n),so(A1,_2,"esm2017"),so("fire-js","")}XW("");function Jb(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function LR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const YW=LR,FR=new Gd("auth","Firebase",LR());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm=new Vg("@firebase/auth");function QW(n,...e){Pm.logLevel<=It.WARN&&Pm.warn(`Auth (${Mu}): ${n}`,...e)}function Up(n,...e){Pm.logLevel<=It.ERROR&&Pm.error(`Auth (${Mu}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ji(n,...e){throw Zb(n,...e)}function uo(n,...e){return Zb(n,...e)}function zR(n,e,t){const r=Object.assign(Object.assign({},YW()),{[e]:t});return new Gd("auth","Firebase",r).create(e,{appName:n.name})}function $o(n){return zR(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Zb(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return FR.create(n,...e)}function We(n,e,...t){if(!n)throw Zb(e,...t)}function Bo(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Up(e),new Error(e)}function ta(n,e){n||Bo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function JW(){return N2()==="http:"||N2()==="https:"}function N2(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZW(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(JW()||kU()||"connection"in navigator)?navigator.onLine:!0}function eV(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd{constructor(e,t){this.shortDelay=e,this.longDelay=t,ta(t>e,"Short delay should be less than long delay!"),this.isMobile=Xb()||NR()}get(){return ZW()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ex(n,e){ta(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV=new qd(3e4,6e4);function Ss(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Is(n,e,t,r,i={}){return jR(n,i,async()=>{let o={},a={};r&&(e==="GET"?a=r:o={body:JSON.stringify(r)});const s=xc(Object.assign({key:n.config.apiKey},a)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const l=Object.assign({method:e,headers:u},o);return TU()||(l.referrerPolicy="no-referrer"),BR.fetch()(UR(n,n.config.apiHost,t,s),l)})}async function jR(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},tV),e);try{const i=new iV(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw up(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const s=o.ok?a.errorMessage:a.error.message,[u,l]=s.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw up(n,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw up(n,"email-already-in-use",a);if(u==="USER_DISABLED")throw up(n,"user-disabled",a);const c=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw zR(n,c,l);ji(n,c)}}catch(i){if(i instanceof sa)throw i;ji(n,"network-request-failed",{message:String(i)})}}async function Kd(n,e,t,r,i={}){const o=await Is(n,e,t,r,i);return"mfaPendingCredential"in o&&ji(n,"multi-factor-auth-required",{_serverResponse:o}),o}function UR(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?ex(n.config,i):`${n.config.apiScheme}://${i}`}function rV(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(uo(this.auth,"network-request-failed")),nV.get())})}}function up(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=uo(n,e,r);return i.customData._tokenResponse=t,i}function T2(n){return n!==void 0&&n.enterprise!==void 0}class oV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return rV(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function aV(n,e){return Is(n,"GET","/v2/recaptchaConfig",Ss(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sV(n,e){return Is(n,"POST","/v1/accounts:delete",e)}async function WR(n,e){return Is(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function uV(n,e=!1){const t=xr(n),r=await t.getIdToken(e),i=tx(r);We(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:Ph(Ky(i.auth_time)),issuedAtTime:Ph(Ky(i.iat)),expirationTime:Ph(Ky(i.exp)),signInProvider:a||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Ky(n){return Number(n)*1e3}function tx(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Up("JWT malformed, contained fewer than 3 sections"),null;try{const i=Rm(t);return i?JSON.parse(i):(Up("Failed to decode base64 JWT payload"),null)}catch(i){return Up("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function k2(n){const e=tx(n);return We(e,"internal-error"),We(typeof e.exp<"u","internal-error"),We(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dd(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof sa&&lV(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function lV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ph(this.lastLoginAt),this.creationTime=Ph(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mm(n){var e;const t=n.auth,r=await n.getIdToken(),i=await dd(n,WR(t,{idToken:r}));We(i==null?void 0:i.users.length,t,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?VR(o.providerUserInfo):[],s=dV(n.providerData,a),u=n.isAnonymous,l=!(n.email&&o.passwordHash)&&!(s!=null&&s.length),c=u?l:!1,h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:s,metadata:new M1(o.createdAt,o.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function hV(n){const e=xr(n);await Mm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function dV(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function VR(n){return n.map(e=>{var{providerId:t}=e,r=Jb(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fV(n,e){const t=await jR(n,{},async()=>{const r=xc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=UR(n,i,"/v1/token",`key=${o}`),s=await n._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",BR.fetch()(a,{method:"POST",headers:s,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function pV(n,e){return Is(n,"POST","/v2/accounts:revokeToken",Ss(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){We(e.idToken,"internal-error"),We(typeof e.idToken<"u","internal-error"),We(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):k2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){We(e.length!==0,"internal-error");const t=k2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(We(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:o}=await fV(e,t);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new Ol;return r&&(We(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(We(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(We(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ol,this.toJSON())}_performRefresh(){return Bo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ca(n,e){We(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class jo{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=Jb(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new cV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new M1(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await dd(this,this.stsTokenManager.getToken(this.auth,e));return We(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return uV(this,e)}reload(){return hV(this)}_assign(e){this!==e&&(We(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new jo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){We(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Mm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(no(this.auth.app))return Promise.reject($o(this.auth));const e=await this.getIdToken();return await dd(this,sV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,s,u,l,c;const h=(r=t.displayName)!==null&&r!==void 0?r:void 0,d=(i=t.email)!==null&&i!==void 0?i:void 0,f=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,m=(a=t.photoURL)!==null&&a!==void 0?a:void 0,v=(s=t.tenantId)!==null&&s!==void 0?s:void 0,y=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,g=(l=t.createdAt)!==null&&l!==void 0?l:void 0,w=(c=t.lastLoginAt)!==null&&c!==void 0?c:void 0,{uid:b,emailVerified:S,isAnonymous:E,providerData:T,stsTokenManager:_}=t;We(b&&_,e,"internal-error");const x=Ol.fromJSON(this.name,_);We(typeof b=="string",e,"internal-error"),Ca(h,e.name),Ca(d,e.name),We(typeof S=="boolean",e,"internal-error"),We(typeof E=="boolean",e,"internal-error"),Ca(f,e.name),Ca(m,e.name),Ca(v,e.name),Ca(y,e.name),Ca(g,e.name),Ca(w,e.name);const C=new jo({uid:b,auth:e,email:d,emailVerified:S,displayName:h,isAnonymous:E,photoURL:m,phoneNumber:f,tenantId:v,stsTokenManager:x,createdAt:g,lastLoginAt:w});return T&&Array.isArray(T)&&(C.providerData=T.map(N=>Object.assign({},N))),y&&(C._redirectEventId=y),C}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ol;i.updateFromServerResponse(t);const o=new jo({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Mm(o),o}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];We(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?VR(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),s=new Ol;s.updateFromIdToken(r);const u=new jo({uid:i.localId,auth:e,stsTokenManager:s,isAnonymous:a}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new M1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(u,l),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R2=new Map;function Uo(n){ta(n instanceof Function,"Expected a class definition");let e=R2.get(n);return e?(ta(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,R2.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}$R.type="NONE";const A2=$R;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wp(n,e,t){return`firebase:${n}:${e}:${t}`}class Pl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=Wp(this.userKey,i.apiKey,o),this.fullPersistenceKey=Wp("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?jo._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Pl(Uo(A2),e,r);const i=(await Promise.all(t.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let o=i[0]||Uo(A2);const a=Wp(r,e.config.apiKey,e.name);let s=null;for(const l of t)try{const c=await l._get(a);if(c){const h=jo._fromJSON(e,c);l!==o&&(s=h),o=l;break}}catch{}const u=i.filter(l=>l._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new Pl(o,e,r):(o=u[0],s&&await o._set(a,s.toJSON()),await Promise.all(t.map(async l=>{if(l!==o)try{await l._remove(a)}catch{}})),new Pl(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D2(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(KR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(HR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(YR(e))return"Blackberry";if(QR(e))return"Webos";if(GR(e))return"Safari";if((e.includes("chrome/")||qR(e))&&!e.includes("edge/"))return"Chrome";if(XR(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function HR(n=mr()){return/firefox\//i.test(n)}function GR(n=mr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function qR(n=mr()){return/crios\//i.test(n)}function KR(n=mr()){return/iemobile/i.test(n)}function XR(n=mr()){return/android/i.test(n)}function YR(n=mr()){return/blackberry/i.test(n)}function QR(n=mr()){return/webos/i.test(n)}function nx(n=mr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function mV(n=mr()){var e;return nx(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function gV(){return RU()&&document.documentMode===10}function JR(n=mr()){return nx(n)||XR(n)||QR(n)||YR(n)||/windows phone/i.test(n)||KR(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZR(n,e=[]){let t;switch(n){case"Browser":t=D2(mr());break;case"Worker":t=`${D2(mr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Mu}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=o=>new Promise((a,s)=>{try{const u=e(o);a(u)}catch(u){s(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yV(n,e={}){return Is(n,"GET","/v2/passwordPolicy",Ss(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wV=6;class bV{constructor(e){var t,r,i,o;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:wV,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,s;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsUppercaseLetter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(a=u.containsNumericCharacter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(s=u.containsNonAlphanumericCharacter)!==null&&s!==void 0?s:!0),u}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new O2(this),this.idTokenSubscription=new O2(this),this.beforeStateQueue=new vV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=FR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Uo(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Pl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await WR(this,{idToken:e}),r=await jo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(no(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,s=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===s)&&(u!=null&&u.user)&&(i=u.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return We(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Mm(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(no(this.app))return Promise.reject($o(this));const t=e?xr(e):null;return t&&We(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&We(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return no(this.app)?Promise.reject($o(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return no(this.app)?Promise.reject($o(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Uo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await yV(this),t=new bV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Gd("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await pV(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Uo(e)||this._popupRedirectResolver;We(t,this,"argument-error"),this.redirectPersistenceManager=await Pl.create(this,[Uo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let a=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(We(s,this,"internal-error"),s.then(()=>{a||o(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{a=!0,u()}}else{const u=e.addObserver(t);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return We(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ZR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&QW(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Lu(n){return xr(n)}class O2{constructor(e){this.auth=e,this.observer=null,this.addObserver=BU(t=>this.observer=t)}get next(){return We(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $g={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _V(n){$g=n}function eA(n){return $g.loadJS(n)}function EV(){return $g.recaptchaEnterpriseScript}function CV(){return $g.gapiScript}function SV(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class IV{constructor(){this.enterprise=new NV}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class NV{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const TV="recaptcha-enterprise",tA="NO_RECAPTCHA";class kV{constructor(e){this.type=TV,this.auth=Lu(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,s)=>{aV(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)s(new Error("recaptcha Enterprise site key undefined"));else{const l=new oV(u);return o.tenantId==null?o._agentRecaptchaConfig=l:o._tenantRecaptchaConfigs[o.tenantId]=l,a(l.siteKey)}}).catch(u=>{s(u)})})}function i(o,a,s){const u=window.grecaptcha;T2(u)?u.enterprise.ready(()=>{u.enterprise.execute(o,{action:e}).then(l=>{a(l)}).catch(()=>{a(tA)})}):s(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new IV().execute("siteKey",{action:"verify"}):new Promise((o,a)=>{r(this.auth).then(s=>{if(!t&&T2(window.grecaptcha))i(s,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=EV();u.length!==0&&(u+=s),eA(u).then(()=>{i(s,o,a)}).catch(l=>{a(l)})}}).catch(s=>{a(s)})})}}async function P2(n,e,t,r=!1,i=!1){const o=new kV(n);let a;if(i)a=tA;else try{a=await o.verify(t)}catch{a=await o.verify(t,!0)}const s=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in s){const u=s.phoneEnrollmentInfo.phoneNumber,l=s.phoneEnrollmentInfo.recaptchaToken;Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in s){const u=s.phoneSignInInfo.recaptchaToken;Object.assign(s,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return s}return r?Object.assign(s,{captchaResp:a}):Object.assign(s,{captchaResponse:a}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function L1(n,e,t,r,i){var o;if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await P2(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await P2(n,e,t,t==="getOobCode");return r(n,s)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RV(n,e){const t=Qb(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),o=t.getOptions();if(Dm(o,e??{}))return i;ji(i,"already-initialized")}return t.initialize({options:e})}function AV(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Uo);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function DV(n,e,t){const r=Lu(n);We(r._canInitEmulator,r,"emulator-config-failed"),We(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,o=nA(e),{host:a,port:s}=OV(e),u=s===null?"":`:${s}`;r.config.emulator={url:`${o}//${a}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:s,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),PV()}function nA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function OV(n){const e=nA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:M2(r.substr(o.length+1))}}else{const[o,a]=r.split(":");return{host:o,port:M2(a)}}}function M2(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function PV(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Bo("not implemented")}_getIdTokenResponse(e){return Bo("not implemented")}_linkToIdToken(e,t){return Bo("not implemented")}_getReauthenticationResolver(e){return Bo("not implemented")}}async function MV(n,e){return Is(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LV(n,e){return Kd(n,"POST","/v1/accounts:signInWithPassword",Ss(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FV(n,e){return Kd(n,"POST","/v1/accounts:signInWithEmailLink",Ss(n,e))}async function zV(n,e){return Kd(n,"POST","/v1/accounts:signInWithEmailLink",Ss(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd extends rx{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new fd(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new fd(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return L1(e,t,"signInWithPassword",LV);case"emailLink":return FV(e,{email:this._email,oobCode:this._password});default:ji(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return L1(e,r,"signUpPassword",MV);case"emailLink":return zV(e,{idToken:t,email:this._email,oobCode:this._password});default:ji(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ml(n,e){return Kd(n,"POST","/v1/accounts:signInWithIdp",Ss(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV="http://localhost";class bu extends rx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new bu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ji("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,o=Jb(t,["providerId","signInMethod"]);if(!r||!i)return null;const a=new bu(r,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Ml(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ml(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ml(e,t)}buildRequest(){const e={requestUri:BV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=xc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jV(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function UV(n){const e=yh(wh(n)).link,t=e?yh(wh(e)).deep_link_id:null,r=yh(wh(n)).deep_link_id;return(r?yh(wh(r)).link:null)||r||t||e||n}class ix{constructor(e){var t,r,i,o,a,s;const u=yh(wh(e)),l=(t=u.apiKey)!==null&&t!==void 0?t:null,c=(r=u.oobCode)!==null&&r!==void 0?r:null,h=jV((i=u.mode)!==null&&i!==void 0?i:null);We(l&&c&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=c,this.continueUrl=(o=u.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=u.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(s=u.tenantId)!==null&&s!==void 0?s:null}static parseLink(e){const t=UV(e);try{return new ix(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(){this.providerId=_c.PROVIDER_ID}static credential(e,t){return fd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=ix.parseLink(t);return We(r,"argument-error"),fd._fromEmailAndCode(e,r.code,r.tenantId)}}_c.PROVIDER_ID="password";_c.EMAIL_PASSWORD_SIGN_IN_METHOD="password";_c.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd extends rA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma extends Xd{constructor(){super("facebook.com")}static credential(e){return bu._fromParams({providerId:Ma.PROVIDER_ID,signInMethod:Ma.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ma.credentialFromTaggedObject(e)}static credentialFromError(e){return Ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ma.credential(e.oauthAccessToken)}catch{return null}}}Ma.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ma.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La extends Xd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return bu._fromParams({providerId:La.PROVIDER_ID,signInMethod:La.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return La.credentialFromTaggedObject(e)}static credentialFromError(e){return La.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return La.credential(t,r)}catch{return null}}}La.GOOGLE_SIGN_IN_METHOD="google.com";La.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa extends Xd{constructor(){super("github.com")}static credential(e){return bu._fromParams({providerId:Fa.PROVIDER_ID,signInMethod:Fa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fa.credentialFromTaggedObject(e)}static credentialFromError(e){return Fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fa.credential(e.oauthAccessToken)}catch{return null}}}Fa.GITHUB_SIGN_IN_METHOD="github.com";Fa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za extends Xd{constructor(){super("twitter.com")}static credential(e,t){return bu._fromParams({providerId:za.PROVIDER_ID,signInMethod:za.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return za.credentialFromTaggedObject(e)}static credentialFromError(e){return za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return za.credential(t,r)}catch{return null}}}za.TWITTER_SIGN_IN_METHOD="twitter.com";za.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WV(n,e){return Kd(n,"POST","/v1/accounts:signUp",Ss(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const o=await jo._fromIdTokenResponse(e,r,i),a=L2(r);return new xu({user:o,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=L2(r);return new xu({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function L2(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm extends sa{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Lm.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Lm(e,t,r,i)}}function iA(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Lm._fromErrorAndOperation(n,o,e,r):o})}async function VV(n,e,t=!1){const r=await dd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return xu._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $V(n,e,t=!1){const{auth:r}=n;if(no(r.app))return Promise.reject($o(r));const i="reauthenticate";try{const o=await dd(n,iA(r,i,e,n),t);We(o.idToken,r,"internal-error");const a=tx(o.idToken);We(a,r,"internal-error");const{sub:s}=a;return We(n.uid===s,r,"user-mismatch"),xu._forOperation(n,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&ji(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oA(n,e,t=!1){if(no(n.app))return Promise.reject($o(n));const r="signIn",i=await iA(n,r,e),o=await xu._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(o.user),o}async function HV(n,e){return oA(Lu(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aA(n){const e=Lu(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function GV(n,e,t){if(no(n.app))return Promise.reject($o(n));const r=Lu(n),a=await L1(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",WV).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&aA(n),u}),s=await xu._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(s.user),s}function qV(n,e,t){return no(n.app)?Promise.reject($o(n)):HV(xr(n),_c.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&aA(n),r})}function KV(n,e,t,r){return xr(n).onIdTokenChanged(e,t,r)}function XV(n,e,t){return xr(n).beforeAuthStateChanged(e,t)}function YV(n,e,t,r){return xr(n).onAuthStateChanged(e,t,r)}function Yd(n){return xr(n).signOut()}const Fm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Fm,"1"),this.storage.removeItem(Fm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QV=1e3,JV=10;class uA extends sA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=JR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,s,u)=>{this.notifyListeners(a,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},o=this.storage.getItem(r);gV()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,JV):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},QV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}uA.type="LOCAL";const ZV=uA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA extends sA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}lA.type="SESSION";const cA=lA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e$(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Hg(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:o}=t.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const s=Array.from(a).map(async l=>l(t.origin,o)),u=await e$(s);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((s,u)=>{const l=ox("",20);i.port1.start();const c=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(c),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),s(d.data.response);break;default:clearTimeout(c),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lo(){return window}function n$(n){lo().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(){return typeof lo().WorkerGlobalScope<"u"&&typeof lo().importScripts=="function"}async function r$(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function i$(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function o$(){return hA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA="firebaseLocalStorageDb",a$=1,zm="firebaseLocalStorage",fA="fbase_key";class Qd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Gg(n,e){return n.transaction([zm],e?"readwrite":"readonly").objectStore(zm)}function s$(){const n=indexedDB.deleteDatabase(dA);return new Qd(n).toPromise()}function F1(){const n=indexedDB.open(dA,a$);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(zm,{keyPath:fA})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(zm)?e(r):(r.close(),await s$(),e(await F1()))})})}async function F2(n,e,t){const r=Gg(n,!0).put({[fA]:e,value:t});return new Qd(r).toPromise()}async function u$(n,e){const t=Gg(n,!1).get(e),r=await new Qd(t).toPromise();return r===void 0?null:r.value}function z2(n,e){const t=Gg(n,!0).delete(e);return new Qd(t).toPromise()}const l$=800,c$=3;class pA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await F1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>c$)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hg._getInstance(o$()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await r$(),!this.activeServiceWorker)return;this.sender=new t$(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||i$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await F1();return await F2(e,Fm,"1"),await z2(e,Fm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>F2(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>u$(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>z2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Gg(i,!1).getAll();return new Qd(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),l$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}pA.type="LOCAL";const h$=pA;new qd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d$(n,e){return e?Uo(e):(We(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax extends rx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ml(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ml(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ml(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function f$(n){return oA(n.auth,new ax(n),n.bypassAuthState)}function p$(n){const{auth:e,user:t}=n;return We(t,e,"internal-error"),$V(t,new ax(n),n.bypassAuthState)}async function m$(n){const{auth:e,user:t}=n;return We(t,e,"internal-error"),VV(t,new ax(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:a,type:s}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(u))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return f$;case"linkViaPopup":case"linkViaRedirect":return m$;case"reauthViaPopup":case"reauthViaRedirect":return p$;default:ji(this.auth,"internal-error")}}resolve(e){ta(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ta(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g$=new qd(2e3,1e4);class Cl extends mA{constructor(e,t,r,i,o){super(e,t,i,o),this.provider=r,this.authWindow=null,this.pollId=null,Cl.currentPopupAction&&Cl.currentPopupAction.cancel(),Cl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return We(e,this.auth,"internal-error"),e}async onExecution(){ta(this.filter.length===1,"Popup operations only handle one event");const e=ox();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(uo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(uo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Cl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(uo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,g$.get())};e()}}Cl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v$="pendingRedirect",Vp=new Map;class y$ extends mA{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Vp.get(this.auth._key());if(!e){try{const r=await w$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Vp.set(this.auth._key(),e)}return this.bypassAuthState||Vp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function w$(n,e){const t=_$(e),r=x$(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function b$(n,e){Vp.set(n._key(),e)}function x$(n){return Uo(n._redirectPersistence)}function _$(n){return Wp(v$,n.config.apiKey,n.name)}async function E$(n,e,t=!1){if(no(n.app))return Promise.reject($o(n));const r=Lu(n),i=d$(r,e),a=await new y$(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C$=10*60*1e3;class S${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!I$(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!gA(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(uo(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=C$&&this.cachedEventUids.clear(),this.cachedEventUids.has(B2(e))}saveEventToCache(e){this.cachedEventUids.add(B2(e)),this.lastProcessedEventTime=Date.now()}}function B2(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function gA({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function I$(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gA(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N$(n,e={}){return Is(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,k$=/^https?/;async function R$(n){if(n.config.emulator)return;const{authorizedDomains:e}=await N$(n);for(const t of e)try{if(A$(t))return}catch{}ji(n,"unauthorized-domain")}function A$(n){const e=P1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!k$.test(t))return!1;if(T$.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D$=new qd(3e4,6e4);function j2(){const n=lo().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function O$(n){return new Promise((e,t)=>{var r,i,o;function a(){j2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{j2(),t(uo(n,"network-request-failed"))},timeout:D$.get()})}if(!((i=(r=lo().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=lo().gapi)===null||o===void 0)&&o.load)a();else{const s=SV("iframefcb");return lo()[s]=()=>{gapi.load?a():t(uo(n,"network-request-failed"))},eA(`${CV()}?onload=${s}`).catch(u=>t(u))}}).catch(e=>{throw $p=null,e})}let $p=null;function P$(n){return $p=$p||O$(n),$p}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M$=new qd(5e3,15e3),L$="__/auth/iframe",F$="emulator/auth/iframe",z$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},B$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function j$(n){const e=n.config;We(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ex(e,F$):`https://${n.config.authDomain}/${L$}`,r={apiKey:e.apiKey,appName:n.name,v:Mu},i=B$.get(n.config.apiHost);i&&(r.eid=i);const o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${xc(r).slice(1)}`}async function U$(n){const e=await P$(n),t=lo().gapi;return We(t,n,"internal-error"),e.open({where:document.body,url:j$(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:z$,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const a=uo(n,"network-request-failed"),s=lo().setTimeout(()=>{o(a)},M$.get());function u(){lo().clearTimeout(s),i(r)}r.ping(u).then(u,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},V$=500,$$=600,H$="_blank",G$="http://localhost";class U2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function q$(n,e,t,r=V$,i=$$){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let s="";const u=Object.assign(Object.assign({},W$),{width:r.toString(),height:i.toString(),top:o,left:a}),l=mr().toLowerCase();t&&(s=qR(l)?H$:t),HR(l)&&(e=e||G$,u.scrollbars="yes");const c=Object.entries(u).reduce((d,[f,m])=>`${d}${f}=${m},`,"");if(mV(l)&&s!=="_self")return K$(e||"",s),new U2(null);const h=window.open(e||"",s,c);We(h,n,"popup-blocked");try{h.focus()}catch{}return new U2(h)}function K$(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X$="__/auth/handler",Y$="emulator/auth/handler",Q$=encodeURIComponent("fac");async function W2(n,e,t,r,i,o){We(n.config.authDomain,n,"auth-domain-config-required"),We(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Mu,eventId:i};if(e instanceof rA){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",T1(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,h]of Object.entries({}))a[c]=h}if(e instanceof Xd){const c=e.getScopes().filter(h=>h!=="");c.length>0&&(a.scopes=c.join(","))}n.tenantId&&(a.tid=n.tenantId);const s=a;for(const c of Object.keys(s))s[c]===void 0&&delete s[c];const u=await n._getAppCheckToken(),l=u?`#${Q$}=${encodeURIComponent(u)}`:"";return`${J$(n)}?${xc(s).slice(1)}${l}`}function J$({config:n}){return n.emulator?ex(n,Y$):`https://${n.authDomain}/${X$}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy="webStorageSupport";class Z${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=cA,this._completeRedirectFn=E$,this._overrideRedirectResult=b$}async _openPopup(e,t,r,i){var o;ta((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const a=await W2(e,t,r,P1(),i);return q$(e,a,ox())}async _openRedirect(e,t,r,i){await this._originValidation(e);const o=await W2(e,t,r,P1(),i);return n$(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(ta(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await U$(e),r=new S$(e);return t.register("authEvent",i=>(We(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Xy,{type:Xy},i=>{var o;const a=(o=i==null?void 0:i[0])===null||o===void 0?void 0:o[Xy];a!==void 0&&t(!!a),ji(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=R$(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return JR()||GR()||nx()}}const e6=Z$;var V2="@firebase/auth",$2="1.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){We(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n6(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function r6(n){wu(new hs("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:s}=r.options;We(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:s,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ZR(n)},l=new xV(r,i,o,u);return AV(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),wu(new hs("auth-internal",e=>{const t=Lu(e.getProvider("auth").getImmediate());return(r=>new t6(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),so(V2,$2,n6(n)),so(V2,$2,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6=5*60,o6=IR("authIdTokenMaxAge")||i6;let H2=null;const a6=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>o6)return;const i=t==null?void 0:t.token;H2!==i&&(H2=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function ua(n=OR()){const e=Qb(n,"auth");if(e.isInitialized())return e.getImmediate();const t=RV(n,{popupRedirectResolver:e6,persistence:[h$,ZV,cA]}),r=IR("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const a=a6(o.toString());XV(t,a,()=>a(t.currentUser)),KV(t,s=>a(s))}}const i=CR("auth");return i&&DV(t,`http://${i}`),t}function s6(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}_V({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const o=uo("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",s6().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});r6("Browser");var u6="firebase",l6="11.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */so(u6,l6,"app");var G2={};const q2="@firebase/database",K2="1.0.10";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vA="";function c6(n){vA=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),An(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:cd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return go(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new h6(e)}}catch{}return new d6},tu=yA("localStorage"),f6=yA("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=new Vg("@firebase/database"),p6=function(){let n=1;return function(){return n++}}(),wA=function(n){const e=WU(n),t=new zU;t.update(e);const r=t.digest();return qb.encodeByteArray(r)},Jd=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Jd.apply(null,r):typeof r=="object"?e+=An(r):e+=r,e+=" "}return e};let Mh=null,X2=!0;const m6=function(n,e){de(!e,"Can't turn on custom loggers persistently."),Ll.logLevel=It.VERBOSE,Mh=Ll.log.bind(Ll)},qn=function(...n){if(X2===!0&&(X2=!1,Mh===null&&f6.get("logging_enabled")===!0&&m6()),Mh){const e=Jd.apply(null,n);Mh(e)}},Zd=function(n){return function(...e){qn(n,...e)}},z1=function(...n){const e="FIREBASE INTERNAL ERROR: "+Jd(...n);Ll.error(e)},na=function(...n){const e=`FIREBASE FATAL ERROR: ${Jd(...n)}`;throw Ll.error(e),new Error(e)},pr=function(...n){const e="FIREBASE WARNING: "+Jd(...n);Ll.warn(e)},g6=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&pr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},sx=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},v6=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Yl="[MIN_NAME]",_u="[MAX_NAME]",Fu=function(n,e){if(n===e)return 0;if(n===Yl||e===_u)return-1;if(e===Yl||n===_u)return 1;{const t=Y2(n),r=Y2(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},y6=function(n,e){return n===e?0:n<e?-1:1},rh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+An(e))},ux=function(n){if(typeof n!="object"||n===null)return An(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=An(e[r]),t+=":",t+=ux(n[e[r]]);return t+="}",t},bA=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Jn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const xA=function(n){de(!sx(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let i,o,a,s,u;n===0?(o=0,a=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(s=Math.min(Math.floor(Math.log(n)/Math.LN2),r),o=s+r,a=Math.round(n*Math.pow(2,t-s)-Math.pow(2,t))):(o=0,a=Math.round(n/Math.pow(2,1-r-t))));const l=[];for(u=t;u;u-=1)l.push(a%2?1:0),a=Math.floor(a/2);for(u=e;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);l.push(i?1:0),l.reverse();const c=l.join("");let h="";for(u=0;u<64;u+=8){let d=parseInt(c.substr(u,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},w6=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},b6=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function x6(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const _6=new RegExp("^-?(0*)\\d{1,10}$"),E6=-2147483648,C6=2147483647,Y2=function(n){if(_6.test(n)){const e=Number(n);if(e>=E6&&e<=C6)return e}return null},Ec=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw pr("Exception was thrown by user callback.",t),e},Math.floor(0))}},S6=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Lh=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){pr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(qn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',pr(e)}}class Hp{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Hp.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx="5",_A="v",EA="s",CA="r",SA="f",IA=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,NA="ls",TA="p",B1="ac",kA="websocket",RA="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e,t,r,i,o=!1,a="",s=!1,u=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=a,this.includeNamespaceInQueryParams=s,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=tu.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&tu.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function T6(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function DA(n,e,t){de(typeof e=="string","typeof type must == string"),de(typeof t=="object","typeof params must == object");let r;if(e===kA)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===RA)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);T6(n)&&(t.ns=n.namespace);const i=[];return Jn(t,(o,a)=>{i.push(o+"="+a)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(){this.counters_={}}incrementCounter(e,t=1){go(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return bU(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy={},Qy={};function cx(n){const e=n.toString();return Yy[e]||(Yy[e]=new k6),Yy[e]}function R6(n,e){const t=n.toString();return Qy[t]||(Qy[t]=e()),Qy[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Ec(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2="start",D6="close",O6="pLPCommand",P6="pRTLPCB",OA="id",PA="pw",MA="ser",M6="cb",L6="seg",F6="ts",z6="d",B6="dframe",LA=1870,FA=30,j6=LA-FA,U6=25e3,W6=3e4;class Sl{constructor(e,t,r,i,o,a,s){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=a,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Zd(e),this.stats_=cx(t),this.urlFn=u=>(this.appCheckToken&&(u[B1]=this.appCheckToken),DA(t,RA,u))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new A6(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(W6)),v6(()=>{if(this.isClosed_)return;this.scriptTagHolder=new hx((...o)=>{const[a,s,u,l,c]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===Q2)this.id=s,this.password=u;else if(a===D6)s?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(s,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...o)=>{const[a,s]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(a,s)},()=>{this.onClosed_()},this.urlFn);const r={};r[Q2]="t",r[MA]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[M6]=this.scriptTagHolder.uniqueCallbackIdentifier),r[_A]=lx,this.transportSessionId&&(r[EA]=this.transportSessionId),this.lastSessionId&&(r[NA]=this.lastSessionId),this.applicationId&&(r[TA]=this.applicationId),this.appCheckToken&&(r[B1]=this.appCheckToken),typeof location<"u"&&location.hostname&&IA.test(location.hostname)&&(r[CA]=SA);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Sl.forceAllow_=!0}static forceDisallow(){Sl.forceDisallow_=!0}static isAvailable(){return Sl.forceAllow_?!0:!Sl.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!w6()&&!b6()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=An(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=_R(t),i=bA(r,j6);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[B6]="t",r[OA]=e,r[PA]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=An(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class hx{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=p6(),window[O6+this.uniqueCallbackIdentifier]=e,window[P6+this.uniqueCallbackIdentifier]=t,this.myIFrame=hx.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(s){qn("frame writing exception"),s.stack&&qn(s.stack),qn(s)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||qn("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[OA]=this.myID,e[PA]=this.myPW,e[MA]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+FA+r.length<=LA;){const a=this.pendingSegs.shift();r=r+"&"+L6+i+"="+a.seg+"&"+F6+i+"="+a.ts+"&"+z6+i+"="+a.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(U6)),o=()=>{clearTimeout(i),r()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{qn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V6=16384,$6=45e3;let Bm=null;typeof MozWebSocket<"u"?Bm=MozWebSocket:typeof WebSocket<"u"&&(Bm=WebSocket);class Ii{constructor(e,t,r,i,o,a,s){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Zd(this.connId),this.stats_=cx(t),this.connURL=Ii.connectionURL_(t,a,s,i,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i,o){const a={};return a[_A]=lx,typeof location<"u"&&location.hostname&&IA.test(location.hostname)&&(a[CA]=SA),t&&(a[EA]=t),r&&(a[NA]=r),i&&(a[B1]=i),o&&(a[TA]=o),DA(e,kA,a)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,tu.set("previous_websocket_failure",!0);try{let r;TR(),this.mySock=new Bm(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Ii.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Bm!==null&&!Ii.forceDisallow_}static previouslyFailed(){return tu.isInMemoryStorage||tu.get("previous_websocket_failure")===!0}markConnectionHealthy(){tu.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=cd(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(de(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=An(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=bA(t,V6);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor($6))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ii.responsesRequiredToBeHealthy=2;Ii.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{static get ALL_TRANSPORTS(){return[Sl,Ii]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=Ii&&Ii.isAvailable();let r=t&&!Ii.previouslyFailed();if(e.webSocketOnly&&(t||pr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Ii];else{const i=this.transports_=[];for(const o of pd.ALL_TRANSPORTS)o&&o.isAvailable()&&i.push(o);pd.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}pd.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6=6e4,G6=5e3,q6=10*1024,K6=100*1024,Jy="t",J2="d",X6="s",Z2="r",Y6="e",eI="o",tI="a",nI="n",rI="p",Q6="h";class J6{constructor(e,t,r,i,o,a,s,u,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=a,this.onReady_=s,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Zd("c:"+this.id+":"),this.transportManager_=new pd(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Lh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>K6?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>q6?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Jy in e){const t=e[Jy];t===tI?this.upgradeIfSecondaryHealthy_():t===Z2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===eI&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=rh("t",e),r=rh("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:rI,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:tI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:nI,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=rh("t",e),r=rh("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=rh(Jy,e);if(J2 in e){const r=e[J2];if(t===Q6){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===nI){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===X6?this.onConnectionShutdown_(r):t===Z2?this.onReset_(r):t===Y6?z1("Server Error: "+r):t===eI?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):z1("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),lx!==r&&pr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Lh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(H6))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Lh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(G6))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:rI,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(tu.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e){this.allowedEvents_=e,this.listeners_={},de(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let o=0;o<i.length;o++)if(i[o].callback===t&&(!r||r===i[o].context)){i.splice(o,1);return}}validateEventType_(e){de(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm extends BA{static getInstance(){return new jm}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Xb()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return de(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI=32,oI=768;class Dt{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function bt(){return new Dt("")}function rt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ds(n){return n.pieces_.length-n.pieceNum_}function zt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Dt(n.pieces_,e)}function dx(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Z6(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function md(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function jA(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Dt(e,0)}function ln(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Dt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Dt(t,0)}function at(n){return n.pieceNum_>=n.pieces_.length}function dr(n,e){const t=rt(n),r=rt(e);if(t===null)return e;if(t===r)return dr(zt(n),zt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function e5(n,e){const t=md(n,0),r=md(e,0);for(let i=0;i<t.length&&i<r.length;i++){const o=Fu(t[i],r[i]);if(o!==0)return o}return t.length===r.length?0:t.length<r.length?-1:1}function fx(n,e){if(ds(n)!==ds(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function hi(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(ds(n)>ds(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class t5{constructor(e,t){this.errorPrefix_=t,this.parts_=md(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Wg(this.parts_[r]);UA(this)}}function n5(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Wg(e),UA(n)}function r5(n){const e=n.parts_.pop();n.byteLength_-=Wg(e),n.parts_.length>0&&(n.byteLength_-=1)}function UA(n){if(n.byteLength_>oI)throw new Error(n.errorPrefix_+"has a key path longer than "+oI+" bytes ("+n.byteLength_+").");if(n.parts_.length>iI)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+iI+") or object contains a cycle "+Vs(n))}function Vs(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px extends BA{static getInstance(){return new px}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return de(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih=1e3,i5=60*5*1e3,aI=30*1e3,o5=1.3,a5=3e4,s5="server_kill",sI=3;class Ho extends zA{constructor(e,t,r,i,o,a,s,u){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=s,this.authOverride_=u,this.id=Ho.nextPersistentConnectionId_++,this.log_=Zd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ih,this.maxReconnectDelay_=i5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!TR())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");px.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&jm.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,o={r:i,a:e,b:t};this.log_(An(o)),de(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new Hd,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const s=a.d;a.s==="ok"?t.resolve(s):t.reject(s)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,r,i){this.initConnection_();const o=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),de(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),de(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const s={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(a).set(o,s),this.connected_&&this.sendListen_(s)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const o={p:r},a="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(a,o,s=>{const u=s.d,l=s.s;Ho.warnOnListenWarnings_(u,t),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",s),l!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(l,u))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&go(e,"w")){const r=Xl(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();pr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||FU(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=aI)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=LU(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,i=>{const o=i.s,a=i.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),de(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const o={p:e},a="n";i&&(o.q=r,o.t=i),this.sendRequest(a,o)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const o={p:t,d:r};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,a=>{i&&setTimeout(()=>{i(a.s,a.d)},Math.floor(0))})}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,o){this.initConnection_();const a={p:t,d:r};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:e,request:a,onComplete:i}),this.outstandingPutCount_++;const s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+An(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):z1("Unrecognized action received from server: "+An(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){de(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ih,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ih,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>a5&&(this.reconnectDelay_=ih),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*o5)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Ho.nextConnectionId_++,o=this.lastSessionId;let a=!1,s=null;const u=function(){s?s.close():(a=!0,r())},l=function(h){de(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(h)};this.realtime_={close:u,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);a?qn("getToken() completed but was canceled"):(qn("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,s=new J6(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,f=>{pr(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(s5)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&pr(h),u())}}}interrupt(e){qn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){qn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],T1(this.interruptReasons_)&&(this.reconnectDelay_=ih,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(o=>ux(o)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new Dt(e).toString();let i;if(this.listens.has(r)){const o=this.listens.get(r);i=o.get(t),o.delete(t),o.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){qn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=sI&&(this.reconnectDelay_=aI,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){qn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=sI&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+vA.replace(/\./g,"-")]=1,Xb()?e["framework.cordova"]=1:NR()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=jm.getInstance().currentlyOnline();return T1(this.interruptReasons_)&&e}}Ho.nextPersistentConnectionId_=0;Ho.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new it(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new it(Yl,e),i=new it(Yl,t);return this.compare(r,i)!==0}minPost(){return it.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lp;class WA extends qg{static get __EMPTY_NODE(){return lp}static set __EMPTY_NODE(e){lp=e}compare(e,t){return Fu(e.name,t.name)}isDefinedOn(e){throw bc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return it.MIN}maxPost(){return new it(_u,lp)}makePost(e,t){return de(typeof e=="string","KeyIndex indexValue must always be a string."),new it(e,lp)}toString(){return".key"}}const Fl=new WA;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(e,t,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=t?r(e.key,t):1,i&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Ln{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??Ln.RED,this.left=i??kr.EMPTY_NODE,this.right=o??kr.EMPTY_NODE}copy(e,t,r,i,o){return new Ln(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return o<0?i=i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return kr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return kr.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Ln.RED=!0;Ln.BLACK=!1;class u5{copy(e,t,r,i,o){return this}insert(e,t,r){return new Ln(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class kr{constructor(e,t=kr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new kr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ln.BLACK,null,null))}remove(e){return new kr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ln.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new cp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new cp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new cp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new cp(this.root_,null,this.comparator_,!0,e)}}kr.EMPTY_NODE=new u5;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l5(n,e){return Fu(n.name,e.name)}function mx(n,e){return Fu(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let j1;function c5(n){j1=n}const VA=function(n){return typeof n=="number"?"number:"+xA(n):"string:"+n},$A=function(n){if(n.isLeafNode()){const e=n.val();de(typeof e=="string"||typeof e=="number"||typeof e=="object"&&go(e,".sv"),"Priority must be a string or number.")}else de(n===j1||n.isEmpty(),"priority of unexpected type.");de(n===j1||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uI;class Pn{static set __childrenNodeConstructor(e){uI=e}static get __childrenNodeConstructor(){return uI}constructor(e,t=Pn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,de(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),$A(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Pn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Pn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return at(e)?this:rt(e)===".priority"?this.priorityNode_:Pn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:Pn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=rt(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(de(r!==".priority"||ds(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Pn.__childrenNodeConstructor.EMPTY_NODE.updateChild(zt(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+VA(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=xA(this.value_):e+=this.value_,this.lazyHash_=wA(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Pn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Pn.__childrenNodeConstructor?-1:(de(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=Pn.VALUE_TYPE_ORDER.indexOf(t),o=Pn.VALUE_TYPE_ORDER.indexOf(r);return de(i>=0,"Unknown leaf type: "+t),de(o>=0,"Unknown leaf type: "+r),i===o?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}Pn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let HA,GA;function h5(n){HA=n}function d5(n){GA=n}class f5 extends qg{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),o=r.compareTo(i);return o===0?Fu(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return it.MIN}maxPost(){return new it(_u,new Pn("[PRIORITY-POST]",GA))}makePost(e,t){const r=HA(e);return new it(t,new Pn("[PRIORITY-POST]",r))}toString(){return".priority"}}const hn=new f5;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p5=Math.log(2);class m5{constructor(e){const t=o=>parseInt(Math.log(o)/p5,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Um=function(n,e,t,r){n.sort(e);const i=function(u,l){const c=l-u;let h,d;if(c===0)return null;if(c===1)return h=n[u],d=t?t(h):h,new Ln(d,h.node,Ln.BLACK,null,null);{const f=parseInt(c/2,10)+u,m=i(u,f),v=i(f+1,l);return h=n[f],d=t?t(h):h,new Ln(d,h.node,Ln.BLACK,m,v)}},o=function(u){let l=null,c=null,h=n.length;const d=function(m,v){const y=h-m,g=h;h-=m;const w=i(y+1,g),b=n[y],S=t?t(b):b;f(new Ln(S,b.node,v,null,w))},f=function(m){l?(l.left=m,l=m):(c=m,l=m)};for(let m=0;m<u.count;++m){const v=u.nextBitIsOne(),y=Math.pow(2,u.count-(m+1));v?d(y,Ln.BLACK):(d(y,Ln.BLACK),d(y,Ln.RED))}return c},a=new m5(n.length),s=o(a);return new kr(r||e,s)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zy;const il={};class Wo{static get Default(){return de(il&&hn,"ChildrenNode.ts has not been loaded"),Zy=Zy||new Wo({".priority":il},{".priority":hn}),Zy}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=Xl(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof kr?t:null}hasIndex(e){return go(this.indexSet_,e.toString())}addIndex(e,t){de(e!==Fl,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const o=t.getIterator(it.Wrap);let a=o.getNext();for(;a;)i=i||e.isDefinedOn(a.node),r.push(a),a=o.getNext();let s;i?s=Um(r,e.getCompare()):s=il;const u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;const c=Object.assign({},this.indexes_);return c[u]=s,new Wo(c,l)}addToIndexes(e,t){const r=Am(this.indexes_,(i,o)=>{const a=Xl(this.indexSet_,o);if(de(a,"Missing index implementation for "+o),i===il)if(a.isDefinedOn(e.node)){const s=[],u=t.getIterator(it.Wrap);let l=u.getNext();for(;l;)l.name!==e.name&&s.push(l),l=u.getNext();return s.push(e),Um(s,a.getCompare())}else return il;else{const s=t.get(e.name);let u=i;return s&&(u=u.remove(new it(e.name,s))),u.insert(e,e.node)}});return new Wo(r,this.indexSet_)}removeFromIndexes(e,t){const r=Am(this.indexes_,i=>{if(i===il)return i;{const o=t.get(e.name);return o?i.remove(new it(e.name,o)):i}});return new Wo(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oh;class Le{static get EMPTY_NODE(){return oh||(oh=new Le(new kr(mx),null,Wo.Default))}constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&$A(this.priorityNode_),this.children_.isEmpty()&&de(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||oh}updatePriority(e){return this.children_.isEmpty()?this:new Le(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?oh:t}}getChild(e){const t=rt(e);return t===null?this:this.getImmediateChild(t).getChild(zt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(de(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new it(e,t);let i,o;t.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(r,this.children_));const a=i.isEmpty()?oh:this.priorityNode_;return new Le(i,a,o)}}updateChild(e,t){const r=rt(e);if(r===null)return t;{de(rt(e)!==".priority"||ds(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(zt(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,o=!0;if(this.forEachChild(hn,(a,s)=>{t[a]=s.val(e),r++,o&&Le.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!e&&o&&i<2*r){const a=[];for(const s in t)a[s]=t[s];return a}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+VA(this.getPriority().val())+":"),this.forEachChild(hn,(t,r)=>{const i=r.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":wA(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const o=i.getPredecessorKey(new it(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new it(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new it(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,it.Wrap);let o=i.peek();for(;o!=null&&t.compare(o,e)<0;)i.getNext(),o=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,it.Wrap);let o=i.peek();for(;o!=null&&t.compare(o,e)>0;)i.getNext(),o=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ef?-1:0}withIndex(e){if(e===Fl||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Le(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Fl||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(hn),i=t.getIterator(hn);let o=r.getNext(),a=i.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=i.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===Fl?null:this.indexMap_.get(e.toString())}}Le.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class g5 extends Le{constructor(){super(new kr(mx),Le.EMPTY_NODE,Wo.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Le.EMPTY_NODE}isEmpty(){return!1}}const ef=new g5;Object.defineProperties(it,{MIN:{value:new it(Yl,Le.EMPTY_NODE)},MAX:{value:new it(_u,ef)}});WA.__EMPTY_NODE=Le.EMPTY_NODE;Pn.__childrenNodeConstructor=Le;c5(ef);d5(ef);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5=!0;function Rn(n,e=null){if(n===null)return Le.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),de(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new Pn(t,Rn(e))}if(!(n instanceof Array)&&v5){const t=[];let r=!1;if(Jn(n,(a,s)=>{if(a.substring(0,1)!=="."){const u=Rn(s);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),t.push(new it(a,u)))}}),t.length===0)return Le.EMPTY_NODE;const o=Um(t,l5,a=>a.name,mx);if(r){const a=Um(t,hn.getCompare());return new Le(o,Rn(e),new Wo({".priority":a},{".priority":hn}))}else return new Le(o,Rn(e),Wo.Default)}else{let t=Le.EMPTY_NODE;return Jn(n,(r,i)=>{if(go(n,r)&&r.substring(0,1)!=="."){const o=Rn(i);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(r,o))}}),t.updatePriority(Rn(e))}}h5(Rn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y5 extends qg{constructor(e){super(),this.indexPath_=e,de(!at(e)&&rt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),o=r.compareTo(i);return o===0?Fu(e.name,t.name):o}makePost(e,t){const r=Rn(e),i=Le.EMPTY_NODE.updateChild(this.indexPath_,r);return new it(t,i)}maxPost(){const e=Le.EMPTY_NODE.updateChild(this.indexPath_,ef);return new it(_u,e)}toString(){return md(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5 extends qg{compare(e,t){const r=e.node.compareTo(t.node);return r===0?Fu(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return it.MIN}maxPost(){return it.MAX}makePost(e,t){const r=Rn(e);return new it(t,r)}toString(){return".value"}}const b5=new w5;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qA(n){return{type:"value",snapshotNode:n}}function Ql(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function gd(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function vd(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function x5(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e){this.index_=e}updateChild(e,t,r,i,o,a){de(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const s=e.getImmediateChild(t);return s.getChild(i).equals(r.getChild(i))&&s.isEmpty()===r.isEmpty()||(a!=null&&(r.isEmpty()?e.hasChild(t)?a.trackChildChange(gd(t,s)):de(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(Ql(t,r)):a.trackChildChange(vd(t,r,s))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(hn,(i,o)=>{t.hasChild(i)||r.trackChildChange(gd(i,o))}),t.isLeafNode()||t.forEachChild(hn,(i,o)=>{if(e.hasChild(i)){const a=e.getImmediateChild(i);a.equals(o)||r.trackChildChange(vd(i,o,a))}else r.trackChildChange(Ql(i,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Le.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e){this.indexedFilter_=new gx(e.getIndex()),this.index_=e.getIndex(),this.startPost_=yd.getStartPost_(e),this.endPost_=yd.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,o,a){return this.matches(new it(t,r))||(r=Le.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,o,a)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Le.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Le.EMPTY_NODE);const o=this;return t.forEachChild(hn,(a,s)=>{o.matches(new it(a,s))||(i=i.updateImmediateChild(a,Le.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new yd(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,o,a){return this.rangedFilter_.matches(new it(t,r))||(r=Le.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,o,a):this.fullLimitUpdateChild_(e,t,r,o,a)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Le.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=Le.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;o.hasNext()&&a<this.limit_;){const s=o.getNext();if(this.withinDirectionalStart(s))if(this.withinDirectionalEnd(s))i=i.updateImmediateChild(s.name,s.node),a++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(Le.EMPTY_NODE);let o;this.reverse_?o=i.getReverseIterator(this.index_):o=i.getIterator(this.index_);let a=0;for(;o.hasNext();){const s=o.getNext();a<this.limit_&&this.withinDirectionalStart(s)&&this.withinDirectionalEnd(s)?a++:i=i.updateImmediateChild(s.name,Le.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,o){let a;if(this.reverse_){const h=this.index_.getCompare();a=(d,f)=>h(f,d)}else a=this.index_.getCompare();const s=e;de(s.numChildren()===this.limit_,"");const u=new it(t,r),l=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),c=this.rangedFilter_.matches(u);if(s.hasChild(t)){const h=s.getImmediateChild(t);let d=i.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===t||s.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:a(d,u);if(c&&!r.isEmpty()&&f>=0)return o!=null&&o.trackChildChange(vd(t,r,h)),s.updateImmediateChild(t,r);{o!=null&&o.trackChildChange(gd(t,h));const v=s.updateImmediateChild(t,Le.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(o!=null&&o.trackChildChange(Ql(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}}else return r.isEmpty()?e:c&&a(l,u)>=0?(o!=null&&(o.trackChildChange(gd(l.name,l.node)),o.trackChildChange(Ql(t,r))),s.updateImmediateChild(t,r).updateImmediateChild(l.name,Le.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=hn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return de(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return de(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Yl}hasEnd(){return this.endSet_}getIndexEndValue(){return de(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return de(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:_u}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return de(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===hn}copy(){const e=new vx;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function E5(n){return n.loadsAllData()?new gx(n.getIndex()):n.hasLimit()?new _5(n):new yd(n)}function lI(n){const e={};if(n.isDefault())return e;let t;if(n.index_===hn?t="$priority":n.index_===b5?t="$value":n.index_===Fl?t="$key":(de(n.index_ instanceof y5,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=An(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=An(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+An(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=An(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+An(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function cI(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==hn&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm extends zA{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(de(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Zd("p:rest:"),this.listens_={}}listen(e,t,r,i){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const a=Wm.getListenId_(e,r),s={};this.listens_[a]=s;const u=lI(e._queryParams);this.restRequest_(o+".json",u,(l,c)=>{let h=c;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(o,h,!1,r),Xl(this.listens_,a)===s){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",i(d,null)}})}unlisten(e,t){const r=Wm.getListenId_(e,t);delete this.listens_[r]}get(e){const t=lI(e._queryParams),r=e._path.toString(),i=new Hd;return this.restRequest_(r+".json",t,(o,a)=>{let s=a;o===404&&(s=null,o=null),o===null?(this.onDataUpdate_(r,s,!1,null),i.resolve(s)):i.reject(new Error(s))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(t.auth=i.accessToken),o&&o.token&&(t.ac=o.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+xc(t);this.log_("Sending REST request for "+a);const s=new XMLHttpRequest;s.onreadystatechange=()=>{if(r&&s.readyState===4){this.log_("REST Response for "+a+" received. status:",s.status,"response:",s.responseText);let u=null;if(s.status>=200&&s.status<300){try{u=cd(s.responseText)}catch{pr("Failed to parse JSON response for "+a+": "+s.responseText)}r(null,u)}else s.status!==401&&s.status!==404&&pr("Got unsuccessful REST response for "+a+" Status: "+s.status),r(s.status);r=null}},s.open("GET",a,!0),s.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C5{constructor(){this.rootNode_=Le.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(){return{value:null,children:new Map}}function KA(n,e,t){if(at(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=rt(e);n.children.has(r)||n.children.set(r,Vm());const i=n.children.get(r);e=zt(e),KA(i,e,t)}}function U1(n,e,t){n.value!==null?t(e,n.value):S5(n,(r,i)=>{const o=new Dt(e.toString()+"/"+r);U1(i,o,t)})}function S5(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I5{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Jn(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI=10*1e3,N5=30*1e3,T5=5*60*1e3;class k5{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new I5(e);const r=hI+(N5-hI)*Math.random();Lh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Jn(e,(i,o)=>{o>0&&go(this.statsToReport_,i)&&(t[i]=o,r=!0)}),r&&this.server_.reportStats(t),Lh(this.reportStats_.bind(this),Math.floor(Math.random()*2*T5))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ki;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ki||(ki={}));function yx(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function wx(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function bx(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=ki.ACK_USER_WRITE,this.source=yx()}operationForChild(e){if(at(this.path)){if(this.affectedTree.value!=null)return de(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Dt(e));return new $m(bt(),t,this.revert)}}else return de(rt(this.path)===e,"operationForChild called for unrelated child."),new $m(zt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t){this.source=e,this.path=t,this.type=ki.LISTEN_COMPLETE}operationForChild(e){return at(this.path)?new wd(this.source,bt()):new wd(this.source,zt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=ki.OVERWRITE}operationForChild(e){return at(this.path)?new Eu(this.source,bt(),this.snap.getImmediateChild(e)):new Eu(this.source,zt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xx=class W1{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=ki.MERGE}operationForChild(e){if(at(this.path)){const t=this.children.subtree(new Dt(e));return t.isEmpty()?null:t.value?new Eu(this.source,bt(),t.value):new W1(this.source,bt(),t)}else return de(rt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new W1(this.source,zt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(at(e))return this.isFullyInitialized()&&!this.filtered_;const t=rt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function A5(n,e,t,r){const i=[],o=[];return e.forEach(a=>{a.type==="child_changed"&&n.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&o.push(x5(a.childName,a.snapshotNode))}),ah(n,i,"child_removed",e,r,t),ah(n,i,"child_added",e,r,t),ah(n,i,"child_moved",o,r,t),ah(n,i,"child_changed",e,r,t),ah(n,i,"value",e,r,t),i}function ah(n,e,t,r,i,o){const a=r.filter(s=>s.type===t);a.sort((s,u)=>O5(n,s,u)),a.forEach(s=>{const u=D5(n,s,o);i.forEach(l=>{l.respondsTo(s.type)&&e.push(l.createEvent(u,n.query_))})})}function D5(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function O5(n,e,t){if(e.childName==null||t.childName==null)throw bc("Should only compare child_ events.");const r=new it(e.childName,e.snapshotNode),i=new it(t.childName,t.snapshotNode);return n.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(n,e){return{eventCache:n,serverCache:e}}function Fh(n,e,t,r){return Kg(new fs(e,t,r),n.serverCache)}function XA(n,e,t,r){return Kg(n.eventCache,new fs(e,t,r))}function Hm(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Cu(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e0;const P5=()=>(e0||(e0=new kr(y6)),e0);class Lt{static fromObject(e){let t=new Lt(null);return Jn(e,(r,i)=>{t=t.set(new Dt(r),i)}),t}constructor(e,t=P5()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:bt(),value:this.value};if(at(e))return null;{const r=rt(e),i=this.children.get(r);if(i!==null){const o=i.findRootMostMatchingPathAndValue(zt(e),t);return o!=null?{path:ln(new Dt(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(at(e))return this;{const t=rt(e),r=this.children.get(t);return r!==null?r.subtree(zt(e)):new Lt(null)}}set(e,t){if(at(e))return new Lt(t,this.children);{const r=rt(e),o=(this.children.get(r)||new Lt(null)).set(zt(e),t),a=this.children.insert(r,o);return new Lt(this.value,a)}}remove(e){if(at(e))return this.children.isEmpty()?new Lt(null):new Lt(null,this.children);{const t=rt(e),r=this.children.get(t);if(r){const i=r.remove(zt(e));let o;return i.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,i),this.value===null&&o.isEmpty()?new Lt(null):new Lt(this.value,o)}else return this}}get(e){if(at(e))return this.value;{const t=rt(e),r=this.children.get(t);return r?r.get(zt(e)):null}}setTree(e,t){if(at(e))return t;{const r=rt(e),o=(this.children.get(r)||new Lt(null)).setTree(zt(e),t);let a;return o.isEmpty()?a=this.children.remove(r):a=this.children.insert(r,o),new Lt(this.value,a)}}fold(e){return this.fold_(bt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(ln(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,bt(),t)}findOnPath_(e,t,r){const i=this.value?r(t,this.value):!1;if(i)return i;if(at(e))return null;{const o=rt(e),a=this.children.get(o);return a?a.findOnPath_(zt(e),ln(t,o),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,bt(),t)}foreachOnPath_(e,t,r){if(at(e))return this;{this.value&&r(t,this.value);const i=rt(e),o=this.children.get(i);return o?o.foreachOnPath_(zt(e),ln(t,i),r):new Lt(null)}}foreach(e){this.foreach_(bt(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(ln(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e){this.writeTree_=e}static empty(){return new Li(new Lt(null))}}function zh(n,e,t){if(at(e))return new Li(new Lt(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let o=r.value;const a=dr(i,e);return o=o.updateChild(a,t),new Li(n.writeTree_.set(i,o))}else{const i=new Lt(t),o=n.writeTree_.setTree(e,i);return new Li(o)}}}function V1(n,e,t){let r=n;return Jn(t,(i,o)=>{r=zh(r,ln(e,i),o)}),r}function dI(n,e){if(at(e))return Li.empty();{const t=n.writeTree_.setTree(e,new Lt(null));return new Li(t)}}function $1(n,e){return zu(n,e)!=null}function zu(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(dr(t.path,e)):null}function fI(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(hn,(r,i)=>{e.push(new it(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new it(r,i.value))}),e}function ns(n,e){if(at(e))return n;{const t=zu(n,e);return t!=null?new Li(new Lt(t)):new Li(n.writeTree_.subtree(e))}}function H1(n){return n.writeTree_.isEmpty()}function Jl(n,e){return YA(bt(),n.writeTree_,e)}function YA(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,o)=>{i===".priority"?(de(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):t=YA(ln(n,i),o,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(ln(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(n,e){return eD(e,n)}function M5(n,e,t,r,i){de(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=zh(n.visibleWrites,e,t)),n.lastWriteId=r}function L5(n,e,t,r){de(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=V1(n.visibleWrites,e,t),n.lastWriteId=r}function F5(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function z5(n,e){const t=n.allWrites.findIndex(s=>s.writeId===e);de(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,o=!1,a=n.allWrites.length-1;for(;i&&a>=0;){const s=n.allWrites[a];s.visible&&(a>=t&&B5(s,r.path)?i=!1:hi(r.path,s.path)&&(o=!0)),a--}if(i){if(o)return j5(n),!0;if(r.snap)n.visibleWrites=dI(n.visibleWrites,r.path);else{const s=r.children;Jn(s,u=>{n.visibleWrites=dI(n.visibleWrites,ln(r.path,u))})}return!0}else return!1}function B5(n,e){if(n.snap)return hi(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&hi(ln(n.path,t),e))return!0;return!1}function j5(n){n.visibleWrites=QA(n.allWrites,U5,bt()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function U5(n){return n.visible}function QA(n,e,t){let r=Li.empty();for(let i=0;i<n.length;++i){const o=n[i];if(e(o)){const a=o.path;let s;if(o.snap)hi(t,a)?(s=dr(t,a),r=zh(r,s,o.snap)):hi(a,t)&&(s=dr(a,t),r=zh(r,bt(),o.snap.getChild(s)));else if(o.children){if(hi(t,a))s=dr(t,a),r=V1(r,s,o.children);else if(hi(a,t))if(s=dr(a,t),at(s))r=V1(r,bt(),o.children);else{const u=Xl(o.children,rt(s));if(u){const l=u.getChild(zt(s));r=zh(r,bt(),l)}}}else throw bc("WriteRecord should have .snap or .children")}}return r}function JA(n,e,t,r,i){if(!r&&!i){const o=zu(n.visibleWrites,e);if(o!=null)return o;{const a=ns(n.visibleWrites,e);if(H1(a))return t;if(t==null&&!$1(a,bt()))return null;{const s=t||Le.EMPTY_NODE;return Jl(a,s)}}}else{const o=ns(n.visibleWrites,e);if(!i&&H1(o))return t;if(!i&&t==null&&!$1(o,bt()))return null;{const a=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(hi(l.path,e)||hi(e,l.path))},s=QA(n.allWrites,a,e),u=t||Le.EMPTY_NODE;return Jl(s,u)}}}function W5(n,e,t){let r=Le.EMPTY_NODE;const i=zu(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(hn,(o,a)=>{r=r.updateImmediateChild(o,a)}),r;if(t){const o=ns(n.visibleWrites,e);return t.forEachChild(hn,(a,s)=>{const u=Jl(ns(o,new Dt(a)),s);r=r.updateImmediateChild(a,u)}),fI(o).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}else{const o=ns(n.visibleWrites,e);return fI(o).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}}function V5(n,e,t,r,i){de(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=ln(e,t);if($1(n.visibleWrites,o))return null;{const a=ns(n.visibleWrites,o);return H1(a)?i.getChild(t):Jl(a,i.getChild(t))}}function $5(n,e,t,r){const i=ln(e,t),o=zu(n.visibleWrites,i);if(o!=null)return o;if(r.isCompleteForChild(t)){const a=ns(n.visibleWrites,i);return Jl(a,r.getNode().getImmediateChild(t))}else return null}function H5(n,e){return zu(n.visibleWrites,e)}function G5(n,e,t,r,i,o,a){let s;const u=ns(n.visibleWrites,e),l=zu(u,bt());if(l!=null)s=l;else if(t!=null)s=Jl(u,t);else return[];if(s=s.withIndex(a),!s.isEmpty()&&!s.isLeafNode()){const c=[],h=a.getCompare(),d=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a);let f=d.getNext();for(;f&&c.length<i;)h(f,r)!==0&&c.push(f),f=d.getNext();return c}else return[]}function q5(){return{visibleWrites:Li.empty(),allWrites:[],lastWriteId:-1}}function Gm(n,e,t,r){return JA(n.writeTree,n.treePath,e,t,r)}function _x(n,e){return W5(n.writeTree,n.treePath,e)}function pI(n,e,t,r){return V5(n.writeTree,n.treePath,e,t,r)}function qm(n,e){return H5(n.writeTree,ln(n.treePath,e))}function K5(n,e,t,r,i,o){return G5(n.writeTree,n.treePath,e,t,r,i,o)}function Ex(n,e,t){return $5(n.writeTree,n.treePath,e,t)}function ZA(n,e){return eD(ln(n.treePath,e),n.writeTree)}function eD(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;de(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),de(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const o=i.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(r,vd(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(r,gd(r,i.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(r,Ql(r,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(r,vd(r,e.snapshotNode,i.oldSnap));else throw bc("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y5{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const tD=new Y5;class Cx{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new fs(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ex(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Cu(this.viewCache_),o=K5(this.writes_,i,t,1,r,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q5(n){return{filter:n}}function J5(n,e){de(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),de(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function Z5(n,e,t,r,i){const o=new X5;let a,s;if(t.type===ki.OVERWRITE){const l=t;l.source.fromUser?a=G1(n,e,l.path,l.snap,r,i,o):(de(l.source.fromServer,"Unknown source."),s=l.source.tagged||e.serverCache.isFiltered()&&!at(l.path),a=Km(n,e,l.path,l.snap,r,i,s,o))}else if(t.type===ki.MERGE){const l=t;l.source.fromUser?a=tH(n,e,l.path,l.children,r,i,o):(de(l.source.fromServer,"Unknown source."),s=l.source.tagged||e.serverCache.isFiltered(),a=q1(n,e,l.path,l.children,r,i,s,o))}else if(t.type===ki.ACK_USER_WRITE){const l=t;l.revert?a=iH(n,e,l.path,r,i,o):a=nH(n,e,l.path,l.affectedTree,r,i,o)}else if(t.type===ki.LISTEN_COMPLETE)a=rH(n,e,t.path,r,o);else throw bc("Unknown operation type: "+t.type);const u=o.getChanges();return eH(e,a,u),{viewCache:a,changes:u}}function eH(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Hm(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&t.push(qA(Hm(e)))}}function nD(n,e,t,r,i,o){const a=e.eventCache;if(qm(r,t)!=null)return e;{let s,u;if(at(t))if(de(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=Cu(e),c=l instanceof Le?l:Le.EMPTY_NODE,h=_x(r,c);s=n.filter.updateFullNode(e.eventCache.getNode(),h,o)}else{const l=Gm(r,Cu(e));s=n.filter.updateFullNode(e.eventCache.getNode(),l,o)}else{const l=rt(t);if(l===".priority"){de(ds(t)===1,"Can't have a priority with additional path components");const c=a.getNode();u=e.serverCache.getNode();const h=pI(r,t,c,u);h!=null?s=n.filter.updatePriority(c,h):s=a.getNode()}else{const c=zt(t);let h;if(a.isCompleteForChild(l)){u=e.serverCache.getNode();const d=pI(r,t,a.getNode(),u);d!=null?h=a.getNode().getImmediateChild(l).updateChild(c,d):h=a.getNode().getImmediateChild(l)}else h=Ex(r,l,e.serverCache);h!=null?s=n.filter.updateChild(a.getNode(),l,h,c,i,o):s=a.getNode()}}return Fh(e,s,a.isFullyInitialized()||at(t),n.filter.filtersNodes())}}function Km(n,e,t,r,i,o,a,s){const u=e.serverCache;let l;const c=a?n.filter:n.filter.getIndexedFilter();if(at(t))l=c.updateFullNode(u.getNode(),r,null);else if(c.filtersNodes()&&!u.isFiltered()){const f=u.getNode().updateChild(t,r);l=c.updateFullNode(u.getNode(),f,null)}else{const f=rt(t);if(!u.isCompleteForPath(t)&&ds(t)>1)return e;const m=zt(t),y=u.getNode().getImmediateChild(f).updateChild(m,r);f===".priority"?l=c.updatePriority(u.getNode(),y):l=c.updateChild(u.getNode(),f,y,m,tD,null)}const h=XA(e,l,u.isFullyInitialized()||at(t),c.filtersNodes()),d=new Cx(i,h,o);return nD(n,h,t,i,d,s)}function G1(n,e,t,r,i,o,a){const s=e.eventCache;let u,l;const c=new Cx(i,e,o);if(at(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,a),u=Fh(e,l,!0,n.filter.filtersNodes());else{const h=rt(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),u=Fh(e,l,s.isFullyInitialized(),s.isFiltered());else{const d=zt(t),f=s.getNode().getImmediateChild(h);let m;if(at(d))m=r;else{const v=c.getCompleteChild(h);v!=null?dx(d)===".priority"&&v.getChild(jA(d)).isEmpty()?m=v:m=v.updateChild(d,r):m=Le.EMPTY_NODE}if(f.equals(m))u=e;else{const v=n.filter.updateChild(s.getNode(),h,m,d,c,a);u=Fh(e,v,s.isFullyInitialized(),n.filter.filtersNodes())}}}return u}function mI(n,e){return n.eventCache.isCompleteForChild(e)}function tH(n,e,t,r,i,o,a){let s=e;return r.foreach((u,l)=>{const c=ln(t,u);mI(e,rt(c))&&(s=G1(n,s,c,l,i,o,a))}),r.foreach((u,l)=>{const c=ln(t,u);mI(e,rt(c))||(s=G1(n,s,c,l,i,o,a))}),s}function gI(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function q1(n,e,t,r,i,o,a,s){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,l;at(t)?l=r:l=new Lt(null).setTree(t,r);const c=e.serverCache.getNode();return l.children.inorderTraversal((h,d)=>{if(c.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),m=gI(n,f,d);u=Km(n,u,new Dt(h),m,i,o,a,s)}}),l.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===null;if(!c.hasChild(h)&&!f){const m=e.serverCache.getNode().getImmediateChild(h),v=gI(n,m,d);u=Km(n,u,new Dt(h),v,i,o,a,s)}}),u}function nH(n,e,t,r,i,o,a){if(qm(i,t)!=null)return e;const s=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(at(t)&&u.isFullyInitialized()||u.isCompleteForPath(t))return Km(n,e,t,u.getNode().getChild(t),i,o,s,a);if(at(t)){let l=new Lt(null);return u.getNode().forEachChild(Fl,(c,h)=>{l=l.set(new Dt(c),h)}),q1(n,e,t,l,i,o,s,a)}else return e}else{let l=new Lt(null);return r.foreach((c,h)=>{const d=ln(t,c);u.isCompleteForPath(d)&&(l=l.set(c,u.getNode().getChild(d)))}),q1(n,e,t,l,i,o,s,a)}}function rH(n,e,t,r,i){const o=e.serverCache,a=XA(e,o.getNode(),o.isFullyInitialized()||at(t),o.isFiltered());return nD(n,a,t,r,tD,i)}function iH(n,e,t,r,i,o){let a;if(qm(r,t)!=null)return e;{const s=new Cx(r,e,i),u=e.eventCache.getNode();let l;if(at(t)||rt(t)===".priority"){let c;if(e.serverCache.isFullyInitialized())c=Gm(r,Cu(e));else{const h=e.serverCache.getNode();de(h instanceof Le,"serverChildren would be complete if leaf node"),c=_x(r,h)}c=c,l=n.filter.updateFullNode(u,c,o)}else{const c=rt(t);let h=Ex(r,c,e.serverCache);h==null&&e.serverCache.isCompleteForChild(c)&&(h=u.getImmediateChild(c)),h!=null?l=n.filter.updateChild(u,c,h,zt(t),s,o):e.eventCache.getNode().hasChild(c)?l=n.filter.updateChild(u,c,Le.EMPTY_NODE,zt(t),s,o):l=u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=Gm(r,Cu(e)),a.isLeafNode()&&(l=n.filter.updateFullNode(l,a,o)))}return a=e.serverCache.isFullyInitialized()||qm(r,bt())!=null,Fh(e,l,a,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oH{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new gx(r.getIndex()),o=E5(r);this.processor_=Q5(o);const a=t.serverCache,s=t.eventCache,u=i.updateFullNode(Le.EMPTY_NODE,a.getNode(),null),l=o.updateFullNode(Le.EMPTY_NODE,s.getNode(),null),c=new fs(u,a.isFullyInitialized(),i.filtersNodes()),h=new fs(l,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Kg(h,c),this.eventGenerator_=new R5(this.query_)}get query(){return this.query_}}function aH(n){return n.viewCache_.serverCache.getNode()}function sH(n){return Hm(n.viewCache_)}function uH(n,e){const t=Cu(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!at(e)&&!t.getImmediateChild(rt(e)).isEmpty())?t.getChild(e):null}function vI(n){return n.eventRegistrations_.length===0}function lH(n,e){n.eventRegistrations_.push(e)}function yI(n,e,t){const r=[];if(t){de(e==null,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(o=>{const a=o.createCancelEvent(t,i);a&&r.push(a)})}if(e){let i=[];for(let o=0;o<n.eventRegistrations_.length;++o){const a=n.eventRegistrations_[o];if(!a.matches(e))i.push(a);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function wI(n,e,t,r){e.type===ki.MERGE&&e.source.queryId!==null&&(de(Cu(n.viewCache_),"We should always have a full cache before handling merges"),de(Hm(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,o=Z5(n.processor_,i,e,t,r);return J5(n.processor_,o.viewCache),de(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,rD(n,o.changes,o.viewCache.eventCache.getNode(),null)}function cH(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(hn,(o,a)=>{r.push(Ql(o,a))}),t.isFullyInitialized()&&r.push(qA(t.getNode())),rD(n,r,t.getNode(),e)}function rD(n,e,t,r){const i=r?[r]:n.eventRegistrations_;return A5(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xm;class iD{constructor(){this.views=new Map}}function hH(n){de(!Xm,"__referenceConstructor has already been defined"),Xm=n}function dH(){return de(Xm,"Reference.ts has not been loaded"),Xm}function fH(n){return n.views.size===0}function Sx(n,e,t,r){const i=e.source.queryId;if(i!==null){const o=n.views.get(i);return de(o!=null,"SyncTree gave us an op for an invalid query."),wI(o,e,t,r)}else{let o=[];for(const a of n.views.values())o=o.concat(wI(a,e,t,r));return o}}function oD(n,e,t,r,i){const o=e._queryIdentifier,a=n.views.get(o);if(!a){let s=Gm(t,i?r:null),u=!1;s?u=!0:r instanceof Le?(s=_x(t,r),u=!1):(s=Le.EMPTY_NODE,u=!1);const l=Kg(new fs(s,u,!1),new fs(r,i,!1));return new oH(e,l)}return a}function pH(n,e,t,r,i,o){const a=oD(n,e,r,i,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,a),lH(a,t),cH(a,t)}function mH(n,e,t,r){const i=e._queryIdentifier,o=[];let a=[];const s=ps(n);if(i==="default")for(const[u,l]of n.views.entries())a=a.concat(yI(l,t,r)),vI(l)&&(n.views.delete(u),l.query._queryParams.loadsAllData()||o.push(l.query));else{const u=n.views.get(i);u&&(a=a.concat(yI(u,t,r)),vI(u)&&(n.views.delete(i),u.query._queryParams.loadsAllData()||o.push(u.query)))}return s&&!ps(n)&&o.push(new(dH())(e._repo,e._path)),{removed:o,events:a}}function aD(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function rs(n,e){let t=null;for(const r of n.views.values())t=t||uH(r,e);return t}function sD(n,e){if(e._queryParams.loadsAllData())return Yg(n);{const r=e._queryIdentifier;return n.views.get(r)}}function uD(n,e){return sD(n,e)!=null}function ps(n){return Yg(n)!=null}function Yg(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ym;function gH(n){de(!Ym,"__referenceConstructor has already been defined"),Ym=n}function vH(){return de(Ym,"Reference.ts has not been loaded"),Ym}let yH=1;class bI{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Lt(null),this.pendingWriteTree_=q5(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function lD(n,e,t,r,i){return M5(n.pendingWriteTree_,e,t,r,i),i?Cc(n,new Eu(yx(),e,t)):[]}function wH(n,e,t,r){L5(n.pendingWriteTree_,e,t,r);const i=Lt.fromObject(t);return Cc(n,new xx(yx(),e,i))}function Wa(n,e,t=!1){const r=F5(n.pendingWriteTree_,e);if(z5(n.pendingWriteTree_,e)){let o=new Lt(null);return r.snap!=null?o=o.set(bt(),!0):Jn(r.children,a=>{o=o.set(new Dt(a),!0)}),Cc(n,new $m(r.path,o,t))}else return[]}function tf(n,e,t){return Cc(n,new Eu(wx(),e,t))}function bH(n,e,t){const r=Lt.fromObject(t);return Cc(n,new xx(wx(),e,r))}function xH(n,e){return Cc(n,new wd(wx(),e))}function _H(n,e,t){const r=Nx(n,t);if(r){const i=Tx(r),o=i.path,a=i.queryId,s=dr(o,e),u=new wd(bx(a),s);return kx(n,o,u)}else return[]}function Qm(n,e,t,r,i=!1){const o=e._path,a=n.syncPointTree_.get(o);let s=[];if(a&&(e._queryIdentifier==="default"||uD(a,e))){const u=mH(a,e,t,r);fH(a)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const l=u.removed;if(s=u.events,!i){const c=l.findIndex(d=>d._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(o,(d,f)=>ps(f));if(c&&!h){const d=n.syncPointTree_.subtree(o);if(!d.isEmpty()){const f=SH(d);for(let m=0;m<f.length;++m){const v=f[m],y=v.query,g=fD(n,v);n.listenProvider_.startListening(Bh(y),bd(n,y),g.hashFn,g.onComplete)}}}!h&&l.length>0&&!r&&(c?n.listenProvider_.stopListening(Bh(e),null):l.forEach(d=>{const f=n.queryToTagMap.get(Qg(d));n.listenProvider_.stopListening(Bh(d),f)}))}IH(n,l)}return s}function cD(n,e,t,r){const i=Nx(n,r);if(i!=null){const o=Tx(i),a=o.path,s=o.queryId,u=dr(a,e),l=new Eu(bx(s),u,t);return kx(n,a,l)}else return[]}function EH(n,e,t,r){const i=Nx(n,r);if(i){const o=Tx(i),a=o.path,s=o.queryId,u=dr(a,e),l=Lt.fromObject(t),c=new xx(bx(s),u,l);return kx(n,a,c)}else return[]}function K1(n,e,t,r=!1){const i=e._path;let o=null,a=!1;n.syncPointTree_.foreachOnPath(i,(d,f)=>{const m=dr(d,i);o=o||rs(f,m),a=a||ps(f)});let s=n.syncPointTree_.get(i);s?(a=a||ps(s),o=o||rs(s,bt())):(s=new iD,n.syncPointTree_=n.syncPointTree_.set(i,s));let u;o!=null?u=!0:(u=!1,o=Le.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((f,m)=>{const v=rs(m,bt());v&&(o=o.updateImmediateChild(f,v))}));const l=uD(s,e);if(!l&&!e._queryParams.loadsAllData()){const d=Qg(e);de(!n.queryToTagMap.has(d),"View does not exist, but we have a tag");const f=NH();n.queryToTagMap.set(d,f),n.tagToQueryMap.set(f,d)}const c=Xg(n.pendingWriteTree_,i);let h=pH(s,e,t,c,o,u);if(!l&&!a&&!r){const d=sD(s,e);h=h.concat(TH(n,e,d))}return h}function Ix(n,e,t){const i=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(a,s)=>{const u=dr(a,e),l=rs(s,u);if(l)return l});return JA(i,e,o,t,!0)}function CH(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(l,c)=>{const h=dr(l,t);r=r||rs(c,h)});let i=n.syncPointTree_.get(t);i?r=r||rs(i,bt()):(i=new iD,n.syncPointTree_=n.syncPointTree_.set(t,i));const o=r!=null,a=o?new fs(r,!0,!1):null,s=Xg(n.pendingWriteTree_,e._path),u=oD(i,e,s,o?a.getNode():Le.EMPTY_NODE,o);return sH(u)}function Cc(n,e){return hD(e,n.syncPointTree_,null,Xg(n.pendingWriteTree_,bt()))}function hD(n,e,t,r){if(at(n.path))return dD(n,e,t,r);{const i=e.get(bt());t==null&&i!=null&&(t=rs(i,bt()));let o=[];const a=rt(n.path),s=n.operationForChild(a),u=e.children.get(a);if(u&&s){const l=t?t.getImmediateChild(a):null,c=ZA(r,a);o=o.concat(hD(s,u,l,c))}return i&&(o=o.concat(Sx(i,n,r,t))),o}}function dD(n,e,t,r){const i=e.get(bt());t==null&&i!=null&&(t=rs(i,bt()));let o=[];return e.children.inorderTraversal((a,s)=>{const u=t?t.getImmediateChild(a):null,l=ZA(r,a),c=n.operationForChild(a);c&&(o=o.concat(dD(c,s,u,l)))}),i&&(o=o.concat(Sx(i,n,r,t))),o}function fD(n,e){const t=e.query,r=bd(n,t);return{hashFn:()=>(aH(e)||Le.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?_H(n,t._path,r):xH(n,t._path);{const o=x6(i,t);return Qm(n,t,null,o)}}}}function bd(n,e){const t=Qg(e);return n.queryToTagMap.get(t)}function Qg(n){return n._path.toString()+"$"+n._queryIdentifier}function Nx(n,e){return n.tagToQueryMap.get(e)}function Tx(n){const e=n.indexOf("$");return de(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Dt(n.substr(0,e))}}function kx(n,e,t){const r=n.syncPointTree_.get(e);de(r,"Missing sync point for query tag that we're tracking");const i=Xg(n.pendingWriteTree_,e);return Sx(r,t,i,null)}function SH(n){return n.fold((e,t,r)=>{if(t&&ps(t))return[Yg(t)];{let i=[];return t&&(i=aD(t)),Jn(r,(o,a)=>{i=i.concat(a)}),i}})}function Bh(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(vH())(n._repo,n._path):n}function IH(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=Qg(r),o=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(o)}}}function NH(){return yH++}function TH(n,e,t){const r=e._path,i=bd(n,e),o=fD(n,t),a=n.listenProvider_.startListening(Bh(e),i,o.hashFn,o.onComplete),s=n.syncPointTree_.subtree(r);if(i)de(!ps(s.value),"If we're adding a query, it shouldn't be shadowed");else{const u=s.fold((l,c,h)=>{if(!at(l)&&c&&ps(c))return[Yg(c).query];{let d=[];return c&&(d=d.concat(aD(c).map(f=>f.query))),Jn(h,(f,m)=>{d=d.concat(m)}),d}});for(let l=0;l<u.length;++l){const c=u[l];n.listenProvider_.stopListening(Bh(c),bd(n,c))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rx{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Rx(t)}node(){return this.node_}}class Ax{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=ln(this.path_,e);return new Ax(this.syncTree_,t)}node(){return Ix(this.syncTree_,this.path_)}}const kH=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},xI=function(n,e,t){if(!n||typeof n!="object")return n;if(de(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return RH(n[".sv"],e,t);if(typeof n[".sv"]=="object")return AH(n[".sv"],e);de(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},RH=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:de(!1,"Unexpected server value: "+n)}},AH=function(n,e,t){n.hasOwnProperty("increment")||de(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&de(!1,"Unexpected increment value: "+r);const i=e.node();if(de(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const a=i.getValue();return typeof a!="number"?r:a+r},pD=function(n,e,t,r){return Dx(e,new Ax(t,n),r)},mD=function(n,e,t){return Dx(n,new Rx(e),t)};function Dx(n,e,t){const r=n.getPriority().val(),i=xI(r,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const a=n,s=xI(a.getValue(),e,t);return s!==a.getValue()||i!==a.getPriority().val()?new Pn(s,Rn(i)):n}else{const a=n;return o=a,i!==a.getPriority().val()&&(o=o.updatePriority(new Pn(i))),a.forEachChild(hn,(s,u)=>{const l=Dx(u,e.getImmediateChild(s),t);l!==u&&(o=o.updateImmediateChild(s,l))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function Px(n,e){let t=e instanceof Dt?e:new Dt(e),r=n,i=rt(t);for(;i!==null;){const o=Xl(r.node.children,i)||{children:{},childCount:0};r=new Ox(i,r,o),t=zt(t),i=rt(t)}return r}function Sc(n){return n.node.value}function gD(n,e){n.node.value=e,X1(n)}function vD(n){return n.node.childCount>0}function DH(n){return Sc(n)===void 0&&!vD(n)}function Jg(n,e){Jn(n.node.children,(t,r)=>{e(new Ox(t,n,r))})}function yD(n,e,t,r){t&&!r&&e(n),Jg(n,i=>{yD(i,e,!0,r)}),t&&r&&e(n)}function OH(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function nf(n){return new Dt(n.parent===null?n.name:nf(n.parent)+"/"+n.name)}function X1(n){n.parent!==null&&PH(n.parent,n.name,n)}function PH(n,e,t){const r=DH(t),i=go(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,X1(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,X1(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MH=/[\[\].#$\/\u0000-\u001F\u007F]/,LH=/[\[\].#$\u0000-\u001F\u007F]/,t0=10*1024*1024,Mx=function(n){return typeof n=="string"&&n.length!==0&&!MH.test(n)},wD=function(n){return typeof n=="string"&&n.length!==0&&!LH.test(n)},FH=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),wD(n)},zH=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!sx(n)||n&&typeof n=="object"&&go(n,".sv")},BH=function(n,e,t,r){Zg(Ug(n,"value"),e,t)},Zg=function(n,e,t){const r=t instanceof Dt?new t5(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Vs(r));if(typeof e=="function")throw new Error(n+"contains a function "+Vs(r)+" with contents = "+e.toString());if(sx(e))throw new Error(n+"contains "+e.toString()+" "+Vs(r));if(typeof e=="string"&&e.length>t0/3&&Wg(e)>t0)throw new Error(n+"contains a string greater than "+t0+" utf8 bytes "+Vs(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,o=!1;if(Jn(e,(a,s)=>{if(a===".value")i=!0;else if(a!==".priority"&&a!==".sv"&&(o=!0,!Mx(a)))throw new Error(n+" contains an invalid key ("+a+") "+Vs(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);n5(r,a),Zg(n,s,r),r5(r)}),i&&o)throw new Error(n+' contains ".value" child '+Vs(r)+" in addition to actual children.")}},jH=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const o=md(r);for(let a=0;a<o.length;a++)if(!(o[a]===".priority"&&a===o.length-1)){if(!Mx(o[a]))throw new Error(n+"contains an invalid key ("+o[a]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(e5);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&hi(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},UH=function(n,e,t,r){const i=Ug(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const o=[];Jn(e,(a,s)=>{const u=new Dt(a);if(Zg(i,s,ln(t,u)),dx(u)===".priority"&&!zH(s))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(u)}),jH(i,o)},bD=function(n,e,t,r){if(!wD(t))throw new Error(Ug(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},WH=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),bD(n,e,t)},VH=function(n,e){if(rt(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},$H=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Mx(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!FH(t))throw new Error(Ug(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HH{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ev(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],o=i.getPath();t!==null&&!fx(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(i)}t&&n.eventLists_.push(t)}function xD(n,e,t){ev(n,t),_D(n,r=>fx(r,e))}function mi(n,e,t){ev(n,t),_D(n,r=>hi(r,e)||hi(e,r))}function _D(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];if(i){const o=i.path;e(o)?(GH(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function GH(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();Mh&&qn("event: "+t.toString()),Ec(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qH="repo_interrupt",KH=25;class XH{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new HH,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Vm(),this.transactionQueueTree_=new Ox,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function YH(n,e,t){if(n.stats_=cx(n.repoInfo_),n.forceRestClient_||S6())n.server_=new Wm(n.repoInfo_,(r,i,o,a)=>{_I(n,r,i,o,a)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>EI(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{An(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Ho(n.repoInfo_,e,(r,i,o,a)=>{_I(n,r,i,o,a)},r=>{EI(n,r)},r=>{JH(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=R6(n.repoInfo_,()=>new k5(n.stats_,n.server_)),n.infoData_=new C5,n.infoSyncTree_=new bI({startListening:(r,i,o,a)=>{let s=[];const u=n.infoData_.getNode(r._path);return u.isEmpty()||(s=tf(n.infoSyncTree_,r._path,u),setTimeout(()=>{a("ok")},0)),s},stopListening:()=>{}}),Lx(n,"connected",!1),n.serverSyncTree_=new bI({startListening:(r,i,o,a)=>(n.server_.listen(r,o,i,(s,u)=>{const l=a(s,u);mi(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function QH(n){const t=n.infoData_.getNode(new Dt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function tv(n){return kH({timestamp:QH(n)})}function _I(n,e,t,r,i){n.dataUpdateCount++;const o=new Dt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let a=[];if(i)if(r){const u=Am(t,l=>Rn(l));a=EH(n.serverSyncTree_,o,u,i)}else{const u=Rn(t);a=cD(n.serverSyncTree_,o,u,i)}else if(r){const u=Am(t,l=>Rn(l));a=bH(n.serverSyncTree_,o,u)}else{const u=Rn(t);a=tf(n.serverSyncTree_,o,u)}let s=o;a.length>0&&(s=Zl(n,o)),mi(n.eventQueue_,s,a)}function EI(n,e){Lx(n,"connected",e),e===!1&&n9(n)}function JH(n,e){Jn(e,(t,r)=>{Lx(n,t,r)})}function Lx(n,e,t){const r=new Dt("/.info/"+e),i=Rn(t);n.infoData_.updateSnapshot(r,i);const o=tf(n.infoSyncTree_,r,i);mi(n.eventQueue_,r,o)}function Fx(n){return n.nextWriteId_++}function ZH(n,e,t){const r=CH(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{const o=Rn(i).withIndex(e._queryParams.getIndex());K1(n.serverSyncTree_,e,t,!0);let a;if(e._queryParams.loadsAllData())a=tf(n.serverSyncTree_,e._path,o);else{const s=bd(n.serverSyncTree_,e);a=cD(n.serverSyncTree_,e._path,o,s)}return mi(n.eventQueue_,e._path,a),Qm(n.serverSyncTree_,e,t,null,!0),o},i=>(rf(n,"get for query "+An(e)+" failed: "+i),Promise.reject(new Error(i))))}function e9(n,e,t,r,i){rf(n,"set",{path:e.toString(),value:t,priority:r});const o=tv(n),a=Rn(t,r),s=Ix(n.serverSyncTree_,e),u=mD(a,s,o),l=Fx(n),c=lD(n.serverSyncTree_,e,u,l,!0);ev(n.eventQueue_,c),n.server_.put(e.toString(),a.val(!0),(d,f)=>{const m=d==="ok";m||pr("set at "+e+" failed: "+d);const v=Wa(n.serverSyncTree_,l,!m);mi(n.eventQueue_,e,v),Y1(n,i,d,f)});const h=Bx(n,e);Zl(n,h),mi(n.eventQueue_,h,[])}function t9(n,e,t,r){rf(n,"update",{path:e.toString(),value:t});let i=!0;const o=tv(n),a={};if(Jn(t,(s,u)=>{i=!1,a[s]=pD(ln(e,s),Rn(u),n.serverSyncTree_,o)}),i)qn("update() called with empty data.  Don't do anything."),Y1(n,r,"ok",void 0);else{const s=Fx(n),u=wH(n.serverSyncTree_,e,a,s);ev(n.eventQueue_,u),n.server_.merge(e.toString(),t,(l,c)=>{const h=l==="ok";h||pr("update at "+e+" failed: "+l);const d=Wa(n.serverSyncTree_,s,!h),f=d.length>0?Zl(n,e):e;mi(n.eventQueue_,f,d),Y1(n,r,l,c)}),Jn(t,l=>{const c=Bx(n,ln(e,l));Zl(n,c)}),mi(n.eventQueue_,e,[])}}function n9(n){rf(n,"onDisconnectEvents");const e=tv(n),t=Vm();U1(n.onDisconnect_,bt(),(i,o)=>{const a=pD(i,o,n.serverSyncTree_,e);KA(t,i,a)});let r=[];U1(t,bt(),(i,o)=>{r=r.concat(tf(n.serverSyncTree_,i,o));const a=Bx(n,i);Zl(n,a)}),n.onDisconnect_=Vm(),mi(n.eventQueue_,bt(),r)}function r9(n,e,t){let r;rt(e._path)===".info"?r=K1(n.infoSyncTree_,e,t):r=K1(n.serverSyncTree_,e,t),xD(n.eventQueue_,e._path,r)}function i9(n,e,t){let r;rt(e._path)===".info"?r=Qm(n.infoSyncTree_,e,t):r=Qm(n.serverSyncTree_,e,t),xD(n.eventQueue_,e._path,r)}function o9(n){n.persistentConnection_&&n.persistentConnection_.interrupt(qH)}function rf(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),qn(t,...e)}function Y1(n,e,t,r){e&&Ec(()=>{if(t==="ok")e(null);else{const i=(t||"error").toUpperCase();let o=i;r&&(o+=": "+r);const a=new Error(o);a.code=i,e(a)}})}function ED(n,e,t){return Ix(n.serverSyncTree_,e,t)||Le.EMPTY_NODE}function zx(n,e=n.transactionQueueTree_){if(e||nv(n,e),Sc(e)){const t=SD(n,e);de(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&a9(n,nf(e),t)}else vD(e)&&Jg(e,t=>{zx(n,t)})}function a9(n,e,t){const r=t.map(l=>l.currentWriteId),i=ED(n,e,r);let o=i;const a=i.hash();for(let l=0;l<t.length;l++){const c=t[l];de(c.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;const h=dr(e,c.path);o=o.updateChild(h,c.currentOutputSnapshotRaw)}const s=o.val(!0),u=e;n.server_.put(u.toString(),s,l=>{rf(n,"transaction put response",{path:u.toString(),status:l});let c=[];if(l==="ok"){const h=[];for(let d=0;d<t.length;d++)t[d].status=2,c=c.concat(Wa(n.serverSyncTree_,t[d].currentWriteId)),t[d].onComplete&&h.push(()=>t[d].onComplete(null,!0,t[d].currentOutputSnapshotResolved)),t[d].unwatcher();nv(n,Px(n.transactionQueueTree_,e)),zx(n,n.transactionQueueTree_),mi(n.eventQueue_,e,c);for(let d=0;d<h.length;d++)Ec(h[d])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{pr("transaction at "+u.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}Zl(n,e)}},a)}function Zl(n,e){const t=CD(n,e),r=nf(t),i=SD(n,t);return s9(n,i,r),r}function s9(n,e,t){if(e.length===0)return;const r=[];let i=[];const a=e.filter(s=>s.status===0).map(s=>s.currentWriteId);for(let s=0;s<e.length;s++){const u=e[s],l=dr(t,u.path);let c=!1,h;if(de(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)c=!0,h=u.abortReason,i=i.concat(Wa(n.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=KH)c=!0,h="maxretry",i=i.concat(Wa(n.serverSyncTree_,u.currentWriteId,!0));else{const d=ED(n,u.path,a);u.currentInputSnapshot=d;const f=e[s].update(d.val());if(f!==void 0){Zg("transaction failed: Data returned ",f,u.path);let m=Rn(f);typeof f=="object"&&f!=null&&go(f,".priority")||(m=m.updatePriority(d.getPriority()));const y=u.currentWriteId,g=tv(n),w=mD(m,d,g);u.currentOutputSnapshotRaw=m,u.currentOutputSnapshotResolved=w,u.currentWriteId=Fx(n),a.splice(a.indexOf(y),1),i=i.concat(lD(n.serverSyncTree_,u.path,w,u.currentWriteId,u.applyLocally)),i=i.concat(Wa(n.serverSyncTree_,y,!0))}else c=!0,h="nodata",i=i.concat(Wa(n.serverSyncTree_,u.currentWriteId,!0))}mi(n.eventQueue_,t,i),i=[],c&&(e[s].status=2,function(d){setTimeout(d,Math.floor(0))}(e[s].unwatcher),e[s].onComplete&&(h==="nodata"?r.push(()=>e[s].onComplete(null,!1,e[s].currentInputSnapshot)):r.push(()=>e[s].onComplete(new Error(h),!1,null))))}nv(n,n.transactionQueueTree_);for(let s=0;s<r.length;s++)Ec(r[s]);zx(n,n.transactionQueueTree_)}function CD(n,e){let t,r=n.transactionQueueTree_;for(t=rt(e);t!==null&&Sc(r)===void 0;)r=Px(r,t),e=zt(e),t=rt(e);return r}function SD(n,e){const t=[];return ID(n,e,t),t.sort((r,i)=>r.order-i.order),t}function ID(n,e,t){const r=Sc(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Jg(e,i=>{ID(n,i,t)})}function nv(n,e){const t=Sc(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,gD(e,t.length>0?t:void 0)}Jg(e,r=>{nv(n,r)})}function Bx(n,e){const t=nf(CD(n,e)),r=Px(n.transactionQueueTree_,e);return OH(r,i=>{n0(n,i)}),n0(n,r),yD(r,i=>{n0(n,i)}),t}function n0(n,e){const t=Sc(e);if(t){const r=[];let i=[],o=-1;for(let a=0;a<t.length;a++)t[a].status===3||(t[a].status===1?(de(o===a-1,"All SENT items should be at beginning of queue."),o=a,t[a].status=3,t[a].abortReason="set"):(de(t[a].status===0,"Unexpected transaction status in abort"),t[a].unwatcher(),i=i.concat(Wa(n.serverSyncTree_,t[a].currentWriteId,!0)),t[a].onComplete&&r.push(t[a].onComplete.bind(null,new Error("set"),!1,null))));o===-1?gD(e,void 0):t.length=o+1,mi(n.eventQueue_,nf(e),i);for(let a=0;a<r.length;a++)Ec(r[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u9(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function l9(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):pr(`Invalid query segment '${t}' in query '${n}'`)}return e}const CI=function(n,e){const t=c9(n),r=t.namespace;t.domain==="firebase.com"&&na(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&na("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||g6();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new AA(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Dt(t.pathString)}},c9=function(n){let e="",t="",r="",i="",o="",a=!0,s="https",u=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(s=n.substring(0,l-1),n=n.substring(l+2));let c=n.indexOf("/");c===-1&&(c=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(c,h)),c<h&&(i=u9(n.substring(c,h)));const d=l9(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(a=s==="https"||s==="wss",u=parseInt(e.substring(l+1),10)):l=e.length;const f=e.slice(0,l);if(f.toLowerCase()==="localhost")t="localhost";else if(f.split(".").length<=2)t=f;else{const m=e.indexOf(".");r=e.substring(0,m).toLowerCase(),t=e.substring(m+1),o=r}"ns"in d&&(o=d.ns)}return{host:e,port:u,domain:t,subdomain:r,secure:a,scheme:s,pathString:i,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h9{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+An(this.snapshot.exportVal())}}class d9{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return de(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return at(this._path)?null:dx(this._path)}get ref(){return new la(this._repo,this._path)}get _queryIdentifier(){const e=cI(this._queryParams),t=ux(e);return t==="{}"?"default":t}get _queryObject(){return cI(this._queryParams)}isEqual(e){if(e=xr(e),!(e instanceof jx))return!1;const t=this._repo===e._repo,r=fx(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+Z6(this._path)}}class la extends jx{constructor(e,t){super(e,t,new vx,!1)}get parent(){const e=jA(this._path);return e===null?null:new la(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class xd{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Dt(e),r=Q1(this.ref,e);return new xd(this._node.getChild(t),r,hn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new xd(i,Q1(this.ref,r),hn)))}hasChild(e){const t=new Dt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ec(n,e){return n=xr(n),n._checkNotDeleted("ref"),e!==void 0?Q1(n._root,e):n._root}function Q1(n,e){return n=xr(n),rt(n._path)===null?WH("child","path",e):bD("child","path",e),new la(n._repo,ln(n._path,e))}function SI(n,e){n=xr(n),VH("set",n._path),BH("set",e,n._path);const t=new Hd;return e9(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function f9(n,e){UH("update",e,n._path);const t=new Hd;return t9(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function TD(n){n=xr(n);const e=new ND(()=>{}),t=new rv(e);return ZH(n._repo,n,t).then(r=>new xd(r,new la(n._repo,n._path),n._queryParams.getIndex()))}class rv{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new h9("value",this,new xd(e.snapshotNode,new la(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new d9(this,e,t):null}matches(e){return e instanceof rv?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function p9(n,e,t,r,i){const o=new ND(t,void 0),a=new rv(o);return r9(n._repo,n,a),()=>i9(n._repo,n,a)}function kD(n,e,t,r){return p9(n,"value",e)}hH(la);gH(la);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m9="FIREBASE_DATABASE_EMULATOR_HOST",J1={};let g9=!1;function v9(n,e,t,r){n.repoInfo_=new AA(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function y9(n,e,t,r,i){let o=r||n.options.databaseURL;o===void 0&&(n.options.projectId||na("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),qn("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let a=CI(o,i),s=a.repoInfo,u;typeof process<"u"&&G2&&(u=G2[m9]),u?(o=`http://${u}?ns=${s.namespace}`,a=CI(o,i),s=a.repoInfo):a.repoInfo.secure;const l=new N6(n.name,n.options,e);$H("Invalid Firebase Database URL",a),at(a.path)||na("Database URL must point to the root of a Firebase Database (not including a child path).");const c=b9(s,n,l,new I6(n.name,t));return new x9(c,n)}function w9(n,e){const t=J1[e];(!t||t[n.key]!==n)&&na(`Database ${e}(${n.repoInfo_}) has already been deleted.`),o9(n),delete t[n.key]}function b9(n,e,t,r){let i=J1[e.name];i||(i={},J1[e.name]=i);let o=i[n.toURLString()];return o&&na("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new XH(n,g9,t,r),i[n.toURLString()]=o,o}class x9{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(YH(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new la(this._repo,bt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(w9(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&na("Cannot call "+e+" on a deleted database.")}}function RD(n=OR(),e){const t=Qb(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=IU("database");r&&_9(t,...r)}return t}function _9(n,e,t,r={}){n=xr(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&na("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&na('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Hp(Hp.OWNER);else if(r.mockUserToken){const a=typeof r.mockUserToken=="string"?r.mockUserToken:NU(r.mockUserToken,n.app.options.projectId);o=new Hp(a)}v9(i,e,t,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E9(n){c6(Mu),wu(new hs("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return y9(r,i,o,t)},"PUBLIC").setMultipleInstances(!0)),so(q2,K2,n),so(q2,K2,"esm2017")}Ho.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Ho.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};E9();var II=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var AD;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,x){function C(){}C.prototype=x.prototype,_.D=x.prototype,_.prototype=new C,_.prototype.constructor=_,_.C=function(N,R,k){for(var D=Array(arguments.length-2),W=2;W<arguments.length;W++)D[W-2]=arguments[W];return x.prototype[R].apply(N,D)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(_,x,C){C||(C=0);var N=Array(16);if(typeof x=="string")for(var R=0;16>R;++R)N[R]=x.charCodeAt(C++)|x.charCodeAt(C++)<<8|x.charCodeAt(C++)<<16|x.charCodeAt(C++)<<24;else for(R=0;16>R;++R)N[R]=x[C++]|x[C++]<<8|x[C++]<<16|x[C++]<<24;x=_.g[0],C=_.g[1],R=_.g[2];var k=_.g[3],D=x+(k^C&(R^k))+N[0]+3614090360&4294967295;x=C+(D<<7&4294967295|D>>>25),D=k+(R^x&(C^R))+N[1]+3905402710&4294967295,k=x+(D<<12&4294967295|D>>>20),D=R+(C^k&(x^C))+N[2]+606105819&4294967295,R=k+(D<<17&4294967295|D>>>15),D=C+(x^R&(k^x))+N[3]+3250441966&4294967295,C=R+(D<<22&4294967295|D>>>10),D=x+(k^C&(R^k))+N[4]+4118548399&4294967295,x=C+(D<<7&4294967295|D>>>25),D=k+(R^x&(C^R))+N[5]+1200080426&4294967295,k=x+(D<<12&4294967295|D>>>20),D=R+(C^k&(x^C))+N[6]+2821735955&4294967295,R=k+(D<<17&4294967295|D>>>15),D=C+(x^R&(k^x))+N[7]+4249261313&4294967295,C=R+(D<<22&4294967295|D>>>10),D=x+(k^C&(R^k))+N[8]+1770035416&4294967295,x=C+(D<<7&4294967295|D>>>25),D=k+(R^x&(C^R))+N[9]+2336552879&4294967295,k=x+(D<<12&4294967295|D>>>20),D=R+(C^k&(x^C))+N[10]+4294925233&4294967295,R=k+(D<<17&4294967295|D>>>15),D=C+(x^R&(k^x))+N[11]+2304563134&4294967295,C=R+(D<<22&4294967295|D>>>10),D=x+(k^C&(R^k))+N[12]+1804603682&4294967295,x=C+(D<<7&4294967295|D>>>25),D=k+(R^x&(C^R))+N[13]+4254626195&4294967295,k=x+(D<<12&4294967295|D>>>20),D=R+(C^k&(x^C))+N[14]+2792965006&4294967295,R=k+(D<<17&4294967295|D>>>15),D=C+(x^R&(k^x))+N[15]+1236535329&4294967295,C=R+(D<<22&4294967295|D>>>10),D=x+(R^k&(C^R))+N[1]+4129170786&4294967295,x=C+(D<<5&4294967295|D>>>27),D=k+(C^R&(x^C))+N[6]+3225465664&4294967295,k=x+(D<<9&4294967295|D>>>23),D=R+(x^C&(k^x))+N[11]+643717713&4294967295,R=k+(D<<14&4294967295|D>>>18),D=C+(k^x&(R^k))+N[0]+3921069994&4294967295,C=R+(D<<20&4294967295|D>>>12),D=x+(R^k&(C^R))+N[5]+3593408605&4294967295,x=C+(D<<5&4294967295|D>>>27),D=k+(C^R&(x^C))+N[10]+38016083&4294967295,k=x+(D<<9&4294967295|D>>>23),D=R+(x^C&(k^x))+N[15]+3634488961&4294967295,R=k+(D<<14&4294967295|D>>>18),D=C+(k^x&(R^k))+N[4]+3889429448&4294967295,C=R+(D<<20&4294967295|D>>>12),D=x+(R^k&(C^R))+N[9]+568446438&4294967295,x=C+(D<<5&4294967295|D>>>27),D=k+(C^R&(x^C))+N[14]+3275163606&4294967295,k=x+(D<<9&4294967295|D>>>23),D=R+(x^C&(k^x))+N[3]+4107603335&4294967295,R=k+(D<<14&4294967295|D>>>18),D=C+(k^x&(R^k))+N[8]+1163531501&4294967295,C=R+(D<<20&4294967295|D>>>12),D=x+(R^k&(C^R))+N[13]+2850285829&4294967295,x=C+(D<<5&4294967295|D>>>27),D=k+(C^R&(x^C))+N[2]+4243563512&4294967295,k=x+(D<<9&4294967295|D>>>23),D=R+(x^C&(k^x))+N[7]+1735328473&4294967295,R=k+(D<<14&4294967295|D>>>18),D=C+(k^x&(R^k))+N[12]+2368359562&4294967295,C=R+(D<<20&4294967295|D>>>12),D=x+(C^R^k)+N[5]+4294588738&4294967295,x=C+(D<<4&4294967295|D>>>28),D=k+(x^C^R)+N[8]+2272392833&4294967295,k=x+(D<<11&4294967295|D>>>21),D=R+(k^x^C)+N[11]+1839030562&4294967295,R=k+(D<<16&4294967295|D>>>16),D=C+(R^k^x)+N[14]+4259657740&4294967295,C=R+(D<<23&4294967295|D>>>9),D=x+(C^R^k)+N[1]+2763975236&4294967295,x=C+(D<<4&4294967295|D>>>28),D=k+(x^C^R)+N[4]+1272893353&4294967295,k=x+(D<<11&4294967295|D>>>21),D=R+(k^x^C)+N[7]+4139469664&4294967295,R=k+(D<<16&4294967295|D>>>16),D=C+(R^k^x)+N[10]+3200236656&4294967295,C=R+(D<<23&4294967295|D>>>9),D=x+(C^R^k)+N[13]+681279174&4294967295,x=C+(D<<4&4294967295|D>>>28),D=k+(x^C^R)+N[0]+3936430074&4294967295,k=x+(D<<11&4294967295|D>>>21),D=R+(k^x^C)+N[3]+3572445317&4294967295,R=k+(D<<16&4294967295|D>>>16),D=C+(R^k^x)+N[6]+76029189&4294967295,C=R+(D<<23&4294967295|D>>>9),D=x+(C^R^k)+N[9]+3654602809&4294967295,x=C+(D<<4&4294967295|D>>>28),D=k+(x^C^R)+N[12]+3873151461&4294967295,k=x+(D<<11&4294967295|D>>>21),D=R+(k^x^C)+N[15]+530742520&4294967295,R=k+(D<<16&4294967295|D>>>16),D=C+(R^k^x)+N[2]+3299628645&4294967295,C=R+(D<<23&4294967295|D>>>9),D=x+(R^(C|~k))+N[0]+4096336452&4294967295,x=C+(D<<6&4294967295|D>>>26),D=k+(C^(x|~R))+N[7]+1126891415&4294967295,k=x+(D<<10&4294967295|D>>>22),D=R+(x^(k|~C))+N[14]+2878612391&4294967295,R=k+(D<<15&4294967295|D>>>17),D=C+(k^(R|~x))+N[5]+4237533241&4294967295,C=R+(D<<21&4294967295|D>>>11),D=x+(R^(C|~k))+N[12]+1700485571&4294967295,x=C+(D<<6&4294967295|D>>>26),D=k+(C^(x|~R))+N[3]+2399980690&4294967295,k=x+(D<<10&4294967295|D>>>22),D=R+(x^(k|~C))+N[10]+4293915773&4294967295,R=k+(D<<15&4294967295|D>>>17),D=C+(k^(R|~x))+N[1]+2240044497&4294967295,C=R+(D<<21&4294967295|D>>>11),D=x+(R^(C|~k))+N[8]+1873313359&4294967295,x=C+(D<<6&4294967295|D>>>26),D=k+(C^(x|~R))+N[15]+4264355552&4294967295,k=x+(D<<10&4294967295|D>>>22),D=R+(x^(k|~C))+N[6]+2734768916&4294967295,R=k+(D<<15&4294967295|D>>>17),D=C+(k^(R|~x))+N[13]+1309151649&4294967295,C=R+(D<<21&4294967295|D>>>11),D=x+(R^(C|~k))+N[4]+4149444226&4294967295,x=C+(D<<6&4294967295|D>>>26),D=k+(C^(x|~R))+N[11]+3174756917&4294967295,k=x+(D<<10&4294967295|D>>>22),D=R+(x^(k|~C))+N[2]+718787259&4294967295,R=k+(D<<15&4294967295|D>>>17),D=C+(k^(R|~x))+N[9]+3951481745&4294967295,_.g[0]=_.g[0]+x&4294967295,_.g[1]=_.g[1]+(R+(D<<21&4294967295|D>>>11))&4294967295,_.g[2]=_.g[2]+R&4294967295,_.g[3]=_.g[3]+k&4294967295}r.prototype.u=function(_,x){x===void 0&&(x=_.length);for(var C=x-this.blockSize,N=this.B,R=this.h,k=0;k<x;){if(R==0)for(;k<=C;)i(this,_,k),k+=this.blockSize;if(typeof _=="string"){for(;k<x;)if(N[R++]=_.charCodeAt(k++),R==this.blockSize){i(this,N),R=0;break}}else for(;k<x;)if(N[R++]=_[k++],R==this.blockSize){i(this,N),R=0;break}}this.h=R,this.o+=x},r.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var x=1;x<_.length-8;++x)_[x]=0;var C=8*this.o;for(x=_.length-8;x<_.length;++x)_[x]=C&255,C/=256;for(this.u(_),_=Array(16),x=C=0;4>x;++x)for(var N=0;32>N;N+=8)_[C++]=this.g[x]>>>N&255;return _};function o(_,x){var C=s;return Object.prototype.hasOwnProperty.call(C,_)?C[_]:C[_]=x(_)}function a(_,x){this.h=x;for(var C=[],N=!0,R=_.length-1;0<=R;R--){var k=_[R]|0;N&&k==x||(C[R]=k,N=!1)}this.g=C}var s={};function u(_){return-128<=_&&128>_?o(_,function(x){return new a([x|0],0>x?-1:0)}):new a([_|0],0>_?-1:0)}function l(_){if(isNaN(_)||!isFinite(_))return h;if(0>_)return y(l(-_));for(var x=[],C=1,N=0;_>=C;N++)x[N]=_/C|0,C*=4294967296;return new a(x,0)}function c(_,x){if(_.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(_.charAt(0)=="-")return y(c(_.substring(1),x));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=l(Math.pow(x,8)),N=h,R=0;R<_.length;R+=8){var k=Math.min(8,_.length-R),D=parseInt(_.substring(R,R+k),x);8>k?(k=l(Math.pow(x,k)),N=N.j(k).add(l(D))):(N=N.j(C),N=N.add(l(D)))}return N}var h=u(0),d=u(1),f=u(16777216);n=a.prototype,n.m=function(){if(v(this))return-y(this).m();for(var _=0,x=1,C=0;C<this.g.length;C++){var N=this.i(C);_+=(0<=N?N:4294967296+N)*x,x*=4294967296}return _},n.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(m(this))return"0";if(v(this))return"-"+y(this).toString(_);for(var x=l(Math.pow(_,6)),C=this,N="";;){var R=S(C,x).g;C=g(C,R.j(x));var k=((0<C.g.length?C.g[0]:C.h)>>>0).toString(_);if(C=R,m(C))return k+N;for(;6>k.length;)k="0"+k;N=k+N}},n.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function m(_){if(_.h!=0)return!1;for(var x=0;x<_.g.length;x++)if(_.g[x]!=0)return!1;return!0}function v(_){return _.h==-1}n.l=function(_){return _=g(this,_),v(_)?-1:m(_)?0:1};function y(_){for(var x=_.g.length,C=[],N=0;N<x;N++)C[N]=~_.g[N];return new a(C,~_.h).add(d)}n.abs=function(){return v(this)?y(this):this},n.add=function(_){for(var x=Math.max(this.g.length,_.g.length),C=[],N=0,R=0;R<=x;R++){var k=N+(this.i(R)&65535)+(_.i(R)&65535),D=(k>>>16)+(this.i(R)>>>16)+(_.i(R)>>>16);N=D>>>16,k&=65535,D&=65535,C[R]=D<<16|k}return new a(C,C[C.length-1]&-2147483648?-1:0)};function g(_,x){return _.add(y(x))}n.j=function(_){if(m(this)||m(_))return h;if(v(this))return v(_)?y(this).j(y(_)):y(y(this).j(_));if(v(_))return y(this.j(y(_)));if(0>this.l(f)&&0>_.l(f))return l(this.m()*_.m());for(var x=this.g.length+_.g.length,C=[],N=0;N<2*x;N++)C[N]=0;for(N=0;N<this.g.length;N++)for(var R=0;R<_.g.length;R++){var k=this.i(N)>>>16,D=this.i(N)&65535,W=_.i(R)>>>16,U=_.i(R)&65535;C[2*N+2*R]+=D*U,w(C,2*N+2*R),C[2*N+2*R+1]+=k*U,w(C,2*N+2*R+1),C[2*N+2*R+1]+=D*W,w(C,2*N+2*R+1),C[2*N+2*R+2]+=k*W,w(C,2*N+2*R+2)}for(N=0;N<x;N++)C[N]=C[2*N+1]<<16|C[2*N];for(N=x;N<2*x;N++)C[N]=0;return new a(C,0)};function w(_,x){for(;(_[x]&65535)!=_[x];)_[x+1]+=_[x]>>>16,_[x]&=65535,x++}function b(_,x){this.g=_,this.h=x}function S(_,x){if(m(x))throw Error("division by zero");if(m(_))return new b(h,h);if(v(_))return x=S(y(_),x),new b(y(x.g),y(x.h));if(v(x))return x=S(_,y(x)),new b(y(x.g),x.h);if(30<_.g.length){if(v(_)||v(x))throw Error("slowDivide_ only works with positive integers.");for(var C=d,N=x;0>=N.l(_);)C=E(C),N=E(N);var R=T(C,1),k=T(N,1);for(N=T(N,2),C=T(C,2);!m(N);){var D=k.add(N);0>=D.l(_)&&(R=R.add(C),k=D),N=T(N,1),C=T(C,1)}return x=g(_,R.j(x)),new b(R,x)}for(R=h;0<=_.l(x);){for(C=Math.max(1,Math.floor(_.m()/x.m())),N=Math.ceil(Math.log(C)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),k=l(C),D=k.j(x);v(D)||0<D.l(_);)C-=N,k=l(C),D=k.j(x);m(k)&&(k=d),R=R.add(k),_=g(_,D)}return new b(R,_)}n.A=function(_){return S(this,_).h},n.and=function(_){for(var x=Math.max(this.g.length,_.g.length),C=[],N=0;N<x;N++)C[N]=this.i(N)&_.i(N);return new a(C,this.h&_.h)},n.or=function(_){for(var x=Math.max(this.g.length,_.g.length),C=[],N=0;N<x;N++)C[N]=this.i(N)|_.i(N);return new a(C,this.h|_.h)},n.xor=function(_){for(var x=Math.max(this.g.length,_.g.length),C=[],N=0;N<x;N++)C[N]=this.i(N)^_.i(N);return new a(C,this.h^_.h)};function E(_){for(var x=_.g.length+1,C=[],N=0;N<x;N++)C[N]=_.i(N)<<1|_.i(N-1)>>>31;return new a(C,_.h)}function T(_,x){var C=x>>5;x%=32;for(var N=_.g.length-C,R=[],k=0;k<N;k++)R[k]=0<x?_.i(k+C)>>>x|_.i(k+C+1)<<32-x:_.i(k+C);return new a(R,_.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=c,AD=a}).apply(typeof II<"u"?II:typeof self<"u"?self:typeof window<"u"?window:{});var hp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,I,A){return p==Array.prototype||p==Object.prototype||(p[I]=A.value),p};function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof hp=="object"&&hp];for(var I=0;I<p.length;++I){var A=p[I];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var r=t(this);function i(p,I){if(I)e:{var A=r;p=p.split(".");for(var M=0;M<p.length-1;M++){var J=p[M];if(!(J in A))break e;A=A[J]}p=p[p.length-1],M=A[p],I=I(M),I!=M&&I!=null&&e(A,p,{configurable:!0,writable:!0,value:I})}}function o(p,I){p instanceof String&&(p+="");var A=0,M=!1,J={next:function(){if(!M&&A<p.length){var ie=A++;return{value:I(ie,p[ie]),done:!1}}return M=!0,{done:!0,value:void 0}}};return J[Symbol.iterator]=function(){return J},J}i("Array.prototype.values",function(p){return p||function(){return o(this,function(I,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},s=this||self;function u(p){var I=typeof p;return I=I!="object"?I:p?Array.isArray(p)?"array":I:"null",I=="array"||I=="object"&&typeof p.length=="number"}function l(p){var I=typeof p;return I=="object"&&p!=null||I=="function"}function c(p,I,A){return p.call.apply(p.bind,arguments)}function h(p,I,A){if(!p)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var J=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(J,M),p.apply(I,J)}}return function(){return p.apply(I,arguments)}}function d(p,I,A){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?c:h,d.apply(null,arguments)}function f(p,I){var A=Array.prototype.slice.call(arguments,1);return function(){var M=A.slice();return M.push.apply(M,arguments),p.apply(this,M)}}function m(p,I){function A(){}A.prototype=I.prototype,p.aa=I.prototype,p.prototype=new A,p.prototype.constructor=p,p.Qb=function(M,J,ie){for(var ge=Array(arguments.length-2),Pt=2;Pt<arguments.length;Pt++)ge[Pt-2]=arguments[Pt];return I.prototype[J].apply(M,ge)}}function v(p){const I=p.length;if(0<I){const A=Array(I);for(let M=0;M<I;M++)A[M]=p[M];return A}return[]}function y(p,I){for(let A=1;A<arguments.length;A++){const M=arguments[A];if(u(M)){const J=p.length||0,ie=M.length||0;p.length=J+ie;for(let ge=0;ge<ie;ge++)p[J+ge]=M[ge]}else p.push(M)}}class g{constructor(I,A){this.i=I,this.j=A,this.h=0,this.g=null}get(){let I;return 0<this.h?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function w(p){return/^[\s\xa0]*$/.test(p)}function b(){var p=s.navigator;return p&&(p=p.userAgent)?p:""}function S(p){return S[" "](p),p}S[" "]=function(){};var E=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function T(p,I,A){for(const M in p)I.call(A,p[M],M,p)}function _(p,I){for(const A in p)I.call(void 0,p[A],A,p)}function x(p){const I={};for(const A in p)I[A]=p[A];return I}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(p,I){let A,M;for(let J=1;J<arguments.length;J++){M=arguments[J];for(A in M)p[A]=M[A];for(let ie=0;ie<C.length;ie++)A=C[ie],Object.prototype.hasOwnProperty.call(M,A)&&(p[A]=M[A])}}function R(p){var I=1;p=p.split(":");const A=[];for(;0<I&&p.length;)A.push(p.shift()),I--;return p.length&&A.push(p.join(":")),A}function k(p){s.setTimeout(()=>{throw p},0)}function D(){var p=q;let I=null;return p.g&&(I=p.g,p.g=p.g.next,p.g||(p.h=null),I.next=null),I}class W{constructor(){this.h=this.g=null}add(I,A){const M=U.get();M.set(I,A),this.h?this.h.next=M:this.g=M,this.h=M}}var U=new g(()=>new j,p=>p.reset());class j{constructor(){this.next=this.g=this.h=null}set(I,A){this.h=I,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let H,z=!1,q=new W,F=()=>{const p=s.Promise.resolve(void 0);H=()=>{p.then(oe)}};var oe=()=>{for(var p;p=D();){try{p.h.call(p.g)}catch(A){k(A)}var I=U;I.j(p),100>I.h&&(I.h++,p.next=I.g,I.g=p)}z=!1};function Q(){this.s=this.s,this.C=this.C}Q.prototype.s=!1,Q.prototype.ma=function(){this.s||(this.s=!0,this.N())},Q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ae(p,I){this.type=p,this.g=this.target=I,this.defaultPrevented=!1}ae.prototype.h=function(){this.defaultPrevented=!0};var me=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var p=!1,I=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const A=()=>{};s.addEventListener("test",A,I),s.removeEventListener("test",A,I)}catch{}return p}();function fe(p,I){if(ae.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var A=this.type=p.type,M=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=I,I=p.relatedTarget){if(E){e:{try{S(I.nodeName);var J=!0;break e}catch{}J=!1}J||(I=null)}}else A=="mouseover"?I=p.fromElement:A=="mouseout"&&(I=p.toElement);this.relatedTarget=I,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:pe[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&fe.aa.h.call(this)}}m(fe,ae);var pe={2:"touch",3:"pen",4:"mouse"};fe.prototype.h=function(){fe.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Ce="closure_listenable_"+(1e6*Math.random()|0),Me=0;function Te(p,I,A,M,J){this.listener=p,this.proxy=null,this.src=I,this.type=A,this.capture=!!M,this.ha=J,this.key=++Me,this.da=this.fa=!1}function Ke(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Fe(p){this.src=p,this.g={},this.h=0}Fe.prototype.add=function(p,I,A,M,J){var ie=p.toString();p=this.g[ie],p||(p=this.g[ie]=[],this.h++);var ge=ze(p,I,M,J);return-1<ge?(I=p[ge],A||(I.fa=!1)):(I=new Te(I,this.src,ie,!!M,J),I.fa=A,p.push(I)),I};function Xe(p,I){var A=I.type;if(A in p.g){var M=p.g[A],J=Array.prototype.indexOf.call(M,I,void 0),ie;(ie=0<=J)&&Array.prototype.splice.call(M,J,1),ie&&(Ke(I),p.g[A].length==0&&(delete p.g[A],p.h--))}}function ze(p,I,A,M){for(var J=0;J<p.length;++J){var ie=p[J];if(!ie.da&&ie.listener==I&&ie.capture==!!A&&ie.ha==M)return J}return-1}var Be="closure_lm_"+(1e6*Math.random()|0),dt={};function nt(p,I,A,M,J){if(Array.isArray(I)){for(var ie=0;ie<I.length;ie++)nt(p,I[ie],A,M,J);return null}return A=mt(A),p&&p[Ce]?p.K(I,A,l(M)?!!M.capture:!!M,J):rn(p,I,A,!1,M,J)}function rn(p,I,A,M,J,ie){if(!I)throw Error("Invalid event type");var ge=l(J)?!!J.capture:!!J,Pt=je(p);if(Pt||(p[Be]=Pt=new Fe(p)),A=Pt.add(I,A,M,ge,ie),A.proxy)return A;if(M=Sn(),A.proxy=M,M.src=p,M.listener=A,p.addEventListener)me||(J=ge),J===void 0&&(J=!1),p.addEventListener(I.toString(),M,J);else if(p.attachEvent)p.attachEvent(xt(I.toString()),M);else if(p.addListener&&p.removeListener)p.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Sn(){function p(A){return I.call(p.src,p.listener,A)}const I=Ut;return p}function Kt(p,I,A,M,J){if(Array.isArray(I))for(var ie=0;ie<I.length;ie++)Kt(p,I[ie],A,M,J);else M=l(M)?!!M.capture:!!M,A=mt(A),p&&p[Ce]?(p=p.i,I=String(I).toString(),I in p.g&&(ie=p.g[I],A=ze(ie,A,M,J),-1<A&&(Ke(ie[A]),Array.prototype.splice.call(ie,A,1),ie.length==0&&(delete p.g[I],p.h--)))):p&&(p=je(p))&&(I=p.g[I.toString()],p=-1,I&&(p=ze(I,A,M,J)),(A=-1<p?I[p]:null)&&pn(A))}function pn(p){if(typeof p!="number"&&p&&!p.da){var I=p.src;if(I&&I[Ce])Xe(I.i,p);else{var A=p.type,M=p.proxy;I.removeEventListener?I.removeEventListener(A,M,p.capture):I.detachEvent?I.detachEvent(xt(A),M):I.addListener&&I.removeListener&&I.removeListener(M),(A=je(I))?(Xe(A,p),A.h==0&&(A.src=null,I[Be]=null)):Ke(p)}}}function xt(p){return p in dt?dt[p]:dt[p]="on"+p}function Ut(p,I){if(p.da)p=!0;else{I=new fe(I,this);var A=p.listener,M=p.ha||p.src;p.fa&&pn(p),p=A.call(M,I)}return p}function je(p){return p=p[Be],p instanceof Fe?p:null}var Qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function mt(p){return typeof p=="function"?p:(p[Qt]||(p[Qt]=function(I){return p.handleEvent(I)}),p[Qt])}function Ue(){Q.call(this),this.i=new Fe(this),this.M=this,this.F=null}m(Ue,Q),Ue.prototype[Ce]=!0,Ue.prototype.removeEventListener=function(p,I,A,M){Kt(this,p,I,A,M)};function yt(p,I){var A,M=p.F;if(M)for(A=[];M;M=M.F)A.push(M);if(p=p.M,M=I.type||I,typeof I=="string")I=new ae(I,p);else if(I instanceof ae)I.target=I.target||p;else{var J=I;I=new ae(M,p),N(I,J)}if(J=!0,A)for(var ie=A.length-1;0<=ie;ie--){var ge=I.g=A[ie];J=Jt(ge,M,!0,I)&&J}if(ge=I.g=p,J=Jt(ge,M,!0,I)&&J,J=Jt(ge,M,!1,I)&&J,A)for(ie=0;ie<A.length;ie++)ge=I.g=A[ie],J=Jt(ge,M,!1,I)&&J}Ue.prototype.N=function(){if(Ue.aa.N.call(this),this.i){var p=this.i,I;for(I in p.g){for(var A=p.g[I],M=0;M<A.length;M++)Ke(A[M]);delete p.g[I],p.h--}}this.F=null},Ue.prototype.K=function(p,I,A,M){return this.i.add(String(p),I,!1,A,M)},Ue.prototype.L=function(p,I,A,M){return this.i.add(String(p),I,!0,A,M)};function Jt(p,I,A,M){if(I=p.i.g[String(I)],!I)return!0;I=I.concat();for(var J=!0,ie=0;ie<I.length;++ie){var ge=I[ie];if(ge&&!ge.da&&ge.capture==A){var Pt=ge.listener,Vn=ge.ha||ge.src;ge.fa&&Xe(p.i,ge),J=Pt.call(Vn,M)!==!1&&J}}return J&&!M.defaultPrevented}function Wt(p,I,A){if(typeof p=="function")A&&(p=d(p,A));else if(p&&typeof p.handleEvent=="function")p=d(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(I)?-1:s.setTimeout(p,I||0)}function In(p){p.g=Wt(()=>{p.g=null,p.i&&(p.i=!1,In(p))},p.l);const I=p.h;p.h=null,p.m.apply(null,I)}class ur extends Q{constructor(I,A){super(),this.m=I,this.l=A,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:In(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ti(p){Q.call(this),this.h=p,this.g={}}m(ti,Q);var bo=[];function ga(p){T(p.g,function(I,A){this.g.hasOwnProperty(A)&&pn(I)},p),p.g={}}ti.prototype.N=function(){ti.aa.N.call(this),ga(this)},ti.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ni=s.JSON.stringify,Yi=s.JSON.parse,va=class{stringify(p){return s.JSON.stringify(p,void 0)}parse(p){return s.JSON.parse(p,void 0)}};function Os(){}Os.prototype.h=null;function kf(p){return p.h||(p.h=p.i())}function Rf(){}var Ps={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Qu(){ae.call(this,"d")}m(Qu,ae);function ya(){ae.call(this,"c")}m(ya,ae);var yi={},Af=null;function Fc(){return Af=Af||new Ue}yi.La="serverreachability";function G(p){ae.call(this,yi.La,p)}m(G,ae);function Y(p){const I=Fc();yt(I,new G(I))}yi.STAT_EVENT="statevent";function re(p,I){ae.call(this,yi.STAT_EVENT,p),this.stat=I}m(re,ae);function ue(p){const I=Fc();yt(I,new re(I,p))}yi.Ma="timingevent";function be(p,I){ae.call(this,yi.Ma,p),this.size=I}m(be,ae);function ke(p,I){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){p()},I)}function Oe(){this.g=!0}Oe.prototype.xa=function(){this.g=!1};function Se(p,I,A,M,J,ie){p.info(function(){if(p.g)if(ie)for(var ge="",Pt=ie.split("&"),Vn=0;Vn<Pt.length;Vn++){var wt=Pt[Vn].split("=");if(1<wt.length){var Zn=wt[0];wt=wt[1];var er=Zn.split("_");ge=2<=er.length&&er[1]=="type"?ge+(Zn+"="+wt+"&"):ge+(Zn+"=redacted&")}}else ge=null;else ge=ie;return"XMLHTTP REQ ("+M+") [attempt "+J+"]: "+I+`
`+A+`
`+ge})}function Re(p,I,A,M,J,ie,ge){p.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+J+"]: "+I+`
`+A+`
`+ie+" "+ge})}function ve(p,I,A,M){p.info(function(){return"XMLHTTP TEXT ("+I+"): "+Je(p,A)+(M?" "+M:"")})}function Ge(p,I){p.info(function(){return"TIMEOUT: "+I})}Oe.prototype.info=function(){};function Je(p,I){if(!p.g)return I;if(!I)return null;try{var A=JSON.parse(I);if(A){for(p=0;p<A.length;p++)if(Array.isArray(A[p])){var M=A[p];if(!(2>M.length)){var J=M[1];if(Array.isArray(J)&&!(1>J.length)){var ie=J[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(var ge=1;ge<J.length;ge++)J[ge]=""}}}}return ni(A)}catch{return I}}var Rt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Nn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ot;function Et(){}m(Et,Os),Et.prototype.g=function(){return new XMLHttpRequest},Et.prototype.i=function(){return{}},Ot=new Et;function At(p,I,A,M){this.j=p,this.i=I,this.l=A,this.R=M||1,this.U=new ti(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new xo}function xo(){this.i=null,this.g="",this.h=!1}var wa={},Lr={};function _r(p,I,A){p.L=1,p.v=Mf(Io(I)),p.m=A,p.P=!0,Ju(p,null)}function Ju(p,I){p.F=Date.now(),Eo(p),p.A=Io(p.v);var A=p.A,M=p.R;Array.isArray(M)||(M=[String(M)]),yC(A.i,"t",M),p.C=0,A=p.j.J,p.h=new xo,p.g=LC(p.j,A?I:null,!p.m),0<p.O&&(p.M=new ur(d(p.Y,p,p.g),p.O)),I=p.U,A=p.g,M=p.ca;var J="readystatechange";Array.isArray(J)||(J&&(bo[0]=J.toString()),J=bo);for(var ie=0;ie<J.length;ie++){var ge=nt(A,J[ie],M||I.handleEvent,!1,I.h||I);if(!ge)break;I.g[ge.key]=ge}I=p.H?x(p.H):{},p.m?(p.u||(p.u="POST"),I["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,I)):(p.u="GET",p.g.ea(p.A,p.u,null,I)),Y(),Se(p.i,p.u,p.A,p.l,p.R,p.m)}At.prototype.ca=function(p){p=p.target;const I=this.M;I&&No(p)==3?I.j():this.Y(p)},At.prototype.Y=function(p){try{if(p==this.g)e:{const er=No(this.g);var I=this.g.Ba();const tl=this.g.Z();if(!(3>er)&&(er!=3||this.g&&(this.h.h||this.g.oa()||SC(this.g)))){this.J||er!=4||I==7||(I==8||0>=tl?Y(3):Y(2)),Ct(this);var A=this.g.Z();this.X=A;t:if(ba(this)){var M=SC(this.g);p="";var J=M.length,ie=No(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ri(this),on(this);var ge="";break t}this.h.i=new s.TextDecoder}for(I=0;I<J;I++)this.h.h=!0,p+=this.h.i.decode(M[I],{stream:!(ie&&I==J-1)});M.length=0,this.h.g+=p,this.C=0,ge=this.h.g}else ge=this.g.oa();if(this.o=A==200,Re(this.i,this.u,this.A,this.l,this.R,er,A),this.o){if(this.T&&!this.K){t:{if(this.g){var Pt,Vn=this.g;if((Pt=Vn.g?Vn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Pt)){var wt=Pt;break t}}wt=null}if(A=wt)ve(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Co(this,A);else{this.o=!1,this.s=3,ue(12),ri(this),on(this);break e}}if(this.P){A=!0;let wi;for(;!this.J&&this.C<ge.length;)if(wi=_o(this,ge),wi==Lr){er==4&&(this.s=4,ue(14),A=!1),ve(this.i,this.l,null,"[Incomplete Response]");break}else if(wi==wa){this.s=4,ue(15),ve(this.i,this.l,ge,"[Invalid Chunk]"),A=!1;break}else ve(this.i,this.l,wi,null),Co(this,wi);if(ba(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),er!=4||ge.length!=0||this.h.h||(this.s=1,ue(16),A=!1),this.o=this.o&&A,!A)ve(this.i,this.l,ge,"[Invalid Chunked Response]"),ri(this),on(this);else if(0<ge.length&&!this.W){this.W=!0;var Zn=this.j;Zn.g==this&&Zn.ba&&!Zn.M&&(Zn.j.info("Great, no buffering proxy detected. Bytes received: "+ge.length),hy(Zn),Zn.M=!0,ue(11))}}else ve(this.i,this.l,ge,null),Co(this,ge);er==4&&ri(this),this.o&&!this.J&&(er==4?DC(this.j,this):(this.o=!1,Eo(this)))}else M3(this.g),A==400&&0<ge.indexOf("Unknown SID")?(this.s=3,ue(12)):(this.s=0,ue(13)),ri(this),on(this)}}}catch{}finally{}};function ba(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function _o(p,I){var A=p.C,M=I.indexOf(`
`,A);return M==-1?Lr:(A=Number(I.substring(A,M)),isNaN(A)?wa:(M+=1,M+A>I.length?Lr:(I=I.slice(M,M+A),p.C=M+A,I)))}At.prototype.cancel=function(){this.J=!0,ri(this)};function Eo(p){p.S=Date.now()+p.I,Ms(p,p.I)}function Ms(p,I){if(p.B!=null)throw Error("WatchDog timer not null");p.B=ke(d(p.ba,p),I)}function Ct(p){p.B&&(s.clearTimeout(p.B),p.B=null)}At.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(Ge(this.i,this.A),this.L!=2&&(Y(),ue(17)),ri(this),this.s=2,on(this)):Ms(this,this.S-p)};function on(p){p.j.G==0||p.J||DC(p.j,p)}function ri(p){Ct(p);var I=p.M;I&&typeof I.ma=="function"&&I.ma(),p.M=null,ga(p.U),p.g&&(I=p.g,p.g=null,I.abort(),I.ma())}function Co(p,I){try{var A=p.j;if(A.G!=0&&(A.g==p||ay(A.h,p))){if(!p.K&&ay(A.h,p)&&A.G==3){try{var M=A.Da.g.parse(I)}catch{M=null}if(Array.isArray(M)&&M.length==3){var J=M;if(J[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<p.F)Uf(A),Bf(A);else break e;cy(A),ue(18)}}else A.za=J[1],0<A.za-A.T&&37500>J[2]&&A.F&&A.v==0&&!A.C&&(A.C=ke(d(A.Za,A),6e3));if(1>=Df(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else Fs(A,11)}else if((p.K||A.g==p)&&Uf(A),!w(I))for(J=A.Da.g.parse(I),I=0;I<J.length;I++){let wt=J[I];if(A.T=wt[0],wt=wt[1],A.G==2)if(wt[0]=="c"){A.K=wt[1],A.ia=wt[2];const Zn=wt[3];Zn!=null&&(A.la=Zn,A.j.info("VER="+A.la));const er=wt[4];er!=null&&(A.Aa=er,A.j.info("SVER="+A.Aa));const tl=wt[5];tl!=null&&typeof tl=="number"&&0<tl&&(M=1.5*tl,A.L=M,A.j.info("backChannelRequestTimeoutMs_="+M)),M=A;const wi=p.g;if(wi){const Wf=wi.g?wi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wf){var ie=M.h;ie.g||Wf.indexOf("spdy")==-1&&Wf.indexOf("quic")==-1&&Wf.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(sy(ie,ie.h),ie.h=null))}if(M.D){const dy=wi.g?wi.g.getResponseHeader("X-HTTP-Session-Id"):null;dy&&(M.ya=dy,Vt(M.I,M.D,dy))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-p.F,A.j.info("Handshake RTT: "+A.R+"ms")),M=A;var ge=p;if(M.qa=MC(M,M.J?M.ia:null,M.W),ge.K){cC(M.h,ge);var Pt=ge,Vn=M.L;Vn&&(Pt.I=Vn),Pt.B&&(Ct(Pt),Eo(Pt)),M.g=ge}else RC(M);0<A.i.length&&jf(A)}else wt[0]!="stop"&&wt[0]!="close"||Fs(A,7);else A.G==3&&(wt[0]=="stop"||wt[0]=="close"?wt[0]=="stop"?Fs(A,7):ly(A):wt[0]!="noop"&&A.l&&A.l.ta(wt),A.v=0)}}Y(4)}catch{}}var an=class{constructor(p,I){this.g=p,this.map=I}};function So(p){this.l=p||10,s.PerformanceNavigationTiming?(p=s.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function zc(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Df(p){return p.h?1:p.g?p.g.size:0}function ay(p,I){return p.h?p.h==I:p.g?p.g.has(I):!1}function sy(p,I){p.g?p.g.add(I):p.h=I}function cC(p,I){p.h&&p.h==I?p.h=null:p.g&&p.g.has(I)&&p.g.delete(I)}So.prototype.cancel=function(){if(this.i=hC(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function hC(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let I=p.i;for(const A of p.g.values())I=I.concat(A.D);return I}return v(p.i)}function b3(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(u(p)){for(var I=[],A=p.length,M=0;M<A;M++)I.push(p[M]);return I}I=[],A=0;for(M in p)I[A++]=p[M];return I}function x3(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(u(p)||typeof p=="string"){var I=[];p=p.length;for(var A=0;A<p;A++)I.push(A);return I}I=[],A=0;for(const M in p)I[A++]=M;return I}}}function dC(p,I){if(p.forEach&&typeof p.forEach=="function")p.forEach(I,void 0);else if(u(p)||typeof p=="string")Array.prototype.forEach.call(p,I,void 0);else for(var A=x3(p),M=b3(p),J=M.length,ie=0;ie<J;ie++)I.call(void 0,M[ie],A&&A[ie],p)}var fC=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _3(p,I){if(p){p=p.split("&");for(var A=0;A<p.length;A++){var M=p[A].indexOf("="),J=null;if(0<=M){var ie=p[A].substring(0,M);J=p[A].substring(M+1)}else ie=p[A];I(ie,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function Ls(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Ls){this.h=p.h,Of(this,p.j),this.o=p.o,this.g=p.g,Pf(this,p.s),this.l=p.l;var I=p.i,A=new Uc;A.i=I.i,I.g&&(A.g=new Map(I.g),A.h=I.h),pC(this,A),this.m=p.m}else p&&(I=String(p).match(fC))?(this.h=!1,Of(this,I[1]||"",!0),this.o=Bc(I[2]||""),this.g=Bc(I[3]||"",!0),Pf(this,I[4]),this.l=Bc(I[5]||"",!0),pC(this,I[6]||"",!0),this.m=Bc(I[7]||"")):(this.h=!1,this.i=new Uc(null,this.h))}Ls.prototype.toString=function(){var p=[],I=this.j;I&&p.push(jc(I,mC,!0),":");var A=this.g;return(A||I=="file")&&(p.push("//"),(I=this.o)&&p.push(jc(I,mC,!0),"@"),p.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&p.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&p.push("/"),p.push(jc(A,A.charAt(0)=="/"?S3:C3,!0))),(A=this.i.toString())&&p.push("?",A),(A=this.m)&&p.push("#",jc(A,N3)),p.join("")};function Io(p){return new Ls(p)}function Of(p,I,A){p.j=A?Bc(I,!0):I,p.j&&(p.j=p.j.replace(/:$/,""))}function Pf(p,I){if(I){if(I=Number(I),isNaN(I)||0>I)throw Error("Bad port number "+I);p.s=I}else p.s=null}function pC(p,I,A){I instanceof Uc?(p.i=I,T3(p.i,p.h)):(A||(I=jc(I,I3)),p.i=new Uc(I,p.h))}function Vt(p,I,A){p.i.set(I,A)}function Mf(p){return Vt(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function Bc(p,I){return p?I?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function jc(p,I,A){return typeof p=="string"?(p=encodeURI(p).replace(I,E3),A&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function E3(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var mC=/[#\/\?@]/g,C3=/[#\?:]/g,S3=/[#\?]/g,I3=/[#\?@]/g,N3=/#/g;function Uc(p,I){this.h=this.g=null,this.i=p||null,this.j=!!I}function xa(p){p.g||(p.g=new Map,p.h=0,p.i&&_3(p.i,function(I,A){p.add(decodeURIComponent(I.replace(/\+/g," ")),A)}))}n=Uc.prototype,n.add=function(p,I){xa(this),this.i=null,p=Zu(this,p);var A=this.g.get(p);return A||this.g.set(p,A=[]),A.push(I),this.h+=1,this};function gC(p,I){xa(p),I=Zu(p,I),p.g.has(I)&&(p.i=null,p.h-=p.g.get(I).length,p.g.delete(I))}function vC(p,I){return xa(p),I=Zu(p,I),p.g.has(I)}n.forEach=function(p,I){xa(this),this.g.forEach(function(A,M){A.forEach(function(J){p.call(I,J,M,this)},this)},this)},n.na=function(){xa(this);const p=Array.from(this.g.values()),I=Array.from(this.g.keys()),A=[];for(let M=0;M<I.length;M++){const J=p[M];for(let ie=0;ie<J.length;ie++)A.push(I[M])}return A},n.V=function(p){xa(this);let I=[];if(typeof p=="string")vC(this,p)&&(I=I.concat(this.g.get(Zu(this,p))));else{p=Array.from(this.g.values());for(let A=0;A<p.length;A++)I=I.concat(p[A])}return I},n.set=function(p,I){return xa(this),this.i=null,p=Zu(this,p),vC(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[I]),this.h+=1,this},n.get=function(p,I){return p?(p=this.V(p),0<p.length?String(p[0]):I):I};function yC(p,I,A){gC(p,I),0<A.length&&(p.i=null,p.g.set(Zu(p,I),v(A)),p.h+=A.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],I=Array.from(this.g.keys());for(var A=0;A<I.length;A++){var M=I[A];const ie=encodeURIComponent(String(M)),ge=this.V(M);for(M=0;M<ge.length;M++){var J=ie;ge[M]!==""&&(J+="="+encodeURIComponent(String(ge[M]))),p.push(J)}}return this.i=p.join("&")};function Zu(p,I){return I=String(I),p.j&&(I=I.toLowerCase()),I}function T3(p,I){I&&!p.j&&(xa(p),p.i=null,p.g.forEach(function(A,M){var J=M.toLowerCase();M!=J&&(gC(this,M),yC(this,J,A))},p)),p.j=I}function k3(p,I){const A=new Oe;if(s.Image){const M=new Image;M.onload=f(_a,A,"TestLoadImage: loaded",!0,I,M),M.onerror=f(_a,A,"TestLoadImage: error",!1,I,M),M.onabort=f(_a,A,"TestLoadImage: abort",!1,I,M),M.ontimeout=f(_a,A,"TestLoadImage: timeout",!1,I,M),s.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=p}else I(!1)}function R3(p,I){const A=new Oe,M=new AbortController,J=setTimeout(()=>{M.abort(),_a(A,"TestPingServer: timeout",!1,I)},1e4);fetch(p,{signal:M.signal}).then(ie=>{clearTimeout(J),ie.ok?_a(A,"TestPingServer: ok",!0,I):_a(A,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(J),_a(A,"TestPingServer: error",!1,I)})}function _a(p,I,A,M,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),M(A)}catch{}}function A3(){this.g=new va}function D3(p,I,A){const M=A||"";try{dC(p,function(J,ie){let ge=J;l(J)&&(ge=ni(J)),I.push(M+ie+"="+encodeURIComponent(ge))})}catch(J){throw I.push(M+"type="+encodeURIComponent("_badmap")),J}}function Lf(p){this.l=p.Ub||null,this.j=p.eb||!1}m(Lf,Os),Lf.prototype.g=function(){return new Ff(this.l,this.j)},Lf.prototype.i=function(p){return function(){return p}}({});function Ff(p,I){Ue.call(this),this.D=p,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(Ff,Ue),n=Ff.prototype,n.open=function(p,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=I,this.readyState=1,Vc(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const I={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(I.body=p),(this.D||s).fetch(new Request(this.A,I)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Wc(this)),this.readyState=0},n.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Vc(this)),this.g&&(this.readyState=3,Vc(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;wC(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function wC(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}n.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var I=p.value?p.value:new Uint8Array(0);(I=this.v.decode(I,{stream:!p.done}))&&(this.response=this.responseText+=I)}p.done?Wc(this):Vc(this),this.readyState==3&&wC(this)}},n.Ra=function(p){this.g&&(this.response=this.responseText=p,Wc(this))},n.Qa=function(p){this.g&&(this.response=p,Wc(this))},n.ga=function(){this.g&&Wc(this)};function Wc(p){p.readyState=4,p.l=null,p.j=null,p.v=null,Vc(p)}n.setRequestHeader=function(p,I){this.u.append(p,I)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],I=this.h.entries();for(var A=I.next();!A.done;)A=A.value,p.push(A[0]+": "+A[1]),A=I.next();return p.join(`\r
`)};function Vc(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Ff.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function bC(p){let I="";return T(p,function(A,M){I+=M,I+=":",I+=A,I+=`\r
`}),I}function uy(p,I,A){e:{for(M in A){var M=!1;break e}M=!0}M||(A=bC(A),typeof p=="string"?A!=null&&encodeURIComponent(String(A)):Vt(p,I,A))}function mn(p){Ue.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(mn,Ue);var O3=/^https?$/i,P3=["POST","PUT"];n=mn.prototype,n.Ha=function(p){this.J=p},n.ea=function(p,I,A,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);I=I?I.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ot.g(),this.v=this.o?kf(this.o):kf(Ot),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(I,String(p),!0),this.B=!1}catch(ie){xC(this,ie);return}if(p=A||"",A=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var J in M)A.set(J,M[J]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const ie of M.keys())A.set(ie,M.get(ie));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(A.keys()).find(ie=>ie.toLowerCase()=="content-type"),J=s.FormData&&p instanceof s.FormData,!(0<=Array.prototype.indexOf.call(P3,I,void 0))||M||J||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,ge]of A)this.g.setRequestHeader(ie,ge);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{CC(this),this.u=!0,this.g.send(p),this.u=!1}catch(ie){xC(this,ie)}};function xC(p,I){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=I,p.m=5,_C(p),zf(p)}function _C(p){p.A||(p.A=!0,yt(p,"complete"),yt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,yt(this,"complete"),yt(this,"abort"),zf(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zf(this,!0)),mn.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?EC(this):this.bb())},n.bb=function(){EC(this)};function EC(p){if(p.h&&typeof a<"u"&&(!p.v[1]||No(p)!=4||p.Z()!=2)){if(p.u&&No(p)==4)Wt(p.Ea,0,p);else if(yt(p,"readystatechange"),No(p)==4){p.h=!1;try{const ge=p.Z();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var A;if(!(A=I)){var M;if(M=ge===0){var J=String(p.D).match(fC)[1]||null;!J&&s.self&&s.self.location&&(J=s.self.location.protocol.slice(0,-1)),M=!O3.test(J?J.toLowerCase():"")}A=M}if(A)yt(p,"complete"),yt(p,"success");else{p.m=6;try{var ie=2<No(p)?p.g.statusText:""}catch{ie=""}p.l=ie+" ["+p.Z()+"]",_C(p)}}finally{zf(p)}}}}function zf(p,I){if(p.g){CC(p);const A=p.g,M=p.v[0]?()=>{}:null;p.g=null,p.v=null,I||yt(p,"ready");try{A.onreadystatechange=M}catch{}}}function CC(p){p.I&&(s.clearTimeout(p.I),p.I=null)}n.isActive=function(){return!!this.g};function No(p){return p.g?p.g.readyState:0}n.Z=function(){try{return 2<No(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(p){if(this.g){var I=this.g.responseText;return p&&I.indexOf(p)==0&&(I=I.substring(p.length)),Yi(I)}};function SC(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function M3(p){const I={};p=(p.g&&2<=No(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<p.length;M++){if(w(p[M]))continue;var A=R(p[M]);const J=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const ie=I[J]||[];I[J]=ie,ie.push(A)}_(I,function(M){return M.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function $c(p,I,A){return A&&A.internalChannelParams&&A.internalChannelParams[p]||I}function IC(p){this.Aa=0,this.i=[],this.j=new Oe,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$c("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$c("baseRetryDelayMs",5e3,p),this.cb=$c("retryDelaySeedMs",1e4,p),this.Wa=$c("forwardChannelMaxRetries",2,p),this.wa=$c("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new So(p&&p.concurrentRequestLimit),this.Da=new A3,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=IC.prototype,n.la=8,n.G=1,n.connect=function(p,I,A,M){ue(0),this.W=p,this.H=I||{},A&&M!==void 0&&(this.H.OSID=A,this.H.OAID=M),this.F=this.X,this.I=MC(this,null,this.W),jf(this)};function ly(p){if(NC(p),p.G==3){var I=p.U++,A=Io(p.I);if(Vt(A,"SID",p.K),Vt(A,"RID",I),Vt(A,"TYPE","terminate"),Hc(p,A),I=new At(p,p.j,I),I.L=2,I.v=Mf(Io(A)),A=!1,s.navigator&&s.navigator.sendBeacon)try{A=s.navigator.sendBeacon(I.v.toString(),"")}catch{}!A&&s.Image&&(new Image().src=I.v,A=!0),A||(I.g=LC(I.j,null),I.g.ea(I.v)),I.F=Date.now(),Eo(I)}PC(p)}function Bf(p){p.g&&(hy(p),p.g.cancel(),p.g=null)}function NC(p){Bf(p),p.u&&(s.clearTimeout(p.u),p.u=null),Uf(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&s.clearTimeout(p.s),p.s=null)}function jf(p){if(!zc(p.h)&&!p.s){p.s=!0;var I=p.Ga;H||F(),z||(H(),z=!0),q.add(I,p),p.B=0}}function L3(p,I){return Df(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=I.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=ke(d(p.Ga,p,I),OC(p,p.B)),p.B++,!0)}n.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const J=new At(this,this.j,p);let ie=this.o;if(this.S&&(ie?(ie=x(ie),N(ie,this.S)):ie=this.S),this.m!==null||this.O||(J.H=ie,ie=null),this.P)e:{for(var I=0,A=0;A<this.i.length;A++){t:{var M=this.i[A];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(I+=M,4096<I){I=A;break e}if(I===4096||A===this.i.length-1){I=A+1;break e}}I=1e3}else I=1e3;I=kC(this,J,I),A=Io(this.I),Vt(A,"RID",p),Vt(A,"CVER",22),this.D&&Vt(A,"X-HTTP-Session-Id",this.D),Hc(this,A),ie&&(this.O?I="headers="+encodeURIComponent(String(bC(ie)))+"&"+I:this.m&&uy(A,this.m,ie)),sy(this.h,J),this.Ua&&Vt(A,"TYPE","init"),this.P?(Vt(A,"$req",I),Vt(A,"SID","null"),J.T=!0,_r(J,A,null)):_r(J,A,I),this.G=2}}else this.G==3&&(p?TC(this,p):this.i.length==0||zc(this.h)||TC(this))};function TC(p,I){var A;I?A=I.l:A=p.U++;const M=Io(p.I);Vt(M,"SID",p.K),Vt(M,"RID",A),Vt(M,"AID",p.T),Hc(p,M),p.m&&p.o&&uy(M,p.m,p.o),A=new At(p,p.j,A,p.B+1),p.m===null&&(A.H=p.o),I&&(p.i=I.D.concat(p.i)),I=kC(p,A,1e3),A.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),sy(p.h,A),_r(A,M,I)}function Hc(p,I){p.H&&T(p.H,function(A,M){Vt(I,M,A)}),p.l&&dC({},function(A,M){Vt(I,M,A)})}function kC(p,I,A){A=Math.min(p.i.length,A);var M=p.l?d(p.l.Na,p.l,p):null;e:{var J=p.i;let ie=-1;for(;;){const ge=["count="+A];ie==-1?0<A?(ie=J[0].g,ge.push("ofs="+ie)):ie=0:ge.push("ofs="+ie);let Pt=!0;for(let Vn=0;Vn<A;Vn++){let wt=J[Vn].g;const Zn=J[Vn].map;if(wt-=ie,0>wt)ie=Math.max(0,J[Vn].g-100),Pt=!1;else try{D3(Zn,ge,"req"+wt+"_")}catch{M&&M(Zn)}}if(Pt){M=ge.join("&");break e}}}return p=p.i.splice(0,A),I.D=p,M}function RC(p){if(!p.g&&!p.u){p.Y=1;var I=p.Fa;H||F(),z||(H(),z=!0),q.add(I,p),p.v=0}}function cy(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=ke(d(p.Fa,p),OC(p,p.v)),p.v++,!0)}n.Fa=function(){if(this.u=null,AC(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=ke(d(this.ab,this),p)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ue(10),Bf(this),AC(this))};function hy(p){p.A!=null&&(s.clearTimeout(p.A),p.A=null)}function AC(p){p.g=new At(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var I=Io(p.qa);Vt(I,"RID","rpc"),Vt(I,"SID",p.K),Vt(I,"AID",p.T),Vt(I,"CI",p.F?"0":"1"),!p.F&&p.ja&&Vt(I,"TO",p.ja),Vt(I,"TYPE","xmlhttp"),Hc(p,I),p.m&&p.o&&uy(I,p.m,p.o),p.L&&(p.g.I=p.L);var A=p.g;p=p.ia,A.L=1,A.v=Mf(Io(I)),A.m=null,A.P=!0,Ju(A,p)}n.Za=function(){this.C!=null&&(this.C=null,Bf(this),cy(this),ue(19))};function Uf(p){p.C!=null&&(s.clearTimeout(p.C),p.C=null)}function DC(p,I){var A=null;if(p.g==I){Uf(p),hy(p),p.g=null;var M=2}else if(ay(p.h,I))A=I.D,cC(p.h,I),M=1;else return;if(p.G!=0){if(I.o)if(M==1){A=I.m?I.m.length:0,I=Date.now()-I.F;var J=p.B;M=Fc(),yt(M,new be(M,A)),jf(p)}else RC(p);else if(J=I.s,J==3||J==0&&0<I.X||!(M==1&&L3(p,I)||M==2&&cy(p)))switch(A&&0<A.length&&(I=p.h,I.i=I.i.concat(A)),J){case 1:Fs(p,5);break;case 4:Fs(p,10);break;case 3:Fs(p,6);break;default:Fs(p,2)}}}function OC(p,I){let A=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(A*=2),A*I}function Fs(p,I){if(p.j.info("Error code "+I),I==2){var A=d(p.fb,p),M=p.Xa;const J=!M;M=new Ls(M||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||Of(M,"https"),Mf(M),J?k3(M.toString(),A):R3(M.toString(),A)}else ue(2);p.G=0,p.l&&p.l.sa(I),PC(p),NC(p)}n.fb=function(p){p?(this.j.info("Successfully pinged google.com"),ue(2)):(this.j.info("Failed to ping google.com"),ue(1))};function PC(p){if(p.G=0,p.ka=[],p.l){const I=hC(p.h);(I.length!=0||p.i.length!=0)&&(y(p.ka,I),y(p.ka,p.i),p.h.i.length=0,v(p.i),p.i.length=0),p.l.ra()}}function MC(p,I,A){var M=A instanceof Ls?Io(A):new Ls(A);if(M.g!="")I&&(M.g=I+"."+M.g),Pf(M,M.s);else{var J=s.location;M=J.protocol,I=I?I+"."+J.hostname:J.hostname,J=+J.port;var ie=new Ls(null);M&&Of(ie,M),I&&(ie.g=I),J&&Pf(ie,J),A&&(ie.l=A),M=ie}return A=p.D,I=p.ya,A&&I&&Vt(M,A,I),Vt(M,"VER",p.la),Hc(p,M),M}function LC(p,I,A){if(I&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return I=p.Ca&&!p.pa?new mn(new Lf({eb:A})):new mn(p.pa),I.Ha(p.J),I}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function FC(){}n=FC.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ii(p,I){Ue.call(this),this.g=new IC(I),this.l=p,this.h=I&&I.messageUrlParams||null,p=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(p?p["X-WebChannel-Content-Type"]=I.messageContentType:p={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.va&&(p?p["X-WebChannel-Client-Profile"]=I.va:p={"X-WebChannel-Client-Profile":I.va}),this.g.S=p,(p=I&&I.Sb)&&!w(p)&&(this.g.m=p),this.v=I&&I.supportsCrossDomainXhr||!1,this.u=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!w(I)&&(this.g.D=I,p=this.h,p!==null&&I in p&&(p=this.h,I in p&&delete p[I])),this.j=new el(this)}m(ii,Ue),ii.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ii.prototype.close=function(){ly(this.g)},ii.prototype.o=function(p){var I=this.g;if(typeof p=="string"){var A={};A.__data__=p,p=A}else this.u&&(A={},A.__data__=ni(p),p=A);I.i.push(new an(I.Ya++,p)),I.G==3&&jf(I)},ii.prototype.N=function(){this.g.l=null,delete this.j,ly(this.g),delete this.g,ii.aa.N.call(this)};function zC(p){Qu.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var I=p.__sm__;if(I){e:{for(const A in I){p=A;break e}p=void 0}(this.i=p)&&(p=this.i,I=I!==null&&p in I?I[p]:void 0),this.data=I}else this.data=p}m(zC,Qu);function BC(){ya.call(this),this.status=1}m(BC,ya);function el(p){this.g=p}m(el,FC),el.prototype.ua=function(){yt(this.g,"a")},el.prototype.ta=function(p){yt(this.g,new zC(p))},el.prototype.sa=function(p){yt(this.g,new BC)},el.prototype.ra=function(){yt(this.g,"b")},ii.prototype.send=ii.prototype.o,ii.prototype.open=ii.prototype.m,ii.prototype.close=ii.prototype.close,Rt.NO_ERROR=0,Rt.TIMEOUT=8,Rt.HTTP_ERROR=6,Nn.COMPLETE="complete",Rf.EventType=Ps,Ps.OPEN="a",Ps.CLOSE="b",Ps.ERROR="c",Ps.MESSAGE="d",Ue.prototype.listen=Ue.prototype.K,mn.prototype.listenOnce=mn.prototype.L,mn.prototype.getLastError=mn.prototype.Ka,mn.prototype.getLastErrorCode=mn.prototype.Ba,mn.prototype.getStatus=mn.prototype.Z,mn.prototype.getResponseJson=mn.prototype.Oa,mn.prototype.getResponseText=mn.prototype.oa,mn.prototype.send=mn.prototype.ea,mn.prototype.setWithCredentials=mn.prototype.Ha}).apply(typeof hp<"u"?hp:typeof self<"u"?self:typeof window<"u"?window:{});const NI="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}zr.UNAUTHENTICATED=new zr(null),zr.GOOGLE_CREDENTIALS=new zr("google-credentials-uid"),zr.FIRST_PARTY=new zr("first-party-uid"),zr.MOCK_USER=new zr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iv="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jm=new Vg("@firebase/firestore");function Ri(n,...e){if(Jm.logLevel<=It.DEBUG){const t=e.map(OD);Jm.debug(`Firestore (${iv}): ${n}`,...t)}}function DD(n,...e){if(Jm.logLevel<=It.ERROR){const t=e.map(OD);Jm.error(`Firestore (${iv}): ${n}`,...t)}}function OD(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PD(n="Unexpected state"){const e=`FIRESTORE (${iv}) INTERNAL ASSERTION FAILED: `+n;throw DD(e),new Error(e)}function jh(n,e){n||PD()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ti extends sa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C9{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class S9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(zr.UNAUTHENTICATED))}shutdown(){}}class I9{constructor(e){this.t=e,this.currentUser=zr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){jh(this.o===void 0);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let o=new Uh;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Uh,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const u=o;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},s=u=>{Ri("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>s(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?s(u):(Ri("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Uh)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Ri("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(jh(typeof r.accessToken=="string"),new C9(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return jh(e===null||typeof e=="string"),new zr(e)}}class N9{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=zr.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class T9{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new N9(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(zr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class k9{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class R9{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){jh(this.o===void 0);const r=o=>{o.error!=null&&Ri("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.R;return this.R=o.token,Ri("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const i=o=>{Ri("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):Ri("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(jh(typeof t.token=="string"),this.R=t.token,new k9(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function A9(n){return n.name==="IndexedDbTransactionError"}class Zm{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Zm("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Zm&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var TI,ft;(ft=TI||(TI={}))[ft.OK=0]="OK",ft[ft.CANCELLED=1]="CANCELLED",ft[ft.UNKNOWN=2]="UNKNOWN",ft[ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ft[ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ft[ft.NOT_FOUND=5]="NOT_FOUND",ft[ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",ft[ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",ft[ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",ft[ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ft[ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ft[ft.ABORTED=10]="ABORTED",ft[ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",ft[ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",ft[ft.INTERNAL=13]="INTERNAL",ft[ft.UNAVAILABLE=14]="UNAVAILABLE",ft[ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new AD([4294967295,4294967295],0);function r0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D9{constructor(e,t,r=1e3,i=1.5,o=6e4){this.li=e,this.timerId=t,this.Qo=r,this.Ko=i,this.$o=o,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const t=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),i=Math.max(0,t-r);i>0&&Ri("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Uh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){const a=Date.now()+r,s=new Ux(e,t,a,i,o);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ti(Ni.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}var kI,RI;(RI=kI||(kI={})).na="default",RI.Cache="cache";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O9(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI=new Map;function P9(n,e,t,r){if(e===!0&&r===!0)throw new Ti(Ni.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Ti(Ni.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ti(Ni.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}P9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=O9((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Ti(Ni.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Ti(Ni.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Ti(Ni.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class M9{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new DI({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ti(Ni.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ti(Ni.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new DI(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new S9;switch(r.type){case"firstParty":return new T9(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ti(Ni.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=AI.get(t);r&&(Ri("ComponentProvider","Removing Datastore"),AI.delete(t),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new D9(this,"async_queue_retry"),this.fu=()=>{const r=r0();r&&Ri("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;const t=r0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const t=r0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const t=new Uh;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!A9(e))throw e;Ri("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const t=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;const i=function(a){let s=a.message||"";return a.stack&&(s=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),s}(r);throw DD("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ru=!1,r))));return this.gu=t,t}enqueueAfterDelay(e,t,r){this.pu(),this.mu.indexOf(e)>-1&&(t=0);const i=Ux.createAndSchedule(this,e,t,r,o=>this.Su(o));return this.du.push(i),i}pu(){this.Au&&PD()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const t of this.du)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.du)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const t=this.du.indexOf(e);this.du.splice(t,1)}}class L9 extends M9{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new OI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new OI(e),this._firestoreClient=void 0,await e}}}(function(e,t=!0){(function(i){iv=i})(Mu),wu(new hs("firestore",(r,{instanceIdentifier:i,options:o})=>{const a=r.getProvider("app").getImmediate(),s=new L9(new I9(r.getProvider("auth-internal")),new R9(r.getProvider("app-check-internal")),function(l,c){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Ti(Ni.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zm(l.options.projectId,c)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),s._setSettings(o),s},"PUBLIC").setMultipleInstances(!0)),so(NI,"4.7.5",e),so(NI,"4.7.5","esm2017")})();const F9={apiKey:"AIzaSyAM6PV2pMY1HUUZ1asW6cA5dDxGRKiho68",authDomain:"inventory-management-93042.firebaseapp.com",projectId:"inventory-management-93042",storageBucket:"inventory-management-93042.appspot.com",messagingSenderId:"335925214706",appId:"1:335925214706:web:20265f6b42683fa6bfff6b",measurementId:"G-ESRD0P0WZ2",databaseURL:"https://inventory-management-93042-default-rtdb.firebaseio.com/"},ca=DR(F9),eg=RD(ca),z9=()=>{const[n,e]=X.useState(!1),[t,r]=X.useState(0),[i,o]=X.useState(!1),a=gi(),s=ua(ca);function u(){Yd(s).then(()=>{alert("Signed out successfully"),a("/"),o(!1)})}function l(){a("/features"),o(!1)}function c(){o(!i)}X.useEffect(()=>{const d=()=>{e(window.scrollY>20)};return window.addEventListener("scroll",d),()=>window.removeEventListener("scroll",d)},[]);const h=[{title:"Smart Inventory Tracking",icon:"📊",description:"Real-time inventory monitoring with predictive stock alerts"},{title:"AI Price Optimization",icon:"💰",description:"Dynamic pricing based on market trends and demand patterns"},{title:"Freshness Verification",icon:"✅",description:"Automated quality control and expiration management"},{title:"Supply Chain Analytics",icon:"🔄",description:"End-to-end visibility with actionable insights"}];return X.useEffect(()=>{const d=setInterval(()=>{r(f=>(f+1)%h.length)},3e3);return()=>clearInterval(d)},[h.length]),O.jsxs("div",{className:"app-container",children:[O.jsx("header",{className:`header ${n?"header-scrolled":""}`,children:O.jsxs("div",{className:"container header-container",children:[O.jsxs("div",{className:"logo-container",children:[O.jsx("div",{className:"logo-icon",children:O.jsx("span",{className:"logo-text",children:"S"})}),O.jsx("h1",{className:"logo-title",children:"StockSense"})]}),O.jsxs("button",{className:"menu-button",onClick:c,children:[O.jsx("div",{className:"menu-line"}),O.jsx("div",{className:"menu-line"}),O.jsx("div",{className:"menu-line"})]}),i&&O.jsx("div",{className:"nav-menu",children:O.jsxs("ul",{className:"nav-links",children:[O.jsx("li",{children:O.jsx(cn,{to:"/Main",onClick:()=>o(!1),children:"Home"})}),O.jsx("li",{children:O.jsx(cn,{to:"/about",onClick:()=>o(!1),children:"About Us"})}),O.jsx("li",{children:O.jsx(cn,{onClick:l,children:"Features"})}),O.jsx("li",{children:O.jsx(cn,{onClick:u,children:"Logout"})})]})})]})}),O.jsx("section",{className:"hero-section",children:O.jsxs("div",{className:"container",children:[O.jsxs("div",{className:"hero-card",children:[O.jsx("h2",{className:"hero-title",children:"Machine learning-powered inventory management"}),O.jsx("p",{className:"hero-description",children:"Revolutionize your item tracking, pricing prediction, and freshness verification with our AI-powered solution."}),O.jsx("button",{className:"cta-button",onClick:l,children:"Try Our Features"})]}),O.jsxs("div",{className:"device-mockup",children:[O.jsx("div",{className:"device-outer"}),O.jsxs("div",{className:"device-inner",children:[O.jsx("div",{className:"device-notch"}),O.jsx("div",{className:"device-content",children:O.jsxs("div",{className:"app-screen",children:[O.jsxs("div",{className:"app-header",children:[O.jsx("div",{className:"app-title",children:"Dashboard"}),O.jsxs("div",{className:"app-dots",children:[O.jsx("div",{className:"app-dot"}),O.jsx("div",{className:"app-dot"}),O.jsx("div",{className:"app-dot"})]})]}),O.jsxs("div",{className:"inventory-status",children:[O.jsx("div",{className:"inventory-icon",children:O.jsx("span",{children:"📊"})}),O.jsxs("div",{className:"inventory-info",children:[O.jsx("div",{className:"inventory-label",children:"Inventory Status"}),O.jsx("div",{className:"inventory-value",children:"Optimal"})]})]}),O.jsxs("div",{className:"metrics-grid",children:[O.jsxs("div",{className:"metric-box",children:[O.jsx("div",{className:"metric-label",children:"Items"}),O.jsx("div",{className:"metric-value",children:"1,248"})]}),O.jsxs("div",{className:"metric-box",children:[O.jsx("div",{className:"metric-label",children:"Alerts"}),O.jsx("div",{className:"metric-value alert",children:"3"})]})]}),O.jsxs("div",{className:"chart-container",children:[O.jsx("div",{className:"chart-title",children:"Stock Trends"}),O.jsxs("div",{className:"chart-bars",children:[O.jsx("div",{className:"chart-bar bar-1"}),O.jsx("div",{className:"chart-bar bar-2"}),O.jsx("div",{className:"chart-bar bar-3"}),O.jsx("div",{className:"chart-bar bar-4"}),O.jsx("div",{className:"chart-bar bar-5"}),O.jsx("div",{className:"chart-bar bar-6"}),O.jsx("div",{className:"chart-bar bar-7"})]})]})]})})]})]})]})}),O.jsx("section",{className:"features-section",children:O.jsxs("div",{className:"container",children:[O.jsx("h2",{className:"section-title",children:"Key Features"}),O.jsxs("div",{className:"feature-carousel",children:[O.jsx("div",{className:"carousel-track",style:{transform:`translateX(-${t*100}%)`},children:h.map((d,f)=>O.jsx("div",{className:"carousel-slide",children:O.jsxs("div",{className:"feature-card",children:[O.jsx("div",{className:"feature-icon",children:d.icon}),O.jsx("h3",{className:"feature-title",children:d.title}),O.jsx("p",{className:"feature-description",children:d.description})]})},f))}),O.jsx("div",{className:"carousel-indicators",children:h.map((d,f)=>O.jsx("button",{onClick:()=>r(f),className:`carousel-dot ${f===t?"active":""}`,"aria-label":`Go to slide ${f+1}`},f))})]}),O.jsxs("div",{className:"cta-card",children:[O.jsx("h3",{className:"cta-title",children:"Ready to transform your inventory management?"}),O.jsx("p",{className:"cta-description",children:"Join innovative businesses already using StockSense to optimize their operations."}),O.jsx("button",{className:"cta-button inverted",onClick:l,children:"Get Started Free"})]})]})}),O.jsx("section",{className:"testimonial-section",children:O.jsx("div",{className:"container",children:O.jsxs("div",{className:"testimonial-card",children:[O.jsx("div",{className:"quote-mark",children:'"'}),O.jsx("p",{className:"testimonial-text",children:"StockSense has revolutionized how we manage our inventory. The AI predictions have reduced our waste by 37% in just three months."}),O.jsxs("div",{className:"testimonial-author",children:[O.jsx("div",{className:"author-avatar"}),O.jsxs("div",{className:"author-info",children:[O.jsx("div",{className:"author-name",children:"Sarah Johnson"}),O.jsx("div",{className:"author-position",children:"Operations Director, TechRetail"})]})]})]})})}),O.jsx("footer",{className:"footer",children:O.jsxs("div",{className:"container",children:[O.jsxs("div",{className:"footer-top",children:[O.jsxs("div",{className:"footer-logo",children:[O.jsx("div",{className:"footer-logo-icon",children:O.jsx("span",{children:"S"})}),O.jsx("span",{className:"footer-logo-text",children:"StockSense"})]}),O.jsxs("div",{className:"footer-social",children:[O.jsx("div",{className:"social-icon",children:O.jsx("span",{children:"📱"})}),O.jsx("div",{className:"social-icon",children:O.jsx("span",{children:"💬"})}),O.jsx("div",{className:"social-icon",children:O.jsx("span",{children:"📧"})})]})]}),O.jsx("div",{className:"footer-bottom",children:O.jsx("p",{children:"© 2025 StockSense. All rights reserved."})})]})})]})},ov=()=>{const n=gi();function e(){const t=ua(ca);Yd(t).then(()=>{alert("Signed out successfully"),n("/")})}return O.jsx("div",{className:"featurs-nav",children:O.jsxs("nav",{className:"landing-nav-main",children:[O.jsx("div",{className:"landing-logo",children:"StockSense"}),O.jsxs("ul",{className:"nav-links-main",children:[O.jsx("li",{children:O.jsx(cn,{to:"/Main",children:"Home"})}),O.jsx("li",{children:O.jsx(cn,{to:"/about",children:"About Us"})}),O.jsx("li",{children:O.jsx(cn,{to:"/features",children:"Features"})}),O.jsx("li",{children:O.jsx(cn,{onClick:e,children:"Logout"})})]})]})})},B9=()=>{const n=gi();return O.jsxs("div",{className:"features-page",children:[O.jsx(ov,{}),O.jsxs("div",{className:"features-heading",children:[O.jsx("h1",{children:"Our Features"}),O.jsx("p",{children:"Discover the powerful tools that make inventory management effortless"})]}),O.jsxs("div",{className:"all-features-1",children:[O.jsxs("div",{className:"feature-section",onClick:()=>n("/additems"),children:[O.jsx("div",{className:"feature-logo",children:O.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"#2563EB",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-circle-plus w-8 h-8 mb-4 text-blue-600",children:[O.jsx("circle",{cx:"12",cy:"12",r:"10"}),O.jsx("path",{d:"M8 12h8"}),O.jsx("path",{d:"M12 8v8"})]})}),O.jsxs("div",{className:"feature-content",children:[O.jsx("h2",{children:"Add Items"}),O.jsx("p",{children:"Easily add new items to your inventory with detailed categorization and tracking capabilities."})]})]}),O.jsxs("div",{className:"feature-section",onClick:()=>n("/predict"),children:[O.jsx("div",{className:"feature-logo",children:O.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"35",height:"35",viewBox:"0 0 24 24",fill:"none",stroke:"rgb(234 88 12)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-trending-up w-8 h-8 mb-4 text-orange-600",children:[O.jsx("polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17"}),O.jsx("polyline",{points:"16 7 22 7 22 13"})]})}),O.jsxs("div",{className:"feature-content",children:[O.jsx("h2",{children:"Predict Price"}),O.jsx("p",{children:"Utilize AI-powered tools to predict prices and optimize inventory decisions effortlessly."})]})]}),O.jsxs("div",{className:"feature-section",onClick:()=>n("/retrive"),children:[O.jsx("div",{className:"feature-logo",children:O.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"35",height:"35",viewBox:"0 0 24 24",fill:"none",stroke:"rgb(22 163 74)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-package-search w-8 h-8 mb-4 text-green-600",children:[O.jsx("path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14"}),O.jsx("path",{d:"m7.5 4.27 9 5.15"}),O.jsx("polyline",{points:"3.29 7 12 12 20.71 7"}),O.jsx("line",{x1:"12",x2:"12",y1:"22",y2:"12"}),O.jsx("circle",{cx:"18.5",cy:"15.5",r:"2.5"}),O.jsx("path",{d:"M20.27 17.27 22 19"})]})}),O.jsxs("div",{className:"feature-content",children:[O.jsx("h2",{children:"Retrieve Items"}),O.jsx("p",{children:"Quick and efficient item lookup system with advanced search and filtering options."})]})]})]}),O.jsxs("div",{className:"all-features-2",children:[O.jsxs("div",{className:"feature-section",onClick:()=>n("/display"),children:[O.jsx("div",{className:"feature-logo",children:O.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"35",height:"35",viewBox:"0 0 24 24",fill:"none",stroke:"rgb(147 51 234)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-list-checks w-8 h-8 mb-4 text-purple-600",children:[O.jsx("path",{d:"m3 17 2 2 4-4"}),O.jsx("path",{d:"m3 7 2 2 4-4"}),O.jsx("path",{d:"M13 6h8"}),O.jsx("path",{d:"M13 12h8"}),O.jsx("path",{d:"M13 18h8"})]})}),O.jsxs("div",{className:"feature-content",children:[O.jsx("h2",{children:"Display Items"}),O.jsx("p",{children:"Comprehensive view of your inventory with customizable display options and sorting capabilities."})]})]}),O.jsxs("div",{className:"feature-section",onClick:()=>n("/check"),children:[O.jsx("div",{className:"feature-logo",children:O.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"rgb(220 38 38)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-thermometer-sun w-8 h-8 mb-4 text-red-600",children:[O.jsx("path",{d:"M12 9a4 4 0 0 0-2 7.5"}),O.jsx("path",{d:"M12 3v2"}),O.jsx("path",{d:"m6.6 18.4-1.4 1.4"}),O.jsx("path",{d:"M20 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"}),O.jsx("path",{d:"M4 13H2"}),O.jsx("path",{d:"M6.34 7.34 4.93 5.93"})]})}),O.jsxs("div",{className:"feature-content",children:[O.jsx("h2",{children:"Check Freshness"}),O.jsx("p",{children:"Automated freshness monitoring system for perishable items with alerts and notifications."})]})]})]})]})},av=()=>{const[n,e]=X.useState(!1),[t,r]=X.useState(!1),i=gi(),o=()=>{r(!0),setTimeout(()=>{i(-1)},600)};return O.jsxs("button",{className:`back-button ${n?"hovered":""} ${t?"clicked":""}`,onMouseEnter:()=>e(!0),onMouseLeave:()=>e(!1),onClick:o,children:[O.jsxs("div",{className:"back-button-content",children:[O.jsx("div",{className:"arrow-container",children:O.jsx("span",{className:"arrow-left"})}),O.jsx("span",{className:"button-text",children:"Back"})]}),O.jsx("div",{className:"ripple-container"})]})},j9=()=>{const[n,e]=X.useState(""),[t,r]=X.useState(""),[i,o]=X.useState(""),[a,s]=X.useState(!1),u=RD(),l=()=>{if(n&&t&&i){s(!0);const c=ec(u,"inventory/"+n);TD(c).then(h=>{if(h.exists()){const d=h.val(),f=parseInt(d.quantity)+parseInt(t);SI(c,{itemsname:n,quantity:f.toString(),description:i}).then(()=>{s(!1),e(""),r(""),o(""),alert("Item updated successfully")}).catch(m=>{s(!1),alert("Error updating item: "+m.message)})}else{const d=new Date().getTime();SI(ec(u,"inventory/"+d),{itemsname:n,quantity:t,description:i}).then(()=>{s(!1),e(""),r(""),o(""),alert("Item added successfully")}).catch(f=>{s(!1),alert("Error adding item: "+f.message)})}}).catch(h=>{s(!1),alert("Error checking item: "+h.message)})}else alert("Please fill all the fields")};return O.jsxs("div",{className:"Additems-main",children:[O.jsx(ov,{}),O.jsxs("div",{className:"Additems-Heading",children:[O.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"60",viewBox:"0 0 24 24",fill:"none",stroke:"#2764EB",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-circle-plus h-16 w-16 text-blue-600",children:[O.jsx("circle",{cx:"12",cy:"12",r:"10"}),O.jsx("path",{d:"M8 12h8"}),O.jsx("path",{d:"M12 8v8"})]}),O.jsx("h1",{children:"Add New Item"}),O.jsx("p",{children:"Enter the details of your new inventory item below"})]}),O.jsxs("div",{className:"Additems-form",children:[O.jsx("div",{className:"form-heading",children:O.jsx("h2",{children:"Item Information"})}),O.jsxs("div",{className:"input-section",children:[O.jsxs("label",{children:["Item Name:",O.jsx("input",{type:"text",value:n,placeholder:"Enter Item Name",onChange:c=>e(c.target.value)})]}),O.jsxs("label",{children:["Quantity:",O.jsx("input",{type:"number",value:t,placeholder:"Enter quantity",onChange:c=>r(c.target.value)})]}),O.jsxs("label",{children:["Description:",O.jsx("input",{type:"text",value:i,placeholder:"Enter item Description",onChange:c=>o(c.target.value)})]})]}),O.jsxs("div",{className:"Additems-buttons",children:[O.jsx("button",{className:"cancel",onClick:()=>{e(""),r(""),o("")},children:"Cancel"}),O.jsx("button",{className:"Add-button",onClick:l,disabled:a,children:a?"Adding...":"Add Item"}),O.jsx(av,{})]})]})]})},U9=()=>{const[n,e]=X.useState([]),[t,r]=X.useState(""),[i,o]=X.useState([]),[a,s]=X.useState(!1);X.useEffect(()=>{const c=ec(eg,"inventory"),h=kD(c,d=>{const f=d.val();if(f){const v=Object.keys(f).map(y=>({id:y,...f[y]})).reduce((y,g)=>{const w=y.find(b=>b.name===g.itemsname);return w?w.quantity=parseInt(w.quantity)+parseInt(g.quantity):y.push({name:g.itemsname,quantity:g.quantity,description:g.description}),y},[]);e(v)}else e([])});return()=>h()},[]);const u=()=>{const c=n.find(h=>h.name===t);c?(o([c]),s(!0)):(o([]),s(!1))},l=c=>{const h=i.filter(d=>d.id!==c);o(h),h.length===0&&s(!1)};return ua(ca),gi(),O.jsxs("div",{className:"full",children:[O.jsx(ov,{}),O.jsxs("div",{className:"container",children:[O.jsxs("div",{className:"header",children:[O.jsx("h1",{children:"Inventory Items"}),O.jsx("p",{children:"View and manage your inventory items below"})]}),O.jsxs("div",{className:"display-select",children:[O.jsx("h3",{className:"writeselect",children:"Select :"}),O.jsxs("select",{name:"Items-selection",onChange:c=>r(c.target.value),children:[O.jsx("option",{value:"",children:"Select an Item"}),n.map((c,h)=>O.jsx("option",{value:c.name,children:c.name},h))]}),O.jsx("button",{onClick:u,children:"Display"})]}),a&&O.jsx("div",{className:"table-container",children:O.jsxs("table",{children:[O.jsx("thead",{children:O.jsxs("tr",{children:[O.jsx("th",{children:"Item Name"}),O.jsx("th",{children:"Quantity"}),O.jsx("th",{children:"Description"}),O.jsx("th",{children:"Actions"})]})}),O.jsx("tbody",{children:i.map(c=>O.jsxs("tr",{children:[O.jsx("td",{children:c.name}),O.jsx("td",{children:c.quantity}),O.jsx("td",{children:c.description}),O.jsx("td",{children:O.jsx("div",{className:"action-buttons",children:O.jsx("button",{className:"btn delete",onClick:()=>l(c.id),children:"Remove from Display"})})})]},c.name))})]})})]}),O.jsx(av,{})]})};var MD={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(typeof self<"u"?self:en,()=>(()=>{var t={75:function(a){(function(){var s,u,l,c,h,d;typeof performance<"u"&&performance!==null&&performance.now?a.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(a.exports=function(){return(s()-h)/1e6},u=process.hrtime,c=(s=function(){var f;return 1e9*(f=u())[0]+f[1]})(),d=1e9*process.uptime(),h=c-d):Date.now?(a.exports=function(){return Date.now()-l},l=Date.now()):(a.exports=function(){return new Date().getTime()-l},l=new Date().getTime())}).call(this)},4087:(a,s,u)=>{for(var l=u(75),c=typeof window>"u"?u.g:window,h=["moz","webkit"],d="AnimationFrame",f=c["request"+d],m=c["cancel"+d]||c["cancelRequest"+d],v=0;!f&&v<h.length;v++)f=c[h[v]+"Request"+d],m=c[h[v]+"Cancel"+d]||c[h[v]+"CancelRequest"+d];if(!f||!m){var y=0,g=0,w=[];f=function(b){if(w.length===0){var S=l(),E=Math.max(0,16.666666666666668-(S-y));y=E+S,setTimeout(function(){var T=w.slice(0);w.length=0;for(var _=0;_<T.length;_++)if(!T[_].cancelled)try{T[_].callback(y)}catch(x){setTimeout(function(){throw x},0)}},Math.round(E))}return w.push({handle:++g,callback:b,cancelled:!1}),g},m=function(b){for(var S=0;S<w.length;S++)w[S].handle===b&&(w[S].cancelled=!0)}}a.exports=function(b){return f.call(c,b)},a.exports.cancel=function(){m.apply(c,arguments)},a.exports.polyfill=function(b){b||(b=c),b.requestAnimationFrame=f,b.cancelAnimationFrame=m}}},r={};function i(a){var s=r[a];if(s!==void 0)return s.exports;var u=r[a]={exports:{}};return t[a].call(u.exports,u,u.exports,i),u.exports}i.n=a=>{var s=a&&a.__esModule?()=>a.default:()=>a;return i.d(s,{a:s}),s},i.d=(a,s)=>{for(var u in s)i.o(s,u)&&!i.o(a,u)&&Object.defineProperty(a,u,{enumerable:!0,get:s[u]})},i.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),i.o=(a,s)=>Object.prototype.hasOwnProperty.call(a,s);var o={};return(()=>{i.d(o,{default:()=>W});var a=i(4087),s=i.n(a);const u=function(U){return new RegExp(/<[a-z][\s\S]*>/i).test(U)},l=function(U,j){return Math.floor(Math.random()*(j-U+1))+U};var c="TYPE_CHARACTER",h="REMOVE_CHARACTER",d="REMOVE_ALL",f="REMOVE_LAST_VISIBLE_NODE",m="PAUSE_FOR",v="CALL_FUNCTION",y="ADD_HTML_TAG_ELEMENT",g="CHANGE_DELETE_SPEED",w="CHANGE_DELAY",b="CHANGE_CURSOR",S="PASTE_STRING",E="HTML_TAG";function T(U){return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},T(U)}function _(U,j){var H=Object.keys(U);if(Object.getOwnPropertySymbols){var z=Object.getOwnPropertySymbols(U);j&&(z=z.filter(function(q){return Object.getOwnPropertyDescriptor(U,q).enumerable})),H.push.apply(H,z)}return H}function x(U){for(var j=1;j<arguments.length;j++){var H=arguments[j]!=null?arguments[j]:{};j%2?_(Object(H),!0).forEach(function(z){k(U,z,H[z])}):Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(H)):_(Object(H)).forEach(function(z){Object.defineProperty(U,z,Object.getOwnPropertyDescriptor(H,z))})}return U}function C(U){return function(j){if(Array.isArray(j))return N(j)}(U)||function(j){if(typeof Symbol<"u"&&j[Symbol.iterator]!=null||j["@@iterator"]!=null)return Array.from(j)}(U)||function(j,H){if(j){if(typeof j=="string")return N(j,H);var z=Object.prototype.toString.call(j).slice(8,-1);return z==="Object"&&j.constructor&&(z=j.constructor.name),z==="Map"||z==="Set"?Array.from(j):z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(z)?N(j,H):void 0}}(U)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function N(U,j){(j==null||j>U.length)&&(j=U.length);for(var H=0,z=new Array(j);H<j;H++)z[H]=U[H];return z}function R(U,j){for(var H=0;H<j.length;H++){var z=j[H];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(U,D(z.key),z)}}function k(U,j,H){return(j=D(j))in U?Object.defineProperty(U,j,{value:H,enumerable:!0,configurable:!0,writable:!0}):U[j]=H,U}function D(U){var j=function(H,z){if(T(H)!=="object"||H===null)return H;var q=H[Symbol.toPrimitive];if(q!==void 0){var F=q.call(H,"string");if(T(F)!=="object")return F;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(H)}(U);return T(j)==="symbol"?j:String(j)}const W=function(){function U(z,q){var F=this;if(function(Q,ae){if(!(Q instanceof ae))throw new TypeError("Cannot call a class as a function")}(this,U),k(this,"state",{cursorAnimation:null,lastFrameTime:null,pauseUntil:null,eventQueue:[],eventLoop:null,eventLoopPaused:!1,reverseCalledEvents:[],calledEvents:[],visibleNodes:[],initialOptions:null,elements:{container:null,wrapper:document.createElement("span"),cursor:document.createElement("span")}}),k(this,"options",{strings:null,cursor:"|",delay:"natural",pauseFor:1500,deleteSpeed:"natural",loop:!1,autoStart:!1,devMode:!1,skipAddStyles:!1,wrapperClassName:"Typewriter__wrapper",cursorClassName:"Typewriter__cursor",stringSplitter:null,onCreateTextNode:null,onRemoveNode:null}),k(this,"setupWrapperElement",function(){F.state.elements.container&&(F.state.elements.wrapper.className=F.options.wrapperClassName,F.state.elements.cursor.className=F.options.cursorClassName,F.state.elements.cursor.innerHTML=F.options.cursor,F.state.elements.container.innerHTML="",F.state.elements.container.appendChild(F.state.elements.wrapper),F.state.elements.container.appendChild(F.state.elements.cursor))}),k(this,"start",function(){return F.state.eventLoopPaused=!1,F.runEventLoop(),F}),k(this,"pause",function(){return F.state.eventLoopPaused=!0,F}),k(this,"stop",function(){return F.state.eventLoop&&((0,a.cancel)(F.state.eventLoop),F.state.eventLoop=null),F}),k(this,"pauseFor",function(Q){return F.addEventToQueue(m,{ms:Q}),F}),k(this,"typeOutAllStrings",function(){return typeof F.options.strings=="string"?(F.typeString(F.options.strings).pauseFor(F.options.pauseFor),F):(F.options.strings.forEach(function(Q){F.typeString(Q).pauseFor(F.options.pauseFor).deleteAll(F.options.deleteSpeed)}),F)}),k(this,"typeString",function(Q){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(u(Q))return F.typeOutHTMLString(Q,ae);if(Q){var me=(F.options||{}).stringSplitter,fe=typeof me=="function"?me(Q):Q.split("");F.typeCharacters(fe,ae)}return F}),k(this,"pasteString",function(Q){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return u(Q)?F.typeOutHTMLString(Q,ae,!0):(Q&&F.addEventToQueue(S,{character:Q,node:ae}),F)}),k(this,"typeOutHTMLString",function(Q){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,me=arguments.length>2?arguments[2]:void 0,fe=function(Te){var Ke=document.createElement("div");return Ke.innerHTML=Te,Ke.childNodes}(Q);if(fe.length>0)for(var pe=0;pe<fe.length;pe++){var Ce=fe[pe],Me=Ce.innerHTML;Ce&&Ce.nodeType!==3?(Ce.innerHTML="",F.addEventToQueue(y,{node:Ce,parentNode:ae}),me?F.pasteString(Me,Ce):F.typeString(Me,Ce)):Ce.textContent&&(me?F.pasteString(Ce.textContent,ae):F.typeString(Ce.textContent,ae))}return F}),k(this,"deleteAll",function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"natural";return F.addEventToQueue(d,{speed:Q}),F}),k(this,"changeDeleteSpeed",function(Q){if(!Q)throw new Error("Must provide new delete speed");return F.addEventToQueue(g,{speed:Q}),F}),k(this,"changeDelay",function(Q){if(!Q)throw new Error("Must provide new delay");return F.addEventToQueue(w,{delay:Q}),F}),k(this,"changeCursor",function(Q){if(!Q)throw new Error("Must provide new cursor");return F.addEventToQueue(b,{cursor:Q}),F}),k(this,"deleteChars",function(Q){if(!Q)throw new Error("Must provide amount of characters to delete");for(var ae=0;ae<Q;ae++)F.addEventToQueue(h);return F}),k(this,"callFunction",function(Q,ae){if(!Q||typeof Q!="function")throw new Error("Callback must be a function");return F.addEventToQueue(v,{cb:Q,thisArg:ae}),F}),k(this,"typeCharacters",function(Q){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Q||!Array.isArray(Q))throw new Error("Characters must be an array");return Q.forEach(function(me){F.addEventToQueue(c,{character:me,node:ae})}),F}),k(this,"removeCharacters",function(Q){if(!Q||!Array.isArray(Q))throw new Error("Characters must be an array");return Q.forEach(function(){F.addEventToQueue(h)}),F}),k(this,"addEventToQueue",function(Q,ae){var me=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return F.addEventToStateProperty(Q,ae,me,"eventQueue")}),k(this,"addReverseCalledEvent",function(Q,ae){var me=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return F.options.loop?F.addEventToStateProperty(Q,ae,me,"reverseCalledEvents"):F}),k(this,"addEventToStateProperty",function(Q,ae){var me=arguments.length>2&&arguments[2]!==void 0&&arguments[2],fe=arguments.length>3?arguments[3]:void 0,pe={eventName:Q,eventArgs:ae||{}};return F.state[fe]=me?[pe].concat(C(F.state[fe])):[].concat(C(F.state[fe]),[pe]),F}),k(this,"runEventLoop",function(){F.state.lastFrameTime||(F.state.lastFrameTime=Date.now());var Q=Date.now(),ae=Q-F.state.lastFrameTime;if(!F.state.eventQueue.length){if(!F.options.loop)return;F.state.eventQueue=C(F.state.calledEvents),F.state.calledEvents=[],F.options=x({},F.state.initialOptions)}if(F.state.eventLoop=s()(F.runEventLoop),!F.state.eventLoopPaused){if(F.state.pauseUntil){if(Q<F.state.pauseUntil)return;F.state.pauseUntil=null}var me,fe=C(F.state.eventQueue),pe=fe.shift();if(!(ae<=(me=pe.eventName===f||pe.eventName===h?F.options.deleteSpeed==="natural"?l(40,80):F.options.deleteSpeed:F.options.delay==="natural"?l(120,160):F.options.delay))){var Ce=pe.eventName,Me=pe.eventArgs;switch(F.logInDevMode({currentEvent:pe,state:F.state,delay:me}),Ce){case S:case c:var Te=Me.character,Ke=Me.node,Fe=document.createTextNode(Te),Xe=Fe;F.options.onCreateTextNode&&typeof F.options.onCreateTextNode=="function"&&(Xe=F.options.onCreateTextNode(Te,Fe)),Xe&&(Ke?Ke.appendChild(Xe):F.state.elements.wrapper.appendChild(Xe)),F.state.visibleNodes=[].concat(C(F.state.visibleNodes),[{type:"TEXT_NODE",character:Te,node:Xe}]);break;case h:fe.unshift({eventName:f,eventArgs:{removingCharacterNode:!0}});break;case m:var ze=pe.eventArgs.ms;F.state.pauseUntil=Date.now()+parseInt(ze);break;case v:var Be=pe.eventArgs,dt=Be.cb,nt=Be.thisArg;dt.call(nt,{elements:F.state.elements});break;case y:var rn=pe.eventArgs,Sn=rn.node,Kt=rn.parentNode;Kt?Kt.appendChild(Sn):F.state.elements.wrapper.appendChild(Sn),F.state.visibleNodes=[].concat(C(F.state.visibleNodes),[{type:E,node:Sn,parentNode:Kt||F.state.elements.wrapper}]);break;case d:var pn=F.state.visibleNodes,xt=Me.speed,Ut=[];xt&&Ut.push({eventName:g,eventArgs:{speed:xt,temp:!0}});for(var je=0,Qt=pn.length;je<Qt;je++)Ut.push({eventName:f,eventArgs:{removingCharacterNode:!1}});xt&&Ut.push({eventName:g,eventArgs:{speed:F.options.deleteSpeed,temp:!0}}),fe.unshift.apply(fe,Ut);break;case f:var mt=pe.eventArgs.removingCharacterNode;if(F.state.visibleNodes.length){var Ue=F.state.visibleNodes.pop(),yt=Ue.type,Jt=Ue.node,Wt=Ue.character;F.options.onRemoveNode&&typeof F.options.onRemoveNode=="function"&&F.options.onRemoveNode({node:Jt,character:Wt}),Jt&&Jt.parentNode.removeChild(Jt),yt===E&&mt&&fe.unshift({eventName:f,eventArgs:{}})}break;case g:F.options.deleteSpeed=pe.eventArgs.speed;break;case w:F.options.delay=pe.eventArgs.delay;break;case b:F.options.cursor=pe.eventArgs.cursor,F.state.elements.cursor.innerHTML=pe.eventArgs.cursor}F.options.loop&&(pe.eventName===f||pe.eventArgs&&pe.eventArgs.temp||(F.state.calledEvents=[].concat(C(F.state.calledEvents),[pe]))),F.state.eventQueue=fe,F.state.lastFrameTime=Q}}}),z)if(typeof z=="string"){var oe=document.querySelector(z);if(!oe)throw new Error("Could not find container element");this.state.elements.container=oe}else this.state.elements.container=z;q&&(this.options=x(x({},this.options),q)),this.state.initialOptions=x({},this.options),this.init()}var j,H;return j=U,(H=[{key:"init",value:function(){var z,q;this.setupWrapperElement(),this.addEventToQueue(b,{cursor:this.options.cursor},!0),this.addEventToQueue(d,null,!0),!window||window.___TYPEWRITER_JS_STYLES_ADDED___||this.options.skipAddStyles||(z=".Typewriter__cursor{-webkit-animation:Typewriter-cursor 1s infinite;animation:Typewriter-cursor 1s infinite;margin-left:1px}@-webkit-keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}@keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}",(q=document.createElement("style")).appendChild(document.createTextNode(z)),document.head.appendChild(q),window.___TYPEWRITER_JS_STYLES_ADDED___=!0),this.options.autoStart===!0&&this.options.strings&&this.typeOutAllStrings().start()}},{key:"logInDevMode",value:function(z){this.options.devMode&&console.log(z)}}])&&R(j.prototype,H),Object.defineProperty(j,"prototype",{writable:!1}),U}()})(),o.default})())})(MD);var W9=MD.exports;const LD=F3(W9),V9=()=>{const[n,e]=X.useState(""),[t,r]=X.useState(""),[i,o]=X.useState(!1),a=ua(ca),s=gi();X.useEffect(()=>{new LD("#typewriter",{strings:["Hello👋","Welcome Back😎"],autoStart:!0,loop:!0})},[]);const u=async c=>{c.preventDefault();try{await qV(a,n,t),s("/main")}catch{alert("Email and Password do not match or there was an issue with login")}},l=()=>{o(!i)};return O.jsxs("div",{className:"login-container",children:[O.jsx("div",{className:"type",children:O.jsx("span",{id:"typewriter"})}),O.jsxs("div",{className:"login-box",children:[O.jsx("h2",{children:"Welcome Back"}),O.jsxs("form",{onSubmit:u,children:[O.jsxs("div",{className:"input-group",children:[O.jsx("label",{children:"Email"}),O.jsx("input",{type:"email",placeholder:"Enter your email",value:n,onChange:c=>e(c.target.value),required:!0})]}),O.jsxs("div",{className:"input-group",children:[O.jsx("label",{children:"Password"}),O.jsxs("div",{className:"password-container",children:[O.jsx("input",{type:i?"text":"password",placeholder:"Enter your password",value:t,onChange:c=>r(c.target.value),required:!0}),O.jsx("span",{className:"eye-icon",onClick:l,children:i?"🙈":"👁️"})]})]}),O.jsx("button",{type:"submit",className:"login-btn",children:"Log In"})]}),O.jsx("div",{className:"footer",children:O.jsxs("p",{children:["Don't have an account? ",O.jsx("span",{onClick:()=>s("/signup"),children:"Sign Up"})]})})]})]})},$9=()=>{const[n,e]=X.useState(""),[t,r]=X.useState(""),[i,o]=X.useState(!1),[a,s]=X.useState(""),u=ua(ca),l=gi();function c(f){l(`/${f}`)}X.useEffect(()=>{const f=new LD("#typewriter",{strings:["Hello","Welcome Back"],autoStart:!0,loop:!0});return()=>{f.stop()}},[]);const h=f=>{if(f.preventDefault(),!n||!t){s("Please fill out both fields.");return}GV(u,n,t).then(alert("signup succesfull")).then(l("/"))},d=()=>{o(!i)};return O.jsxs("div",{className:"signup-container",children:[O.jsx("div",{className:"type2",children:O.jsx("span",{id:"typewriter"})}),O.jsxs("div",{className:"signup-box",children:[O.jsx("h2",{children:"Create an Account"}),O.jsxs("form",{onSubmit:h,children:[a&&O.jsx("div",{className:"error-message",children:a}),O.jsxs("div",{className:"input-group",children:[O.jsx("label",{children:"Email"}),O.jsx("input",{type:"email",placeholder:"Enter your email",value:n,onChange:f=>e(f.target.value),required:!0})]}),O.jsxs("div",{className:"input-group",children:[O.jsx("label",{children:"Password"}),O.jsxs("div",{className:"password-container",children:[O.jsx("input",{type:i?"text":"password",placeholder:"Enter your password",value:t,onChange:f=>r(f.target.value),required:!0}),O.jsx("span",{className:"eye-icon",onClick:d,children:i?"🙈":"👁️"})]})]}),O.jsx("button",{type:"submit",className:"signup-btn",children:"Sign Up"})]}),O.jsx("div",{className:"footer",children:O.jsxs("p",{children:["Already have an account? ",O.jsx("span",{onClick:()=>c(""),children:"Log in"})]})})]})]})},H9=()=>{const[n,e]=X.useState([]),[t,r]=X.useState(""),[i,o]=X.useState(""),[a,s]=X.useState("");X.useEffect(()=>{u()},[]);const u=async()=>{try{const c=ec(eg,"inventory"),h=await TD(c);if(h.exists()){const d=h.val(),f=Object.keys(d).map(m=>({id:m,...d[m]}));e(f)}else e([])}catch(c){console.error("Error fetching items:",c)}},l=async c=>{if(c.preventDefault(),s(""),!t||!i){s("Please select an item and enter a quantity.");return}try{const h=n.find(m=>m.id===t);if(!h){s("Selected item not found.");return}if(parseInt(i)>h.quantity){s("Not enough stock to remove.");return}const d=h.quantity-parseInt(i),f=ec(eg,`inventory/${t}`);await f9(f,{quantity:d}),alert(`Updated successfully! Remaining quantity: ${d}`),o(""),u()}catch(h){console.error("Error updating quantity:",h),s("An error occurred while updating the item.")}};return O.jsxs("div",{className:"retrieve-update-container",children:[O.jsx(ov,{}),O.jsx("h1",{children:"Retrieve and Update Items"}),O.jsxs("form",{onSubmit:l,className:"retrieve-update-form",children:[O.jsxs("div",{className:"form-group",children:[O.jsx("label",{children:"Select Item:"}),O.jsxs("select",{value:t,onChange:c=>r(c.target.value),required:!0,children:[O.jsx("option",{value:"",children:"-- Select an Item --"}),n.map(c=>O.jsx("option",{value:c.id,children:c.itemsname},c.id))]})]}),O.jsxs("div",{className:"form-group",children:[O.jsx("label",{children:"Quantity to Remove:"}),O.jsx("input",{type:"number",value:i,onChange:c=>o(c.target.value),min:"1",required:!0})]}),a&&O.jsx("p",{className:"error",children:a}),O.jsx("button",{type:"submit",className:"update-btn",children:"Remove Quantity"})]}),O.jsx("h2",{children:"Current Items"}),O.jsxs("table",{className:"items-table",children:[O.jsx("thead",{children:O.jsxs("tr",{children:[O.jsx("th",{children:"Name"}),O.jsx("th",{children:"Quantity"}),O.jsx("th",{children:"Description"})]})}),O.jsx("tbody",{children:n.map(c=>O.jsxs("tr",{children:[O.jsx("td",{children:c.itemsname}),O.jsx("td",{children:c.quantity}),O.jsx("td",{children:c.description})]},c.id))})]}),O.jsx(av,{})]})};var FD={},Wx={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zD=function(n,e){return(zD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])})(n,e)};function Hi(n,e){function t(){this.constructor=n}zD(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Ie(n,e,t,r){return new(t||(t=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(c){o(c)}}function s(l){try{u(r.throw(l))}catch(c){o(c)}}function u(l){l.done?i(l.value):new t(function(c){c(l.value)}).then(a,s)}u((r=r.apply(n,[])).next())})}function Ne(n,e){var t,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){a.label=c[1];break}if(c[0]===6&&a.label<i[1]){a.label=i[1],i=c;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(n,a)}catch(h){c=[6,h],r=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var BD=function(){function n(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return n.prototype.setPlatform=function(e,t){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},n.prototype.registerFlag=function(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){var i=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+i+"."),this.set(e,i)}},n.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},n.prototype.getNumber=function(e){return this.get(e)},n.prototype.getBool=function(e){return this.get(e)},n.prototype.getFlags=function(){return this.flags},Object.defineProperty(n.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),n.prototype.set=function(e,t){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)},n.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},n.prototype.setFlags=function(e){this.flags=Object.assign({},e)},n.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},n.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var t,r,i=(t=this.global.location.search,r={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(o){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return function(u,l,c){u[decodeURIComponent(l)]=decodeURIComponent(c||"")}(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach(function(o){var a=o.split(":"),s=a[0],u=a[1];e.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},n}();function te(){return Vx}var Vx=null,tc=new Map;function jD(n,e){var t=$x(n,e);return tc.get(t)}function Z1(n){for(var e=tc.entries(),t=[];;){var r=e.next(),i=r.done,o=r.value;if(i)break;var a=o[0],s=o[1];a.split("_")[0]===n&&t.push(s)}return t}function ew(n){var e=n.kernelName,t=n.backendName,r=$x(e,t);if(tc.has(r))throw new Error("The kernel '"+e+"' for backend '"+t+"' is already registered");tc.set(r,n)}function G9(n,e){var t=$x(n,e);if(!tc.has(t))throw new Error("The kernel '"+n+"' for backend '"+e+"' is not registered");tc.delete(t)}function $x(n,e){return e+"_"+n}function PI(n){for(var e=n.length,t=0,r=0;e>0;)r=Math.random()*e|0,t=n[--e],n[e]=n[r],n[r]=t}function tg(n,e,t){return Math.max(n,Math.min(e,t))}function Hx(n){return n%2==0?n:n+1}function UD(n){for(var e=0,t=0;t<n.length;t++)e+=n[t];return e}function B(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function pt(n,e,t){t===void 0&&(t=""),B(jn(n,e),function(){return t+" Shapes "+n+" and "+e+" must match"})}function Bu(n){B(n!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function ra(n,e,t){if(e===void 0&&(e=[]),t===void 0&&(t=!1),e==null&&(e=[]),Array.isArray(n)||Kn(n)&&!t)for(var r=0;r<n.length;++r)ra(n[r],e,t);else e.push(n);return e}function Ae(n){if(n.length===0)return 1;for(var e=n[0],t=1;t<n.length;t++)e*=n[t];return e}function jn(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function dn(n){return n%1==0}function WD(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;var e=Math.exp(2*n);return(e-1)/(e+1)}function ng(n){var e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function lu(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function tw(n,e,t){return e===void 0&&(e=function(r){return 0}),new Promise(function(r,i){var o=0,a=function(){if(n())r();else{var s=e(++o);t!=null&&o>=t?i():setTimeout(a,s)}};a()})}function VD(n,e){for(var t=1,r=-1,i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(n[i]<0)throw Error("Shapes can not be < 0. Found "+n[i]+" at dim "+i);if(r===-1){if(e>0&&e!==t)throw Error("Size("+e+") must match the product of shape "+n);return n}if(t===0)throw Error("Cannot infer the missing size in ["+n+"] when there are 0 elements");if(e%t!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+t);var o=n.slice();return o[r]=e/t,o}function Wn(n,e){var t=e.length;return B((n=n==null?e.map(function(r,i){return i}):[].concat(n)).every(function(r){return r>=-t&&r<t}),function(){return"All values in axis param must be in range [-"+t+", "+t+") but got axis "+n}),B(n.every(function(r){return dn(r)}),function(){return"All values in axis param must be integers but got axis "+n}),n.map(function(r){return r<0?t+r:r})}function Ba(n,e){for(var t=[],r=[],i=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||i?null:Wn(e,n).sort(),a=0,s=0;s<n.length;++s){if(o!=null){if(o[a]===s&&n[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+n[s]+"' is not 1");(o[a]==null||o[a]>s)&&n[s]===1&&(t.push(n[s]),r.push(s)),o[a]<=s&&a++}n[s]!==1&&(t.push(n[s]),r.push(s))}return{newShape:t,keptDims:r}}function _d(n,e){var t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else{if(n!=="bool")throw new Error("Unknown data type "+n);t=new Uint8Array(e)}return t}function Ed(n,e){var t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else{if(n!=="string")throw new Error("Unknown data type "+n);t=new Array(e)}return t}function $D(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function HD(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function GD(n,e){return e!=="complex64"&&(e!=="float32"||n==="complex64")&&(e!=="int32"||n==="float32"||n==="complex64")&&(e!=="bool"||n!=="bool")}function Kn(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array}function Gx(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error("Unknown dtype "+n)}function qD(n){if(n==null)return 0;var e=0;return n.forEach(function(t){return e+=t.length}),e}function Va(n){return typeof n=="string"||n instanceof String}function KD(n){return typeof n=="boolean"}function XD(n){return typeof n=="number"}function Ic(n){return Array.isArray(n)?Ic(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array?"int32":XD(n)?"float32":Va(n)?"string":KD(n)?"bool":"float32"}function ms(n){return!!(n&&n.constructor&&n.call&&n.apply)}function rg(n,e){for(var t=e;t<n;++t)if(n%t==0)return t;return n}function Ns(n){var e=n.length;if(e<2)return[];var t=new Array(e-1);t[e-2]=n[e-1];for(var r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function qx(n,e,t){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=ra(n)),t&&$D(n,e),function(o,a){return o instanceof Float32Array&&a==="float32"||o instanceof Int32Array&&a==="int32"||o instanceof Uint8Array&&a==="bool"}(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){for(var r=new Uint8Array(n.length),i=0;i<r.length;++i)Math.round(n[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function nw(n,e){if(n.length===0)return e[0];var t=n.reduce(function(r,i){return r*i});if(t===0)return[];if(t!==e.length)throw new Error("["+n+"] does not match the input size.");return function r(i,o,a){var s=new Array;if(o.length===1)for(var u=o[0],l=0;l<u;l++)s[l]=a[i+l];else{u=o[0];var c=o.slice(1),h=c.reduce(function(d,f){return d*f});for(l=0;l<u;l++)s[l]=r(i+l*h,c,a)}return s}(0,n,e)}function Kx(n,e){for(var t=Nc(n,e),r=0;r<t.length;r++)t[r]=1;return t}function Nc(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error("Unknown data type "+e)}function Si(){return te().platform.now()}function Xx(n){n.forEach(function(e){B(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+n+"]."})})}function YD(n,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",te().platform.encode(n,e)}function Cd(n,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",te().platform.decode(n,e)}var De=Object.freeze({shuffle:PI,clamp:tg,nearestLargerEven:Hx,sum:UD,randUniform:function(n,e){var t=Math.random();return e*t+(1-t)*n},distSquared:function(n,e){for(var t=0,r=0;r<n.length;r++){var i=Number(n[r])-Number(e[r]);t+=i*i}return t},assert:B,assertShapesMatch:pt,assertNonNull:Bu,flatten:ra,sizeFromShape:Ae,isScalarShape:function(n){return n.length===0},arraysEqual:jn,isInt:dn,tanh:WD,sizeToSquarishShape:ng,createShuffledIndices:function(n){for(var e=new Uint32Array(n),t=0;t<n;++t)e[t]=t;return PI(e),e},rightPad:lu,repeatedTry:tw,inferFromImplicitShape:VD,parseAxisParam:Wn,squeezeShape:Ba,getTypedArrayFromDType:_d,getArrayFromDType:Ed,checkConversionForErrors:$D,isValidDtype:HD,hasEncodingLoss:GD,isTypedArray:Kn,bytesPerElement:Gx,bytesFromStringArray:qD,isString:Va,isBoolean:KD,isNumber:XD,inferDtype:Ic,isFunction:ms,nearestDivisor:rg,computeStrides:Ns,toTypedArray:qx,toNestedArray:nw,makeOnesTypedArray:Kx,makeZerosTypedArray:Nc,now:Si,assertNonNegativeIntegerDimensions:Xx,fetch:function(n,e){return te().platform.fetch(n,e)},encodeString:YD,decodeString:Cd}),q9=function(){function n(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new K9)}return n.prototype.profileKernel=function(e,t,r){var i,o=this,a=this.backendTimer.time(function(){i=r()});return i.forEach(function(s){s.data().then(function(u){(function(l,c,h){if(c!=="float32")return!1;for(var d=0;d<l.length;d++){var f=l[d];if(isNaN(f)||!isFinite(f))return console.warn("Found "+f+" in the result of '"+h+"'"),!0}})(u,s.dtype,e),a.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),o.logger.logKernelProfile(e,s,u,l.kernelMs,t,c)})})}),i},n}(),K9=function(){function n(){}return n.prototype.logKernelProfile=function(e,t,r,i,o,a){var s=lu(i+"ms",9),u=lu(e,25),l=t.rank,c=t.size,h=lu(t.shape.toString(),14),d="";for(var f in o){var m=o[f].shape,v=m.length;d+=f+": "+v+"D "+(v>0?m:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+h+"	%c"+c+"	%c"+d+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},n}(),MI=20,sh=3,i0=7;function X9(n,e,t,r){var i=Ns(e),o=function(l,c,h,d){var f=Ae(c),m=d[d.length-1],v=new Array(m).fill(0),y=c.length,g=h==="complex64"?lh(l):l;if(y>1)for(var w=0;w<f/m;w++)for(var b=w*m,S=0;S<m;S++)v[S]=Math.max(v[S],uh(g[b+S],0,h).length);return v}(n,e,t,i),a=e.length,s=function l(c,h,d,f,m,v){v===void 0&&(v=!0);var y=d==="complex64"?2:1,g=h[0],w=h.length;if(w===0){if(d==="complex64"){var b=lh(c);return[uh(b[0],0,d)]}return d==="bool"?[QD(c[0])]:[c[0].toString()]}if(w===1){if(g>MI){var S=sh*y,E=Array.from(c.slice(0,S)),T=Array.from(c.slice(g-sh*y,g));return d==="complex64"&&(E=lh(E),T=lh(T)),["["+E.map(function(H,z){return uh(H,m[z],d)}).join(", ")+", ..., "+T.map(function(H,z){return uh(H,m[g-sh+z],d)}).join(", ")+"]"]}var _=d==="complex64"?lh(c):Array.from(c);return["["+_.map(function(H,z){return uh(H,m[z],d)}).join(", ")+"]"]}var x=h.slice(1),C=f.slice(1),N=f[0]*y,R=[];if(g>MI){for(var k=0;k<sh;k++){var D=k*N,W=D+N;R.push.apply(R,l(c.slice(D,W),x,d,C,m,!1))}R.push("...");for(var k=g-sh;k<g;k++){var D=k*N,W=D+N;R.push.apply(R,l(c.slice(D,W),x,d,C,m,k===g-1))}}else for(var k=0;k<g;k++){var D=k*N,W=D+N;R.push.apply(R,l(c.slice(D,W),x,d,C,m,k===g-1))}var U=w===2?",":"";R[0]="["+R[0]+U;for(var k=1;k<R.length-1;k++)R[k]=" "+R[k]+U;for(var j=`,
`,k=2;k<w;k++)j+=`
`;return R[R.length-1]=" "+R[R.length-1]+"]"+(v?"":j),R}(n,e,t,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+t),u.push("  rank: "+a),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function uh(n,e,t){return lu(Array.isArray(n)?parseFloat(n[0].toFixed(i0))+" + "+parseFloat(n[1].toFixed(i0))+"j":Va(n)?"'"+n+"'":t==="bool"?QD(n):parseFloat(n.toFixed(i0)).toString(),e)}function QD(n){return n===0?"false":"true"}function lh(n){for(var e=[],t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}var nc=function(){function n(e,t,r){var i=this;if(this.dtype=t,this.shape=e.slice(),this.size=Ae(e),r!=null){var o=r.length;B(o===this.size,function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+i.size+"'."})}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Ed(t,this.size),this.strides=Ns(e)}return n.prototype.set=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),B(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+t.rank+")"});var o=this.locToIndex(r);this.values[o]=e},n.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length===0&&(e=[0]);for(var r=0,i=0,o=e;i<o.length;i++){var a=o[i];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=e[e.length-1],l=0;l<e.length-1;++l)u+=this.strides[l]*e[l];return this.values[u]},n.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var t=e[e.length-1],r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t},n.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var t=new Array(this.shape.length),r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.toTensor=function(){return to().makeTensor(this.values,this.shape,this.dtype)},n}(),to=null,ne=null,JD=null,Nt=function(){function n(e,t,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ae(e),this.strides=Ns(e),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return n.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},n.prototype.asScalar=function(){return this.throwIfDisposed(),B(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},n.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},n.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},n.prototype.as3D=function(e,t,r){return this.throwIfDisposed(),this.reshape([e,t,r])},n.prototype.as4D=function(e,t,r,i){return this.throwIfDisposed(),this.reshape([e,t,r,i])},n.prototype.as5D=function(e,t,r,i,o){return this.throwIfDisposed(),this.reshape([e,t,r,i,o])},n.prototype.asType=function(e){return this.throwIfDisposed(),ne.cast(this,e)},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.buffer=function(){return Ie(this,void 0,void 0,function(){var e;return Ne(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,ne.buffer(this.shape,this.dtype,e)]}})})},n.prototype.bufferSync=function(){return ne.buffer(this.shape,this.dtype,this.dataSync())},n.prototype.array=function(){return Ie(this,void 0,void 0,function(){var e;return Ne(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,nw(this.shape,e)]}})})},n.prototype.arraySync=function(){return nw(this.shape,this.dataSync())},n.prototype.data=function(){return Ie(this,void 0,void 0,function(){var e,t;return Ne(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),e=to().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:t=r.sent();try{return[2,t.map(function(i){return Cd(i)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,e]}})})},n.prototype.dataSync=function(){this.throwIfDisposed();var e=to().readSync(this.dataId);if(this.dtype==="string")try{return e.map(function(t){return Cd(t)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},n.prototype.bytes=function(){return Ie(this,void 0,void 0,function(){var e;return Ne(this,function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,to().read(this.dataId)];case 1:return e=t.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}})})},n.prototype.dispose=function(){this.isDisposed||(to().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(n.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),n.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},n.prototype.toFloat=function(){return this.asType("float32")},n.prototype.toInt=function(){return this.asType("int32")},n.prototype.toBool=function(){return this.asType("bool")},n.prototype.print=function(e){return e===void 0&&(e=!1),ne.print(this,e)},n.prototype.reshape=function(e){return this.throwIfDisposed(),ne.reshape(this,e)},n.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},n.prototype.expandDims=function(e){return e===void 0&&(e=0),ne.expandDims(this,e)},n.prototype.cumsum=function(e,t,r){return e===void 0&&(e=0),t===void 0&&(t=!1),r===void 0&&(r=!1),ne.cumsum(this,e,t,r)},n.prototype.squeeze=function(e){return this.throwIfDisposed(),ne.squeeze(this,e)},n.prototype.clone=function(){return this.throwIfDisposed(),ne.clone(this)},n.prototype.oneHot=function(e,t,r){return this.throwIfDisposed(),ne.oneHot(this,e,t,r)},n.prototype.toString=function(e){return e===void 0&&(e=!1),X9(this.dataSync(),this.shape,this.dtype,e)},n.prototype.tile=function(e){return this.throwIfDisposed(),ne.tile(this,e)},n.prototype.gather=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),ne.gather(this,e,t)},n.prototype.matMul=function(e,t,r){return t===void 0&&(t=!1),r===void 0&&(r=!1),this.throwIfDisposed(),ne.matMul(this,e,t,r)},n.prototype.dot=function(e){return this.throwIfDisposed(),ne.dot(this,e)},n.prototype.norm=function(e,t,r){return e===void 0&&(e="euclidean"),t===void 0&&(t=null),r===void 0&&(r=!1),this.throwIfDisposed(),ne.norm(this,e,t,r)},n.prototype.slice=function(e,t){return this.throwIfDisposed(),ne.slice(this,e,t)},n.prototype.reverse=function(e){return this.throwIfDisposed(),ne.reverse(this,e)},n.prototype.concat=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),e instanceof n&&(e=[e]),ne.concat([this].concat(e),t)},n.prototype.split=function(e,t){return t===void 0&&(t=0),this.throwIfDisposed(),ne.split(this,e,t)},n.prototype.stack=function(e,t){return t===void 0&&(t=0),ne.stack([this,e],t)},n.prototype.unstack=function(e){return e===void 0&&(e=0),ne.unstack(this,e)},n.prototype.pad=function(e,t){return t===void 0&&(t=0),ne.pad(this,e,t)},n.prototype.batchNormalization=function(e,t,r,i,o){return r===void 0&&(r=.001),JD("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,o,i,r)},n.prototype.batchNorm=function(e,t,r,i,o){return o===void 0&&(o=.001),this.throwIfDisposed(),ne.batchNorm(this,e,t,r,i,o)},n.prototype.all=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ne.all(this,e,t)},n.prototype.any=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ne.any(this,e,t)},n.prototype.logSumExp=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ne.logSumExp(this,e,t)},n.prototype.sum=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ne.sum(this,e,t)},n.prototype.prod=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ne.prod(this,e,t)},n.prototype.mean=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ne.mean(this,e,t)},n.prototype.min=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ne.min(this,e,t)},n.prototype.max=function(e,t){return e===void 0&&(e=null),t===void 0&&(t=!1),this.throwIfDisposed(),ne.max(this,e,t)},n.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),ne.argMin(this,e)},n.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),ne.argMax(this,e)},n.prototype.cast=function(e){return this.throwIfDisposed(),ne.cast(this,e)},n.prototype.add=function(e){return this.throwIfDisposed(),ne.add(this,e)},n.prototype.addStrict=function(e){return this.throwIfDisposed(),ne.addStrict(this,e)},n.prototype.atan2=function(e){return this.throwIfDisposed(),ne.atan2(this,e)},n.prototype.sub=function(e){return this.throwIfDisposed(),ne.sub(this,e)},n.prototype.subStrict=function(e){return this.throwIfDisposed(),ne.subStrict(this,e)},n.prototype.pow=function(e){return this.throwIfDisposed(),ne.pow(this,e)},n.prototype.powStrict=function(e){return this.throwIfDisposed(),ne.powStrict(this,e)},n.prototype.mul=function(e){return this.throwIfDisposed(),ne.mul(this,e)},n.prototype.mulStrict=function(e){return this.throwIfDisposed(),ne.mulStrict(this,e)},n.prototype.div=function(e){return this.throwIfDisposed(),ne.div(this,e)},n.prototype.floorDiv=function(e){return this.throwIfDisposed(),ne.floorDiv(this,e)},n.prototype.divStrict=function(e){return this.throwIfDisposed(),ne.divStrict(this,e)},n.prototype.minimum=function(e){return this.throwIfDisposed(),ne.minimum(this,e)},n.prototype.minimumStrict=function(e){return this.throwIfDisposed(),ne.minimumStrict(this,e)},n.prototype.maximum=function(e){return this.throwIfDisposed(),ne.maximum(this,e)},n.prototype.maximumStrict=function(e){return this.throwIfDisposed(),ne.maximumStrict(this,e)},n.prototype.mod=function(e){return this.throwIfDisposed(),ne.mod(this,e)},n.prototype.modStrict=function(e){return this.throwIfDisposed(),ne.modStrict(this,e)},n.prototype.squaredDifference=function(e){return this.throwIfDisposed(),ne.squaredDifference(this,e)},n.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),ne.squaredDifferenceStrict(this,e)},n.prototype.transpose=function(e){return this.throwIfDisposed(),ne.transpose(this,e)},n.prototype.notEqual=function(e){return this.throwIfDisposed(),ne.notEqual(this,e)},n.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),ne.notEqualStrict(this,e)},n.prototype.less=function(e){return this.throwIfDisposed(),ne.less(this,e)},n.prototype.lessStrict=function(e){return this.throwIfDisposed(),ne.lessStrict(this,e)},n.prototype.equal=function(e){return this.throwIfDisposed(),ne.equal(this,e)},n.prototype.equalStrict=function(e){return this.throwIfDisposed(),ne.equalStrict(this,e)},n.prototype.lessEqual=function(e){return this.throwIfDisposed(),ne.lessEqual(this,e)},n.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),ne.lessEqualStrict(this,e)},n.prototype.greater=function(e){return this.throwIfDisposed(),ne.greater(this,e)},n.prototype.greaterStrict=function(e){return this.throwIfDisposed(),ne.greaterStrict(this,e)},n.prototype.greaterEqual=function(e){return this.throwIfDisposed(),ne.greaterEqual(this,e)},n.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),ne.greaterEqualStrict(this,e)},n.prototype.logicalAnd=function(e){return this.throwIfDisposed(),ne.logicalAnd(this,e)},n.prototype.logicalOr=function(e){return this.throwIfDisposed(),ne.logicalOr(this,e)},n.prototype.logicalNot=function(){return this.throwIfDisposed(),ne.logicalNot(this)},n.prototype.logicalXor=function(e){return this.throwIfDisposed(),ne.logicalXor(this,e)},n.prototype.where=function(e,t){return this.throwIfDisposed(),ne.where(e,this,t)},n.prototype.neg=function(){return this.throwIfDisposed(),ne.neg(this)},n.prototype.ceil=function(){return this.throwIfDisposed(),ne.ceil(this)},n.prototype.floor=function(){return this.throwIfDisposed(),ne.floor(this)},n.prototype.sign=function(){return this.throwIfDisposed(),ne.sign(this)},n.prototype.isNaN=function(){return this.throwIfDisposed(),ne.isNaN(this)},n.prototype.isInf=function(){return this.throwIfDisposed(),ne.isInf(this)},n.prototype.isFinite=function(){return this.throwIfDisposed(),ne.isFinite(this)},n.prototype.exp=function(){return this.throwIfDisposed(),ne.exp(this)},n.prototype.expm1=function(){return this.throwIfDisposed(),ne.expm1(this)},n.prototype.log=function(){return this.throwIfDisposed(),ne.log(this)},n.prototype.log1p=function(){return this.throwIfDisposed(),ne.log1p(this)},n.prototype.sqrt=function(){return this.throwIfDisposed(),ne.sqrt(this)},n.prototype.rsqrt=function(){return this.throwIfDisposed(),ne.rsqrt(this)},n.prototype.square=function(){return this.throwIfDisposed(),ne.square(this)},n.prototype.reciprocal=function(){return this.throwIfDisposed(),ne.reciprocal(this)},n.prototype.abs=function(){return this.throwIfDisposed(),ne.abs(this)},n.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),ne.clipByValue(this,e,t)},n.prototype.relu=function(){return this.throwIfDisposed(),ne.relu(this)},n.prototype.relu6=function(){return this.throwIfDisposed(),ne.relu6(this)},n.prototype.elu=function(){return this.throwIfDisposed(),ne.elu(this)},n.prototype.selu=function(){return this.throwIfDisposed(),ne.selu(this)},n.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),ne.leakyRelu(this,e)},n.prototype.prelu=function(e){return this.throwIfDisposed(),ne.prelu(this,e)},n.prototype.sigmoid=function(){return this.throwIfDisposed(),ne.sigmoid(this)},n.prototype.logSigmoid=function(){return this.throwIfDisposed(),ne.logSigmoid(this)},n.prototype.softplus=function(){return this.throwIfDisposed(),ne.softplus(this)},n.prototype.zerosLike=function(){return this.throwIfDisposed(),ne.zerosLike(this)},n.prototype.onesLike=function(){return this.throwIfDisposed(),ne.onesLike(this)},n.prototype.sin=function(){return this.throwIfDisposed(),ne.sin(this)},n.prototype.cos=function(){return this.throwIfDisposed(),ne.cos(this)},n.prototype.tan=function(){return this.throwIfDisposed(),ne.tan(this)},n.prototype.asin=function(){return this.throwIfDisposed(),ne.asin(this)},n.prototype.acos=function(){return this.throwIfDisposed(),ne.acos(this)},n.prototype.atan=function(){return this.throwIfDisposed(),ne.atan(this)},n.prototype.sinh=function(){return this.throwIfDisposed(),ne.sinh(this)},n.prototype.cosh=function(){return this.throwIfDisposed(),ne.cosh(this)},n.prototype.tanh=function(){return this.throwIfDisposed(),ne.tanh(this)},n.prototype.asinh=function(){return this.throwIfDisposed(),ne.asinh(this)},n.prototype.acosh=function(){return this.throwIfDisposed(),ne.acosh(this)},n.prototype.atanh=function(){return this.throwIfDisposed(),ne.atanh(this)},n.prototype.erf=function(){return this.throwIfDisposed(),ne.erf(this)},n.prototype.round=function(){return this.throwIfDisposed(),ne.round(this)},n.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),ne.step(this,e)},n.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),ne.softmax(this,e)},n.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),ne.logSoftmax(this,e)},n.prototype.resizeBilinear=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),ne.image.resizeBilinear(this,e,t)},n.prototype.resizeNearestNeighbor=function(e,t){return t===void 0&&(t=!1),this.throwIfDisposed(),ne.image.resizeNearestNeighbor(this,e,t)},n.prototype.conv1d=function(e,t,r,i,o,a){return i===void 0&&(i="NWC"),o===void 0&&(o=1),this.throwIfDisposed(),ne.conv1d(this,e,t,r,i,o,a)},n.prototype.conv2d=function(e,t,r,i,o,a){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),ne.conv2d(this,e,t,r,i,o,a)},n.prototype.conv2dTranspose=function(e,t,r,i,o){return this.throwIfDisposed(),ne.conv2dTranspose(this,e,t,r,i,o)},n.prototype.depthwiseConv2D=function(e,t,r,i,o,a){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),ne.depthwiseConv2d(this,e,t,r,i,o,a)},n.prototype.separableConv2d=function(e,t,r,i,o,a){return o===void 0&&(o=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),ne.separableConv2d(this,e,t,r,i,o,a)},n.prototype.avgPool=function(e,t,r,i){return this.throwIfDisposed(),ne.avgPool(this,e,t,r,i)},n.prototype.maxPool=function(e,t,r,i){return this.throwIfDisposed(),ne.maxPool(this,e,t,r,i)},n.prototype.localResponseNormalization=function(e,t,r,i){return e===void 0&&(e=5),t===void 0&&(t=1),r===void 0&&(r=1),i===void 0&&(i=.5),ne.localResponseNormalization(this,e,t,r,i)},n.prototype.pool=function(e,t,r,i,o){return this.throwIfDisposed(),ne.pool(this,e,t,r,i,o)},n.prototype.variable=function(e,t,r){return e===void 0&&(e=!0),this.throwIfDisposed(),to().makeVariable(this,e,t,r)},n.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),ne.unsortedSegmentSum(this,e,t)},n.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),ne.batchToSpaceND(this,e,t)},n.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),ne.spaceToBatchND(this,e,t)},n.prototype.topk=function(e,t){return e===void 0&&(e=1),t===void 0&&(t=!0),this.throwIfDisposed(),ne.topk(this,e,t)},n.prototype.stridedSlice=function(e,t,r,i,o,a,s,u){return i===void 0&&(i=0),o===void 0&&(o=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),ne.stridedSlice(this,e,t,r,i,o,a,s,u)},n.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),ne.depthToSpace(this,e,t)},n.prototype.fft=function(){return this.throwIfDisposed(),ne.spectral.fft(this)},n.prototype.ifft=function(){return this.throwIfDisposed(),ne.spectral.ifft(this)},n.prototype.rfft=function(){return this.throwIfDisposed(),ne.spectral.rfft(this)},n.prototype.irfft=function(){return this.throwIfDisposed(),ne.spectral.irfft(this)},n}();Object.defineProperty(Nt,Symbol.hasInstance,{value:function(n){return!!n&&n.dataId!=null&&n.shape!=null&&n.dtype!=null}});var rw,iw,ow,aw,sw,Sd=function(n){function e(t,r,i,o){var a=n.call(this,t.shape,t.dtype,t.dataId,o)||this;return a.trainable=r,a.name=i,a}return Hi(e,n),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!jn(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");to().disposeTensor(this),this.dataId=t.dataId,to().incRef(this,null)},e.prototype.dispose=function(){to().disposeVariable(this),this.isDisposedInternal=!0},e}(Nt);Object.defineProperty(Sd,Symbol.hasInstance,{value:function(n){return n instanceof Nt&&n.assign!=null&&n.assign instanceof Function}}),function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"}(rw||(rw={})),function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"}(iw||(iw={})),function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"}(ow||(ow={})),function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"}(aw||(aw={})),function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"}(sw||(sw={}));var Y9={float32:aw,int32:iw,bool:ow,complex64:sw};function wn(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error("Can not upcast "+n+" with "+e)}return Y9[n][e]}function o0(n){return wn(n,"int32")}function fn(n,e){if(n.dtype===e.dtype)return[n,e];var t=wn(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function ZD(n,e){B(n.dtype===e.dtype,function(){return"The dtypes of the first("+n.dtype+") and second("+e.dtype+") input must match"})}function Yx(n){var e=[];return function t(r,i,o){if(r!=null){if(r instanceof Nt)return void i.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var l=s[u];o.has(l)||(o.add(l),t(l,i,o))}}}}(n,e,new Set),e}var a0,co=Object.freeze({makeTypesMatch:fn,assertTypesMatch:ZD,isTensorInList:function(n,e){for(var t=0;t<e.length;t++)if(e[t].id===n.id)return!0;return!1},getTensorsInContainer:Yx}),LI=function(){function n(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return n.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},n}(),Q9=function(){function n(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new LI}return n.prototype.ready=function(){return Ie(this,void 0,void 0,function(){var e,t,r;return Ne(this,function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),t=0,i.label=1;case 1:return t<e.length?(r=e[t],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(n.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),n.prototype.backendNames=function(){return Object.keys(this.registryFactory)},n.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},n.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},n.prototype.registerBackend=function(e,t,r){return r===void 0&&(r=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:r},!0)},n.prototype.setBackend=function(e){return Ie(this,void 0,void 0,function(){var t,r,i;return Ne(this,function(o){switch(o.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),r=t.success,t.asyncInit?[4,r]:[3,2]);case 1:return i=o.sent(),[3,3];case 2:i=r,o.label=3;case 3:if(!i)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new q9(this.backendInstance),[2,!0]}})})},n.prototype.setupRegisteredKernels=function(){var e=this;Z1(this.backendName).forEach(function(t){t.setupFunc!=null&&t.setupFunc(e.backendInstance)})},n.prototype.disposeRegisteredKernels=function(e){var t=this;Z1(e).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(t.registry[e])})},n.prototype.initializeBackend=function(e){var t=this,r=this.registryFactory[e];if(r==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var o=++this.pendingBackendInitId,a=i.then(function(s){return!(o<t.pendingBackendInitId)&&(t.registry[e]=s,t.pendingBackendInit=null,!0)}).catch(function(s){return!(o<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[e]=i,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},n.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},n.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(t,r){return e.registryFactory[r].priority-e.registryFactory[t].priority})},n.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var r=e[t],i=this.initializeBackend(r),o=i.success,a=i.asyncInit;if(a||o)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},n.prototype.moveData=function(e,t){var r=this.state.tensorInfo.get(t),i=r.backend,o=this.readSync(t);i.disposeData(t),r.backend=e,e.move(t,o,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},n.prototype.tidy=function(e,t){var r,i=this,o=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}return this.scopedRun(function(){return i.startScope(o)},function(){return i.endScope(r)},function(){return(r=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},n.prototype.scopedRun=function(e,t,r){e();try{var i=r();return t(),i}catch(o){throw t(),o}},n.prototype.nextTensorId=function(){return n.nextTensorId++},n.prototype.nextVariableId=function(){return n.nextVariableId++},n.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),r={x:e};return this.addTapeNode(this.state.activeScope.name,r,[t],function(i){return{x:function(){return i.toFloat()}}},[]),t},n.prototype.runKernel=function(e,t,r,i,o){return this.runKernelFunc(null,t,null,e,r,i,o)},n.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},n.prototype.checkKernelForMemLeak=function(e,t,r){var i=this.backend.numDataIds(),o=0;r.forEach(function(u){o+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=i-t-o-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+e+"'")},n.prototype.runKernelFunc=function(e,t,r,i,o,a,s){var u,l=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var c,h=[],d=this.isTapeOn(),f=this.state.activeScope!=null?this.state.activeScope.name:"",m=function(b){d&&(h=b.map(function(S){return l.keep(l.clone(S))}))},v=this.state.numBytes,y=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,w=jD(i,this.backendName);return c=w!=null?function(){var b=l.backend.numDataIds();g=w.kernelFunc({inputs:t,attrs:o,backend:l.backend});var S=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(f,b,S);var E=S.map(function(_){var x=_.dataId,C=_.shape,N=_.dtype;return l.makeTensorFromDataId(x,C,N)}),T=E.filter(function(_,x){return s[x]});return m(a.slice().concat(T)),E}:function(){var b=l.backend.numDataIds();g=l.tidy(function(){return e(l.backend,m)});var S=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(f,b,S),S},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(f,t,function(){return c()}):c()}),d&&this.addTapeNode(f,t,u,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:f,bytesAdded:this.state.numBytes-v,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-y,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map(function(b){return t[b].shape}),outputShapes:u.map(function(b){return b.shape})}),Array.isArray(g)?u:u[0]},n.prototype.makeTensor=function(e,t,r,i){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var o=e;r==="string"&&Va(e[0])&&(o=e.map(function(c){return YD(c)}));var a=i.write(o,t,r),s=new Nt(t,r,a,this.nextTensorId());if(this.incRef(s,i),r==="string"){var u=this.state.tensorInfo.get(a),l=qD(o);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},n.prototype.makeTensorFromDataId=function(e,t,r,i){var o=new Nt(t,r=r||"float32",e,this.nextTensorId());return this.incRef(o,i),o},n.prototype.makeVariable=function(e,t,r,i){t===void 0&&(t=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==e.dtype&&(e=e.asType(i));var o=new Sd(e,t,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},n.prototype.incRef=function(e,t){var r=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(i=e.size*Gx(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Sd||this.track(e)},n.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},n.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},n.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},n.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},n.prototype.profile=function(e){return Ie(this,void 0,void 0,function(){var t,r;return Ne(this,function(i){return this.state.profiling=!0,t=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(o){return o.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},n.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},n.prototype.addTapeNode=function(e,t,r,i,o){var a=this,s={id:this.state.nextTapeNodeId++,name:e,inputs:t,outputs:r,saved:o};i!=null&&(s.gradient=function(u){return u=u.map(function(l,c){if(l==null){var h=r[c],d=Nc(h.size,h.dtype);return a.makeTensor(d,h.shape,h.dtype)}return l}),i(u.length>1?u:u[0],o)}),this.state.activeTape.push(s)},n.prototype.keep=function(e){return e.kept=!0,e},n.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},n.prototype.endTape=function(){this.state.gradientDepth--},n.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},n.prototype.endScope=function(e){for(var t=this,r=Yx(e),i=new Set(r.map(function(u){return u.id})),o=0;o<this.state.activeScope.track.length;o++){var a=this.state.activeScope.track[o];a.kept||i.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||t.track(u)})},n.prototype.gradients=function(e,t,r,i){var o=this;if(i===void 0&&(i=!1),B(t.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return o.startTape()},function(){return o.endTape()},function(){return o.tidy("forward",e)});B(a instanceof Nt,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var h={},d={},f=0;f<l.length;f++)h[l[f].id]=!0;for(f=0;f<u.length;f++){var m=(T=u[f]).inputs;for(var v in m){for(var y=m[v],g=!1,w=0;w<l.length;w++)if(h[y.id]){T.outputs.forEach(function(N){return h[N.id]=!0}),g=!0,d[T.id]=!0;break}if(g)break}}var b={};b[c.id]=!0;var S={};for(f=u.length-1;f>=0;f--)for(m=(T=u[f]).inputs,w=0;w<T.outputs.length;w++)if(b[T.outputs[w].id]){for(var v in m)b[m[v].id]=!0,S[T.id]=!0;break}var E=[];for(f=0;f<u.length;f++){var T;if(d[(T=u[f]).id]&&S[T.id]){var _={};for(var v in T.inputs){var x=T.inputs[v];h[x.id]&&(_[v]=x)}var C=Object.assign({},T);C.inputs=_,C.outputs=T.outputs,E.push(C)}}return E}(this.state.activeTape,t,a);if(!i&&s.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[a.id]=r??(u=a.shape,l=Kx(Ae(u),"float32"),V.makeTensor(l,u,"float32")),function(d,f,m){for(var v=function(g){var w=f[g],b=[];if(w.outputs.forEach(function(_){var x=d[_.id];x!=null?b.push(x):b.push(null)}),w.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+w.name+".");var S=w.gradient(b),E=function(_){if(!(_ in S))throw new Error("Cannot backprop through input "+_+". Available gradients found: "+Object.keys(S)+".");var x=m(function(){return S[_]()});if(x.dtype!=="float32")throw new Error("Error in gradient for op "+w.name+". The gradient of input "+_+" must have 'float32' dtype, but has '"+x.dtype+"'");var C=w.inputs[_];if(!jn(x.shape,C.shape))throw new Error("Error in gradient for op "+w.name+". The gradient of input '"+_+"' has shape '"+x.shape+"', which does not match the shape of the input '"+C.shape+"'");if(d[C.id]==null)d[C.id]=x;else{var N=d[C.id];d[C.id]=N.add(x),N.dispose()}};for(var T in w.inputs)E(T)},y=f.length-1;y>=0;y--)v(y)}(c,s,function(d){return o.tidy(d)});var h=t.map(function(d){return c[d.id]});return o.state.gradientDepth===0&&(o.state.activeTape.forEach(function(d){for(var f in d.saved)d.saved[f].dispose()}),o.state.activeTape=null),{value:a,grads:h}})},n.prototype.customGrad=function(e){var t=this;return B(ms(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];B(i.every(function(s){return s instanceof Nt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return i.forEach(function(s,u){a[u]=s}),t.runKernelFunc(function(s,u){return B((r=e.apply(void 0,i.concat([u]))).value instanceof Nt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),B(ms(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];B(c.length===i.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),B(c.every(function(d){return d instanceof Nt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var h={};return c.forEach(function(d,f){h[f]=function(){return d}}),h})}},n.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},n.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},n.prototype.fromPixels=function(e,t){return this.backend.fromPixels(e,t)},n.prototype.time=function(e){return Ie(this,void 0,void 0,function(){var t,r;return Ne(this,function(i){switch(i.label){case 0:return t=Si(),[4,this.backend.time(e)];case 1:return(r=i.sent()).wallMs=Si()-t,[2,r]}})})},n.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(n.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),n.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new LI,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},n.nextTensorId=0,n.nextVariableId=0,n}(),V=function(){var n=function(){if(a0==null){var t=void 0;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else{if(typeof self>"u")throw new Error("Could not find a global object");t=self}a0=t}return a0}();if(n._tfengine==null){var e=new BD(n);n._tfengine=new Q9(e)}return function(t){Vx=t}(n._tfengine.ENV),to=function(){return n._tfengine},n._tfengine}();function eO(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var To=te();To.registerFlag("DEBUG",function(){return!1},function(n){n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),To.registerFlag("IS_BROWSER",function(){return eO()}),To.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),To.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),To.registerFlag("PROD",function(){return!1}),To.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return To.getBool("DEBUG")}),To.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),To.registerFlag("IS_TEST",function(){return!1});var Id,Wr,jr,$s={},s0={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function tO(n,e){$s[n]=e}function vo(n){n in $s||($s[n]=function(t){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=nO(t);return r.addEventListener("webglcontextlost",function(i){i.preventDefault(),delete $s[t]},!1),t===1?r.getContext("webgl",s0)||r.getContext("experimental-webgl",s0):r.getContext("webgl2",s0)}(n));var e=$s[n];return e.isContextLost()?(delete $s[n],vo(n)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),$s[n])}function nO(n){if(typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function sv(n,e){return[e,n]}function Wh(n){var e=Ae(n);return ng(Math.ceil(e/4))}function of(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function Qx(n,e){var t,r,i,o,a,s,u,l,c,h=n;return te().getNumber("WEBGL_VERSION")===2?(t=h.R32F,r=h.R16F,i=h.RGBA16F,o=h.RGBA32F,a=h.RED,s=4,u=1,l=h.HALF_FLOAT,c=h.FLOAT):(t=n.RGBA,r=n.RGBA,i=n.RGBA,o=h.RGBA,a=n.RGBA,s=4,u=4,l=e!=null?e.HALF_FLOAT_OES:null,c=n.FLOAT),{internalFormatFloat:t,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:n.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function _e(n,e,t){var r=t();return e&&function(i){var o=i.getError();if(o!==i.NO_ERROR)throw new Error("WebGL Error: "+iO(i,o))}(n),r}(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(Id||(Id={})),function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"}(Wr||(Wr={})),function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(jr||(jr={}));var J9=596e-10,Z9=65504;function rO(n){return!!(te().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||J9<Math.abs(n)&&Math.abs(n)<Z9)}function iO(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function Gp(n,e,t){return ha(n,e,function(){return n.getExtension(t)},'Extension "'+t+'" not supported on this browser.')}function oO(n,e,t){var r=ha(n,e,function(){return n.createShader(n.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(_e(n,e,function(){return n.shaderSource(r,t)}),_e(n,e,function(){return n.compileShader(r)}),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function aO(n,e,t){var r=ha(n,e,function(){return n.createShader(n.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(_e(n,e,function(){return n.shaderSource(r,t)}),_e(n,e,function(){return n.compileShader(r)}),n.getShaderParameter(r,n.COMPILE_STATUS)===!1)throw function(i,o){var a=eG.exec(o);if(a==null)return console.log("Couldn't parse line number in error: "+o),void console.log(i);for(var s=+a[1],u=i.split(`
`),l=u.length.toString().length+2,c=u.map(function(y,g){return lu((g+1).toString(),l)+y}),h=0,d=0;d<c.length;d++)h=Math.max(c[d].length,h);var f=c.slice(0,s-1),m=c.slice(s-1,s),v=c.slice(s);console.log(f.join(`
`)),console.log(o.split(`
`)[0]),console.log("%c "+lu(m[0],h),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(v.join(`
`))}(t,n.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var qp,Kp,eG=/ERROR: [0-9]+:([0-9]+):/g;function sO(n,e){return ha(n,e,function(){return n.createProgram()},"Unable to create WebGLProgram.")}function uO(n,e,t){if(_e(n,e,function(){return n.linkProgram(t)}),n.getProgramParameter(t,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function Xp(n,e,t){if(_e(n,e,function(){return n.validateProgram(t)}),n.getProgramParameter(t,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function lO(n,e,t){var r=ha(n,e,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return _e(n,e,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),_e(n,e,function(){return n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)}),r}function cO(n,e,t){var r=ha(n,e,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return _e(n,e,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r)}),_e(n,e,function(){return n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)}),r}function hO(n,e){return ha(n,e,function(){return n.createTexture()},"Unable to create WebGLTexture.")}function dO(n,e){var t=te().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){var r="["+n+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t)throw r="["+n+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+t+"x"+t+"]")+".")}function fO(n,e){return ha(n,e,function(){return n.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function uw(n,e,t,r,i,o,a,s){var u=n.getAttribLocation(t,r);return u!==-1&&(_e(n,e,function(){return n.bindBuffer(n.ARRAY_BUFFER,i)}),_e(n,e,function(){return n.vertexAttribPointer(u,o,n.FLOAT,!1,a,s)}),_e(n,e,function(){return n.enableVertexAttribArray(u)}),!0)}function pO(n,e,t,r){wO(n,r),_e(n,e,function(){return n.activeTexture(n.TEXTURE0+r)}),_e(n,e,function(){return n.bindTexture(n.TEXTURE_2D,t)})}function mO(n,e,t,r){return ha(n,e,function(){return n.getUniformLocation(t,r)},'uniform "'+r+'" not present in program.')}function gO(n,e,t){return n.getUniformLocation(e,t)}function vO(n,e,t,r,i,o){_e(n,e,function(){return pO(n,e,r,o)}),_e(n,e,function(){return n.uniform1i(i,o)})}function Yp(n,e,t,r){_e(n,e,function(){return n.bindFramebuffer(n.FRAMEBUFFER,r)}),_e(n,e,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0)})}function lw(n,e,t){_e(n,e,function(){return n.bindFramebuffer(n.FRAMEBUFFER,t)}),_e(n,e,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0)})}function bh(n){var e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+yO(n,e))}function yO(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function ha(n,e,t,r){var i=_e(n,e,function(){return t()});if(i==null)throw new Error(r);return i}function wO(n,e){var t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+t+"]")+".")}function Nd(n,e){return e===void 0&&(e=2),Ae(n.slice(0,n.length-e))}function Td(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Qp(n){var e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Nd(n)].concat(Td(n))),e}function bO(n,e){var t;e===void 0&&(e=!1);var r=te().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,(n=n.map(function(l,c){return c>=n.length-2?Hx(n[c]):n[c]})).length===1&&(n=[2,n[0]])),n.length!==2){var i=Ba(n);n=i.newShape}var o=Ae(n);if(n.length<=1&&o<=r)return[1,o];if(n.length===2&&n[0]<=r&&n[1]<=r)return n;if(n.length===3&&n[0]*n[1]<=r&&n[2]<=r)return[n[0]*n[1],n[2]];if(n.length===3&&n[0]<=r&&n[1]*n[2]<=r)return[n[0],n[1]*n[2]];if(n.length===4&&n[0]*n[1]*n[2]<=r&&n[3]<=r)return[n[0]*n[1]*n[2],n[3]];if(n.length===4&&n[0]<=r&&n[1]*n[2]*n[3]<=r)return[n[0],n[1]*n[2]*n[3]];if(e){var a=Nd(n),s=2,u=2;return n.length&&(s=(t=Td(n))[0],u=t[1]),ng(o=a*(s/2)*(u/2)).map(function(l){return 2*l})}return ng(o)}function dp(n){return n%2==0}function xh(n,e){if(jn(n=n.slice(-2),e=e.slice(-2))||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){var t=n.slice(-1)[0],r=e.slice(-1)[0];if(t===r||dp(t)&&dp(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&dp(n[0])&&dp(e[0])}function xO(n){if(qp==null){var e=vo(n);qp=e.getParameter(e.MAX_TEXTURE_SIZE)}return qp}function _O(n){if(Kp==null){var e=vo(n);Kp=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Kp)}function EO(n){if(n===0)return 0;var e=vo(n);return Ai(e,"EXT_disjoint_timer_query_webgl2")&&n===2?2:Ai(e,"EXT_disjoint_timer_query")?1:0}function Ai(n,e){return n.getExtension(e)!=null}function cw(n){try{if(vo(n)!=null)return!0}catch{return!1}return!1}function CO(n){if(n===0)return!1;var e=vo(n);if(n===1){if(!Ai(e,"OES_texture_float"))return!1}else if(!Ai(e,"EXT_color_buffer_float"))return!1;return hw(e)}function SO(n){if(n===0)return!1;var e=vo(n);if(n!==1){if(Ai(e,"EXT_color_buffer_float"))return hw(e);if(Ai(e,"EXT_color_buffer_half_float")){var t=e.getExtension("EXT_color_buffer_half_float");return function(r,i){var o=Qx(r,i),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,o.internalFormatHalfFloat,1,1,0,o.textureFormatFloat,o.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(e,t)}return!1}return!!Ai(e,"OES_texture_float")&&!!Ai(e,"WEBGL_color_buffer_float")&&hw(e)}function hw(n){var e=Qx(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);var i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(r),i}function IO(n){return n===2&&vo(n).fenceSync!=null}var tG=Object.freeze({callAndCheck:_e,canBeRepresented:rO,getWebGLErrorMessage:iO,getExtensionOrThrow:Gp,createVertexShader:oO,createFragmentShader:aO,createProgram:sO,linkProgram:uO,validateProgram:Xp,createStaticVertexBuffer:lO,createStaticIndexBuffer:cO,getNumChannels:function(){return te().getNumber("WEBGL_VERSION")===2?1:4},createTexture:hO,validateTextureSize:dO,createFramebuffer:fO,bindVertexBufferToProgramAttribute:uw,bindTextureUnit:pO,unbindTextureUnit:function(n,e,t){wO(n,t),_e(n,e,function(){return n.activeTexture(n.TEXTURE0+t)}),_e(n,e,function(){return n.bindTexture(n.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:mO,getProgramUniformLocation:gO,bindTextureToProgramUniformSampler:vO,bindCanvasToFramebuffer:function(n,e){_e(n,e,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),_e(n,e,function(){return n.viewport(0,0,n.canvas.width,n.canvas.height)}),_e(n,e,function(){return n.scissor(0,0,n.canvas.width,n.canvas.height)})},bindColorTextureToFramebuffer:Yp,unbindColorTextureFromFramebuffer:lw,validateFramebuffer:bh,getFramebufferErrorMessage:yO,getBatchDim:Nd,getRowsCols:Td,getShapeAs3D:Qp,getTextureShapeFromLogicalShape:bO,isReshapeFree:xh,getWebGLMaxTextureSize:xO,resetMaxTextureSize:function(){qp=null},resetMaxTexturesInShader:function(){Kp=null},getMaxTexturesInShader:_O,getWebGLDisjointQueryTimerVersion:EO,hasExtension:Ai,isWebGLVersionEnabled:cw,isCapableOfRenderingToFloatTexture:CO,isDownloadFloatTextureEnabled:SO,isWebGLFenceEnabled:IO}),Ve=te();function nG(){te().set("PROD",!0)}function rG(){te().set("DEBUG",!0)}function iG(){te().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function uv(n){te().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function oG(){V.disposeVariables()}function aG(){return V}function dw(){return V.memory()}function sG(n){return V.profile(n)}function Z(n,e){return V.tidy(n,e)}function Ze(n){Yx(n).forEach(function(e){return e.dispose()})}function ho(n){return V.keep(n)}function uG(n){return V.time(n)}function lG(n){return V.setBackend(n)}function cG(){return V.ready()}function hG(){return V.backendName}function dG(n){V.removeBackend(n)}function fG(n){return V.findBackend(n)}function pG(n){return V.findBackendFactory(n)}function mG(n,e,t){return t===void 0&&(t=1),V.registerBackend(n,e,t)}function NO(){return V.backend}function gG(n,e){te().setPlatform(n,e)}function fw(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];te().getBool("IS_TEST")||console.warn.apply(console,n)}function fo(n,e){var t=n;if(Kn(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];for(var r=[];Array.isArray(t)||Kn(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&te().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function i(o,a,s){if(s=s||[],!Array.isArray(o)&&!Kn(o))return void B(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});B(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+o.length+" elements"}),B(o.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+o.length+" elements"});for(var u=a.slice(1),l=0;l<o.length;++l)i(o[l],u,s.concat(l))}(n,r,[]),r}function FI(n,e,t,r){if(n!=null&&(n!=="numeric"&&n!==e||n==="numeric"&&e==="string"))throw new Error("Argument '"+t+"' passed to '"+r+"' must be "+n+" tensor, but got "+e+" tensor")}function L(n,e,t,r){if(r===void 0&&(r="numeric"),n instanceof Nt)return FI(r,n.dtype,e,t),n;var i=Ic(n);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),FI(r,i,e,t),n==null||!Kn(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){var o=n==null?"null":n.constructor.name;throw new Error("Argument '"+e+"' passed to '"+t+"' must be a Tensor or TensorLike, but got '"+o+"'")}var a=fo(n,i);Kn(n)||Array.isArray(n)||(n=[n]);var s=i!=="string"?qx(n,i,te().getBool("DEBUG")):ra(n,[],!0);return V.makeTensor(s,a,i)}function kd(n,e,t,r){if(r===void 0&&(r="numeric"),!Array.isArray(n))throw new Error("Argument "+e+" passed to "+t+" must be a `Tensor[]` or `TensorLike[]`");return n.map(function(i,o){return L(i,e+"["+o+"]",t)},r)}function Jx(n,e){for(var t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function TO(n,e,t){for(var r=n.length+e.length,i=[],o=0,a=0,s=0;s<r;s++)t.indexOf(s)===-1?i.push(n[o++]):i.push(e[a++]);return i}function Gn(n,e){for(var t=[],r=n.length,i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);return[t,e.map(function(o){return n[o]})]}function Kr(n,e){return TO(n,e.map(function(t){return 1}),e)}function Cr(n,e,t){B(Jx(e,t),function(){return n+" supports only inner-most axes for now. Got axes "+e+" and rank-"+t+" input."})}function Gi(n,e){if(Jx(n,e))return null;for(var t=[],r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(function(i){return t.push(i)}),t}function lv(n){return n.map(function(e,t){return[t,e]}).sort(function(e,t){return e[1]-t[1]}).map(function(e){return e[0]})}function qi(n,e){for(var t=[],r=e-n;r<e;++r)t.push(r);return t}function kO(n,e){var t=n[0].length;n.forEach(function(i,o){B(i.length===t,function(){return"Error in concat"+t+"D: rank of tensors["+o+"] must be the same as the rank of the rest ("+t+")"})}),B(e>=0&&e<t,function(){return"Error in concat"+t+"D: axis must be between 0 and "+(t-1)+"."});var r=n[0];n.forEach(function(i,o){for(var a=0;a<t;a++)B(a===e||i[a]===r[a],function(){return"Error in concat"+t+"D: Shape of tensors["+o+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."})})}function Su(n,e){for(var t=n[0].slice(),r=1;r<n.length;r++)t[e]+=n[r][e];return t}function $(n){var e=Object.keys(n);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var t=e[0],r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1));var i=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];V.startScope(t);try{var s=r.apply(void 0,o);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),V.endScope(s),s}catch(u){throw V.endScope(null),u}};return Object.defineProperty(i,"name",{value:t,configurable:!0}),i}Ve.registerFlag("HAS_WEBGL",function(){return Ve.getNumber("WEBGL_VERSION")>0}),Ve.registerFlag("WEBGL_VERSION",function(){return cw(2)?2:cw(1)?1:0}),Ve.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Ve.get("WEBGL_VERSION")===2}),Ve.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Ve.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Ve.registerFlag("WEBGL_PACK",function(){return Ve.getBool("HAS_WEBGL")}),Ve.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Ve.getBool("WEBGL_PACK")}),Ve.registerFlag("WEBGL_PACK_CLIP",function(){return Ve.getBool("WEBGL_PACK")}),Ve.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Ve.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Ve.getBool("WEBGL_PACK")}),Ve.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Ve.getBool("WEBGL_PACK")}),Ve.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Ve.getBool("WEBGL_PACK")}),Ve.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Ve.getBool("WEBGL_PACK")}),Ve.registerFlag("WEBGL_PACK_REDUCE",function(){return Ve.getBool("WEBGL_PACK")}),Ve.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Ve.getBool("WEBGL_PACK")}),Ve.registerFlag("WEBGL_CONV_IM2COL",function(){return Ve.getBool("WEBGL_PACK")}),Ve.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return xO(Ve.getNumber("WEBGL_VERSION"))}),Ve.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return _O(Ve.getNumber("WEBGL_VERSION"))}),Ve.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var n=Ve.getNumber("WEBGL_VERSION");return n===0?0:EO(n)}),Ve.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Ve.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(n=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))));var n}),Ve.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return CO(Ve.getNumber("WEBGL_VERSION"))}),Ve.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Ve.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ve.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Ve.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return SO(Ve.getNumber("WEBGL_VERSION"))}),Ve.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return IO(Ve.getNumber("WEBGL_VERSION"))}),Ve.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Ve.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),JD=uv;var Tn=$({complex_:function(n,e){var t=L(n,"real","complex"),r=L(e,"imag","complex");return pt(t.shape,r.shape,"real and imag shapes, "+t.shape+" and "+r.shape+", must match in call to tf.complex()."),V.runKernelFunc(function(i){return i.complex(t,r)},{$real:t,$imag:r})}}),Ir=$({real_:function(n){var e=L(n,"input","real");return V.runKernelFunc(function(t){return t.real(e)},{$input:e})}}),li=$({imag_:function(n){var e=L(n,"input","imag");return V.runKernelFunc(function(t){return t.imag(e)},{$input:e})}});function gn(n,e,t){return Ts(n,e,fo(n,t),t)}function Ts(n,e,t,r){if(r==null&&(r=Ic(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Kn(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Xx(e);var i=Ae(e),o=Ae(t);B(i===o,function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o});for(var a=0;a<t.length;++a){var s=t[a],u=a!==t.length-1||s!==Ae(e.slice(a));B(t[a]===e[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+t+") does not match the provided shape ("+e+"). "})}}return Kn(n)||Array.isArray(n)||(n=[n]),e=e||t,n=r!=="string"?qx(n,r,te().getBool("DEBUG")):ra(n,[],!0),V.makeTensor(n,e,r)}function Ee(n,e){if((Kn(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Kn(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ts(n,[],[],e)}function Or(n,e){Bu(n);var t=fo(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ts(n,null,t,e)}function Go(n,e,t){if(Bu(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=fo(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ts(n,e,r,t)}function Zx(n,e,t){if(Bu(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=fo(n,t);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ts(n,e,r,t)}function Aa(n,e,t){if(Bu(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=fo(n,t);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ts(n,e,r,t)}function RO(n,e,t){if(Bu(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=fo(n,t);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ts(n,e,r,t)}function AO(n,e,t){if(Bu(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=fo(n,t);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Ts(n,e=e||r,r,t)}function e_(n,e,t,r){return e===void 0&&(e=!0),V.makeVariable(n,e,t,r)}function yo(n,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=yo(n,"float32"),r=St(n,"float32");return Tn(t,r)}var i=Kx(Ae(n),e);return V.makeTensor(i,n,e)}function St(n,e){if(e===void 0&&(e="float32"),e==="complex64"){var t=St(n,"float32"),r=St(n,"float32");return Tn(t,r)}var i=Nc(Ae(n),e);return V.makeTensor(i,n,e)}function Tc(n,e,t){return V.runKernelFunc(function(r){return r.fill(n,e,t)},{})}function t_(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");return V.runKernelFunc(function(r){return r.linspace(n,e,t)},{})}function cv(n,e,t,r){if(t===void 0&&(t=1),r===void 0&&(r="float32"),t===0)throw new Error("Cannot have a step of zero");if(n===e||n<e&&t<0||e<n&&t>1)return St([0],r);var i=Nc(Math.abs(Math.ceil((e-n)/t)),r);e<n&&t===1&&(t=-1),i[0]=n;for(var o=1;o<i.length;o++)i[o]=i[o-1]+t;return Or(i,r)}var Xr=$({onesLike_:function(n){var e=L(n,"x","onesLike");if(e.dtype==="complex64"){var t=Xr(Ir(e)),r=ct(li(e));return Tn(t,r)}return V.runKernelFunc(function(i){return i.onesLike(e)},{$x:e},function(i,o){return{$x:function(){return ct(i)}}})}}),ct=$({zerosLike_:function(n){var e=L(n,"x","zerosLike");return V.runKernelFunc(function(t){return t.zerosLike(e)},{$x:e},function(t,r){return{$x:function(){return ct(t)}}})}}),ar=$({concat_:function(n,e){e===void 0&&(e=0),B(n.length>=1,function(){return"Pass at least one tensor to concat"});var t=kd(n,"tensors","concat");t[0].dtype==="complex64"&&t.forEach(function(a){if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+a.dtype+". ")}),e=Wn(e,t[0].shape)[0];var r=Su(t.map(function(a){return a.shape}),e);if(Ae(r)===0)return gn([],r);if((t=t.filter(function(a){return a.size>0})).length===1)return t[0];var i=t.map(function(a){return a.shape});kO(i,e);var o=t;return V.runKernelFunc(function(a){return a.concat(t,e)},o,function(a){var s=i.map(function(u){return u[e]});return qo(a,s,e).map(function(u){return function(){return u}})})}}),n_=$({concat1d_:function(n){return ar(n,0)}}),r_=$({concat2d_:function(n,e){return ar(n,e)}}),i_=$({concat3d_:function(n,e){return ar(n,e)}}),o_=$({concat4d_:function(n,e){return ar(n,e)}}),qo=$({split_:function(n,e,t){t===void 0&&(t=0);var r,i=L(n,"x","split");return t=Wn(t,i.shape)[0],typeof e=="number"?(B(i.shape[t]%e==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(e).fill(i.shape[t]/e)):(B(i.shape[t]===e.reduce(function(o,a){return o+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=e),V.runKernelFunc(function(o){return o.split(i,r,t)},{$x:i},function(o){return{$x:function(){return ar(o,t)}}})}});function ju(n,e){return n(e={exports:{}},e.exports),e.exports}var vG=ju(function(n){(function(e,t,r){function i(s){var u,l=this,c=(u=4022871197,function(h){h=h.toString();for(var d=0;d<h.length;d++){var f=.02519603282416938*(u+=h.charCodeAt(d));f-=u=f>>>0,u=(f*=u)>>>0,u+=4294967296*(f-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var h=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=h-(l.c=0|h)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function o(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var l=new i(s),c=u&&u.state,h=l.next;return h.int32=function(){return 4294967296*l.next()|0},h.double=function(){return h()+11102230246251565e-32*(2097152*h()|0)},h.quick=h,c&&(typeof c=="object"&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.alea=a})(0,n)}),yG=ju(function(n){(function(e,t,r){function i(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var h=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^h^h>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function o(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new i(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},h.int32=l.next,h.quick=h,c&&(typeof c=="object"&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.xor128=a})(0,n)}),wG=ju(function(n){(function(e,t,r){function i(s){var u=this,l="";u.next=function(){var h=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^h^h<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new i(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},h.int32=l.next,h.quick=h,c&&(typeof c=="object"&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.xorwow=a})(0,n)}),bG=ju(function(n){(function(e,t,r){function i(s){var u=this;u.next=function(){var l,c,h=u.x,d=u.i;return l=h[d],c=(l^=l>>>7)^l<<24,c^=(l=h[d+1&7])^l>>>10,c^=(l=h[d+3&7])^l>>>3,c^=(l=h[d+4&7])^l<<7,l=h[d+7&7],c^=(l^=l<<13)^l<<9,h[d]=c,u.i=d+1&7,c},function(l,c){var h,d=[];if(c===(0|c))d[0]=c;else for(c=""+c,h=0;h<c.length;++h)d[7&h]=d[7&h]<<15^c.charCodeAt(h)+d[h+1&7]<<13;for(;d.length<8;)d.push(0);for(h=0;h<8&&d[h]===0;++h);for(h==8?d[7]=-1:d[h],l.x=d,l.i=0,h=256;h>0;--h)l.next()}(u,s)}function o(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},h.int32=l.next,h.quick=h,c&&(c.x&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.xorshift7=a})(0,n)}),xG=ju(function(n){(function(e,t,r){function i(s){var u=this;u.next=function(){var l,c,h=u.w,d=u.X,f=u.i;return u.w=h=h+1640531527|0,c=d[f+34&127],l=d[f=f+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=d[f]=c^l,u.i=f,c+(h^h>>>16)|0},function(l,c){var h,d,f,m,v,y=[],g=128;for(c===(0|c)?(d=c,c=null):(c+="\0",d=0,g=Math.max(g,c.length)),f=0,m=-32;m<g;++m)c&&(d^=c.charCodeAt((m+32)%c.length)),m===0&&(v=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,m>=0&&(v=v+1640531527|0,f=(h=y[127&m]^=d+v)==0?f+1:0);for(f>=128&&(y[127&(c&&c.length||0)]=-1),f=127,m=512;m>0;--m)d=y[f+34&127],h=y[f=f+1&127],d^=d<<13,h^=h<<17,d^=d>>>15,h^=h>>>12,y[f]=d^h;l.w=v,l.X=y,l.i=f}(u,s)}function o(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},h.int32=l.next,h.quick=h,c&&(c.X&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.xor4096=a})(0,n)}),_G=ju(function(n){(function(e,t,r){function i(s){var u=this,l="";u.next=function(){var h=u.b,d=u.c,f=u.d,m=u.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^m,m=m-h|0,u.b=h=h<<20^h>>>12^d,u.c=d=d-f|0,u.d=f<<16^d>>>16^m,u.a=m-h|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function o(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new i(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},h.int32=l.next,h.quick=h,c&&(typeof c=="object"&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.tychei=a})(0,n)}),Hs=ju(function(n){(function(e,t){var r,i=this,o=256,a=6,s="random",u=t.pow(o,a),l=t.pow(2,52),c=2*l,h=o-1;function d(g,w,b){var S=[],E=v(function x(C,N){var R,k=[],D=typeof C;if(N&&D=="object")for(R in C)try{k.push(x(C[R],N-1))}catch{}return k.length?k:D=="string"?C:C+"\0"}((w=w==1?{entropy:!0}:w||{}).entropy?[g,y(e)]:g??function(){try{var x;return r&&(x=r.randomBytes)?x=x(o):(x=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(x)),y(x)}catch{var C=i.navigator,N=C&&C.plugins;return[+new Date,i,N,i.screen,y(e)]}}(),3),S),T=new f(S),_=function(){for(var x=T.g(a),C=u,N=0;x<l;)x=(x+N)*o,C*=o,N=T.g(1);for(;x>=c;)x/=2,C/=2,N>>>=1;return(x+N)/C};return _.int32=function(){return 0|T.g(4)},_.quick=function(){return T.g(4)/4294967296},_.double=_,v(y(T.S),e),(w.pass||b||function(x,C,N,R){return R&&(R.S&&m(R,T),x.state=function(){return m(T,{})}),N?(t[s]=x,C):x})(_,E,"global"in w?w.global:this==t,w.state)}function f(g){var w,b=g.length,S=this,E=0,T=S.i=S.j=0,_=S.S=[];for(b||(g=[b++]);E<o;)_[E]=E++;for(E=0;E<o;E++)_[E]=_[T=h&T+g[E%b]+(w=_[E])],_[T]=w;(S.g=function(x){for(var C,N=0,R=S.i,k=S.j,D=S.S;x--;)C=D[R=h&R+1],N=N*o+D[h&(D[R]=D[k=h&k+C])+(D[k]=C)];return S.i=R,S.j=k,N})(o)}function m(g,w){return w.i=g.i,w.j=g.j,w.S=g.S.slice(),w}function v(g,w){for(var b,S=g+"",E=0;E<S.length;)w[h&E]=h&(b^=19*w[h&E])+S.charCodeAt(E++);return y(w)}function y(g){return String.fromCharCode.apply(0,g)}if(t["seed"+s]=d,v(t.random(),e),n.exports){n.exports=d;try{r=require("crypto")}catch{}}})([],Math)});Hs.alea=vG,Hs.xor128=yG,Hs.xorwow=wG,Hs.xorshift7=bG,Hs.xor4096=xG,Hs.tychei=_G;var hv=Hs.alea,a_=function(){function n(e,t,r,i,o){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=o||Math.random();this.random=hv(a.toString())}return n.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,r,i=!1;!i;){var o=void 0,a=void 0,s=void 0;do s=(o=2*this.random()-1)*o+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);t=this.mean+this.stdDev*o*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(t)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(t)},n.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},n.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},n}(),EG=function(){function n(e,t,r,i){this.alpha=e,this.beta=1/t,this.dtype=r;var o=i||Math.random();this.randu=hv(o.toString()),this.randn=new a_(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return n.prototype.nextValue=function(){for(var e,t,r,i,o,a;;){do i=this.randn.nextValue(),a=1+this.c*i;while(a<=0);if(a*=a*a,t=1-.331*(e=i*i)*e,r=.5*e+this.d*(1-a+Math.log(a)),(o=this.randu())<t||Math.log(o)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},n.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},n}(),CG=function(){function n(e,t,r,i){var o=this;if(e===void 0&&(e=0),t===void 0&&(t=1),this.canReturnFloat=function(){return o.dtype==null||o.dtype==="float32"},this.min=e,this.range=t-e,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=hv(i)}return n.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},n.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},n}();function qe(n,e,t){return e===void 0&&(e="float32"),e=e||"float32",Xx(n),new nc(n,e,t)}function DO(n,e){e===void 0&&(e=!1),console.log(n.toString(e))}var dv=$({batchToSpaceND_:function(n,e,t){var r=L(n,"x","batchToSpaceND"),i=e.reduce(function(o,a){return o*a});return B(r.rank>=1+e.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length}),B(t.length===e.length,function(){return"crops.length is "+t.length+" but should be equal to blockShape.length  "+e.length}),B(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i}),V.runKernelFunc(function(o){return o.batchToSpaceND(r,e,t)},{$x:r},function(o){return{$x:function(){return o.spaceToBatchND(e,t)}}})}}),fv=$({cast_:function(n,e){var t=L(n,"x","cast");if(!HD(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:e};return V.runKernelFunc(function(i){return i.cast(t,e)},{x:t},function(i){return{x:function(){return i.clone()}}},"Cast",r)}}),OO=$({clone_:function(n){var e=L(n,"x","clone",null);return V.runKernelFunc(function(){return V.makeTensorFromDataId(e.dataId,e.shape,e.dtype)},{$x:e},function(t){return{$x:function(){return t.toFloat()}}})}}),PO=$({cumsum_:function(n,e,t,r){e===void 0&&(e=0),t===void 0&&(t=!1),r===void 0&&(r=!1);var i=L(n,"x","cumsum"),o=Gi([e|=0],i.rank),a=i;o!=null&&(a=i.transpose(o));var s=qi(1,i.rank)[0],u=V.runKernelFunc(function(l){return l.cumsum(a,s,t,r)},{permutedX:a},function(l){return{permutedX:function(){return l.cumsum(e,t,!r)}}});return o!=null&&(u=u.transpose(o)),u}}),s_=$({depthToSpace_:function(n,e,t){t===void 0&&(t="NHWC");var r=L(n,"x","depthToSpace"),i=t==="NHWC"?r.shape[1]:r.shape[2],o=t==="NHWC"?r.shape[2]:r.shape[3],a=t==="NHWC"?r.shape[3]:r.shape[1];return B(i*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+`  for depthToSpace with input shape
      `+r.shape}),B(o*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+e+` for depthToSpace with input shape
          `+r.shape}),B(a%(e*e)==0,function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+a+" for depthToSpace with input shape "+r.shape}),V.runKernelFunc(function(s){return s.depthToSpace(r,e,t)},{$x:r})}}),Ur=$({expandDims_:function(n,e){e===void 0&&(e=0);var t=L(n,"x","expandDims",null);B(e<=t.rank,function(){return"Axis must be <= rank of the tensor"});var r=t.shape.slice();return e<0&&(B(-(t.rank+1)<=e,function(){return"Axis must be in the interval ["+-(t.rank+1)+", "+t.rank+"]"}),e=t.rank+e+1),r.splice(e,0,1),af(t,r)}}),pv=$({eye_:function(n,e,t,r){r===void 0&&(r="float32"),e==null&&(e=n);for(var i=qe([n,e],r),o=n<=e?n:e,a=0;a<o;++a)i.set(1,a,a);var s=i.toTensor().as2D(n,e);if(t==null)return s;if(t.length===1)return is(Ur(s,0),[t[0],1,1]);if(t.length===2)return is(Ur(Ur(s,0),0),[t[0],t[1],1,1]);if(t.length===3)return is(Ur(Ur(Ur(s,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+t.length+"D.")}}),u_=$({multinomial_:function(n,e,t,r){r===void 0&&(r=!1);var i=L(n,"logits","multinomial"),o=i.size,a=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);t=t||Math.random();var s=a===1?i.as2D(1,-1):i,u=V.runKernelFunc(function(l){return l.multinomial(s,r,e,t)},{logits2D:s});return a===1?u.as1D():u}}),rc=$({oneHot_:function(n,e,t,r){if(t===void 0&&(t=1),r===void 0&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=L(n,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),V.runKernelFunc(function(a){return a.oneHot(i,e,t,r)},{$indices:i},function(a){return{$indices:function(){return St(i.shape,"float32")}}}).reshape(o)}}),ks=$({pad_:function(n,e,t){t===void 0&&(t=0);var r=L(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=e.map(function(o){return o[0]});return V.runKernelFunc(function(o){return o.pad(r,e,t)},{$x:r},function(o){return{$x:function(){return o.slice(i,r.shape)}}})}}),MO=$({pad1d_:function(n,e,t){return t===void 0&&(t=0),B(e.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),ks(n,[e],t)}}),LO=$({pad2d_:function(n,e,t){return t===void 0&&(t=0),B(e.length===2&&e[0].length===2&&e[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ks(n,e,t)}}),FO=$({pad3d_:function(n,e,t){return t===void 0&&(t=0),B(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ks(n,e,t)}}),zO=$({pad4d_:function(n,e,t){return t===void 0&&(t=0),B(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ks(n,e,t)}}),BO=$({rand_:function(n,e,t){var r=Ae(n),i=null;if(t==null||t==="float32")i=new Float32Array(r);else if(t==="int32")i=new Int32Array(r);else{if(t!=="bool")throw new Error("Unknown data type "+t);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return V.makeTensor(i,n,t)}}),l_=$({randomNormal_:function(n,e,t,r,i){if(e===void 0&&(e=0),t===void 0&&(t=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new a_(e,t,r,!1,i),a=qe(n,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),jO=$({randomGamma_:function(n,e,t,r,i){if(t===void 0&&(t=1),r===void 0&&(r="float32"),t==null&&(t=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var o=new EG(e,t,r,i),a=qe(n,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Uu=$({randomUniform_:function(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=1),r===void 0&&(r="float32");for(var o=qe(n,r),a=new CG(e,t,null,i),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),af=$({reshape_:function(n,e){var t=L(n,"x","reshape",null);e=VD(e,t.size),B(t.size===Ae(e),function(){return"new shape and old shape must have the same number of elements."});var r={shape:e};return V.runKernelFunc(function(i){return i.reshape(t,e)},{x:t},function(i){return{x:function(){return i.reshape(t.shape)}}},"Reshape",r)}}),mv=$({spaceToBatchND_:function(n,e,t){var r=L(n,"x","spaceToBatchND");return B(r.rank>=1+e.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length}),B(t.length===e.length,function(){return"paddings.shape[0] "+t.length+" must be equal to [blockShape] "+e.length}),B(r.shape.reduce(function(i,o,a){return a>0&&a<=e.length?i&&(o+t[a-1][0]+t[a-1][1])%e[a-1]==0:i},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+t.toString()+" must be divisible by blockShapes "+e.toString()}),V.runKernelFunc(function(i){return i.spaceToBatchND(r,e,t)},{$x:r},function(i){return{$x:function(){return i.batchToSpaceND(e,t)}}})}}),sf=$({squeeze_:function(n,e){var t=L(n,"x","squeeze");return af(t,Ba(t.shape,e).newShape)}}),Ui=$({stack_:function(n,e){e===void 0&&(e=0);var t=kd(n,"tensors","stack");if(B(t.length>=1,function(){return"Pass at least one tensor to tf.stack"}),t.length===1)return t[0].expandDims(e);var r=t[0].rank,i=t[0].shape,o=t[0].dtype;B(e<=r,function(){return"Axis must be <= rank of the tensor"}),t.forEach(function(s){pt(i,s.shape,"All tensors passed to stack must have matching shapes")}),t.forEach(function(s){B(o===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=t.map(function(s){return s.expandDims(e)});return ar(a,e)}}),is=$({tile_:function(n,e){var t=L(n,"x","tile",null);return B(t.rank===e.length,function(){return"Error in transpose: rank of input "+t.rank+" must match length of reps "+e+"."}),V.runKernelFunc(function(r,i){var o=r.tile(t,e);return i([t]),o},{$x:t},function(r,i){var o=i[0];return{$x:function(){var a=ct(o);if(o.rank===1)for(var s=0;s<e[0];++s)a=a.add(r.slice([s*o.shape[0]],[o.shape[0]]));else if(o.rank===2)for(s=0;s<e[0];++s)for(var u=0;u<e[1];++u)a=a.add(r.slice([s*o.shape[0],u*o.shape[1]],[o.shape[0],o.shape[1]]));else if(o.rank===3)for(s=0;s<e[0];++s)for(u=0;u<e[1];++u)for(var l=0;l<e[2];++l)a=a.add(r.slice([s*o.shape[0],u*o.shape[1],l*o.shape[2]],[o.shape[0],o.shape[1],o.shape[2]]));else{if(o.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+o.rank+" tensors yet.");for(s=0;s<e[0];++s)for(u=0;u<e[1];++u)for(l=0;l<e[2];++l)for(var c=0;c<e[3];++c)a=a.add(r.slice([s*o.shape[0],u*o.shape[1],l*o.shape[2],c*o.shape[3]],[o.shape[0],o.shape[1],o.shape[2],o.shape[3]]))}return a}}})}}),uf=$({truncatedNormal_:function(n,e,t,r,i){if(e===void 0&&(e=0),t===void 0&&(t=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new a_(e,t,r,!0,i),a=qe(n,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Iu=$({unstack_:function(n,e){e===void 0&&(e=0),e=e||0;var t=L(n,"x","unstack");return B(e>=-t.shape.length&&e<t.shape.length,function(){return"Axis = "+e+" is not in [-"+t.shape.length+", "+t.shape.length+")"}),e<0&&(e+=t.shape.length),V.runKernelFunc(function(r){return r.unstack(t,e)},{$x:t},function(r){return{$x:function(){return Ui(r,e)}}})}}),c_=function(n,e){return Ie(this,void 0,void 0,function(){var t,r,i,o,a,s,u,l,c,h;return Ne(this,function(d){switch(d.label){case 0:return t=L(n,"x","setdiff1d"),r=L(e,"y","setdiff1d"),B(t.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+t.dtype+") and y ("+r.dtype+")."}),B(t.rank===1,function(){return"x should be 1D tensor, but got x ("+t.shape+")."}),B(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,t.data()];case 1:return i=d.sent(),[4,r.data()];case 2:for(o=d.sent(),a=new Set(o),s=0,c=0;c<i.length;c++)a.has(i[c])||s++;for(u=new nc([s],t.dtype),l=new nc([s],"int32"),c=0,h=0;c<i.length;c++)a.has(i[c])||(u.values[h]=i[c],l.values[h]=c,h++);return[2,[u.toTensor(),l.toTensor()]]}})})};function ig(n,e,t,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(n[0]/t),i=i.concat(n.slice(1));else{i=i.concat(n[0]);for(var o=e.length,a=0;a<o;++a)i=i.concat([n[a+1]/e[a],e[a]]);i=i.concat(n.slice(o+1))}return i}function og(n,e,t){t===void 0&&(t=!0);var r=[];if(t){r.push(e);for(var i=e+1;i<n;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],a=[];for(i=1;i<n;++i)i>=2*e+1||i%2==1?a.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,a)}return r}function ag(n,e,t,r){r===void 0&&(r=!0);var i=[];r?i.push(n[0]/t):i.push(n[0]*t);for(var o=1;o<n.length;++o)o<=e.length?r?i.push(e[o-1]*n[o]):i.push(n[o]/e[o-1]):i.push(n[o]);return i}function UO(n,e){for(var t=[0],r=0;r<e;++r)t.push(n[r][0]);return t}function WO(n,e,t){for(var r=n.slice(0,1),i=0;i<t;++i)r.push(n[i+1]-e[i][0]-e[i][1]);return r}function VO(n,e){if(n.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+n.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>n.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+n.rank);if(n.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+n.shape+".");for(var t=e.shape,r=t[t.length-1],i=1,o=0;o<t.length-1;++o)i*=t[o];var a=n.shape,s=t.slice();s.pop();var u=1;for(o=r;o<n.rank;++o)u*=a[o],s.push(a[o]);var l=Ns(n.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,i,u,l]}var $O=30;function u0(n){return n<=$O?n:rg(n,Math.floor(Math.sqrt(n)))}function SG(n,e,t){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(n.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+n.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(t.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+t);if(t.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(n.size===0)throw new Error("Updates specified for empty output. updates shape: "+n.shape)}(function(r,i,o){var a=i.rank>1?i.shape[i.rank-1]:1,s=i.rank>1?i.rank-1:1,u="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+o.shape+", indices.shape: "+i.shape+", shape: "+r+", sliceDim: "+a+", and batchDim: "+s+".";if(o.rank<s)throw new Error(u+" update.rank < "+s+". ");if(r.length<a+(o.rank-s))throw new Error(u+" Output shape length < "+(a+(o.rank-s)));if(o.rank!==s+r.length-a)throw new Error(u+" update.rank != "+(s+r.length-a));for(var l=0;l<s;++l)if(o.shape[l]!==i.shape[l])throw new Error(u+" updates.shape["+l+"] ("+o.shape[l]+") != indices.shape["+l+"] ("+i.shape[l]+").");for(l=0;l<o.rank-s;++l)if(o.shape[l+s]!==r[l+a])throw new Error(u+" updates.shape["+(l+s)+"] ("+o.shape[l+s]+") != shape["+(l+s)+"] ("+r[l+s]+")")})(t,e,n)}function sg(n,e,t){for(var r=e.rank>1?e.shape[e.rank-1]:1,i=t.length,o=1,a=r;a<i;++a)o*=t[a];var s=r<1?1:r;return{sliceRank:r,numUpdates:e.size/s,sliceSize:o,strides:Ns(t.slice(0,r)).concat([1]),outputSize:Ae(t)}}function HO(n,e,t){B(n.rank===e.length,function(){return"Error in slice"+n.rank+"D: Length of begin "+e+" must match the rank of the array ("+n.rank+")."}),B(n.rank===t.length,function(){return"Error in slice"+n.rank+"D: Length of size "+t+" must match the rank of the array ("+n.rank+")."});for(var r=function(o){B(e[o]+t[o]<=n.shape[o],function(){return"Error in slice"+n.rank+"D: begin["+o+"] + size["+o+"] ("+(e[o]+t[o])+") would overflow input.shape["+o+"] ("+n.shape[o]+")"})},i=0;i<n.rank;++i)r(i)}function pw(n){for(var e=[],t=0;n>0;)1&n&&e.push(t),n/=2,t++;return e}function gv(n,e,t){for(var r=[],i=0;i<n.length;i++)r[i]=Math.ceil((e[i]-n[i])/t[i]);return r}function GO(n,e,t,r,i){var o=e[i],a=t[i]||1;(n&1<<i||o==null)&&(o=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),o=tg(0,o,s-1)}function qO(n,e,t,r,i){var o=e[i],a=t[i]||1;(n&1<<i||o==null)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),o=a>0?tg(0,o,s):tg(-1,o,s-1)}function h_(n,e,t){for(var r=t.length,i=0;i<t.length;i++)if(t[i]>1){r=i;break}for(i=r+1;i<t.length;i++)if(e[i]>0||t[i]!==n[i])return!1;return!0}function d_(n,e){for(var t=n.length>0?n[n.length-1]:1,r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}var IG=Object.freeze({assertParamsValid:HO,maskToAxes:pw,computeOutShape:gv,startForAxis:GO,stopForAxis:qO,isSliceContinous:h_,computeFlatOffset:d_});function NG(n){return B(ms(n),function(){return"The f passed in grad(f) must be a function"}),function(e,t){var r=L(e,"x","tf.grad",null),i=t!=null?L(t,"dy","tf.grad"):null;return V.tidy(function(){var o=V.gradients(function(){return n(r)},[r],i),a=o.value,s=o.grads;return i!=null&&pt(a.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),vv(s),s[0]})}}function TG(n){return B(ms(n),function(){return"The f passed in grads(f) must be a function"}),function(e,t){B(Array.isArray(e),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var r=kd(e,"args","tf.grads",null),i=t!=null?L(t,"dy","tf.grads"):null;return V.tidy(function(){var o=V.gradients(function(){return n.apply(void 0,r)},r,i),a=o.value,s=o.grads;return i!=null&&pt(a.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),vv(s),s})}}function kG(n){return B(ms(n),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(e,t){B(e instanceof Nt,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),B(t==null||t instanceof Nt,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var r=V.gradients(function(){return n(e)},[e],t),i=r.grads,o=r.value;return vv(i),{grad:i[0],value:o}}}function RG(n){return B(ms(n),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(e,t){B(Array.isArray(e)&&e.every(function(i){return i instanceof Nt}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),B(t==null||t instanceof Nt,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var r=V.gradients(function(){return n.apply(void 0,e)},e,t);return t!=null&&pt(r.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),vv(r.grads),r}}function KO(n,e){B(ms(n),function(){return"The f passed in variableGrads(f) must be a function"}),B(e==null||Array.isArray(e)&&e.every(function(c){return c instanceof Sd}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var t=e!=null;if(!t)for(var r in e=[],V.registeredVariables)e.push(V.registeredVariables[r]);var i=t?e.filter(function(c){return!c.trainable}):null,o=e.length;B((e=e.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."});var a=V.gradients(n,e,null,!0),s=a.value,u=a.grads;B(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),B(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return e.forEach(function(c,h){u[h]!=null&&(l[c.name]=u[h])}),i!=null&&i.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function kc(n){return V.customGrad(n)}function vv(n){if(n.filter(function(e){return e==null}).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var Wu=$({softmax_:function(n,e){e===void 0&&(e=-1);var t=L(n,"logits","softmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and dim was "+e);return kc(function(r,i){var o=r.logSumExp([e],!0),a=r.toFloat().sub(o).exp();return i([a]),{value:a,gradFunc:function(s,u){var l=u[0],c=s.mul(l);return c.sub(c.sum([e],!0).mul(l))}}})(t)}}),yv=$({logSoftmax_:function(n,e){e===void 0&&(e=-1);var t=L(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+t.rank+" and axis was "+e);return kc(function(r,i){var o=r.max(e,!0),a=r.sub(o),s=a.toFloat().sub(a.exp().sum(e,!0).log());return i([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(e,!0).mul(c))}}})(t)}}),f_=function(){function n(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return n.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},n.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},n.prototype.has=function(e){return this.data.has(e)},n.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},n.prototype.numDataIds=function(){return this.dataIdsCount},n}(),p_=function(){function n(){}return n.prototype.time=function(e){return ee()},n.prototype.read=function(e){return ee()},n.prototype.readSync=function(e){return ee()},n.prototype.numDataIds=function(){return ee()},n.prototype.disposeData=function(e){return ee()},n.prototype.fromPixels=function(e,t){return ee()},n.prototype.write=function(e,t,r){return ee()},n.prototype.move=function(e,t,r,i){return ee()},n.prototype.memory=function(){return ee()},n.prototype.floatPrecision=function(){return ee()},n.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},n.prototype.batchMatMul=function(e,t,r,i){return ee()},n.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,ee()},n.prototype.slice=function(e,t,r){return ee()},n.prototype.stridedSlice=function(e,t,r,i){return ee()},n.prototype.unstack=function(e,t){return ee()},n.prototype.reverse=function(e,t){return ee()},n.prototype.concat=function(e,t){return ee()},n.prototype.neg=function(e){return ee()},n.prototype.add=function(e,t){return ee()},n.prototype.addN=function(e){return ee()},n.prototype.subtract=function(e,t){return ee()},n.prototype.multiply=function(e,t){return ee()},n.prototype.realDivide=function(e,t){return ee()},n.prototype.floorDiv=function(e,t){return ee()},n.prototype.sum=function(e,t){return ee()},n.prototype.prod=function(e,t){return ee()},n.prototype.unsortedSegmentSum=function(e,t,r){return ee()},n.prototype.argMin=function(e,t){return ee()},n.prototype.argMax=function(e,t){return ee()},n.prototype.equal=function(e,t){return ee()},n.prototype.notEqual=function(e,t){return ee()},n.prototype.less=function(e,t){return ee()},n.prototype.lessEqual=function(e,t){return ee()},n.prototype.greater=function(e,t){return ee()},n.prototype.greaterEqual=function(e,t){return ee()},n.prototype.logicalNot=function(e){return ee()},n.prototype.logicalAnd=function(e,t){return ee()},n.prototype.logicalOr=function(e,t){return ee()},n.prototype.where=function(e){return ee()},n.prototype.select=function(e,t,r){return ee()},n.prototype.topk=function(e,t,r){return ee()},n.prototype.min=function(e,t){return ee()},n.prototype.minimum=function(e,t){return ee()},n.prototype.mod=function(e,t){return ee()},n.prototype.max=function(e,t){return ee()},n.prototype.maximum=function(e,t){return ee()},n.prototype.all=function(e,t){return ee()},n.prototype.any=function(e,t){return ee()},n.prototype.squaredDifference=function(e,t){return ee()},n.prototype.ceil=function(e){return ee()},n.prototype.floor=function(e){return ee()},n.prototype.round=function(e){return ee()},n.prototype.sign=function(e){return ee()},n.prototype.isNaN=function(e){return ee()},n.prototype.isInf=function(e){return ee()},n.prototype.isFinite=function(e){return ee()},n.prototype.pow=function(e,t){return ee()},n.prototype.exp=function(e){return ee()},n.prototype.expm1=function(e){return ee()},n.prototype.log=function(e){return ee()},n.prototype.log1p=function(e){return ee()},n.prototype.sqrt=function(e){return ee()},n.prototype.rsqrt=function(e){return ee()},n.prototype.square=function(e){return ee()},n.prototype.reciprocal=function(e){return ee()},n.prototype.relu=function(e){return ee()},n.prototype.relu6=function(e){return ee()},n.prototype.prelu=function(e,t){return ee()},n.prototype.elu=function(e){return ee()},n.prototype.eluDer=function(e,t){return ee()},n.prototype.selu=function(e){return ee()},n.prototype.int=function(e){return ee()},n.prototype.clip=function(e,t,r){return ee()},n.prototype.abs=function(e){return ee()},n.prototype.complexAbs=function(e){return ee()},n.prototype.sigmoid=function(e){return ee()},n.prototype.softplus=function(e){return ee()},n.prototype.sin=function(e){return ee()},n.prototype.cos=function(e){return ee()},n.prototype.tan=function(e){return ee()},n.prototype.asin=function(e){return ee()},n.prototype.acos=function(e){return ee()},n.prototype.atan=function(e){return ee()},n.prototype.atan2=function(e,t){return ee()},n.prototype.sinh=function(e){return ee()},n.prototype.cosh=function(e){return ee()},n.prototype.tanh=function(e){return ee()},n.prototype.asinh=function(e){return ee()},n.prototype.acosh=function(e){return ee()},n.prototype.atanh=function(e){return ee()},n.prototype.erf=function(e){return ee()},n.prototype.step=function(e,t){return ee()},n.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,ee()},n.prototype.conv2d=function(e,t,r){return ee()},n.prototype.conv2dDerInput=function(e,t,r){return ee()},n.prototype.conv2dDerFilter=function(e,t,r){return ee()},n.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,ee()},n.prototype.depthwiseConv2D=function(e,t,r){return ee()},n.prototype.depthwiseConv2DDerInput=function(e,t,r){return ee()},n.prototype.depthwiseConv2DDerFilter=function(e,t,r){return ee()},n.prototype.conv3d=function(e,t,r){return ee()},n.prototype.conv3dDerInput=function(e,t,r){return ee()},n.prototype.conv3dDerFilter=function(e,t,r){return ee()},n.prototype.maxPool=function(e,t){return ee()},n.prototype.maxPoolBackprop=function(e,t,r,i){return ee()},n.prototype.avgPool=function(e,t){return ee()},n.prototype.avgPoolBackprop=function(e,t,r){return ee()},n.prototype.avgPool3d=function(e,t){return ee()},n.prototype.avgPool3dBackprop=function(e,t,r){return ee()},n.prototype.maxPool3d=function(e,t){return ee()},n.prototype.maxPool3dBackprop=function(e,t,r,i){return ee()},n.prototype.reshape=function(e,t){return ee()},n.prototype.cast=function(e,t){return ee()},n.prototype.tile=function(e,t){return ee()},n.prototype.pad=function(e,t,r){return ee()},n.prototype.transpose=function(e,t){return ee()},n.prototype.gather=function(e,t,r){return ee()},n.prototype.gatherND=function(e,t){return ee()},n.prototype.scatterND=function(e,t,r){return ee()},n.prototype.batchToSpaceND=function(e,t,r){return ee()},n.prototype.spaceToBatchND=function(e,t,r){return ee()},n.prototype.resizeBilinear=function(e,t,r,i){return ee()},n.prototype.resizeBilinearBackprop=function(e,t,r){return ee()},n.prototype.resizeNearestNeighbor=function(e,t,r,i){return ee()},n.prototype.resizeNearestNeighborBackprop=function(e,t,r){return ee()},n.prototype.batchNormalization=function(e,t,r,i,o,a){return ee()},n.prototype.localResponseNormalization4D=function(e,t,r,i,o){return ee()},n.prototype.LRNGrad=function(e,t,r,i,o,a,s){return ee()},n.prototype.multinomial=function(e,t,r,i){return ee()},n.prototype.oneHot=function(e,t,r,i){return ee()},n.prototype.cumsum=function(e,t,r,i){return ee()},n.prototype.nonMaxSuppression=function(e,t,r,i,o){return ee()},n.prototype.fft=function(e){return ee()},n.prototype.ifft=function(e){return ee()},n.prototype.complex=function(e,t){return ee()},n.prototype.real=function(e){return ee()},n.prototype.imag=function(e){return ee()},n.prototype.cropAndResize=function(e,t,r,i,o,a){return ee()},n.prototype.depthToSpace=function(e,t,r){return ee()},n.prototype.split=function(e,t,r){return ee()},n.prototype.sparseToDense=function(e,t,r,i){return ee()},n.prototype.diag=function(e){return ee()},n.prototype.fill=function(e,t,r){throw new Error("Not yet implemented.")},n.prototype.onesLike=function(e){return ee()},n.prototype.zerosLike=function(e){return ee()},n.prototype.linspace=function(e,t,r){return ee()},n.prototype.dispose=function(){return ee()},n}();function ee(){throw new Error("Not yet implemented or not found in the registry. Did you forget to import the kernel?")}function nu(n,e){for(var t=n.length,r=[],i=0;i<t;i++){var o=t-1-i,a=n[o]||1;(e[e.length-1-i]||1)>1&&a===1&&r.unshift(o)}return r}function En(n,e){for(var t=[],r=0;r<e.length;r++){var i=n[n.length-r-1],o=e.length-r-1,a=e[o];(i==null||i===1&&a>1)&&t.unshift(o)}return t}function st(n,e){for(var t=[],r=Math.max(n.length,e.length),i=0;i<r;i++){var o=n[n.length-i-1];o==null&&(o=1);var a=e[e.length-i-1];if(a==null&&(a=1),o===1)t.unshift(a);else if(a===1)t.unshift(o);else{if(o!==a)throw Error("Operands could not be broadcast together with shapes "+n+" and "+e+".");t.unshift(o)}}return t}function ic(n,e,t,r,i,o,a){a===void 0&&(a="channelsLast");var s,u=ug(e),l=u[0],c=u[1];if(a==="channelsLast")s=[l,c,n[3],n[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[l,c,n[1],n[1]]}return Rs(n,s,t,r,i,o,!1,a)}function Rd(n,e,t,r,i,o,a){a===void 0&&(a="NDHWC");var s,u,l=mw(e),c=l[0],h=l[1],d=l[2];if(a==="NDHWC")u="channelsLast",s=[c,h,d,n[4],n[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,h,d,n[1],n[1]]}return Ad(n,s,t,r,i,!1,u,o)}function Rs(n,e,t,r,i,o,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],h=u[2],d=u[3];if(s==="channelsLast")l=n[0],c=n[1],h=n[2],d=n[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=n[0],d=n[1],c=n[2],h=n[3]}var f,m=e[0],v=e[1],y=e[3],g=ug(t),w=g[0],b=g[1],S=ug(r),E=S[0],T=S[1],_=zl(m,E),x=zl(v,T),C=function(W,U,j,H,z,q,F,oe){var Q,ae,me;if(typeof W=="number"){var fe=W===0?"VALID":"NUMBER";Q={top:W,bottom:W,left:W,right:W,type:fe};var pe=function(ze,Be,dt,nt,rn){nt==null&&(nt=m_(ze,Be,dt));var Sn=ze[0],Kt=ze[1],pn=Vh((Sn-Be+2*nt)/dt+1,rn);B(dn(pn),function(){return"The output # of rows ("+pn+") must be an integer. Change the stride and/or zero pad parameters"});var xt=Vh((Kt-Be+2*nt)/dt+1,rn);return B(dn(xt),function(){return"The output # of columns ("+xt+") must be an integer. Change the stride and/or zero pad parameters"}),[pn,xt]}([U,j],q,H,W,oe);ae=pe[0],me=pe[1]}else if(W==="same"){ae=Math.ceil(U/H),me=Math.ceil(j/z);var Ce=Math.max(0,(ae-1)*H+q-U),Me=Math.max(0,(me-1)*z+F-j),Te=Math.floor(Ce/2),Ke=Ce-Te,Fe=Math.floor(Me/2),Xe=Me-Fe;Q={top:Te,bottom:Ke,left:Fe,right:Xe,type:"SAME"}}else{if(W!=="valid")throw Error("Unknown padding parameter: "+W);Q={top:0,bottom:0,left:0,right:0,type:"VALID"},ae=Math.ceil((U-q+1)/H),me=Math.ceil((j-F+1)/z)}return{padInfo:Q,outHeight:ae,outWidth:me}}(i,c,h,w,b,_,x,o),N=C.padInfo,R=C.outHeight,k=C.outWidth,D=a?y*d:y;return s==="channelsFirst"?f=[l,D,R,k]:s==="channelsLast"&&(f=[l,R,k,D]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:h,inChannels:d,outHeight:R,outWidth:k,outChannels:D,padInfo:N,strideHeight:w,strideWidth:b,filterHeight:m,filterWidth:v,effectiveFilterHeight:_,effectiveFilterWidth:x,dilationHeight:E,dilationWidth:T,inShape:n,outShape:f,filterShape:e}}function Ad(n,e,t,r,i,o,a,s){o===void 0&&(o=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],h=u[2],d=u[3],f=u[4];if(a==="channelsLast")l=n[0],c=n[1],h=n[2],d=n[3],f=n[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=n[0],f=n[1],c=n[2],h=n[3],d=n[4]}var m,v=e[0],y=e[1],g=e[2],w=e[4],b=mw(t),S=b[0],E=b[1],T=b[2],_=mw(r),x=_[0],C=_[1],N=_[2],R=zl(v,x),k=zl(y,C),D=zl(g,N),W=function(F,oe,Q,ae,me,fe,pe,Ce,Me,Te,Ke){var Fe,Xe,ze,Be;if(typeof F=="number"){var dt=F===0?"VALID":"NUMBER";Fe={top:F,bottom:F,left:F,right:F,front:F,back:F,type:dt};var nt=function(Ue,yt,Jt,Wt,In,ur){In==null&&(In=m_(Ue,yt,Wt));var ti=Ue[0],bo=Ue[1],ga=Ue[2],ni=Vh((ti-yt+2*In)/Wt+1,ur);B(dn(ni),function(){return"The output # of depths ("+ni+") must be an integer. Change the stride and/or zero pad parameters"});var Yi=Vh((bo-yt+2*In)/Wt+1,ur);B(dn(Yi),function(){return"The output # of rows ("+Yi+") must be an integer. Change the stride and/or zero pad parameters"});var va=Vh((ga-yt+2*In)/Wt+1,ur);return B(dn(va),function(){return"The output # of columns ("+va+") must be an integer. Change the stride and/or zero pad parameters"}),[ni,Yi,va,Jt]}([oe,Q,ae,1],Ce,1,me,F,Ke);Xe=nt[0],ze=nt[1],Be=nt[2]}else if(F==="same"){Xe=Math.ceil(oe/me),ze=Math.ceil(Q/fe),Be=Math.ceil(ae/pe);var rn=(Xe-1)*me+Ce-oe,Sn=(ze-1)*fe+Me-Q,Kt=(Be-1)*pe+Te-ae,pn=Math.floor(rn/2),xt=rn-pn,Ut=Math.floor(Sn/2),je=Sn-Ut,Qt=Math.floor(Kt/2),mt=Kt-Qt;Fe={top:Ut,bottom:je,left:Qt,right:mt,front:pn,back:xt,type:"SAME"}}else{if(F!=="valid")throw Error("Unknown padding parameter: "+F);Fe={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Xe=Math.ceil((oe-Ce+1)/me),ze=Math.ceil((Q-Me+1)/fe),Be=Math.ceil((ae-Te+1)/pe)}return{padInfo:Fe,outDepth:Xe,outHeight:ze,outWidth:Be}}(i,c,h,d,S,E,T,R,k,D,s),U=W.padInfo,j=W.outDepth,H=W.outHeight,z=W.outWidth,q=o?w*f:w;return a==="channelsFirst"?m=[l,q,j,H,z]:a==="channelsLast"&&(m=[l,j,H,z,q]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:h,inWidth:d,inChannels:f,outDepth:j,outHeight:H,outWidth:z,outChannels:q,padInfo:U,strideDepth:S,strideHeight:E,strideWidth:T,filterDepth:v,filterHeight:y,filterWidth:g,effectiveFilterDepth:R,effectiveFilterHeight:k,effectiveFilterWidth:D,dilationDepth:x,dilationHeight:C,dilationWidth:N,inShape:n,outShape:m,filterShape:e}}function m_(n,e,t,r){r===void 0&&(r=1);var i=zl(e,r);return Math.floor((n[0]*(t-1)-t+i)/2)}function ug(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function mw(n){return typeof n=="number"?[n,n,n]:n}function zl(n,e){return e<=1?n:n+(n-1)*(e-1)}function Vh(n,e){if(!e)return n;switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error("Unknown roundingMode "+e)}}function Nu(n){var e=ug(n),t=e[0],r=e[1],i=e[2];return t===1&&r===1&&i===1}function gr(n,e){return Nu(n)||Nu(e)}function wv(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+n)}function g_(n,e,t){if(e==="complex64"){if(n.dtype==="complex64")return n.clone();var r=St(n.shape),i=n.toFloat(),o=t.complex(i,r);return r.dispose(),i.dispose(),o}if(!GD(n.dtype,e))return V.makeTensorFromDataId(n.dataId,n.shape,e);if(n.dtype==="complex64"){var a=t.real(n);return o=a.cast(e),a.dispose(),o}if(e==="int32")return t.int(n);if(e==="bool"){var s=Ee(0,n.dtype);return o=t.notEqual(n,s),s.dispose(),o}throw new Error("Error in Cast: failed to cast "+n.dtype+" to "+e)}function lg(n,e){return V.makeTensorFromDataId(n.dataId,e,n.dtype)}function v_(n,e,t){var r=(e-n)/(t-1),i=Nc(t,"float32");i[0]=n;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return Or(i,"float32")}var AG=Object.freeze({castTensor:g_,reshapeTensor:lg,linspaceImpl:v_,upcastType:wn,axesAreInnerMostDims:Jx,combineLocations:TO,computeOutAndReduceShapes:Gn,expandShapeToKeepDim:Kr,assertAxesAreInnerMostDims:Cr,getAxesPermutation:Gi,getUndoAxesPermutation:lv,getInnerMostAxes:qi,getBroadcastDims:nu,getReductionAxes:En,assertAndGetBroadcastShape:st,assertParamsConsistent:kO,computeOutShape:Su,computePool2DInfo:ic,computePool3DInfo:Rd,computeConv2DInfo:Rs,computeConv3DInfo:Ad,computeDefaultPad:m_,tupleValuesAreOne:Nu,eitherStridesOrDilationsAreOne:gr,convertConv2DDataFormat:wv});function gw(n,e){if(n.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+n.length+", imag: "+e.length+".");for(var t=new Float32Array(2*n.length),r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function zI(n,e){return{real:n[2*e],imag:n[2*e+1]}}function DG(n,e,t,r){n[2*r]=e,n[2*r+1]=t}function OG(n,e,t){var r=(t?2:-2)*Math.PI*(n/e);return{real:Math.cos(r),imag:Math.sin(r)}}function y_(n,e,t,r,i){for(var o=Array.from(e).map(function(f,m){return{score:f,boxIndex:m}}).filter(function(f){return f.score>i}).sort(function(f,m){return m.score-f.score}),a=[],s=0;s<o.length;s++){var u=o[s],l=u.score,c=u.boxIndex;if(l<i)break;for(var h=!1,d=a.length-1;d>=0;--d)if(PG(n,c,a[d])>=r){h=!0;break}if(!h&&(a.push(c),a.length>=t))break}return Or(a,"int32")}function PG(n,e,t){var r=n.subarray(4*e,4*e+4),i=n.subarray(4*t,4*t+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),f=(s-o)*(u-a),m=(h-l)*(d-c);if(f<=0||m<=0)return 0;var v=Math.max(o,l),y=Math.max(a,c),g=Math.min(s,h),w=Math.min(u,d),b=Math.max(g-v,0)*Math.max(w-y,0);return b/(f+m-b)}function XO(n,e,t){var r=new Array(n.rank).fill(0),i=n.shape.slice();return e.map(function(o){i[t]=o;var a=n.slice(r,i);return r[t]+=o,a})}function YO(n,e){for(var t=new Array(n.rank),r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];var i=qe(t,n.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),a=new Array(n.rank),s=0;s<a.length;s++)a[s]=o[s]%n.shape[s];var u=n.locToIndex(a);i.values[r]=n.values[u]}return i.toTensor()}function QO(n,e,t,r,i){for(var o=e[e.length-1],a=[n.length/o,o],s=a[0],u=a[1],l=_d(t,s*r),c=_d("int32",s*r),h=0;h<s;h++){for(var d=h*u,f=n.subarray(d,d+u),m=[],v=0;v<f.length;v++)m.push({value:f[v],index:v});m.sort(function(S,E){return E.value-S.value});var y=h*r,g=l.subarray(y,y+r),w=c.subarray(y,y+r);for(v=0;v<r;v++)g[v]=m[v].value,w[v]=m[v].index}var b=e.slice();return b[b.length-1]=r,[gn(l,b,t),gn(c,b,"int32")]}function w_(n,e){for(var t=[],r=0;r<e.length;r++)e[r]&&t.push(r);var i=qe(n,"int32"),o=qe([t.length,n.length],"int32");for(r=0;r<t.length;r++){var a=i.indexToLoc(t[r]),s=r*n.length;o.values.set(a,s)}return o.toTensor()}var MG=function(){return function(n,e){this.outputShape=[],this.outputShape=n,this.variableNames=e.map(function(i,o){return"T"+o});var t=[];this.variableNames.forEach(function(i){t.push("float v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `}}(),LG=function(){return function(n,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=e.map(function(i,o){return"T"+o});var t=[];this.variableNames.forEach(function(i){t.push("vec4 v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+t.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `}}(),FG=function(){return function(n,e,t){this.variableNames=["A"];var r=n.windowSize,i=n.batchSize,o=n.inSize,a=Math.ceil(o/r);t||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];var s=e==="max"?">":"<",u=t?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}();function JO(n,e){return["x","y","z","w","u","v"].slice(0,e).map(function(t){return n+"."+t})}function Nr(n,e){return e===1?[n]:JO(n,e)}function ir(){var n,e,t,r,i,o,a,s,u,l;return te().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",i="texture",o="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",i="texture2D",o="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:i,output:o,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function ru(n,e,t){t===void 0&&(t="index");var r=Ns(e);return r.map(function(i,o){return"int "+n[o]+" = "+t+" / "+i+"; "+(o===r.length-1?"int "+n[o+1]+" = "+t+" - "+n[o]+" * "+i:"index -= "+n[o]+" * "+i)+";"}).join("")}function b_(n){var e=Ns(n).map(function(t){return t.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var ZO=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function zG(n,e,t,r){var i=[];n.forEach(function(f){var m=Ae(f.shapeInfo.logicalShape);f.shapeInfo.isUniform?i.push("uniform float "+f.name+(m>1?"["+m+"]":"")+";"):(i.push("uniform sampler2D "+f.name+";"),i.push("uniform int offset"+f.name+";"))});var o,a,s=i.join(`
`),u=n.map(function(f){return function(m,v,y){y===void 0&&(y=!1);var g="";g+=y?eP(m):ul(m);var w=m.shapeInfo.logicalShape,b=v.logicalShape;return w.length<=b.length&&(g+=y?function(S,E){var T,_=S.name,x=_.charAt(0).toUpperCase()+_.slice(1),C="get"+x+"AtOutCoords",N=S.shapeInfo.logicalShape.length,R=E.logicalShape.length,k=nu(S.shapeInfo.logicalShape,E.logicalShape),D=jt(R),W=R-N,U=["x","y","z","w","u","v"];T=N===0?"":R<2&&k.length>=1?"coords = 0;":k.map(function(Q){return"coords."+U[Q+W]+" = 0;"}).join(`
`);var j="";j=R<2&&N>0?"coords":S.shapeInfo.logicalShape.map(function(Q,ae){return"coords."+U[ae+W]}).join(", ");var H="return outputValue;",z=Ae(S.shapeInfo.logicalShape)===1,q=Ae(E.logicalShape)===1;if(N!==1||z||q){if(z&&!q)H=R===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(k.length){var F=N-2,oe=N-1;k.indexOf(F)>-1&&k.indexOf(oe)>-1?H="return vec4(outputValue.x);":k.indexOf(F)>-1?H="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":k.indexOf(oe)>-1&&(H="return vec4(outputValue.xx, outputValue.zz);")}}else H=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+C+`() {
      `+D+` coords = getOutputCoords();
      `+T+`
      vec4 outputValue = get`+x+"("+j+`);
      `+H+`
    }
  `}(m,v):function(S,E){var T=S.name,_=T.charAt(0).toUpperCase()+T.slice(1),x="get"+_+"AtOutCoords",C=E.texShape,N=S.shapeInfo.texShape,R=S.shapeInfo.logicalShape.length,k=E.logicalShape.length;if(!S.shapeInfo.isUniform&&R===k&&S.shapeInfo.flatOffset==null&&jn(N,C))return`
      float `+x+`() {
        return sampleTexture(`+T+`, resultUV);
      }
    `;var D,W=jt(k),U=nu(S.shapeInfo.logicalShape,E.logicalShape),j=k-R,H=["x","y","z","w","u","v"];D=R===0?"":k<2&&U.length>=1?"coords = 0;":U.map(function(q){return"coords."+H[q+j]+" = 0;"}).join(`
`);var z="";return z=k<2&&R>0?"coords":S.shapeInfo.logicalShape.map(function(q,F){return"coords."+H[F+j]}).join(", "),`
    float `+x+`() {
      `+W+` coords = getOutputCoords();
      `+D+`
      return get`+_+"("+z+`);
    }
  `}(m,v)),g}(f,e,r)}).join(`
`),l=e.texShape,c=ir(),h=function(f){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+f.texture2D+`(textureSampler, uv).r;
    }
  `}(c),d=function(f){return f.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+f.varyingFs+` vec2 resultUV;
    `+f.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+f.defineSpecialNaN+`
    `+f.defineSpecialInf+`
    `+f.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+BG+`
    `+jG+`
    `+UG+`
  `}(c);return e.isPacked?(o=function(f,m){switch(f.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(S,E){var T=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];return T[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+T[1]+`.0);
      }
    `:T[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+T[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+T[0]+", "+T[1]+`));
      return 2 * (resTexRC.x * `+T[1]+` + resTexRC.y);
    }
  `}(0,m);case 2:return function(S,E){var T=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];if(jn(S,E))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+T[0]+", "+T[1]+`));
      }
    `;var _=Math.ceil(S[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+T[0]+", "+T[1]+`));

      int index = resTexRC.x * `+T[1]+` + resTexRC.y;
      int r = 2 * (index / `+_+`);
      int c = imod(index, `+_+`) * 2;

      return ivec2(r, c);
    }
  `}(f,m);case 3:return v=f,y=m,g=[Math.ceil(y[0]/2),Math.ceil(y[1]/2)],w=Math.ceil(v[2]/2),b=w*Math.ceil(v[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+w+`);
      int c = imod(index, `+w+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(S,E){for(var T=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)],_=Math.ceil(S[S.length-1]/2),x=_*Math.ceil(S[S.length-2]/2),C=x,N="",R="b, r, c",k=2;k<S.length-1;k++)C*=S[S.length-k-1],N=`
      int b`+k+" = index / "+C+`;
      index -= b`+k+" * "+C+`;
    `+N,R="b"+k+", "+R;return`
    ivec`+S.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+T[0]+", "+T[1]+`));
      int index = resTexRC.x * `+T[1]+` + resTexRC.y;

      `+N+`

      int b = index / `+x+`;
      index -= b * `+x+`;

      int r = 2 * (index / `+_+`);
      int c = imod(index, `+_+`) * 2;

      return ivec`+S.length+"("+R+`);
    }
  `}(f,m)}var v,y,g,w,b}(e.logicalShape,l),a=function(f){return`
    void setOutput(vec4 val) {
      `+f.output+` = val;
    }
  `}(c)):(o=function(f,m){switch(f.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(g,w){return w[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+w[1]+`.0);
      }
    `:w[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+w[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+w[0]+", "+w[1]+`));
      return resTexRC.x * `+w[1]+` + resTexRC.y;
    }
  `}(0,m);case 2:return function(g,w){return jn(g,w)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+w[0]+", "+w[1]+`));
      }
    `:g[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+w[0]+", "+w[1]+`));
        int index = resTexRC.x * `+w[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:g[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+w[0]+", "+w[1]+`));
        int index = resTexRC.x * `+w[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;
      int r = index / `+g[1]+`;
      int c = index - r * `+g[1]+`;
      return ivec2(r, c);
    }
  `}(f,m);case 3:return v=m,y=ru(["r","c","d"],f),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;
      `+y+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(g,w){var b=ru(["r","c","d","d2"],g);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(f,m);case 5:return function(g,w){var b=ru(["r","c","d","d2","d3"],g);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+w[0]+`,
                             `+w[1]+`));

      int index = resTexRC.x * `+w[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(f,m);case 6:return function(g,w){var b=ru(["r","c","d","d2","d3","d4"],g);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(f,m);default:throw new Error(f.length+"-D output sampling is not yet supported")}var v,y}(e.logicalShape,l),a=function(f){return`
    void setOutput(float val) {
      `+f.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(d+=WG),[d,h,a,s,o,u,t].join(`
`)}function ul(n){var e=n.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){var r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var o=t.shapeInfo.texShape,a=o[0],s=o[1];if(a===1&&s===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=t.shapeInfo.texShape,l=u[0],c=u[1],h=zs(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+h+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(n);case 1:return function(t){var r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(t.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+ol(t)+`
      }
    `;var o=t.shapeInfo.texShape,a=o[0],s=o[1];if(s===1&&a===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=zs(r);return s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(n);case 2:return function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=t.shapeInfo.texShape;if(a!=null&&jn(r,a)){var s=a[0],u=a[1];return`
    float `+o+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var l=Ba(r),c=l.newShape,h=l.keptDims,d=c;if(d.length<r.length){var f=ll(t,d);return`
      `+ul(f)+`
      float `+o+`(int row, int col) {
        return `+o+"("+cl(["row","col"],h)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+ol(t)+`
      }
    `;var m=a[0],v=a[1],y=zs(i);return v===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+m+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:m===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+v+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+o+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+y+`;
    vec2 uv = uvFromFlat(`+m+", "+v+`, index);
    return sampleTexture(`+i+`, uv);
  }
`}(n);case 3:return function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[1]*r[2],s=r[2],u=Ba(r),l=u.newShape,c=u.keptDims,h=l;if(h.length<r.length){var d=ll(t,h);return`
        `+ul(d)+`
        float `+o+`(int row, int col, int depth) {
          return `+o+"("+cl(["row","col","depth"],c)+`);
        }
      `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+ol(t)+`
      }
    `;var f=t.shapeInfo.texShape,m=f[0],v=f[1],y=t.shapeInfo.flatOffset;if(v===a&&y==null)return`
        float `+o+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+v+".0, "+m+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(v===s&&y==null)return`
    float `+o+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+v+".0, "+m+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var g=zs(i);return`
      float `+o+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+g+`;
        vec2 uv = uvFromFlat(`+m+", "+v+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `}(n);case 4:return function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,l=Ba(r),c=l.newShape,h=l.keptDims;if(c.length<r.length){var d=ll(t,c);return`
      `+ul(d)+`
      float `+o+`(int row, int col, int depth, int depth2) {
        return `+o+"("+cl(["row","col","depth","depth2"],h)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+ol(t)+`
      }
    `;var f=t.shapeInfo.flatOffset,m=t.shapeInfo.texShape,v=m[0],y=m[1];if(y===u&&f==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(y===a&&f==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var g=zs(i);return`
    float `+o+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+v+", "+y+", index + "+g+`);
      return sampleTexture(`+i+`, uv);
    }
  `}(n);case 5:return function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,l=r[1]*u,c=Ba(r),h=c.newShape,d=c.keptDims;if(h.length<r.length){var f=ll(t,h);return`
      `+ul(f)+`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        return `+o+"("+cl(["row","col","depth","depth2","depth3"],d)+`);
      }
    `}if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+ol(t)+`
      }
    `;var m=t.shapeInfo.flatOffset,v=t.shapeInfo.texShape,y=v[0],g=v[1];if(g===l&&m==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+y+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(g===a&&m==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+y+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var w=zs(i);return`
    float `+o+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+w+`;
      vec2 uv = uvFromFlat(`+y+", "+g+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(n);case 6:return function(t){var r=t.shapeInfo.logicalShape,i=t.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=Ba(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var l=ll(t,s);return`
      `+ul(l)+`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+o+"("+cl(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],h=r[4]*c,d=r[3]*h,f=r[2]*d,m=r[1]*f;if(t.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+m+", "+f+", "+d+", "+h+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+ol(t)+`
      }
    `;var v=t.shapeInfo.flatOffset,y=t.shapeInfo.texShape,g=y[0],w=y[1];if(w===m&&v==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+f+", "+d+", "+h+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+w+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(w===c&&v==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+w+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var b=zs(i);return`
    float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+m+" + col * "+f+" + depth * "+d+` +
          depth2 * `+h+" + depth3 * "+c+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+g+", "+w+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(n);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function eP(n){var e,t,r;switch(n.shapeInfo.logicalShape.length){case 0:return e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=ir(),`
    vec4 `+t+`() {
      return `+r.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return function(i){var o=i.name,a="get"+o.charAt(0).toUpperCase()+o.slice(1),s=i.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=ir();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+o+`, uv);
    }
  `}(n);case 2:return function(i){var o=i.shapeInfo.logicalShape,a=i.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=i.shapeInfo.texShape,l=u[0],c=u[1],h=ir();if(u!=null&&jn(o,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+h.texture2D+"("+a+`, uv);
      }
    `;var d=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],f=Math.ceil(o[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+f+", "+d[0]+", "+d[1]+`, row, col);
      return `+h.texture2D+"("+a+`, uv);
    }
  `}(n);case 3:return function(i){var o=i.shapeInfo.logicalShape,a=i.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=i.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(o[0]===1){var c=o.slice(1),h=ll(i,c);return`
        `+eP(h)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+cl(["b","row","col"],[1,2])+`);
        }
      `}var d=l[0],f=l[1],m=Math.ceil(o[2]/2),v=m*Math.ceil(o[1]/2),y=ir();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+d+", "+f+", "+v+", "+m+`, b, row, col);
      return `+y.texture2D+"("+a+`, uv);
    }
  `}(n);default:return function(i){for(var o=i.shapeInfo.logicalShape,a=o.length,s=i.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=i.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],h=c[0],d=c[1],f=Math.ceil(o[a-1]/2),m=f*Math.ceil(o[a-2]/2),v="int b, int row, int col",y="b * "+m+" + (row / 2) * "+f+" + (col / 2)",g=2;g<a-1;g++)v="int b"+g+", "+v,m*=o[a-g-1],y="b"+g+" * "+m+" + "+y;var w=ir();return`
    vec4 `+u+"("+v+`) {
      int index = `+y+`;
      int texR = index / `+d+`;
      int texC = index - texR * `+d+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+d+", "+h+`);
      return `+w.texture2D+"("+s+`, uv);
    }
  `}(n)}}var BG=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jG=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,UG=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,WG=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function zs(n){return"offset"+n}function ol(n){var e=n.name,t=Ae(n.shapeInfo.logicalShape);return t<2?"return "+e+";":`
    for (int i = 0; i < `+t+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function jt(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error("GPU for rank "+n+" is not yet supported")}function ll(n,e){var t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function cl(n,e){return e.map(function(t){return n[t]}).join(", ")}var VG=function(){return function(n,e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,B(n.length>2,function(){return"Packed arg"+(t.charAt(0).toUpperCase()+t.slice(1))+" supports only inputs with rank above 2."});var i=n[n.length-1],o=Math.ceil(i/e);this.outputShape=n.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=jt(l),h=Nr("coords",l);if(o===1){var d=jt(s=l+1);a=`
        `+d+" sourceLocR = "+d+"("+h.join()+`, 0);
        ++`+h[l-1]+`;
        `+d+" sourceLocG = "+d+"("+h.join()+`, 0);
        ++`+h[l-2]+`;
        `+d+" sourceLocA = "+d+"("+h.join()+`, 0);
        --`+h[l-1]+`;
        `+d+" sourceLocB = "+d+"("+h.join()+`, 0);
        --`+h[l-2]+";"}else s=l,a=`
        `+c+` sourceLocR = coords;
        ++`+h[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+h[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+h[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+h[l-2]+";";var f=["x","y","z","w","u","v"].slice(0,s),m="."+f[s-1],v=f.map(function(x){return"int "+x}),y=Nr("sourceLocR",s-1).concat("inIdx.r"),g=Nr("sourceLocG",s-1).concat("inIdx.g"),w=Nr("sourceLocB",s-1).concat("inIdx.b"),b=Nr("sourceLocA",s-1).concat("inIdx.a"),S=t==="max"?"greaterThan":"lessThan",E=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+w.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",T=`vec4(
            getAChannel(`+y.join()+`),
            hasNextCol ? getAChannel(`+g.join()+`) : 0.,
            hasNextRow ? getAChannel(`+w.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",_=r?"":`
      float getBestIndicesAChannel(`+v.join()+`) {
        return getChannel(getBestIndicesA(`+f.join()+`),
                                          vec2(`+f.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+v.join()+`) {
        return getChannel(getA(`+f.join()+`),
                               vec2(`+f.slice(-2).join()+`));
      }
      `+_+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+h[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+h[l-2]+" < "+(u[l-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+m+", sourceLocG"+m+`,
          sourceLocB`+m+", sourceLocA"+m+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+T+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+E+`
          vec4 candidate = `+T+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+S+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}(),$G=function(){return function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.effectiveFilterHeight,u=n.effectiveFilterWidth,l=s-1-n.padInfo.top,c=u-1-n.padInfo.left,h=1/(e*t);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+h+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+o+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}(),HG=function(){return function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var e=n.filterDepth,t=n.filterHeight,r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,a=n.strideWidth,s=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,c=n.effectiveFilterDepth,h=n.effectiveFilterHeight,d=n.effectiveFilterWidth,f=c-1-n.padInfo.front,m=h-1-n.padInfo.top,v=d-1-n.padInfo.left,y=1/(e*t*r);this.userCode=`
      const ivec3 pads = ivec3(`+f+", "+m+", "+v+`);
      const float avgMultiplier = float(`+y+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+h+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+d+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),GG=function(){return function(n,e,t,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],st(n,e),st(n,t);var a="0.0";r!=null&&(st(n,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";i!=null&&(st(n,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+o+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}(),qG=function(){return function(n,e,t,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],st(n,e),st(n,t);var a="vec4(0.0)";r!=null&&(st(n,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";i!=null&&(st(n,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+o+`));

        setOutput((x - mean) * inv + offset);
      }
    `}}(),KG="return areal * breal - aimag * bimag;",XG="return areal * bimag + aimag * breal;",BI=function(){return function(n,e,t){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=st(e,t),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+n+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}(),l0="return a + b;",c0="return a - b;",jI="return a * b;",tP="return (a < 0.) ? b * a : a;",sn=function(){return function(n,e,t){this.variableNames=["A","B"],this.outputShape=st(e,t),this.userCode=`
      float binaryOperation(float a, float b) {
        `+n+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}(),nP=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,ko=function(){return function(n,e,t,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=st(e,t);var i=this.outputShape.length,o="";if(r)if(i===0||Ae(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          `+jt(i)+` coords = getOutputCoords();
        `,i===1)o+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=Nr("coords",i);o+=`
            bool nextRowOutOfBounds =
              (`+a[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+a[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+n+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+o+`

        setOutput(result);
      }
    `}}(),YG=function(){function n(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return n.prototype.getCustomSetupFunc=function(e,t){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,e),i.gl.uniform1f(r.maxLoc,t)}},n}(),QG=function(){function n(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return n.prototype.getCustomSetupFunc=function(e,t){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,e),i.gl.uniform1f(r.maxLoc,t)}},n}(),JG=function(){return function(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}(),ZG=function(){return function(n){this.outputShape=[],this.outputShape=Su(n,1),this.variableNames=n.map(function(s,u){return"T"+u});var e=new Array(n.length-1);e[0]=n[0][1];for(var t=1;t<e.length;t++)e[t]=e[t-1]+n[t][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(t=1;t<e.length;t++){var i=e[t-1];r.push("else if (yC < "+e[t]+") setOutput(getT"+t+"(yR, yC-"+i+"));")}var o=e.length,a=e[e.length-1];r.push("else setOutput(getT"+o+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `}}(),eq=function(){return function(n,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Su(n,e);var t=this.outputShape,r=t.length,i=jt(r),o=Nr("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=n.map(function(y,g){return"T"+g});var s=new Array(n.length-1);s[0]=n[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+n[u][e];var l=a[e],c=a.slice(-2),h=a.join(),d="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+h+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var f=s[u-1];d+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+fp(a,l,f)+`),
            vec2(`+fp(c,l,f)+`));
        }`}var m=s.length,v=s[s.length-1];d+=`
        return getChannel(
          getT`+m+"("+fp(a,l,v)+`),
          vec2(`+fp(c,l,v)+"));",this.userCode=`
      float getValue(`+a.map(function(y){return"int "+y})+`) {
        `+d+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+o+`), 0., 0., 0.);

        `+o[r-1]+" = "+o[r-1]+` + 1;
        if (`+o[r-1]+" < "+t[r-1]+`) {
          result.g = getValue(`+o+`);
        }

        `+o[r-2]+" = "+o[r-2]+` + 1;
        if (`+o[r-2]+" < "+t[r-2]+`) {
          result.a = getValue(`+o+`);
        }

        `+o[r-1]+" = "+o[r-1]+` - 1;
        if (`+o[r-2]+" < "+t[r-2]+` &&
            `+o[r-1]+" < "+t[r-1]+`) {
          result.b = getValue(`+o+`);
        }
        setOutput(result);
      }
    `}}();function fp(n,e,t){var r=n.indexOf(e);return n.map(function(i,o){return o===r?i+" - "+t:i}).join()}var tq=function(){return function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideHeight,t=n.strideWidth,r=n.padInfo.top,i=n.padInfo.left,o=n.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+i+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              if (`+o+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),nq=function(){return function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=n.dataFormat==="channelsLast",a=e-1-n.padInfo.top,s=t-1-n.padInfo.left,u=o?1:2,l=o?2:3,c=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {

              if (`+o+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),rq=function(){return function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideDepth,t=n.strideHeight,r=n.strideWidth,i=n.padInfo.front,o=n.padInfo.top,a=n.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yF = 0; yF < `+n.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+i+`;

            if (xF < 0 || xF >= `+n.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+n.outHeight+`; yR++) {
              int xR = wR + yR * `+t+" - "+o+`;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+n.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),iq=function(){return function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterDepth,t=n.filterHeight,r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,a=n.strideWidth,s=e-1-n.padInfo.front,u=t-1-n.padInfo.top,l=r-1-n.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+n.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+t+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+t+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+n.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),oq=function(){return function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;var e=n.strideHeight,t=n.strideWidth,r=n.padInfo.top,i=n.padInfo.left,o=n.outChannels/n.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+o+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+n.batchSize+`; b++) {
          for (int yR = 0; yR < `+n.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+n.outWidth+`; yC++) {
              int xC = wC + yC * `+t+" - "+i+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),aq=function(){return function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var e=n.filterHeight,t=n.filterWidth,r=n.strideHeight,i=n.strideWidth,o=e-1-n.padInfo.top,a=t-1-n.padInfo.left,s=n.outChannels/n.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+t+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+t+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),UI=function(){return function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var i=n.padInfo.top,o=n.padInfo.left,a=n.strideHeight,s=n.strideWidth,u=n.dilationHeight,l=n.dilationWidth,c=n.filterHeight,h=n.filterWidth,d=4*Math.floor(n.inChannels/4),f=n.inChannels%4,m=n.dataFormat==="channelsLast",v=m?1:2,y=m?2:3,g=m?3:1,w="",b="";t&&(w=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,b="result = activation(result);");var S=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+i+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+g+`];

        ivec2 xRCCorner =
            ivec2(coords[`+v+"], coords["+y+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+n.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+d+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+m+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(f===1)+`) {

              if (`+m+`) {
                dotProd +=
                    getX(batch, xR, xC, `+d+`) *
                    getW(wR, wC, `+d+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+d+`, xR, xC) *
                    getW(wR, wC, `+d+`, d2);
              }

            } else if (`+(f===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2)
              );

              if (`+m+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(f===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2),
                getW(wR, wC, `+d+` + 2, d2)
              );

              if (`+m+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1),
                  getX(batch, xR, xC, `+d+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC),
                  getX(batch, `+d+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+S+`
        `+b+`
        setOutput(result);
      }
    `}}(),sq=function(){return function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var e=n.padInfo.front,t=n.padInfo.top,r=n.padInfo.left,i=n.strideDepth,o=n.strideHeight,a=n.strideWidth,s=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,c=n.filterDepth,h=n.filterHeight,d=n.filterWidth,f=4*Math.floor(n.inChannels/4),m=n.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+o+", "+a+`);
      const ivec3 pads = ivec3(`+e+", "+t+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+d+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+f+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(m===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+f+`) *
                  getW(wF, wR, wC, `+f+`, d2);
              } else if (`+(m===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+f+`),
                  getX(batch, xF, xR, xC, `+f+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+f+`, d2),
                  getW(wF, wR, wC, `+f+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(m===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+f+`),
                  getX(batch, xF, xR, xC, `+f+` + 1),
                  getX(batch, xF, xR, xC, `+f+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+f+`, d2),
                  getW(wF, wR, wC, `+f+` + 1, d2),
                  getW(wF, wR, wC, `+f+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),WI=function(){return function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var i=n.inHeight,o=n.inWidth,a=n.padInfo.top,s=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,c=n.dilationHeight,h=n.dilationWidth,d=n.filterHeight,f=n.filterWidth,m=n.outChannels/n.inChannels,v="",y="";t&&(v=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`
          float activation(float x) {
            `+t+`
          }
        `,y="result = activation(result);");var g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+v+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+m+`;
        int q = d2 - d1 * `+m+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+h+`;

            if (xC < 0 || xC >= `+o+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+g+`
        `+y+`
        setOutput(result);
      }
    `}}(),VI=function(){return function(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.outShape;for(var i=n.inHeight,o=n.inWidth,a=n.padInfo.top,s=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,c=n.dilationHeight,h=n.dilationWidth,d=n.filterHeight,f=n.filterWidth,m=f,v="int xR; int xC; int xCOffset;",y=0;y<d;y++)for(var g=0;g<f;g++)v+=`
          vec4 xTexelR`+y+"C"+2*g+` = vec4(0.);
          vec4 wR`+y+"C"+g+` = vec4(0.);
          vec4 xR`+y+"C"+g+" = vec4(0.);";for(y=0;y<d;y++)for(var w=0;w<m;w++){if(v+=`
          xR = xRCorner + `+y*c+`;
          xC = xCCorner + `+(g=2*w)*h+`;
        `,l===1){if(g<f&&(v+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  xTexelR`+y+"C"+g+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+g+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);
                  xR`+y+"C"+g+" = vec4(previous.zw, xTexelR"+y+"C"+g+`.xy);
                } else {
                  xR`+y+"C"+g+" = vec4(0, 0, xTexelR"+y+"C"+g+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+o+`) {
                  xTexelR`+y+"C"+g+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+g+` = vec4(0.);
                }

                xR`+y+"C"+g+" = xTexelR"+y+"C"+g+`;
              `,g+1<f)){var b=s%2==0?Hx(h):h;h%2==0&&s%2==1||h%2!=0&&s%2!=1?(v+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+y+"C"+(g+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,h>1&&(v+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+o+`) {
                      xTexelR`+y+"C"+g+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+y+"C"+g+` = vec4(0.);
                    }
                  `),v+=`
                  xR`+y+"C"+(g+1)+` = vec4(
                    xTexelR`+y+"C"+g+".zw, xTexelR"+y+"C"+(g+2)+`.xy);
                `):v+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+y+"C"+(g+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+y+"C"+(g+1)+" = xTexelR"+y+"C"+(g+2)+`;
                `}}else g<f&&(v+=`
              if(xR >= 0 && xR < `+i+`) {
            `,s%2==1?(v+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+y+"C"+g+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+g+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+o+`) {
                  xTexelR`+y+"C"+(g+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+y+"C"+(g+2)+` = vec4(0.);
                }

                xR`+y+"C"+g+` = vec4(
                  xTexelR`+y+"C"+g+".zw, xTexelR"+y+"C"+(g+2)+`.zw);
              `,g+1<f&&(v+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+o+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+y+"C"+(g+1)+" = vec4(xTexelR"+y+"C"+(g+2)+`.xy, final.xy);
                `)):(v+=`
                if(xC >= 0 && xC < `+o+`) {
                  xTexelR`+y+"C"+g+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+g+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+y+"C"+(g+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+(g+2)+` = vec4(0.);
                }

                xR`+y+"C"+g+` = vec4(
                  xTexelR`+y+"C"+g+".xy, xTexelR"+y+"C"+(g+2)+`.xy);
              `,g+1<f&&(v+=`
                  xR`+y+"C"+(g+1)+` = vec4(
                    xTexelR`+y+"C"+g+".zw, xTexelR"+y+"C"+(g+2)+`.zw);
                `)),v+="}");g<f&&(v+=`
            vec4 wTexelR`+y+"C"+g+" = getW("+y+", "+g+`, d1, q);
            wR`+y+"C"+g+" = vec4(wTexelR"+y+"C"+g+".xz, wTexelR"+y+"C"+g+`.xz);
          `,g+1<f&&(v+=`
              vec4 wTexelR`+y+"C"+(g+1)+" = getW("+y+", "+(g+1)+`, d1, q);
              wR`+y+"C"+(g+1)+` =
                vec4(wTexelR`+y+"C"+(g+1)+".xz, wTexelR"+y+"C"+(g+1)+".xz);"))}for(y=0;y<d;y++)for(g=0;g<f;g++)v+="dotProd += xR"+y+"C"+g+" * wR"+y+"C"+g+";";var S="",E="";t&&(S=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+t+`
        }`:`vec4 activation(vec4 x) {
          `+t+`
        }`,E="result = activation(result);");var T=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+S+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+v+`

        vec4 result = dotProd;
        `+T+`
        `+E+`
        setOutput(result);
      }
    `}}(),uq=function(){return function(n,e,t,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=n[0],a=n[1],s=n[2],u=n[3],l=e[0],c=t[0],h=t[1];this.outputShape=[l,c,h,u];var d=r==="bilinear"?1:0,f=[a-1+".0",s-1+".0"],m=f[0],v=f[1],y=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+m+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+m],g=y[0],w=y[1],b=y[2],S=h>1?[""+(s-1)/(h-1),"(x2-x1) * width_ratio","x1*"+v+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+v],E=S[0],T=S[1],_=S[2];this.userCode=`
      const float height_ratio = float(`+g+`);
      const float width_ratio = float(`+E+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+o+`) {
          return;
        }

        float height_scale = `+w+`;
        float width_scale = `+T+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+m+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+_+`;
        if( in_x < 0.0 || in_x > `+v+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+d+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}(),lq=function(){return function(n,e,t){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=n[n.length-1],o=t?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(t?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+jt(r)+` coords = getOutputCoords();
        int end = `+$I(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+o+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+$I(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `}}();function $I(n,e){if(n===1)return""+e;if(n===2)return e+".y";if(n===3)return e+".z";if(n===4)return e+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}var cq=function(){return function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Id.DENSE;var e=Wh(n),t=ir();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ru(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+t.output+` = result;
      }
    `}}(),hq=function(){return function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Id.DENSE;var e=Wh(n),t=ir();this.outputShape=n,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ru(["r","c","d"],n)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+t.output+` = result;
      }
    `}}(),dq=function(){function n(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+t+`;
      int offset_h = imod(h, `+t+`);
      int in_w = w / `+t+`;
      int offset_w = imod(w, `+t+`);
      int offset_d = (offset_h * `+t+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return n.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},n.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},n.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},n.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},n.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},n}(),fq=function(){return function(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}(),pq=function(){return function(n){this.variableNames=["A"],this.outTexUsage=Wr.DOWNLOAD;var e=ir();this.outputShape=n,this.userCode=`
      `+ZO+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `}}(),mq=function(){return function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Wr.DOWNLOAD;var e=ir();this.outputShape=n,this.userCode=`
      `+ZO+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `}}(),gq=function(){return function(n,e,t){t===void 0&&(t=!1),this.variableNames=["A"];var r=ir(),i=e[0],o=e[1];this.outputShape=n;var a="result";t&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+b_(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+o+`;
        int c = imod(flatIndex, `+o+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `}}(),vq=function(){return function(n,e,t){t===void 0&&(t=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=ir(),i=e[0],o=e[1];this.outputShape=n;var a="",s="result";t&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+n[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+n[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+o+`;
              c = imod(flatIndex, `+o+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+b_(n)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `}}(),yq="return real * expR - imag * expI;",wq="return real * expI + imag * expR;",HI=function(){return function(n,e,t){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=t?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=t?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+n+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+o+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}(),bq=function(){function n(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;return function(r,i){t.valueLoc==null&&(t.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(t.valueLoc,e)}},n}(),xq=function(){return function(n){this.variableNames=["A"];var e=ir(),t=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+t+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}(),_q=function(){return function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=ir(),t=n[0],r=n[1];this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+t+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `}}(),Eq=function(){return function(n,e,t){this.variableNames=["A","indices"];var r=n.slice();r[t]=e,this.outputShape=r,this.rank=r.length;var i=jt(this.rank),o=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],h=0;h<a.length;h++)h===s?c.push("int(getIndices("+l[h]+"))"):c.push(""+l[h]);return c.join()}(n,t);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `}}(),Cq=function(){return function(n,e,t){this.sliceDim=n,this.strides=e,this.variableNames=["x","indices"],this.outputShape=t;var r=jt(e.length),i=jt(t.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+o+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `}}();function rP(n,e){var t=ir();return oO(n,e,t.version+`
    precision highp float;
    `+t.attribute+` vec3 clipSpacePos;
    `+t.attribute+` vec2 uv;
    `+t.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function iP(n,e){return lO(n,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function oP(n,e){return cO(n,e,new Uint16Array([0,1,2,2,1,3]))}function lf(n,e,t,r,i,o,a){dO(t,r);var s=hO(n,e),u=n.TEXTURE_2D;return _e(n,e,function(){return n.bindTexture(u,s)}),_e(n,e,function(){return n.texParameteri(u,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)}),_e(n,e,function(){return n.texParameteri(u,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)}),_e(n,e,function(){return n.texParameteri(u,n.TEXTURE_MIN_FILTER,n.NEAREST)}),_e(n,e,function(){return n.texParameteri(u,n.TEXTURE_MAG_FILTER,n.NEAREST)}),_e(n,e,function(){return n.texImage2D(u,0,i,t,r,0,o,a,null)}),_e(n,e,function(){return n.bindTexture(n.TEXTURE_2D,null)}),s}function aP(n,e,t,r,i){var o=sv(t,r);return lf(n,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,n.FLOAT)}function sP(n,e,t,r,i){var o=sv(t,r);return lf(n,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function uP(n,e,t,r,i){var o=sv(t,r);return lf(n,e,o[0],o[1],n.RGBA,n.RGBA,n.UNSIGNED_BYTE)}function lP(n,e,t,r,i){var o=of(t,r);return lf(n,e,o[0],o[1],i.internalFormatPackedFloat,n.RGBA,n.FLOAT)}function cP(n,e,t,r,i){var o=of(t,r);return lf(n,e,o[0],o[1],i.internalFormatPackedHalfFloat,n.RGBA,i.textureTypeHalfFloat)}function hP(n,e,t,r){return _e(n,e,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),uw(n,e,t,"clipSpacePos",r,3,20,0)&&uw(n,e,t,"uv",r,2,20,12)}function dP(n,e,t,r,i,o,a){var s,u,l;_e(n,e,function(){return n.bindTexture(n.TEXTURE_2D,t)}),o instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=n.UNSIGNED_BYTE,l=n.RGBA):(s=new Float32Array(r*i*4),u=n.FLOAT,l=a.internalFormatPackedFloat),s.set(o),_e(n,e,function(){return n.texImage2D(n.TEXTURE_2D,0,l,r,i,0,n.RGBA,u,s)}),_e(n,e,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function fP(n,e,t,r){_e(n,e,function(){return n.bindTexture(n.TEXTURE_2D,t)}),r.data instanceof Uint8Array?_e(n,e,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r.width,r.height,0,n.RGBA,n.UNSIGNED_BYTE,r.data)}):_e(n,e,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)}),_e(n,e,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function pP(n,e,t,r,i){var o=n.createBuffer();_e(n,e,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,o)});var a=16*t*r;return _e(n,e,function(){return n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)}),_e(n,e,function(){return n.readPixels(0,0,r,t,n.RGBA,n.FLOAT,0)}),_e(n,e,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}),o}function mP(n,e,t){var r=n,i=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function gP(n,e,t,r,i){var o=sv(t,r),a=o[0],s=o[1],u=new Uint8Array(t*r*4);return _e(n,e,function(){return n.readPixels(0,0,a,s,i.downloadTextureFormat,n.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function vP(n,e,t,r,i,o,a,s){var u=n,l=new Float32Array(function(c,h){var d=of(c,h);return d[0]*d[1]*4}(o,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function yP(n,e,t,r){var i=new Float32Array(t*r*4);return _e(n,e,function(){return n.readPixels(0,0,r,t,n.RGBA,n.FLOAT,i)}),i}var Sq=Object.freeze({createVertexShader:rP,createVertexBuffer:iP,createIndexBuffer:oP,createFloat32MatrixTexture:aP,createFloat16MatrixTexture:sP,createUnsignedBytesMatrixTexture:uP,createPackedMatrixTexture:lP,createFloat16PackedMatrixTexture:cP,bindVertexProgramAttributeStreams:hP,uploadDenseMatrixToTexture:dP,uploadPixelDataToTexture:fP,createBufferFromOutputTexture:pP,downloadFloat32MatrixFromBuffer:mP,downloadByteEncodedFloatMatrixFromOutputTexture:gP,downloadPackedMatrixFromBuffer:vP,downloadMatrixFromPackedOutputTexture:yP}),wP=function(){function n(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=te().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,tO(t,e)):this.gl=vo(t),te().getNumber("WEBGL_VERSION")===1)this.textureFloatExtension=Gp(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=Gp(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(Ai(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!Ai(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=iP(this.gl,this.debug),this.indexBuffer=oP(this.gl,this.debug),this.framebuffer=fO(this.gl,this.debug),this.textureConfig=Qx(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(n.prototype,"debug",{get:function(){return te().getBool("DEBUG")},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;_e(t,this.debug,function(){return t.finish()}),_e(t,this.debug,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),_e(t,this.debug,function(){return t.deleteFramebuffer(e.framebuffer)}),_e(t,this.debug,function(){return t.bindBuffer(t.ARRAY_BUFFER,null)}),_e(t,this.debug,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}),_e(t,this.debug,function(){return t.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},n.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),aP(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),sP(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),uP(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),fP(this.gl,this.debug,e,t)},n.prototype.uploadDenseMatrixToTexture=function(e,t,r,i){this.throwIfDisposed(),dP(this.gl,this.debug,e,t,r,i,this.textureConfig)},n.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),cP(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),lP(this.gl,this.debug,e,t,this.textureConfig)},n.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(lw(this.gl,this.debug,this.framebuffer),this.outputTexture=null),_e(this.gl,this.debug,function(){return t.gl.deleteTexture(e)})},n.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,r){var i=this;return this.downloadMatrixDriver(e,function(){return gP(i.gl,i.debug,t,r,i.textureConfig)})},n.prototype.downloadPackedMatrixFromBuffer=function(e,t,r,i,o,a){return vP(this.gl,e,0,0,0,o,a,this.textureConfig)},n.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return mP(this.gl,e,t)},n.prototype.createBufferFromTexture=function(e,t,r){this.bindTextureToFrameBuffer(e);var i=pP(this.gl,this.debug,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},n.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},n.prototype.createFence=function(e){var t,r,i=this;if(te().getBool("WEBGL_FENCE_API_ENABLED")){var o=e,a=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=function(){var s=o.clientWaitSync(a,0,0);return s===o.ALREADY_SIGNALED||s===o.CONDITION_SATISFIED},t=a}else te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(t,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:t,isFencePassed:r}},n.prototype.downloadMatrixFromPackedTexture=function(e,t,r){var i=this;return this.downloadMatrixDriver(e,function(){return yP(i.gl,i.debug,t,r)})},n.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,r=aO(t,this.debug,e),i=rP(t,this.debug),o=sO(t,this.debug);return _e(t,this.debug,function(){return t.attachShader(o,i)}),_e(t,this.debug,function(){return t.attachShader(o,r)}),uO(t,this.debug,o),this.debug&&Xp(t,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=hP(t,this.debug,this.program,this.vertexBuffer)),o},n.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&_e(this.gl,this.debug,function(){return t.gl.deleteProgram(e)})},n.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Xp(this.gl,this.debug,this.program),_e(this.gl,this.debug,function(){return t.gl.useProgram(e)})},n.prototype.getUniformLocation=function(e,t,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?mO(this.gl,this.debug,e,t):gO(this.gl,e,t)},n.prototype.getAttributeLocation=function(e,t){var r=this;return this.throwIfDisposed(),_e(this.gl,this.debug,function(){return r.gl.getAttribLocation(e,t)})},n.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},n.prototype.setInputMatrixTexture=function(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),vO(this.gl,this.debug,this.program,e,t,r)},n.prototype.setOutputMatrixTexture=function(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)},n.prototype.setOutputPackedMatrixTexture=function(e,t,r){this.throwIfDisposed();var i=of(t,r),o=i[0],a=i[1];this.setOutputMatrixTextureDriver(e,o,a)},n.prototype.setOutputMatrixWriteRegion=function(e,t,r,i){this.setOutputMatrixWriteRegionDriver(r,e,i,t)},n.prototype.setOutputPackedMatrixWriteRegion=function(e,t,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},n.prototype.debugValidate=function(){this.program!=null&&Xp(this.gl,this.debug,this.program),bh(this.gl)},n.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),_e(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},n.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),_e(this.gl,this.debug,function(){return e.gl.finish()})},n.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Gp(this.gl,this.debug,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},n.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},n.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},n.prototype.beginQuery=function(){if(te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),r=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),o=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,o),o},n.prototype.endQuery=function(){if(te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT)}},n.prototype.waitForQueryAndGetTime=function(e){return Ie(this,void 0,void 0,function(){var t=this;return Ne(this,function(r){switch(r.label){case 0:return[4,tw(function(){return t.disposed||t.isQueryAvailable(e,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(e,te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},n.prototype.getQueryTime=function(e,t){if(t===0)return null;if(t===2){var r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(e,i.QUERY_RESULT_EXT)/1e6},n.prototype.isQueryAvailable=function(e,t){if(t===0)return!0;if(t===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint},n.prototype.pollFence=function(e){var t=this;return new Promise(function(r){t.addItemToPoll(function(){return e.isFencePassed()},function(){return r()})})},n.prototype.pollItems=function(){for(var e=function(r){for(var i=0;i<r.length;++i){var o=r[i]();if(!o)break}return i-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},n.prototype.addItemToPoll=function(e,t){var r=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||tw(function(){return r.pollItems(),r.itemsToPoll.length===0})},n.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),Yp(this.gl,this.debug,e,this.framebuffer),this.debug&&bh(this.gl)},n.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Yp(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&bh(this.gl)):lw(this.gl,this.debug,this.framebuffer)},n.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var r=t();return this.unbindTextureToFrameBuffer(),r},n.prototype.setOutputMatrixTextureDriver=function(e,t,r){this.throwIfDisposed();var i=this.gl;Yp(i,this.debug,e,this.framebuffer),this.debug&&bh(i),this.outputTexture=e,_e(i,this.debug,function(){return i.viewport(0,0,t,r)}),_e(i,this.debug,function(){return i.scissor(0,0,t,r)})},n.prototype.setOutputMatrixWriteRegionDriver=function(e,t,r,i){var o=this;this.throwIfDisposed(),_e(this.gl,this.debug,function(){return o.gl.scissor(e,t,r,i)})},n.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},n.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},n}();function GI(n,e){if(n.length!==e.length)throw Error("Binary was compiled with "+n.length+" inputs, but was executed with "+e.length+" inputs");n.forEach(function(t,r){var i=t.logicalShape,o=e[r],a=o.shape;if(!jn(i,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+a+" must match");if(!t.isUniform||!o.isUniform){var s=t.texShape,u=o.isUniform?null:o.texData.texShape;if(!jn(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var Iq=function(){return function(n,e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var r=t.filterWidth,i=t.inChannels,o=t.strideWidth,a=t.strideHeight,s=t.padInfo,u=t.outWidth,l=t.dilationWidth,c=t.dilationHeight,h=t.dataFormat,d=s.left,f=s.top,m=i*r,v=ir(),y=h==="channelsLast",g=y?0:1,w=y?1:2,b="",S=0;S<=1;S++)for(var E=0;E<=1;E++)b+=`
          blockIndex = rc.y + `+E+`;
          pos = rc.x + `+S+`;

          if(blockIndex < `+n[1]+" && pos < "+n[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+f+`;
            d0 = offsetY + `+c+" * (pos / "+m+`);

            if(d0 < `+e[g]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+o+". - "+d+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+m+".) / "+i+`.));

              if(d1 < `+e[w]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+y+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*S+E)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*S+E)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+v.output+` = result;
      }
    `}}(),Nq=function(){return function(n,e,t,r,i){this.variableNames=["x"],this.outputShape=[];var o,a=e,s=n[3]-1;this.outputShape=n;var u="float("+t+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+o+`;
        setOutput(val);
      }
    `}}(),Tq=function(){return function(n,e,t,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=e,this.bias=t,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+t+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}(),kq=function(){return function(n,e,t,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,a=e,s=n[3]-1;this.outputShape=n;var u="float("+t+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+o+`;
        setOutput(result);
      }
    `}}(),Rq=function(){return function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var e=n.strideHeight,t=n.strideWidth,r=n.dilationHeight,i=n.effectiveFilterHeight,o=n.effectiveFilterWidth,a=i-1-n.padInfo.top,s=o-1-n.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+o+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+t+`.0;

            if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+o+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}(),Aq=function(){return function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var e=n.strideDepth,t=n.strideHeight,r=n.strideWidth,i=n.dilationDepth,o=n.dilationHeight,a=n.dilationWidth,s=n.effectiveFilterDepth,u=n.effectiveFilterHeight,l=n.effectiveFilterWidth,c=s-1-n.padInfo.front,h=u-1-n.padInfo.top,d=l-1-n.padInfo.left,f=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+h+", "+d+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+n.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+o+`) {
            float dyR = float(dyRCorner + wR) / `+t+`.0;

            if (dyR < 0.0 || dyR >= `+n.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+n.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+f+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),h0=function(){return function(n,e,t,r,i,o,a){t===void 0&&(t=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),o===void 0&&(o=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=t?n[1]:n[2],u=Math.ceil(s/2),l=t?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",h=t?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],f="",m="";o&&(f=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+o+`
        }`:`vec4 activation(vec4 x) {
          `+o+`
        }`,m="result = activation(result);");var v=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+f+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+h[0]+" * "+d[0]+`);
          result += (`+h[1]+" * "+d[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+v+`

        `+m+`

        setOutput(result);
      }
    `}}(),Dq=function(){function n(e,t,r){this.variableNames=["probs"],this.outputShape=[e,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(t-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(t-1)+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;return function(r,i){t.seedLoc==null&&(t.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(t.seedLoc,e)}},n}(),Oq=function(){return function(n,e,t,r){this.variableNames=["indices"],this.outputShape=[n,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+t+`),
                      float(index == coords.y)));
      }
    `}}(),Pq=function(){return function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n;var e=n.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var t=Nr("rc",e),r=jt(e),i=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",h=s-2;h<s;h++)c+=l[h]+" >= "+u[h],h<s-1&&(c+="||");return c}(e,n,t),o=function(s,u,l,c){if(s===1)return"";var h=c.slice(-2);return`
    int r = `+h[0]+`;
    int c = `+h[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(e,n[n.length-1],n[n.length-2],t),a=function(s,u){var l=s.length,c=function(h,d){for(var f=[],m=0;m<=1;m++)for(var v=0;v<=1;v++){for(var y=(m===0?"r":"rp1")+", "+(v===0?"c":"cp1"),g=2;g<h;g++)y=d[d.length-1-g]+","+y;f.push(y)}return f}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(n,t);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+o+`

            setOutput(vec4(`+a+`));
          }
        }
      `}}}(),Mq=function(){return function(n,e,t){this.variableNames=["x"],this.outputShape=e.map(function(u,l){return u[0]+n[l]+u[1]});var r=n.length,i=jt(r),o=e.map(function(u){return u[0]}).join(","),a=e.map(function(u,l){return u[0]+n[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+o+`);
      `+i+" end = "+i+"("+a+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+t+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+o+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+t+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `}}(),Lq=function(){return function(n,e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(function(y,g){return y[0]+n[g]+y[1]});for(var r=n.length,i=jt(r),o=e.map(function(y){return y[0]}).join(","),a=e.map(function(y,g){return y[0]+n[g]}).join(","),s=Nr("rc",r),u=Nr("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",h=[i+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],d=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",m=0,v=r===1?2:4;m<v;m++)f+=`
        `+h[m]+`
        if (`+d+`) {
          result[`+m+"] = float("+t+`);
        } else {
          `+i+` source = rc - start;
          result[`+m+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;f+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+o+`);
      const `+i+" end = "+i+"("+a+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+f+`
        setOutput(result);
      }
    `}}(),d0=function(){return function(n,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,i=n.strideHeight,o=n.strideWidth,a=n.dilationHeight,s=n.dilationWidth,u=n.effectiveFilterHeight,l=n.effectiveFilterWidth,c=n.padInfo.top,h=n.padInfo.left;this.outputShape=n.outShape;var d=e==="avg",f="0.0";if(d||(f="-1.0 / 1e-20"),t)this.userCode=`
        const ivec2 strides = ivec2(`+i+", "+o+`);
        const ivec2 pads = ivec2(`+c+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+n.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var m=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(m="avgValue / count");var v=4*Math.floor(r/4),y=r%4,g=`
      if (`+d+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+i+", "+o+`);
      const ivec2 pads = ivec2(`+c+", "+h+`);
      const float initializationValue = `+f+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+f+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+n.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+g+`
          }

          int xC = xCCorner + `+v+`;
          if (`+(y===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+g+`
          } else if (`+(y===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+g+`
          } else if (`+(y===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+g+`
          }
        }
        setOutput(`+m+`);
      }
    `}}}(),f0=function(){return function(n,e,t){if(this.variableNames=["x"],e==="avg"&&t)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,i=n.strideDepth,o=n.strideHeight,a=n.strideWidth,s=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,c=n.effectiveFilterDepth,h=n.effectiveFilterHeight,d=n.effectiveFilterWidth,f=n.padInfo.front,m=n.padInfo.top,v=n.padInfo.left;this.outputShape=n.outShape;var y=e==="avg",g="0.0";if(y||(g="-1.0 / 1e-20"),t)this.userCode=`
        const ivec3 strides =
            ivec3(`+i+", "+o+", "+a+`);
        const ivec3 pads = ivec3(`+f+", "+m+", "+v+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+n.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+n.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+d+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+n.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+h+" * "+d+` +
                      wR * `+d+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var w=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(w="avgValue / count");var b=4*Math.floor(r/4),S=r%4,E=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+i+", "+o+", "+a+`);
      const ivec3 pads = ivec3(`+f+", "+m+", "+v+`);
      const float initializationValue = `+g+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+n.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+g+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+n.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+n.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+b+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+E+`
            }

            int xC = xCCorner + `+b+`;
            if (`+(S===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+E+`
            } else if (`+(S===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+E+`
            } else if (`+(S===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+E+`
            }
          }
          setOutput(`+w+`);
        }
      }
    `}}}(),Fq=function(){return function(n,e){this.variableNames=["x"];var t=n.windowSize,r=n.batchSize,i=n.inSize,o=Math.ceil(i/t);this.outputShape=[r,o];var a="0.0",s="";e==="prod"?a="1.0":e==="min"?(a="1.0 / 1e-20",s="min"):e==="max"&&(a="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?u="sumValue":e==="prod"?u="prodValue":e==="all"?u="allValue":e==="any"&&(u="anyValue");var l=4*Math.floor(t/4),c=t%4,h=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,d="vec4";e==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):e==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");var f="";i%t>0&&(f=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+f+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+t+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+h+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(c===2)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(c===3)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+h+`
        }
        setOutput(`+u+`);
      }
    `}}(),zq=function(){return function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var t="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),t+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+ru(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+b_(n)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+n[1]+`;
        int cols = `+n[2]+`;

        `+t+`

        setOutput(result);
      }
    `}}(),Bq=function(){return function(n,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],a=n.shape,s=a[1],u=a[2],l=[t&&s>1?i-1:i,t&&u>1?o-1:o],c=[t&&s>1?s-1:s,t&&u>1?u-1:u],h=l[0]/c[0],d=l[1]/c[1],f=1/h,m=1/d,v=2*Math.ceil(f)+2,y=2*Math.ceil(m)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+f+`);
        const float invWidthScale = float(`+m+`);

        const int winHeight = int(`+v+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(o-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}(),jq=function(){return function(n,e,t,r){this.variableNames=["A"],this.outputShape=[];var i=n[0],o=n[1],a=n[2],s=n[3];this.outputShape=[i,e,t,s];var u=[r&&e>1?o-1:o,r&&t>1?a-1:a],l=[r&&e>1?e-1:e,r&&t>1?t-1:t];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}(),Uq=function(){return function(n,e,t,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=n[0],o=n[1],a=n[2],s=n[3];this.outputShape=[i,e,t,s];var u=[r&&e>1?o-1:o,r&&t>1?a-1:a],l=[r&&e>1?e-1:e,r&&t>1?t-1:t];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+o+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(t-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}(),Wq=function(){return function(n,e,t){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],a=n.shape,s=a[1],u=a[2],l=[t&&s>1?i-1:i,t&&u>1?o-1:o],c=[t&&s>1?s-1:s,t&&u>1?u-1:u],h=l[0]/c[0],d=l[1]/c[1],f=1/h,m=1/d,v=2*Math.ceil(f)+2,y=2*Math.ceil(m)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+f+`);
        const float invWidthScale = float(`+m+`);

        const int winHeight = int(`+v+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+t+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+o+`) - 1),
                `+t+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}(),Vq=function(){return function(n,e,t,r){this.variableNames=["A"],this.outputShape=[];var i=n[0],o=n[1],a=n[2],s=n[3];this.outputShape=[i,e,t,s];var u=[r&&e>1?o-1:o,r&&t>1?a-1:a],l=[r&&e>1?e-1:e,r&&t>1?t-1:t],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}(),$q=function(){return function(n,e){this.variableNames=["x"];var t=n.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");if(this.outputShape=n,t!==1){var r=n.map(function(o,a){return function(s){return e.indexOf(s)!==-1&&n[s]!==1?n[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),i=jt(t);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+n[0]+` - coord - 1));
        }
      `}}(),Hq=function(){return function(n,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var t=n.length;if(t>4)throw new Error("WebGL backend: Reverse of rank-"+t+" tensor is not yet supported");this.outputShape=n;var r=Nr("rc",t),i=r[t-1]+" + 1 < "+this.outputShape[t-1],o=r[t-2]+" + 1 < "+this.outputShape[t-2],a=jt(t);function s(u){var l=n.map(function(c,h){return function(d,f){return e.indexOf(d)!==-1&&n[d]!==1?n[d]+" - "+f[d]+" - 1":""+f[d]}(h,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=t===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+n[0]+` - rc - 1),
            `+n[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+n[0]+` - (rc  + 1) - 1),
                `+n[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+i+`){
            result.g = `+function(u){return u[t-1]="("+u[t-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+o+`) {
            result.b = `+function(u){return u[t-2]="("+u[t-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+i+`) {
              result.a = `+function(u){return u[t-1]="("+u[t-1]+" + 1)",u[t-2]="("+u[t-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `}}(),qI=function(){return function(n,e,t,r,i,o,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=jt(i.length),u=jt(o.length),l="";t===1?l="i":t===2&&(l="i, j");var c="getIndices("+l+")",h="";r===1?h="i":r===2&&(h="i, coords[1]");var d="getUpdates("+h+")",f=e>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+n+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+f+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+d+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}(),Gq=function(){return function(n,e){this.variableNames=["x","segmentIds"];var t=n.windowSize,r=n.batchSize,i=n.inSize,o=n.numSegments,a=o*Math.ceil(i/t);this.outputShape=[r,a];var s=4*Math.floor(t/4),u=t%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";i%t>0&&(c=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var h="";i%t>0&&(h=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+h+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+o+")) * float("+t+`));
        int currentSeg = int(mod(float(outIdx), float(`+o+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `}}(),qq=function(){return function(n,e,t){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,t>4)throw Error("Where for rank "+t+" is not yet supported");if(t===1)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<e.length;u++)s.push(""+o[u]),u<n&&a.push(""+o[u]);r=a.join(),i=s.join()}var l=jt(t);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `}}(),Kq=function(){function n(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,r=jt(this.rank),i="uniform int start["+this.rank+"];",o=function(a){if(a===1)return"sourceLoc";if(a<=6)return p0.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);t=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+e.map(function(a,s){return"sourceLoc."+p0[s]+" = start["+s+"] + coords."+p0[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+t+`
        setOutput(getSource(`+o+`));
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,i){t.startLoc==null&&(t.startLoc=r.getUniformLocationNoThrow(i,"start"),t.startLoc==null)||r.gl.uniform1iv(t.startLoc,e)}},n}(),p0=["x","y","z","w","u","v"],Xq=function(){function n(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=jt(this.rank),r=Nr("coords",this.rank),i=Nr("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",a="getChannel(getSource("+i.join()+"), "+o+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+a+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+t+"("+e.map(function(c,h){return"start["+h+"]"}).join()+");":e.map(function(c,h){return i[h]+" = "+r[h]+" + start["+h+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+t+` coords = getOutputCoords();
        `+t+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return n.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,i){t.startLoc==null&&(t.startLoc=r.getUniformLocationNoThrow(i,"start"),t.startLoc==null)||r.gl.uniform1iv(t.startLoc,e)}},n}(),Yq=function(){return function(n,e,t){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=jt(t.length),o=jt(t.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=t.map(function(u,l){return s++,t.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+n+`);
      `+i+" strides = "+i+"("+e+`);

      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `}}(),Qq=function(){function n(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return n.prototype.acquireTexture=function(e,t,r){var i,o=KI(t,r),a=XI(e,o,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),o===jr.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===jr.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===jr.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===jr.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===jr.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),i},n.prototype.releaseTexture=function(e,t,r,i){if(this.freeTextures!=null){var o=XI(t,KI(r,i),i);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(e),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[o],s=a.indexOf(e);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},n.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},n.prototype.getNumUsedTextures=function(){return this.numUsedTextures},n.prototype.getNumFreeTextures=function(){return this.numFreeTextures},n.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var t in this.freeTextures)this.freeTextures[t].forEach(function(r){e.gpgpu.deleteMatrixTexture(r)});for(var t in this.usedTextures)this.usedTextures[t].forEach(function(i){e.gpgpu.deleteMatrixTexture(i)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},n}();function KI(n,e){if(n===Wr.UPLOAD)return jr.PACKED_2X2_FLOAT32;if(n===Wr.RENDER||n==null)return function(t){return te().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?jr.PACKED_2X2_FLOAT32:jr.UNPACKED_FLOAT32:t?jr.PACKED_2X2_FLOAT16:jr.UNPACKED_FLOAT16}(e);if(n===Wr.DOWNLOAD||n===Wr.PIXELS)return jr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+n)}function XI(n,e,t){return n[0]+"_"+n[1]+"_"+e+"_"+t}var Jq=function(){return function(n,e){this.variableNames=["A"];for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[r]*e[r];this.outputShape=t,this.rank=t.length;var i=jt(this.rank),o=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<a.length;c++)l.push("imod("+u[c]+", "+a[c]+")");return l.join()}(n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `}}(),Zq=function(){return function(n,e){this.variableNames=["A"];for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[e[r]];this.outputShape=t,this.rank=t.length;var i=jt(this.rank),o=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<a.length;c++)l[a[c]]=u[c];return l.join()}(e);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+o+`));
    }
    `}}(),e7=function(){return function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var t=new Array(n.length),r=0;r<t.length;r++)t[r]=n[e[r]];if(this.outputShape=t,this.rank=t.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=jt(this.rank),o=JO("rc",this.rank),a=new Array(this.rank);for(r=0;r<e.length;r++)a[e[r]]=o[r];var s="vec2("+a.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+t[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+o[this.rank-1]+`;
      if(++`+o[this.rank-2]+" < "+t[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `}}(),x_=1.7580993408473768,__=1.0507009873554805,Qe=function(){return function(n,e){this.variableNames=["A"],this.outputShape=n,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}(),Ki="if (isnan(x)) return x;",t7="return x;",YI="return abs(x);",bP=Ki+`
  return (x < 0.0) ? 0.0 : x;
`,xP=Ki+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,_P="return (x >= 0.0) ? x : (exp(x) - 1.0);",n7=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+x_+`;
  float scale = `+__+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,QI="return -x;",JI="return ceil(x);",ZI="return floor(x);",eN="return exp(x);",tN="return exp(x) - 1.0;",r7=Ki+`
  return sin(x);
`,i7=Ki+`
  return cos(x);
`,o7=Ki+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,a7=Ki+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,s7=Ki+`
  return atan(x);
`,u7=Ki+"return log(x + sqrt(x * x + 1.0));",l7=Ki+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,c7=Ki+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,pp="return x;",h7="return x;",EP=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,CP=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,SP=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ch=function(){return function(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}(),d7=function(){return function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n;var e=n.length,t=Nr("rc",e),r=jt(e),i=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(e,t),o=t.slice(-2),a=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `}}(),mp={};function gp(n,e){if(e===void 0&&(e=!1),n==="linear")return e?h7:t7;if(n==="relu")return e?EP:bP;if(n==="elu")return e?SP:_P;if(n==="relu6")return e?CP:xP;if(n==="prelu")return e?nP:tP;throw new Error("Activation "+n+" has not been implemented for the WebGL backend.")}var f7=600,IP=function(n){function e(t){var r,i=n.call(this)||this;if(i.gpgpu=t,i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!te().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(t==null){var o=vo(te().getNumber("WEBGL_VERSION"));i.binaryCache=((r=te().getNumber("WEBGL_VERSION"))in mp||(mp[r]={}),mp[r]),i.gpgpu=new wP(o),i.canvas=o.canvas,i.gpgpuCreatedLocally=!0}else i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=t.gl.canvas;return i.textureManager=new Qq(i.gpgpu),i.numMBBeforeWarning=te().global.screen==null?1024:te().global.screen.height*te().global.screen.width*window.devicePixelRatio*f7/1024/1024,i.texData=new f_(i,V),i}return Hi(e,n),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.fromPixels=function(t,r){if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var i=typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement,o=t.data instanceof Uint8Array,a=typeof ImageData<"u"&&t instanceof ImageData,s=typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement,u=typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement,l=s?[t.videoWidth,t.videoHeight]:[t.width,t.height],c=l[0],h=l[1],d=[h,c],f=[h,c,r];if(!(i||o||a||s||u))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);(u||s)&&(this.fromPixels2DContext==null&&(this.fromPixels2DContext=nO(te().getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=c,this.fromPixels2DContext.canvas.height=h,this.fromPixels2DContext.drawImage(t,0,0,c,h),t=this.fromPixels2DContext.canvas);var m,v,y=this.makeTensorInfo(d,"int32");return this.texData.get(y.dataId).usage=Wr.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(y.dataId),t),te().getBool("WEBGL_PACK")?(m=new _q(f),v=this.compileAndRun(m,[y])):(m=new xq(f),v=this.compileAndRun(m,[y])),this.disposeData(y.dataId),v},e.prototype.write=function(t,r,i){if(te().getBool("DEBUG")&&this.checkNumericalProblems(t),i==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var o={};return this.texData.set(o,{shape:r,dtype:i,values:t,usage:Wr.UPLOAD}),o},e.prototype.move=function(t,r,i,o){if(te().getBool("DEBUG")&&this.checkNumericalProblems(r),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:i,dtype:o,values:r,usage:Wr.UPLOAD})},e.prototype.readSync=function(t){var r=this.texData.get(t),i=r.values,o=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new ch(u,pp):new Qe(u,pp);var h=this.runWebGLProgram(c,[{dataId:t,shape:u,dtype:o}],o),d=this.readSync(h.dataId);return this.disposeData(h.dataId),d}if(i!=null)return this.convertAndCacheOnCPU(t);if(o==="string")return i;var f,m,v=this.activeTimers!=null;return v&&(f=Si()),o==="complex64"?m=gw(a.real.dataSync(),a.imag.dataSync()):m=this.getValuesFromTexture(t),v&&(this.downloadWaitMs+=Si()-f),this.convertAndCacheOnCPU(t,m)},e.prototype.read=function(t){return Ie(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h,d,f,m,v,y,g,w,b,S,E,T,_,x;return Ne(this,function(C){switch(C.label){case 0:if(this.pendingRead.has(t))return r=this.pendingRead.get(t),[2,new Promise(function(N){return r.push(N)})];if(i=this.texData.get(t),o=i.values,a=i.shape,s=i.slice,u=i.dtype,l=i.complexTensors,c=i.isPacked,s!=null)return h=void 0,h=c?new ch(a,pp):new Qe(a,pp),d=this.runWebGLProgram(h,[{dataId:t,shape:a,dtype:u}],u),f=this.read(d.dataId),this.disposeData(d.dataId),[2,f];if(o!=null)return[2,this.convertAndCacheOnCPU(t)];if(!te().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&te().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return m=null,u!=="complex64"&&te().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(t),y=this.texData.get(v.dataId),m=(x=this.gpgpu).createBufferFromTexture.apply(x,[y.texture].concat(Wh(a)))),this.pendingRead.set(t,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:C.sent(),C.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return w=C.sent(),b=w[0],S=w[1],g=gw(b,S),[3,5];case 4:m==null?g=this.getValuesFromTexture(t):(E=Ae(a),g=this.gpgpu.downloadFloat32MatrixFromBuffer(m,E)),C.label=5;case 5:return v!=null&&this.disposeData(v.dataId),T=this.convertAndCacheOnCPU(t,g),_=this.pendingRead.get(t),this.pendingRead.delete(t),_.forEach(function(N){return N(T)}),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,T]}})})},e.prototype.checkNumericalProblems=function(t){if(t!=null)for(var r=0;r<t.length;r++){var i=t[r];if(!rO(i))throw te().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(t){var r,i=this.texData.get(t),o=i.shape,a=i.dtype,s=i.isPacked,u=Ae(o);if(te().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(t),c=this.texData.get(l.dataId),h=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(Wh(o))).subarray(0,u);return this.disposeData(l.dataId),h}var d=te().getBool("WEBGL_PACK")&&s===!0,f=d?Qp(o):o,m=d?new mq(f):new pq(f),v=this.runWebGLProgram(m,[{shape:f,dtype:a,dataId:t}],"float32"),y=this.texData.get(v.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(y.texture,y.texShape[0],y.texShape[1]).subarray(0,u);return this.disposeData(v.dataId),g},e.prototype.time=function(t){return Ie(this,void 0,void 0,function(){var r,i,o,a,s,u,l;return Ne(this,function(c){switch(c.label){case 0:return r=this.activeTimers,i=[],o=!1,this.programTimersStack==null?(this.programTimersStack=i,o=!0):this.activeTimers.push(i),this.activeTimers=i,t(),a=ra(this.activeTimers.map(function(h){return h.query})).filter(function(h){return h!=null}),s=ra(this.activeTimers.map(function(h){return h.name})).filter(function(h){return h!=null}),this.activeTimers=r,o&&(this.programTimersStack=null),[4,Promise.all(a)];case 1:return u=c.sent(),l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:UD(u),getExtraProfileInfo:function(){return u.map(function(h,d){return{name:s[d],ms:h}}).map(function(h){return h.name+": "+h.ms}).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,l]}})})},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:Si(),endMs:null}},e.prototype.endTimer=function(t){return te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=Si(),t)},e.prototype.getQueryTime=function(t){return Ie(this,void 0,void 0,function(){var r;return Ne(this,function(i){return te().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(r=t).endMs-r.startMs]})})},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var r=this.texData.get(t).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var r=this.texData.get(t),i=r.texture,o=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||t,h=this.dataRefCount.get(c);h>1?this.dataRefCount.set(c,h-1):(this.dataRefCount.delete(c),i!=null&&(this.numBytesInGPU-=this.computeBytes(a,o),this.textureManager.releaseTexture(i,a,s,u)));var d=this.texData.get(t);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return te().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=V.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&t.every(function(o){return i.texData.get(o.dataId).texture==null&&o.size<r})},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,r){var i=this.makeOutput(t.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:V.keep(t.clone()),imag:V.keep(r.clone())},i},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,r,i){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,r,i);if(Ae(i)===0)return gn([],i,t.dtype);var o=this.texData.get(t.dataId).isPacked,a=h_(t.shape,r,i);if(o||!a){var s=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Xq(i):new Kq(i),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[t],null,u)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,r,i)},e.prototype.shallowSlice=function(t,r,i){var o=this.texData.get(t.dataId),a=this.makeOutput(i,t.dtype),s=this.texData.get(a.dataId);Object.assign(s,o),s.shape=i,s.dtype=t.dtype;var u=d_(r,t.strides);o.slice&&(u+=o.slice.flatOffset),s.slice={flatOffset:u,origDataId:o.slice&&o.slice.origDataId||t.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),a},e.prototype.stridedSlice=function(t,r,i,o){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,r,i,o);var a=gv(r,i,o);if(a.some(function(u){return u===0}))return gn([],a);var s=new Yq(r,o,a);return this.compileAndRun(s,[t])},e.prototype.reverse=function(t,r){var i=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hq(t.shape,r):new $q(t.shape,r);return this.compileAndRun(i,[t])},e.prototype.concat=function(t,r){if(t[0].dtype==="complex64"){var i=t.map(function(f){return Ir(f)}),o=t.map(function(f){return li(f)});return Tn(this.concat(i,r),this.concat(o,r))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,r);if(t.length===1)return t[0];if(t.length>te().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(t.length/2),s=this.concat(t.slice(0,a),r),u=this.concat(t.slice(a),r);return this.concat([s,u],r)}if(te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var l=new eq(t.map(function(f){return f.shape}),r);return this.compileAndRun(l,t)}var c=Su(t.map(function(f){return f.shape}),r),h=t.map(function(f){return f.as2D(-1,Ae(f.shape.slice(r)))}),d=new ZG(h.map(function(f){return f.shape}));return this.compileAndRun(d,h).reshape(c)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,QI,t.dtype);var r=new Qe(t.shape,QI);return this.compileAndRun(r,[t])},e.prototype.batchMatMul=function(t,r,i,o){var a=i?t.shape[2]:t.shape[1],s=o?r.shape[1]:r.shape[2],u=i?t.shape[1]:t.shape[2],l=t.shape[0];if((a===1||s===1)&&u>1e3){i&&(t=t.transpose([0,2,1])),o&&(r=r.transpose([0,2,1]));var c=s===1?t:t.as3D(l,u,1),h=s===1?2:1,d=s===1?r.as3D(l,1,u):r;return this.multiply(c,d).sum(h,!0)}var f=wn(t.dtype,r.dtype),m=new h0(t.shape,[l,a,s],i,o);return this.compileAndRun(m,[t,r],f)},e.prototype.fusedBatchMatMul=function(t){var r=t.a,i=t.b,o=t.transposeA,a=t.transposeB,s=t.bias,u=t.activation,l=t.preluActivationWeights,c=o?r.shape[2]:r.shape[1],h=a?i.shape[1]:i.shape[2],d=r.shape[0],f=wn(r.dtype,i.dtype),m=s!=null,v=l!=null,y=u?gp(u,!0):null,g=new h0(r.shape,[d,c,h],o,a,m,y,v),w=[r,i];return s&&w.push(s),l&&w.push(l),this.compileAndRun(g,w,f)},e.prototype.multiply=function(t,r){if(t.dtype==="complex64"){var i=this.texData.get(t.dataId),o=this.texData.get(r.dataId),a=new BI(KG,t.shape,r.shape),s=new BI(XG,t.shape,r.shape),u=[this.makeComplexComponentTensorInfo(t,i.complexTensors.real),this.makeComplexComponentTensorInfo(t,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,o.complexTensors.real),this.makeComplexComponentTensorInfo(r,o.complexTensors.imag)],l=this.compileAndRun(a,u),c=this.compileAndRun(s,u),h=this.complex(l,c);return l.dispose(),c.dispose(),h}if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.multiply(t,r);if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,jI,t.dtype);var d=new sn(jI,t.shape,r.shape);return this.compileAndRun(d,[t,r],t.dtype)},e.prototype.batchNormalization=function(t,r,i,o,a,s){var u=[t,r,i],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(a!=null&&(c=a.shape,u.push(a)),te().getBool("WEBGL_PACK_NORMALIZATION")){var h=new qG(t.shape,r.shape,i.shape,l,c,o);return this.compileAndRun(h,u)}var d=new GG(t.shape,r.shape,i.shape,l,c,o);return this.compileAndRun(d,u)},e.prototype.localResponseNormalization4D=function(t,r,i,o,a){var s=te().getBool("WEBGL_PACK_NORMALIZATION")?new kq(t.shape,r,i,o,a):new Nq(t.shape,r,i,o,a);return this.compileAndRun(s,[t])},e.prototype.LRNGrad=function(t,r,i,o,a,s,u){var l=new Tq(r.shape,o,a,s,u);return this.compileAndRun(l,[r,i,t])},e.prototype.tile=function(t,r){if(t.dtype==="string"){var i=this.readSync(t.dataId).map(function(a){return Cd(a)});return YO(qe(t.shape,t.dtype,i),r)}var o=new Jq(t.shape,r);return this.compileAndRun(o,[t])},e.prototype.pad=function(t,r,i){var o=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Lq(t.shape,r,i):new Mq(t.shape,r,i);return this.compileAndRun(o,[t])},e.prototype.transpose=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,r);var i=te().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new e7(t.shape,r):new Zq(t.shape,r);return this.compileAndRun(i,[t])},e.prototype.gather=function(t,r,i){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.gather(t,r,i);var o=new Eq(t.shape,r.size,i);return this.compileAndRun(o,[t,r])},e.prototype.batchToSpaceND=function(t,r,i){B(t.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var o=r.reduce(function(h,d){return h*d}),a=ig(t.shape,r,o),s=og(a.length,r.length),u=ag(t.shape,r,o),l=UO(i,r.length),c=WO(u,i,r.length);return t.reshape(a).transpose(s).reshape(u).slice(l,c)},e.prototype.spaceToBatchND=function(t,r,i){B(t.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var o=r.reduce(function(d,f){return d*f}),a=[[0,0]];a.push.apply(a,i);for(var s=1+r.length;s<t.shape.length;++s)a.push([0,0]);var u=t.pad(a),l=ig(u.shape,r,o,!1),c=og(l.length,r.length,!1),h=ag(u.shape,r,o,!1);return u.reshape(l).transpose(c).reshape(h)},e.prototype.reduce=function(t,r,i){var o=t.shape[0],a=t.shape[1],s=u0(a),u=new Fq({windowSize:s,inSize:a,batchSize:o},r),l=this.compileAndRun(u,[t],i);return l.shape[1]===1?l:this.reduce(l,r,i)},e.prototype.argReduce=function(t,r,i){i===void 0&&(i=null);var o=t.shape[0],a=t.shape[1];i!=null&&(o=i.shape[0],a=i.shape[1]);var s=u0(a),u=new FG({windowSize:s,inSize:a,batchSize:o},r,i==null),l=[t];i!=null&&l.push(i);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(t,r,c)},e.prototype.argReducePacked=function(t,r,i){i===void 0&&(i=null);var o=i!=null?i.shape:t.shape,a=u0(o[o.length-1]),s=new VG(o,a,r,i==null),u=i==null?[t]:[t,i],l=this.compileAndRun(s,u,"int32");return l.rank===t.rank?this.argReducePacked(t,r,l):l},e.prototype.sum=function(t,r){Cr("sum",r,t.rank);var i=Gn(t.shape,r),o=i[0],a=Ae(i[1]),s=t.as2D(-1,a),u=o0(t.dtype);return this.reduce(s,"sum",u).reshape(o)},e.prototype.prod=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,r);var i=Gn(t.shape,r),o=i[0],a=Ae(i[1]),s=t.as2D(-1,a),u=o0(t.dtype);return this.reduce(s,"prod",u).reshape(o)},e.prototype.unsortedSegmentSum=function(t,r,i){var o=0,a=Gi([o],t.rank),s=t;a!=null&&(s=t.transpose(a),o=qi(1,t.rank)[0]);var u=function(f,m,v){for(var y=[],g=f.length,w=0;w<g;w++)w!==m?y.push(f[w]):y.push(v);return y}(s.shape,o,i),l=Ae([s.shape[o]]),c=s.as2D(-1,l),h=o0(t.dtype),d=this.segOpCompute(c,"unsortedSegmentSum",r,h,i).reshape(u);return a!=null&&(d=d.transpose(lv(a))),d},e.prototype.segOpCompute=function(t,r,i,o,a){var s=t.shape[0],u=t.shape[1],l=function(d,f){var m,v=!1;for(d<=$O?(m=d,v=!0):m=rg(d,Math.floor(Math.sqrt(d)));!v;)m>f||m===d?v=!0:m=rg(d,m+1);return m}(u,a),c=new Gq({windowSize:l,inSize:u,batchSize:s,numSegments:a},r),h=this.compileAndRun(c,[t,i],o);return h.shape[1]===a?h:(i=cv(0,a).tile([u/l]),this.segOpCompute(h,r,i,o,a))},e.prototype.argMinMaxReduce=function(t,r,i){var o=[r];if(Cr("arg"+i.charAt(0).toUpperCase()+i.slice(1),o,t.rank),!te().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var a=Gn(t.shape,o),s=a[0],u=Ae(a[1]),l=t.as2D(-1,u);return this.argReduce(l,i).reshape(s)}return this.argReducePacked(t,i)},e.prototype.argMin=function(t,r){return this.argMinMaxReduce(t,r,"min")},e.prototype.argMax=function(t,r){return this.argMinMaxReduce(t,r,"max")},e.prototype.cumsum=function(t,r,i,o){if(r!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+r);var a=new lq(t.shape,i,o);return this.compileAndRun(a,[t])},e.prototype.equal=function(t,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(equal(a, b));
`,"bool");var i=new sn("return float(a == b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.notEqual=function(t,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new sn("return float(a != b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.less=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.less(t,r);if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new sn("return float(a < b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.lessEqual=function(t,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new sn("return float(a <= b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.greater=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.greater(t,r);if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new sn("return float(a > b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.greaterEqual=function(t,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new sn("return float(a >= b);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.logicalNot=function(t){var r=new Qe(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[t])},e.prototype.logicalAnd=function(t,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new sn("return float(a >= 1.0 && b >= 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.logicalOr=function(t,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new sn("return float(a >= 1.0 || b >= 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r],"bool")},e.prototype.select=function(t,r,i){var o=new qq(t.rank,r.shape,r.rank);return this.compileAndRun(o,[t,r,i],wn(r.dtype,i.dtype))},e.prototype.where=function(t){fw("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=t.dataSync();return w_(t.shape,r)},e.prototype.topk=function(t,r,i){return QO(t.dataSync(),t.shape,t.dtype,r)},e.prototype.min=function(t,r){Cr("min",r,t.rank);var i=Gn(t.shape,r),o=i[0],a=Ae(i[1]),s=t.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(o)},e.prototype.minimum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.minimum(t,r);var i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ko(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new sn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.mod=function(t,r){var i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ko(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new sn(`if (b == 0.0) return NAN;
  return mod(a, b);`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.max=function(t,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,r);Cr("max",r,t.rank);var i=Gn(t.shape,r),o=i[0],a=Ae(i[1]),s=t.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(o)},e.prototype.maximum=function(t,r){if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.maximum(t,r);var i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ko(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new sn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.all=function(t,r){Cr("all",r,t.rank);var i=Gn(t.shape,r),o=i[0],a=Ae(i[1]),s=t.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(o)},e.prototype.any=function(t,r){Cr("any",r,t.rank);var i=Gn(t.shape,r),o=i[0],a=Ae(i[1]),s=t.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(o)},e.prototype.squaredDifference=function(t,r){var i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ko("return (a - b) * (a - b);",t.shape,r.shape):new sn("return (a - b) * (a - b);",t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.realDivide=function(t,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var i=new sn(`
if (a == b) {
  return 1.0;
};
return a / b;`,t.shape,r.shape);return this.compileAndRun(i,[t,r],"float32")},e.prototype.floorDiv=function(t,r){if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new sn(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,t.shape,r.shape);return this.compileAndRun(i,[t,r],"int32")},e.prototype.add=function(t,r){if(t.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(t,r,l0);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.add(t,r);var i=wn(t.dtype,r.dtype);if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,l0,i);var o=new sn(l0,t.shape,r.shape);return this.compileAndRun(o,[t,r],i)},e.prototype.packedUnaryOp=function(t,r,i){var o=new ch(t.shape,r);return this.compileAndRun(o,[t],i)},e.prototype.packedBinaryOp=function(t,r,i,o,a){a===void 0&&(a=!1);var s=new ko(i,t.shape,r.shape,a);return this.compileAndRun(s,[t,r],o)},e.prototype.complexSeparableBinaryOp=function(t,r,i){var o=this,a=this.texData.get(t.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(d){var f=d[0],m=d[1],v=o.makeComplexComponentTensorInfo(t,f),y=o.makeComplexComponentTensorInfo(r,m),g=new sn(i,t.shape,r.shape);return o.compileAndRun(g,[v,y],wn(f.dtype,m.dtype))}),l=u[0],c=u[1],h=this.complex(l,c);return l.dispose(),c.dispose(),h},e.prototype.makeComplexComponentTensorInfo=function(t,r){return{dataId:r.dataId,dtype:r.dtype,shape:t.shape}},e.prototype.addN=function(t){if(t.length===1)return t[0];if(t.length>te().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(t.length/2),i=this.addN(t.slice(0,r)),o=this.addN(t.slice(r));return this.addN([i,o])}var a=t.map(function(l){return l.dtype}).reduce(function(l,c){return wn(l,c)}),s=t.map(function(l){return l.shape}),u=te().getBool("WEBGL_PACK")?new LG(t[0].shape,s):new MG(t[0].shape,s);return this.compileAndRun(u,t,a)},e.prototype.subtract=function(t,r){if(t.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(t,r,c0);if(this.shouldExecuteOnCPU([t,r]))return this.cpuBackend.subtract(t,r);var i=wn(t.dtype,r.dtype);if(te().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,r,c0,t.dtype);var o=new sn(c0,t.shape,r.shape);return this.compileAndRun(o,[t,r],i)},e.prototype.pow=function(t,r){var i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ko(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new sn(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,t.shape,r.shape),o=wn(t.dtype,r.dtype);return this.compileAndRun(i,[t,r],o)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,JI,t.dtype);var r=new Qe(t.shape,JI);return this.compileAndRun(r,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ZI,t.dtype);var r=new Qe(t.shape,ZI);return this.compileAndRun(r,[t])},e.prototype.sign=function(t){var r=new Qe(t.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[t])},e.prototype.isNaN=function(t){var r=new Qe(t.shape,"return float(isnan(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.isInf=function(t){var r=new Qe(t.shape,"return float(isinf(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.isFinite=function(t){var r=new Qe(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[t],"bool")},e.prototype.round=function(t){var r=new Qe(t.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,eN,t.dtype);var r=new Qe(t.shape,eN);return this.compileAndRun(r,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,tN,t.dtype);var r=new Qe(t.shape,tN);return this.compileAndRun(r,[t])},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,t.dtype);var r=new Qe(t.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[t])},e.prototype.log1p=function(t){var r=new Qe(t.shape,"return log(1.0 + x);");return this.compileAndRun(r,[t])},e.prototype.sqrt=function(t){var r=new Qe(t.shape,"return sqrt(x);");return this.compileAndRun(r,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var r=new Qe(t.shape,"return inversesqrt(x);");return this.compileAndRun(r,[t])},e.prototype.reciprocal=function(t){var r=new Qe(t.shape,"return 1.0 / x;");return this.compileAndRun(r,[t])},e.prototype.relu=function(t){var r;return r=te().getBool("WEBGL_PACK")?new ch(t.shape,EP):new Qe(t.shape,bP),this.compileAndRun(r,[t])},e.prototype.relu6=function(t){var r;return r=te().getBool("WEBGL_PACK")?new ch(t.shape,CP):new Qe(t.shape,xP),this.compileAndRun(r,[t])},e.prototype.prelu=function(t,r){var i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ko(nP,t.shape,r.shape):new sn(tP,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.elu=function(t){if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,SP,t.dtype);var r=new Qe(t.shape,_P);return this.compileAndRun(r,[t])},e.prototype.eluDer=function(t,r){var i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ko(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,t.shape,r.shape):new sn("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.selu=function(t){var r=new Qe(t.shape,n7);return this.compileAndRun(r,[t])},e.prototype.int=function(t){var r=new Qe(t.shape,"return float(int(x));");return this.compileAndRun(r,[t],"int32")},e.prototype.clip=function(t,r,i){var o,a=(o=te().getBool("WEBGL_PACK_CLIP")?new QG(t.shape):new YG(t.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(o,[t],null,a)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(te().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,YI,t.dtype);var r=new Qe(t.shape,YI);return this.compileAndRun(r,[t])},e.prototype.complexAbs=function(t){var r=this.texData.get(t.dataId),i=new JG(t.shape),o=[this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)];return this.compileAndRun(i,o)},e.prototype.sigmoid=function(t){var r=new Qe(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[t])},e.prototype.softplus=function(t){var r=new Qe(t.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[t])},e.prototype.sin=function(t){var r=new Qe(t.shape,r7);return this.compileAndRun(r,[t])},e.prototype.cos=function(t){var r=new Qe(t.shape,i7);return this.compileAndRun(r,[t])},e.prototype.tan=function(t){var r=new Qe(t.shape,"return tan(x);");return this.compileAndRun(r,[t])},e.prototype.asin=function(t){var r=new Qe(t.shape,o7);return this.compileAndRun(r,[t])},e.prototype.acos=function(t){var r=new Qe(t.shape,a7);return this.compileAndRun(r,[t])},e.prototype.atan=function(t){var r=new Qe(t.shape,s7);return this.compileAndRun(r,[t])},e.prototype.atan2=function(t,r){var i=te().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ko(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,t.shape,r.shape):new sn(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,t.shape,r.shape);return this.compileAndRun(i,[t,r])},e.prototype.sinh=function(t){var r=new Qe(t.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[t])},e.prototype.cosh=function(t){var r=new Qe(t.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[t])},e.prototype.tanh=function(t){var r=new Qe(t.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[t])},e.prototype.asinh=function(t){var r=new Qe(t.shape,u7);return this.compileAndRun(r,[t])},e.prototype.acosh=function(t){var r=new Qe(t.shape,l7);return this.compileAndRun(r,[t])},e.prototype.atanh=function(t){var r=new Qe(t.shape,c7);return this.compileAndRun(r,[t])},e.prototype.erf=function(t){var r=new Qe(t.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[t])},e.prototype.step=function(t,r){var i=new Qe(t.shape,function(o){return o===void 0&&(o=0),Ki+`
    return x > 0.0 ? 1.0 : float(`+o+`);
  `}(r));return this.compileAndRun(i,[t])},e.prototype.conv2dByMatMul=function(t,r,i,o,a,s){var u=t.shape,l=this.texData.get(t.dataId),c=i.inChannels,h=u[0]*u[1]*u[2],d=i.outChannels,f=i.dataFormat==="channelsLast",m=(h===1||d===1)&&c>1e3,v=u[2]%2!=0&&!!l.isPacked;if(m||!te().getBool("WEBGL_LAZILY_UNPACK")||!te().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!v){var y=f?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],g=this.reshape(t,[1,y,i.inChannels]),w=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:g,b:w,transposeA:!1,transposeB:!1,bias:o,activation:a,preluActivationWeights:s}),i.outShape)}var b=f?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),S={dataId:t.dataId,shape:[1,b,i.inChannels],dtype:t.dtype},E=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,B(xh(l.shape,S.shape),function(){return"packed reshape "+l.shape+" to "+S.shape+" isn't free"});var T=this.reshape(r,[1,i.inChannels,i.outChannels]),_=this.fusedBatchMatMul({a:S,b:T,transposeA:!1,transposeB:!1,bias:o,activation:a,preluActivationWeights:s}),x=this.texData.get(_.dataId);return B(x.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=E,x.shape=i.outShape,V.makeTensorFromDataId(_.dataId,i.outShape,_.dtype)},e.prototype.conv2dWithIm2Row=function(t,r,i,o,a,s){var u=i.filterWidth,l=i.filterHeight,c=i.inChannels,h=i.outWidth,d=i.outHeight,f=i.dataFormat==="channelsLast",m=u*l*c,v=d*h,y=[m,v],g=t.squeeze([0]),w=r.reshape([1,m,-1]),b=new Iq(y,g.shape,i),S=this.compileAndRun(b,[g]).reshape([1,y[0],y[1]]),E=o!=null,T=s!=null,_=a?gp(a,!0):null,x=new h0(S.shape,[1,v,i.outChannels],!0,!1,E,_,T),C=[S,w];o&&C.push(o),T&&C.push(s);var N=this.compileAndRun(x,C);return f?N.reshape([1,d,h,i.outChannels]):N.reshape([1,i.outChannels,d,h])},e.prototype.fusedConv2d=function(t){var r=t.input,i=t.filter,o=t.convInfo,a=t.bias,s=t.activation,u=t.preluActivationWeights;if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,o,a,s,u);if(te().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,o,a,s,u);var l=a!=null,c=u!=null,h=s?gp(s,!1):null,d=new UI(o,l,h,c),f=[r,i];return a&&f.push(a),u&&f.push(u),this.compileAndRun(d,f)},e.prototype.conv2d=function(t,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(t,r,i);if(te().getBool("WEBGL_CONV_IM2COL")&&t.shape[0]===1)return this.conv2dWithIm2Row(t,r,i);var o=new UI(i);return this.compileAndRun(o,[t,r])},e.prototype.conv2dDerInput=function(t,r,i){var o=new nq(i);return this.compileAndRun(o,[t,r])},e.prototype.conv2dDerFilter=function(t,r,i){var o=new tq(i);return this.compileAndRun(o,[t,r])},e.prototype.fusedDepthwiseConv2D=function(t){var r,i=t.input,o=t.filter,a=t.convInfo,s=t.bias,u=t.activation,l=t.preluActivationWeights,c=te().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,h=u?gp(u,c):null,d=[i,o],f=s!=null,m=l!=null;return f&&d.push(s),m&&d.push(l),c?(r=new VI(a,f,h,m),this.compileAndRun(r,d)):(r=new WI(a,f,h,m),this.compileAndRun(r,d))},e.prototype.depthwiseConv2D=function(t,r,i){var o;return te().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(o=new VI(i),this.compileAndRun(o,[t,r])):(o=new WI(i),this.compileAndRun(o,[t,r]))},e.prototype.depthwiseConv2DDerInput=function(t,r,i){var o=new aq(i);return this.compileAndRun(o,[t,r])},e.prototype.depthwiseConv2DDerFilter=function(t,r,i){var o=new oq(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3d=function(t,r,i){var o=new sq(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3dDerInput=function(t,r,i){var o=new iq(i);return this.compileAndRun(o,[t,r])},e.prototype.conv3dDerFilter=function(t,r,i){var o=new rq(i);return this.compileAndRun(o,[t,r])},e.prototype.maxPool=function(t,r){var i=new d0(r,"max",!1);return this.compileAndRun(i,[t])},e.prototype.avgPool=function(t,r){var i=new d0(r,"avg",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.maxPoolBackprop=function(t,r,i,o){var a=new d0(o,"max",!0),s=this.compileAndRun(a,[r]),u=new Rq(o),l=this.compileAndRun(u,[t,s],r.dtype);return s.dispose(),l},e.prototype.avgPoolBackprop=function(t,r,i){var o=new $G(i);return this.compileAndRun(o,[t],r.dtype)},e.prototype.cast=function(t,r){return g_(t,r,this)},e.prototype.unstack=function(t,r){for(var i=t.shape[r],o=new Array(t.rank-1),a=0,s=0;s<t.rank;s++)s!==r&&(o[a++]=t.shape[s]);var u=new Array(t.rank).fill(0),l=t.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(t,u,l).reshape(o);return c},e.prototype.avgPool3d=function(t,r){var i=new f0(r,"avg",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,r,i){var o=new HG(i);return this.compileAndRun(o,[t],r.dtype)},e.prototype.maxPool3d=function(t,r){var i=new f0(r,"max",!1);return this.compileAndRun(i,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,r,i,o){var a=new f0(o,"max",!0),s=this.compileAndRun(a,[r]),u=new Aq(o),l=this.compileAndRun(u,[t,s],r.dtype);return s.dispose(),l},e.prototype.reshape=function(t,r){var i=this.texData.get(t.dataId);if(i.isPacked&&!xh(t.shape,r)&&(i.texture===null||!xh(i.shape,r))){var o=this.packedReshape(t,r);return V.makeTensorFromDataId(o.dataId,o.shape,o.dtype)}return lg(t,r)},e.prototype.resizeBilinear=function(t,r,i,o){var a=te().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Uq(t.shape,r,i,o):new jq(t.shape,r,i,o);return this.compileAndRun(a,[t])},e.prototype.resizeBilinearBackprop=function(t,r,i){var o=new Bq(t,r,i);return this.compileAndRun(o,[t])},e.prototype.resizeNearestNeighbor=function(t,r,i,o){var a=new Vq(t.shape,r,i,o);return this.compileAndRun(a,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,r,i){var o=new Wq(t,r,i);return this.compileAndRun(o,[t])},e.prototype.multinomial=function(t,r,i,o){var a=r?t:Wu(t),s=a.shape[0],u=a.shape[1],l=new Dq(s,u,i),c=l.getCustomSetupFunc(o);return this.compileAndRun(l,[a],"int32",c)},e.prototype.oneHot=function(t,r,i,o){var a=new Oq(t.size,r,i,o);return this.compileAndRun(a,[t])},e.prototype.diag=function(t){var r=new fq(t.size);return this.compileAndRun(r,[t])},e.prototype.nonMaxSuppression=function(t,r,i,o,a){return fw("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),y_(t.dataSync(),r.dataSync(),i,o,a)},e.prototype.cropAndResize=function(t,r,i,o,a,s){var u=new uq(t.shape,r.shape,o,a,s);return this.compileAndRun(u,[t,r,i])},e.prototype.depthToSpace=function(t,r,i){B(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var o=t.shape[0],a=i==="NHWC"?t.shape[1]:t.shape[2],s=i==="NHWC"?t.shape[2]:t.shape[3],u=i==="NHWC"?t.shape[3]:t.shape[1],l=a*r,c=s*r,h=u/(r*r),d=new dq(i==="NHWC"?[o,l,c,h]:[o,h,l,c],r,i);return this.compileAndRun(d,[t])},e.prototype.split=function(t,r,i){return XO(t,r,i)},e.prototype.scatterND=function(t,r,i){var o=sg(0,t,i),a=o.sliceRank,s=o.numUpdates,u=o.sliceSize,l=o.strides,c=o.outputSize,h=[c/u,u],d=t.reshape([s,a]),f=r.reshape([s,u]);if(c===0)return lg(gn([]),i);var m=Ee(0),v=new qI(s,a,d.rank,f.rank,l,h);return this.compileAndRun(v,[f,d,m]).reshape(i)},e.prototype.sparseToDense=function(t,r,i,o){var a=sg(0,t,i),s=a.sliceRank,u=a.numUpdates,l=a.strides,c=a.outputSize,h=new qI(u,s,t.rank,r.rank,l,[c,1],!1);return this.compileAndRun(h,[r,t,o]).reshape(i)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,r){var i=this.texData.get(t.dataId),o=new HI(yq,t.shape,r),a=new HI(wq,t.shape,r),s=[this.makeComplexComponentTensorInfo(t,i.complexTensors.real),this.makeComplexComponentTensorInfo(t,i.complexTensors.imag)],u=this.compileAndRun(o,s),l=this.compileAndRun(a,s),c=this.complex(u,l).as2D(t.shape[0],t.shape[1]);return u.dispose(),l.dispose(),c},e.prototype.gatherND=function(t,r){var i=r.shape,o=i[i.length-1],a=VO(t,r),s=a[0],u=a[1],l=a[2],c=a[3],h=r.reshape([u,o]),d=t.reshape([t.size/l,l]),f=new Cq(o,c,[u,l]);return this.compileAndRun(f,[d,h]).reshape(s)},e.prototype.fill=function(t,r,i){if((i=i||Ic(r))==="string"){var o=Ed(i,Ae(t));return o.fill(r),V.makeTensor(o,t,i,this)}var a=new bq(t,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],i,s)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,t.dtype==="string"?"":0,t.dtype)},e.prototype.linspace=function(t,r,i){return v_(t,r,i)},e.prototype.makeTensorInfo=function(t,r){var i=this.write(null,t,r);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:r}},e.prototype.makeOutput=function(t,r){var i=this.makeTensorInfo(t,r).dataId;return V.makeTensorFromDataId(i,t,r,this)},e.prototype.unpackTensor=function(t){var r=new d7(t.shape);return this.runWebGLProgram(r,[t],t.dtype)},e.prototype.packTensor=function(t){var r=new Pq(t.shape);return this.runWebGLProgram(r,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,r){var i=[Nd(t.shape)].concat(Td(t.shape)),o={dtype:t.dtype,shape:i,dataId:t.dataId},a=[Nd(r)].concat(Td(r)),s=new zq(a,i),u=this.runWebGLProgram(s,[o],t.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},e.prototype.decode=function(t){var r,i=this.texData.get(t),o=i.isPacked,a=i.shape,s=i.dtype,u=Qp(a);return r=o?new hq(u):new cq(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:t}],s,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,r,i,o,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(t.outputShape,i),l=this.texData.get(u.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===Id.DENSE){var c=Wh(t.outputShape);l.texShape=c.map(function(b){return 2*b})}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),Ae(u.shape)===0)return l.values=_d(u.dtype,0),u;var h=[],d=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var S=s.texData.get(b.dataId);if(S.texture==null){if(!t.packedInputs&&Ae(b.shape)<=te().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:S.values};t.packedInputs&&(S.isPacked=!0,S.shape=b.shape)}else if(!!S.isPacked!=!!t.packedInputs)b=S.isPacked?s.unpackTensor(b):s.packTensor(b),h.push(b),S=s.texData.get(b.dataId);else if(S.isPacked&&!xh(S.shape,b.shape)){var E=b,T=b.shape;b.shape=S.shape,b=s.packedReshape(b,T),h.push(b),S=s.texData.get(b.dataId),E.shape=T}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:S,isUniform:!1}});this.uploadToGPU(u.dataId);var f,m={shape:u.shape,texData:l,isUniform:!1},v=function(b,S,E){var T="";S.concat(E).forEach(function(C){var N=C.texData!=null&&C.texData.slice!=null&&C.texData.slice.flatOffset>0,R=C.isUniform?"uniform":C.texData.texShape;T+=C.shape+"_"+R+"_"+N});var _=b.userCode,x=b.constructor.name;return x+="_"+T+"_"+_}(t,d,m),y=this.getAndSaveBinary(v,function(){return function(b,S,E,T){var _=S.userCode,x=E.map(function(z,q){var F={logicalShape:z.shape,texShape:z.isUniform?null:z.texData.texShape,isUniform:z.isUniform,isPacked:!z.isUniform&&z.texData.isPacked,flatOffset:null};return z.texData!=null&&z.texData.slice!=null&&z.texData.slice.flatOffset>0&&(F.flatOffset=z.texData.slice.flatOffset),{name:S.variableNames[q],shapeInfo:F}}),C=x.map(function(z){return z.shapeInfo}),N={logicalShape:T.shape,texShape:T.texData.texShape,isUniform:!1,isPacked:T.texData.isPacked,flatOffset:null},R=zG(x,N,_,S.packedInputs),k=b.createProgram(R),D=null,W=b.getUniformLocation(k,"NAN",!1);te().getNumber("WEBGL_VERSION")===1&&(D=b.getUniformLocation(k,"INFINITY",!1));for(var U={},j=0;j<S.variableNames.length;j++){var H=S.variableNames[j];U[H]=b.getUniformLocation(k,H,!1),U["offset"+H]=b.getUniformLocation(k,"offset"+H,!1)}return{program:S,source:R,webGLProgram:k,uniformLocations:U,inShapeInfos:C,outShapeInfo:N,infLoc:D,nanLoc:W}}(s.gpgpu,t,d,m)}),g=this.activeTimers!=null;if(g&&(f=this.startTimer()),function(b,S,E,T,_){GI(S.inShapeInfos,E),GI([S.outShapeInfo],[T]);var x=T.texData.texture,C=T.texData.texShape;T.texData.isPacked?b.setOutputPackedMatrixTexture(x,C[0],C[1]):b.setOutputMatrixTexture(x,C[0],C[1]),b.setProgram(S.webGLProgram),te().getNumber("WEBGL_VERSION")===1&&S.infLoc!==null&&b.gl.uniform1f(S.infLoc,1/0),S.nanLoc!==null&&b.gl.uniform1f(S.nanLoc,NaN),E.forEach(function(N,R){var k=S.program.variableNames[R],D=S.uniformLocations[k],W=S.uniformLocations["offset"+k];if(D!=null)if(N.isUniform)if(Ae(N.shape)<2)b.gl.uniform1f(D,N.uniformValues[0]);else{var U=N.uniformValues;U instanceof Float32Array||(U=new Float32Array(U)),b.gl.uniform1fv(D,U)}else N.texData.slice!=null&&W!=null&&b.gl.uniform1i(W,N.texData.slice.flatOffset),b.setInputMatrixTexture(N.texData.texture,D,R)}),_!=null&&_(b,S.webGLProgram),b.executeProgram()}(this.gpgpu,y,d,m,o),h.forEach(function(b){return s.disposeData(b.dataId)}),g&&(f=this.endTimer(f),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(f)})),!te().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){var w=this.unpackTensor(u);return this.disposeData(u.dataId),w}return u},e.prototype.compileAndRun=function(t,r,i,o,a){a===void 0&&(a=!1),i=i||r[0].dtype;var s=this.runWebGLProgram(t,r,i,o,a);return V.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},e.prototype.getAndSaveBinary=function(t,r){return t in this.binaryCache||(this.binaryCache[t]=r()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.fromPixels2DContext!=null&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Z(function(){if(!te().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=te().getBool("DEBUG");te().set("DEBUG",!1);var i=t.abs(Ee(1e-8)).dataSync()[0];if(te().set("DEBUG",r),i>0)return 32}return 16})),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var r,i=this.texData.get(t),o=i.shape,a=i.dtype,s=i.values,u=i.texture,l=i.usage,c=i.isPacked;if(u==null){var h,d=this.activeTimers!=null;d&&(h=Si());var f=i.texShape;if(f==null&&(f=bO(o,c),i.texShape=f),s!=null){var m=Qp(o),v=void 0,y=f[1],g=f[0],w=s instanceof Uint8Array;c?(y=(r=of(f[0],f[1]))[0],g=r[1],v=new vq(m,[g,y],w)):v=new gq(m,[g,y],w);var b=this.makeTensorInfo([g,y],a);this.texData.get(b.dataId).usage=w?Wr.PIXELS:Wr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),y,g,s);var S=this.runWebGLProgram(v,[b],a,null,!0),E=this.texData.get(S.dataId);i.texture=E.texture,i.texShape=E.texShape,i.isPacked=E.isPacked,i.usage=E.usage,this.disposeData(b.dataId),this.texData.delete(S.dataId),i.values=null,d&&(this.uploadWaitMs+=Si()-h)}else{var T=this.acquireTexture(f,l,a,c);i.texture=T}}},e.prototype.convertAndCacheOnCPU=function(t,r){var i=this.texData.get(t),o=i.dtype;return this.releaseGPUData(t),r!=null&&(i.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),l=0;l<u.length;++l)u[l]=Math.round(a[l]);return u}throw new Error("Unknown dtype "+s)}(r,o)),i.values},e.prototype.acquireTexture=function(t,r,i,o){if(this.numBytesInGPU+=this.computeBytes(t,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,r,o)},e.prototype.computeBytes=function(t,r){return t[0]*t[1]*Gx(r)},e}(p_);eO()&&V.registerBackend("webgl",function(){return new IP},2);var E_=$({square_:function(n){var e=L(n,"x","square"),t=[e];return V.runKernelFunc(function(r,i){return i([e]),r.square(e)},{x:e},function(r,i){var o=i[0];return{x:function(){return r.mul(o.toFloat().mul(2))}}},"Square",{},t,[])}}),gs=$({abs_:function(n){var e=L(n,"x","abs");return e.dtype==="complex64"?V.runKernelFunc(function(t){return t.complexAbs(e)},{$x:e}):V.runKernelFunc(function(t,r){var i=t.abs(e);return r([e]),i},{x:e},function(t,r){var i=r[0];return{x:function(){return t.mul(i.toFloat().step(-1))}}},"Abs")}}),C_=$({acos_:function(n){var e=L(n,"x","acos");return V.runKernelFunc(function(t,r){var i=t.acos(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.divStrict(Ee(1).sub(i.toFloat().square()).sqrt()).neg()}}})}}),S_=$({acosh_:function(n){var e=L(n,"x","acosh");return V.runKernelFunc(function(t,r){var i=t.acosh(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.divStrict(i.toFloat().square().sub(1).sqrt())}}})}}),I_=$({asin_:function(n){var e=L(n,"x","asin");return V.runKernelFunc(function(t,r){var i=t.asin(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.divStrict(Ee(1).sub(i.toFloat().square()).sqrt())}}})}}),N_=$({asinh_:function(n){var e=L(n,"x","asinh");return V.runKernelFunc(function(t,r){var i=t.asinh(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.divStrict(Ee(1).add(i.toFloat().square()).sqrt())}}})}}),T_=$({atan_:function(n){var e=L(n,"x","atan");return V.runKernelFunc(function(t,r){var i=t.atan(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat().square().add(1))}}})}}),k_=$({atanh_:function(n){var e=L(n,"x","atanh");return V.runKernelFunc(function(t,r){var i=t.atanh(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(Ee(1).sub(i.toFloat().square()))}}})}}),R_=$({ceil_:function(n){var e=L(n,"x","ceil");return V.runKernelFunc(function(t){return t.ceil(e)},{$x:e},function(t){return{$x:function(){return ct(t)}}})}}),vr=$({clipByValue_:function(n,e,t){var r=L(n,"x","clipByValue");return B(e<=t,function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+t+")."}),V.runKernelFunc(function(i,o){var a=i.clip(r,e,t);return o([r]),a},{$x:r},function(i,o){var a=o[0];return{$x:function(){return i.where(a.greaterEqual(e).logicalAnd(a.lessEqual(t)),ct(i))}}})}}),A_=$({cos_:function(n){var e=L(n,"x","cos");return V.runKernelFunc(function(t,r){var i=t.cos(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return i.toFloat().sin().neg().mul(t)}}})}}),D_=$({cosh_:function(n){var e=L(n,"x","cosh");return V.runKernelFunc(function(t,r){var i=t.cosh(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(t)}}})}}),O_=$({erf_:function(n){var e=L(n,"x","erf");return B(e.dtype==="int32"||e.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),e.dtype==="int32"&&(e=e.toFloat()),V.runKernelFunc(function(t,r){var i=t.erf(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),P_=$({exp_:function(n){var e=L(n,"x","exp");return V.runKernelFunc(function(t,r){var i=t.exp(e);return r([i]),i},{$x:e},function(t,r){return{$x:function(){return t.mulStrict(r[0])}}})}}),M_=$({expm1_:function(n){var e=L(n,"x","expm1");return V.runKernelFunc(function(t,r){var i=t.expm1(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.mul(i.exp())}}})}}),bv=$({floor_:function(n){var e=L(n,"x","floor");return V.runKernelFunc(function(t){return t.floor(e)},{$x:e},function(t){return{$x:function(){return ct(t)}}})}}),ia=$({log_:function(n){var e=L(n,"x","log");return V.runKernelFunc(function(t,r){var i=t.log(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat())}}})}}),L_=$({log1p_:function(n){var e=L(n,"x","log1p");return V.runKernelFunc(function(t,r){var i=t.log1p(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.add(1))}}})}}),NP=$({logSigmoid_:function(n){var e=L(n,"x","logSigmoid");return V.runKernelFunc(function(t,r){var i=t.softplus(e.neg()).neg();return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.mul(i.neg().sigmoid())}}})}}),Vu=$({neg_:function(n){var e=L(n,"x","neg");return V.runKernelFunc(function(t){return t.neg(e)},{$x:e},function(t){return{$x:function(){return t.neg()}}})}}),F_=$({reciprocal_:function(n){var e=L(n,"x","reciprocal");return V.runKernelFunc(function(t,r){var i=t.reciprocal(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.square().neg())}}})}}),z_=$({round_:function(n){var e=L(n,"x","round");return V.runKernelFunc(function(t){return t.round(e)},{$x:e},function(t){return{$x:function(){return ct(t)}}})}}),xv=$({rsqrt_:function(n){var e=L(n,"x","rsqrt");return V.runKernelFunc(function(t,r){var i=t.rsqrt(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.pow(1.5).mul(2)).neg()}}})}}),_v=$({sigmoid_:function(n){var e=L(n,"x","sigmoid");return V.runKernelFunc(function(t,r){var i=t.sigmoid(e);return r([i]),i},{x:e},function(t,r){var i=r[0];return{x:function(){return t.mul(i.mul(Ee(1).sub(i)))}}},"Sigmoid")}}),B_=$({sign_:function(n){var e=L(n,"x","sign");return V.runKernelFunc(function(t){return t.sign(e)},{$x:e},function(t){return{$x:function(){return ct(t)}}})}}),TP=$({isNaN_:function(n){var e=L(n,"x","isNaN");return V.runKernelFunc(function(t){return t.isNaN(e)},{$x:e},function(t){return{$x:function(){return ct(t)}}})}}),kP=$({isInf_:function(n){var e=L(n,"x","isInf");return V.runKernelFunc(function(t){return t.isInf(e)},{$x:e},function(t){return{$x:function(){return ct(t)}}})}}),RP=$({isFinite_:function(n){var e=L(n,"x","isFinite");return V.runKernelFunc(function(t){return t.isFinite(e)},{$x:e},function(t){return{$x:function(){return ct(t)}}})}}),j_=$({sin_:function(n){var e=L(n,"x","sin");return V.runKernelFunc(function(t,r){var i=t.sin(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return i.toFloat().cos().mul(t)}}})}}),U_=$({sinh_:function(n){var e=L(n,"x","sinh");return V.runKernelFunc(function(t,r){var i=t.sinh(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(t)}}})}}),cf=$({softplus_:function(n){var e=L(n,"x","softplus");return V.runKernelFunc(function(t,r){var i=t.softplus(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.mul(i.sigmoid())}}})}}),hf=$({sqrt_:function(n){var e=L(n,"x","sqrt");return V.runKernelFunc(function(t,r){var i=t.sqrt(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.toFloat().sqrt().mul(2))}}})}}),AP=$({step_:function(n,e){e===void 0&&(e=0);var t=L(n,"x","step");return V.runKernelFunc(function(r){return r.step(t,e)},{$x:t},function(r){return{$x:function(){return ct(r)}}})}}),W_=$({tan_:function(n){var e=L(n,"x","tan");return V.runKernelFunc(function(t,r){var i=t.tan(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.div(i.cos().square())}}})}}),Ev=$({tanh_:function(n){var e=L(n,"x","tanh");return V.runKernelFunc(function(t,r){var i=t.tanh(e);return r([i]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return Ee(1).sub(i.square()).mulStrict(t)}}})}});function DP(n,e,t,r,i,o){var a,s,u=L(n,"x","batchNorm"),l=L(e,"mean","batchNorm"),c=L(t,"variance","batchNorm");return i!=null&&(a=L(i,"scale","batchNorm")),r!=null&&(s=L(r,"offset","batchNorm")),B(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),B(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),B(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),a!=null&&B(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&B(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),df(u,l,c,s,a,o)}function OP(n,e,t,r,i,o){var a,s,u=L(n,"x","batchNorm"),l=L(e,"mean","batchNorm"),c=L(t,"variance","batchNorm");return i!=null&&(a=L(i,"scale","batchNorm")),r!=null&&(s=L(r,"offset","batchNorm")),B(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),B(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),B(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),a!=null&&B(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&B(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),df(u,l,c,s,a,o)}function PP(n,e,t,r,i,o){var a,s,u=L(n,"x","batchNorm"),l=L(e,"mean","batchNorm"),c=L(t,"variance","batchNorm");return i!=null&&(a=L(i,"scale","batchNorm")),r!=null&&(s=L(r,"offset","batchNorm")),B(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),B(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),B(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),a!=null&&B(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&B(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),df(u,l,c,s,a,o)}function df(n,e,t,r,i,o){o==null&&(o=.001);var a,s,u,l=L(n,"x","batchNorm"),c=L(e,"mean","batchNorm"),h=L(t,"variance","batchNorm");i!=null&&(a=L(i,"scale","batchNorm")),r!=null&&(s=L(r,"offset","batchNorm")),B(c.rank===h.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),B(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),B(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var d=[l,c,h,a];return V.runKernelFunc(function(f,m){var v=f.batchNormalization(u,vp(c),vp(h),o,vp(a),vp(s));return m([l,c,h,a]),v},{x:l,mean:c,variance:h,scale:a,offset:s},function(f,m){var v=m,y=v[0],g=v[1],w=v[2],b=v[3],S=b??Ee(1),E=En(g.shape,u.shape),T=[];if(g.rank===1){for(var _=0;_<u.shape.length-1;++_)T.push(u.shape[_]);T.push(1)}var x=y.sub(g),C=f.mul(S),N=xv(w.add(Ee(o))),R=N.mul(N).mul(N).mul(Ee(-.5));return{x:function(){return g.rank===1?f.mul(is(N.as4D(1,1,1,g.shape[0]),T)).mul(S).reshape(y.shape):f.mul(N).mul(S).reshape(y.shape)},mean:function(){var k=N.mul(Ee(-1)).mul(C);return g.rank===1&&(k=k.sum(E)),k.reshape(g.shape)},variance:function(){var k=R.mul(x).mul(C);return g.rank===1&&(k=k.sum(E)),k.reshape(g.shape)},scale:function(){var k=x.mul(N),D=f.mul(k);return g.rank===1&&(D=D.sum(E)),D.reshape(g.shape)},offset:function(){var k=f;return g.rank===1&&(k=k.sum(E)),k.reshape(g.shape)}}},"BatchNormalization",{varianceEpsilon:o},d).reshape(l.shape)}function vp(n){return n==null?null:n.rank===0?n.as1D():n.rank===1?n:n.rank===2?n.as4D(1,1,n.shape[0],n.shape[1]):n.rank===3?n.as4D(1,n.shape[0],n.shape[1],n.shape[2]):n}function Cv(){uv("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var MP=$({batchNormalization2d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),Cv(),DP(n,e,t,o,i,r)}}),LP=$({batchNormalization3d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),Cv(),OP(n,e,t,o,i,r)}}),FP=$({batchNormalization4d_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),Cv(),PP(n,e,t,o,i,r)}}),zP=$({batchNormalization_:function(n,e,t,r,i,o){return r===void 0&&(r=.001),Cv(),df(n,e,t,o,i,r)}}),V_=$({batchNorm_:df}),$_=$({batchNorm2d_:DP}),H_=$({batchNorm3d_:OP}),G_=$({batchNorm4d_:PP}),da=$({logicalAnd_:function(n,e){var t=L(n,"a","logicalAnd","bool"),r=L(e,"b","logicalAnd","bool");return st(t.shape,r.shape),V.runKernelFunc(function(i){return i.logicalAnd(t,r)},{$a:t,$b:r})}}),q_=$({logicalNot_:function(n){var e=L(n,"x","logicalNot","bool");return V.runKernelFunc(function(t){return t.logicalNot(e)},{$x:e})}}),Sv=$({logicalOr_:function(n,e){var t=L(n,"a","logicalOr","bool"),r=L(e,"b","logicalOr","bool");return st(t.shape,r.shape),V.runKernelFunc(function(i){return i.logicalOr(t,r)},{$a:t,$b:r})}}),BP=$({logicalXor_:function(n,e){var t=L(n,"a","logicalXor","bool"),r=L(e,"b","logicalXor","bool");return st(t.shape,r.shape),Sv(n,e).logicalAnd(da(n,e).logicalNot())}}),oa=$({where_:function(n,e,t){var r=L(e,"a","where"),i=L(t,"b","where"),o=L(n,"condition","where","bool");return pt(r.shape,i.shape,"Error in where: "),o.rank===1?B(o.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):pt(o.shape,i.shape,"Error in where: "),V.runKernelFunc(function(a,s){var u=a.select(o,r,i);return s([o]),u},{$condition:o,$a:r,$b:i},function(a,s){var u=s[0];return{$condition:function(){return ct(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),Iv=function(n){return Ie(this,void 0,void 0,function(){var e,t,r;return Ne(this,function(i){switch(i.label){case 0:return[4,(e=L(n,"condition","whereAsync","bool")).data()];case 1:return t=i.sent(),r=w_(e.shape,t),n!==e&&e.dispose(),[2,r]}})})},ot=$({add_:function(n,e){var t,r=L(n,"a","add"),i=L(e,"b","add");t=fn(r,i),r=t[0],i=t[1];var o=st(r.shape,i.shape);return V.runKernelFunc(function(a){return a.add(r,i)},{a:r,b:i},function(a){return{a:function(){var s=a,u=En(r.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=En(i.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(i.shape)}}},"Add")}}),K_=$({addN_:function(n){B(Array.isArray(n),function(){return"The argument passed to tf.addN() must be a list of tensors"}),B(n.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+n.length});var e=n.map(function(i,o){return L(i,"tensors"+o,"addN")}),t=e[0];e.forEach(function(i){if(i.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(function(i){if(!jn(i.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=e;return V.runKernelFunc(function(i){return i.addN(e)},r,function(i){var o={};return e.forEach(function(a,s){o[s]=function(){return i.clone()}}),o})}}),jP=$({addStrict_:function(n,e){var t=L(n,"a","addStrict"),r=L(e,"b","addStrict");return pt(t.shape,r.shape,"Error in addStrict: "),t.add(r)}}),X_=$({atan2_:function(n,e){var t,r=L(n,"a","atan2"),i=L(e,"b","atan2");t=fn(r,i),r=t[0],i=t[1];var o=st(r.shape,i.shape);return V.runKernelFunc(function(a,s){var u=a.atan2(r,i);return s([r,i]),u},{$a:r,$b:i},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=ot(u.square(),l.square()),h=a.mul(l.div(c)),d=En(u.shape,o);return d.length>0&&(h=h.sum(d)),h.reshape(u.shape)},$b:function(){var c=ot(u.square(),l.square()),h=Vu(a.mul(u.div(c))),d=En(l.shape,o);return d.length>0&&(h=h.sum(d)),h.reshape(l.shape)}}})}}),sr=$({div_:function(n,e){var t,r=L(n,"a","div"),i=L(e,"b","div");if(t=fn(r,i),r=t[0],i=t[1],r.dtype==="int32"&&i.dtype==="int32")return Nv(r,i);var o=st(r.shape,i.shape);return V.runKernelFunc(function(a,s){var u=a.realDivide(r,i);return s([r,i]),u},{a:r,b:i},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),h=En(u.shape,o);return h.length>0?c.sum(h).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),h=En(l.shape,o);h.length>0&&(c=c.sum(h).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}},"Div")}}),UP=$({divStrict_:function(n,e){var t=L(n,"a","div"),r=L(e,"b","div");return pt(t.shape,r.shape,"Error in divideStrict: "),t.div(r)}}),Nv=$({floorDiv_:function(n,e){var t,r=L(n,"a","floorDiv"),i=L(e,"b","floorDiv");t=fn(r,i),r=t[0],i=t[1];var o=st(r.shape,i.shape);return V.runKernelFunc(function(a,s){var u=a.floorDiv(r,i);return s([r,i]),u},{$a:r,$b:i},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=a.div(l.toFloat()),h=En(u.shape,o);return h.length>0?c.sum(h).reshape(u.shape):c},$b:function(){var c=a.mul(u.toFloat()),h=En(l.shape,o);h.length>0&&(c=c.sum(h).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}})}}),wo=$({maximum_:function(n,e){var t,r=L(n,"a","maximum"),i=L(e,"b","maximum");return t=fn(r,i),r=t[0],i=t[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),st(r.shape,i.shape),V.runKernelFunc(function(o,a){var s=o.maximum(r,i);return a([r,i]),s},{$a:r,$b:i},function(o,a){var s=a[0],u=a[1];return{$a:function(){return o.mul(s.greaterEqual(u).toFloat())},$b:function(){return o.mul(s.less(u).toFloat())}}})}}),WP=$({maximumStrict_:function(n,e){var t=L(n,"a","maximumStrict"),r=L(e,"b","maximumStrict");return pt(t.shape,r.shape,"Error in maximumStrict: "),t.maximum(r)}}),Rc=$({minimum_:function(n,e){var t,r=L(n,"a","minimum"),i=L(e,"b","minimum");return t=fn(r,i),r=t[0],i=t[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),st(r.shape,i.shape),V.runKernelFunc(function(o,a){var s=o.minimum(r,i);return a([r,i]),s},{$a:r,$b:i},function(o,a){var s=a[0],u=a[1];return{$a:function(){return o.mul(s.lessEqual(u).toFloat())},$b:function(){return o.mul(s.greater(u).toFloat())}}})}}),VP=$({minimumStrict_:function(n,e){var t=L(n,"a","minimumStrict"),r=L(e,"b","minimumStrict");return pt(t.shape,r.shape,"Error in minimumStrict: "),t.minimum(r)}}),Y_=$({mod_:function(n,e){var t,r=L(n,"a","mod"),i=L(e,"b","mod");t=fn(r,i),r=t[0],i=t[1];var o=st(r.shape,i.shape);return V.runKernelFunc(function(a,s){var u=a.mod(r,i);return s([r,i]),u},{$a:r,$b:i},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=En(u.shape,o);return c.length>0?a.sum(c).reshape(u.shape):a},$b:function(){var c=a.mul(u.div(l).floor().neg()),h=En(l.shape,o);return h.length>0?c.sum(h).reshape(l.shape):c}}})}}),$P=$({modStrict_:function(n,e){var t=L(n,"a","modStrict"),r=L(e,"b","modStrict");return pt(t.shape,r.shape,"Error in modStrict: "),t.mod(r)}}),He=$({mul_:function(n,e){var t,r=L(n,"a","mul"),i=L(e,"b","mul");t=fn(r,i),r=t[0],i=t[1];var o=st(r.shape,i.shape);return V.runKernelFunc(function(a,s){var u=a.multiply(r,i);return s([r,i]),u},{a:r,b:i},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.mul(l.toFloat()),h=En(u.shape,o);return h.length>0?c.sum(h).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),h=En(l.shape,o);return h.length>0?c.sum(h).reshape(l.shape):c}}},"Mul")}}),Tv=$({mulStrict_:function(n,e){var t=L(n,"a","mul"),r=L(e,"b","mul");return pt(t.shape,r.shape,"Error in multiplyStrict: "),t.mul(r)}}),oc=$({pow_:function(n,e){var t=L(n,"base","pow"),r=L(e,"exp","pow"),i=st(t.shape,r.shape);return n=t.cast(wn(t.dtype,r.dtype)),e=r.cast(wn(t.dtype,r.dtype)),V.runKernelFunc(function(o,a){var s=o.pow(t,r);return a([t,r,s]),s},{$base:t,$exp:r},function(o,a){var s=a[0],u=a[1],l=a[2];return{$base:function(){var c=u.toFloat(),h=o.mul(c.mul(s.pow(c.sub(Ee(1))))),d=En(s.shape,i);return d.length>0&&(h=h.sum(d)),h.reshape(s.shape)},$exp:function(){var c=s.greater(0),h=s.log().where(c,ct(s)),d=o.mul(l.mul(h)),f=En(u.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)}}})}}),HP=$({powStrict_:function(n,e){return pt(n.shape,e.shape,"Error in powStrict: "),n.pow(e)}}),Q_=$({squaredDifference_:function(n,e){var t,r=L(n,"a","squaredDifference"),i=L(e,"b","squaredDifference");return t=fn(r,i),r=t[0],i=t[1],st(r.shape,i.shape),V.runKernelFunc(function(o,a){var s=o.squaredDifference(r,i);return a([r,i]),s},{$a:r,$b:i},function(o,a){var s=a[0],u=a[1],l=Ee(2);return{$a:function(){return o.mul(s.sub(u).mul(l))},$b:function(){return o.mul(u.sub(s).mul(l))}}})}}),GP=$({squaredDifferenceStrict_:function(n,e){var t=L(n,"a","squaredDifferenceStrict"),r=L(e,"b","squaredDifferenceStrict");return pt(t.shape,r.shape,"Error in squaredDifferenceStrict: "),t.squaredDifference(r)}}),Un=$({sub_:function(n,e){var t,r=L(n,"a","sub"),i=L(e,"b","sub");t=fn(r,i),r=t[0],i=t[1];var o=st(r.shape,i.shape);return V.runKernelFunc(function(a){return a.subtract(r,i)},{a:r,b:i},function(a){return{a:function(){var s=a,u=En(r.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=En(i.shape,o);return u.length>0&&(s=s.sum(u)),s.neg().reshape(i.shape)}}},"Sub")}}),qP=$({subStrict_:function(n,e){var t=L(n,"a","subStrict"),r=L(e,"b","subStrict");return pt(t.shape,r.shape,"Error in subStrict: "),t.sub(r)}}),$u=$({equal_:function(n,e){var t,r=L(n,"a","equal"),i=L(e,"b","equal");return t=fn(r,i),r=t[0],i=t[1],st(r.shape,i.shape),V.runKernelFunc(function(o){return o.equal(r,i)},{$a:r,$b:i})}}),KP=$({equalStrict_:function(n,e){var t=L(n,"a","equalStrict"),r=L(e,"b","equalStrict");return pt(t.shape,r.shape,"Error in equalStrict: "),t.equal(r)}}),Ac=$({greater_:function(n,e){var t,r=L(n,"a","greater"),i=L(e,"b","greater");return t=fn(r,i),r=t[0],i=t[1],st(r.shape,i.shape),V.runKernelFunc(function(o){return o.greater(r,i)},{$a:r,$b:i})}}),ff=$({greaterEqual_:function(n,e){var t,r=L(n,"a","greaterEqual"),i=L(e,"b","greaterEqual");return t=fn(r,i),r=t[0],i=t[1],st(r.shape,i.shape),V.runKernelFunc(function(o,a){var s=o.greaterEqual(r,i);return a([r,i]),s},{$a:r,$b:i},function(o,a){var s=a[0],u=a[1];return{$a:function(){return ct(s)},$b:function(){return ct(u)}}})}}),XP=$({greaterEqualStrict_:function(n,e){var t=L(n,"a","greaterEqualStrict"),r=L(e,"b","greaterEqualStrict");return pt(t.shape,r.shape,"Error in greaterEqualStrict: "),t.greaterEqual(r)}}),YP=$({greaterStrict_:function(n,e){var t=L(n,"a","greaterStrict"),r=L(e,"b","greaterStrict");return pt(t.shape,r.shape,"Error in greaterStrict: "),t.greater(r)}}),J_=$({less_:function(n,e){var t,r=L(n,"a","less"),i=L(e,"b","less");return t=fn(r,i),r=t[0],i=t[1],st(r.shape,i.shape),V.runKernelFunc(function(o){return o.less(r,i)},{$a:r,$b:i})}}),Z_=$({lessEqual_:function(n,e){var t,r=L(n,"a","lessEqual"),i=L(e,"b","lessEqual");return t=fn(r,i),r=t[0],i=t[1],st(r.shape,i.shape),V.runKernelFunc(function(o){return o.lessEqual(r,i)},{$a:r,$b:i})}}),QP=$({lessEqualStrict_:function(n,e){var t=L(n,"a","lessEqualStrict"),r=L(e,"b","lessEqualStrict");return pt(t.shape,r.shape,"Error in lessEqualStrict: "),t.lessEqual(r)}}),JP=$({lessStrict_:function(n,e){var t=L(n,"a","lessStrict"),r=L(e,"b","lessStrict");return pt(t.shape,r.shape,"Error in lessStrict: "),t.less(r)}}),ac=$({notEqual_:function(n,e){var t,r=L(n,"a","notEqual"),i=L(e,"b","notEqual");return t=fn(r,i),r=t[0],i=t[1],st(r.shape,i.shape),V.runKernelFunc(function(o){return o.notEqual(r,i)},{$a:r,$b:i})}}),ZP=$({notEqualStrict_:function(n,e){var t=L(n,"a","notEqualStrict"),r=L(e,"b","notEqualStrict");return pt(t.shape,r.shape,"Error in notEqualStrict: "),t.notEqual(r)}});function nN(n,e){for(var t=[],r=n;r<e;++r)t.push(r);return t}function rN(n){for(var e=[],t=0;t<n.length;++t)for(var r=0;r<n[t].length;++r)e.push(n[t][r]);return e}var Dc=$({gather_:function(n,e,t){t===void 0&&(t=0);var r=L(n,"x","gather"),i=L(e,"indices","gather","int32");t=Wn(t,r.shape)[0];var o=function(a,s,u){for(var l=a.shape[u],c=[],h=1,d=1,f=0;f<u;f++)c.push(a.shape[f]),h*=a.shape[f];for(f=0;f<s.rank;f++)c.push(s.shape[f]);for(f=u+1;f<a.rank;f++)c.push(a.shape[f]),d*=a.shape[f];return{batchSize:h,sliceSize:d,dimSize:l,outputShape:c}}(r,i,t);return V.runKernelFunc(function(a,s){var u=a.gather(r,i.flatten(),t);return s([i]),u},{$x:r},function(a,s){var u=s[0];return{$x:function(){var l=r.shape,c=u.size,h=l.slice(0,t),d=h.length,f=l.slice(t,l.length).slice(1),m=f.length,v=nN(0,d),y=nN(d+1,d+1+m),g=rN([h,[c],f]),w=a.reshape(g),b=u.reshape([c]),S=rN([[d],v,y]),E=w.transpose(S),T=eE(E,b,r.shape[t]),_=lv(S);return T=T.transpose(_)}}}).reshape(o.outputShape)}}),eE=$({unsortedSegmentSum_:function(n,e,t){var r=L(n,"x","unsortedSegmentSum"),i=L(e,"segmentIds","unsortedSegmentSum","int32");return B(dn(t),function(){return"numSegments must be of dtype int"}),V.runKernelFunc(function(o,a){var s=o.unsortedSegmentSum(r,i,t);return a([i]),s},{$x:r},function(o,a){var s=a[0];return{$x:function(){return function(u,l){for(var c=wo(l,ct(l)),h=Dc(u,c),d=ff(l,Ee(0,"int32")),f=h.rank-d.rank,m=0;m<f;++m)d=Ur(d,m+1);d=da(d,yo(h.shape,"bool"));var v=ct(h);return oa(d,h,v)}(o,s)}}})}}),eM=function(n,e,t){return Ie(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h,d,f,m,v;return Ne(this,function(y){switch(y.label){case 0:for(r=L(n,"tensor","boolMask"),i=L(e,"mask","boolMask","bool"),o=t??0,a=i.rank,s=r.shape,B(a>0,function(){return"mask cannot be scalar"}),pt(s.slice(o,o+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=o;l<o+a;l++)u*=s[l];return c=s.slice(0,o).concat([u],s.slice(o+a)),h=r.reshape(c),d=i.reshape([-1]),[4,Iv(d)];case 1:return f=y.sent(),m=f.squeeze([1]),v=Dc(h,m,o),n!==r&&r.dispose(),e!==i&&i.dispose(),m.dispose(),h.dispose(),d.dispose(),f.dispose(),[2,v]}})})};function tM(n,e,t,r,i,o,a){o===void 0&&(o="NHWC"),B(n.length===e.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+e.rank+") must match"});var s=n,u=e,l=!1;e.rank===3&&(l=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,n[0],n[1],n[2]]),B(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),B(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),B(t.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+t.rank});var c=o==="NHWC"?s[3]:s[1],h=o==="NHWC"?u.shape[3]:u.shape[1];B(c===t.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+t.shape[2]+"."}),B(h===t.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+t.shape[3]+"."}),a!=null&&B(dn(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var d=wv(o),f=Rs(s,t.shape,r,1,i,a,!1,d),m=V.runKernelFunc(function(v,y){var g=v.conv2dDerInput(u,t,f);return y([t,u]),g},{dy4D:u,filter:t},function(v,y){var g=y[0],w=y[1];return{dy4D:function(){return Hu(v,g,r,i,o,1,a)},filter:function(){return tE(v,w,g.shape,r,i,o,a)}}});return l?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}function m0(n){var e=function(o){return typeof o=="number"?[o,o,o]:o.length===2?[o[0],o[1],1]:o}(n),t=e[0],r=e[1],i=e[2];return t===1&&r===1&&i===1}function nM(n,e,t,r,i){B(n.length===e.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+e.rank+") must match"});var o=n,a=e,s=!1;e.rank===4&&(s=!0,a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,n[0],n[1],n[2],n[3]]);var u=o[4],l=a.shape[4];B(o.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."}),B(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),B(t.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+t.rank}),B(u===t.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+t.shape[3]+"."}),B(l===t.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+t.shape[4]+"."});var c=Ad(o,t.shape,r,1,i),h=V.runKernelFunc(function(d){return d.conv3dDerInput(a,t,c)},{dy5D:a});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var kv=$({conv1d_:function(n,e,t,r,i,o,a){i===void 0&&(i="NWC"),o===void 0&&(o=1);var s=L(n,"x","conv1d"),u=L(e,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),B(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),B(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&B(dn(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),B(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),B(gr(t,o),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+t+" and dilation '"+o+"'"}),B(i==="NWC",function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),f=Hu(d,h,[1,t],r,"NHWC",[1,o],a);return c?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),Hu=$({conv2d_:function(n,e,t,r,i,o,a){i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]);var s=L(n,"x","conv2d"),u=L(e,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),B(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),B(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&B(dn(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var h=i==="NHWC"?l.shape[3]:l.shape[1];B(h===u.shape[2],function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+u.shape[2]+"."}),B(gr(t,o),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"});var d=wv(i),f=Rs(l.shape,u.shape,t,o,r,a,!1,d),m=V.runKernelFunc(function(v,y){var g=v.conv2d(l,u,f);return y([u,l]),g},{x:l,$filter:u},function(v,y){var g=y,w=g[0],b=g[1];return B(Nu(o),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}),{x:function(){return rM(b.shape,v,w,t,r,i)},$filter:function(){return tE(b,v,w.shape,t,r,i)}}});return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),Rv=$({conv3d_:function(n,e,t,r,i,o){i===void 0&&(i="NDHWC"),o===void 0&&(o=[1,1,1]);var a=L(n,"x","conv3d"),s=L(e,"filter","conv3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),B(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),B(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),B(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),B(function(d,f){return m0(d)||m0(f)}(t,o),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"}),B(i==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var c=Ad(u.shape,s.shape,t,o,r),h=V.runKernelFunc(function(d,f){var m=d.conv3d(u,s,c);return f([u,s]),m},{x:u,$filter:s},function(d,f){B(m0(o),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"});var m=f[0],v=f[1];return{x:function(){return nM(m.shape,d,v,t,r)},$filter:function(){return function(y,g,w,b,S){var E=y;y.rank===4&&(E=y.as5D(1,y.shape[0],y.shape[1],y.shape[2],y.shape[3]));var T=g;T.rank===4&&(T=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3])),B(E.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+E.shape+"."}),B(T.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+T.shape+"."}),B(w.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+w+"."}),B(E.shape[4]===w[3],function(){return"Error in conv3dDerFilter: depth of input "+E.shape[4]+") must match input depth in filter ("+w[3]+"."}),B(T.shape[4]===w[4],function(){return"Error in conv3dDerFilter: depth of dy ("+T.shape[4]+") must match output depth for filter ("+w[4]+")."});var _=Ad(E.shape,w,b,1,S);return V.runKernelFunc(function(x){return x.conv3dDerFilter(E,T,_)},{x5D:E,dy5D:T})}(m,d,v.shape,t,r)}}});return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),tE=$({conv2dDerFilter_:function(n,e,t,r,i,o,a){o===void 0&&(o="NHWC");var s=n;n.rank===3&&(s=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var u=e;u.rank===3&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),B(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),B(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),B(t.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+t+"."});var l=o==="NHWC"?s.shape[3]:s.shape[1],c=o==="NHWC"?u.shape[3]:u.shape[1];B(l===t[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+t[2]+"."}),B(c===t[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+t[3]+")."}),a!=null&&B(dn(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var h=wv(o),d=Rs(s.shape,t,r,1,i,a,!1,h);return V.runKernelFunc(function(f){return f.conv2dDerFilter(s,u,d)},{x4D:s,dy4D:u})}}),rM=$({conv2dDerInput_:tM}),Oc=$({depthwiseConv2d_:function(n,e,t,r,i,o,a){o===void 0&&(o=[1,1]);var s=L(n,"x","depthwiseConv2d"),u=L(e,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),B(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),B(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),B(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),o==null&&(o=[1,1]),B(gr(t,o),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+o+"'"}),a!=null&&B(dn(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var h=Rs(l.shape,u.shape,t,o,r,a,!0),d=V.runKernelFunc(function(f,m){var v=f.depthwiseConv2D(l,u,h);return m([l,u]),v},{x:l,$filter:u},function(f,m){B(Nu(o),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"});var v=m[0],y=m[1];return{x:function(){return iM(v.shape,f,y,h)},$filter:function(){return oM(v,f,y.shape,h)}}});return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),iM=$({depthwiseConv2dDerInput_:function(n,e,t,r){var i=e,o=!1;e.rank===3&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=V.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(i,t,r)},{dy4D:i});return o?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),oM=$({depthwiseConv2dDerFilter_:function(n,e,t,r){var i=n;n.rank===3&&(i=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var o=e;return o.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),V.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(i,o,r)},{x4D:i,dy4D:o})}}),nE=$({separableConv2d_:function(n,e,t,r,i,o,a){o===void 0&&(o=[1,1]),a===void 0&&(a="NHWC");var s=L(n,"x","separableConv2d"),u=L(e,"depthwiseFilter","separableConv2d"),l=L(t,"pointwiseFilter","separableConv2d"),c=s,h=!1;if(s.rank===3&&(h=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");B(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),B(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),B(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),B(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),B(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var d=u.shape[2],f=u.shape[3];B(l.shape[2]===d*f,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*f+", but got "+l.shape[2]+"."});var m=Oc(c,u,r,i,a,o),v=Hu(m,l,1,"valid",a);return h?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),Av=$({conv2dTranspose_:function(n,e,t,r,i,o){return tM(t,L(n,"x","conv2dTranspose"),L(e,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),aM=$({conv3dTranspose_:function(n,e,t,r,i){return nM(t,L(n,"x","conv3dTranspose"),L(e,"filter","conv3dTranspose"),r,i)}}),Dv=$({matMul_:function(n,e,t,r){var i;t===void 0&&(t=!1),r===void 0&&(r=!1);var o=L(n,"a","matMul"),a=L(e,"b","matMul");i=fn(o,a),o=i[0],a=i[1];var s=t?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=t?o.shape[o.rank-1]:o.shape[o.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],h=o.shape.slice(0,-2),d=a.shape.slice(0,-2),f=Ae(h),m=Ae(d);B(o.rank>=2&&a.rank>=2&&o.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+a.rank+"."}),B(jn(h,d),function(){return"Error in matMul: outer dimensions ("+h+") and ("+d+") of Tensors with shapes "+o.shape+" and "+a.shape+" must match."}),B(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+o.shape+" and "+a.shape+" and transposeA="+t+" and transposeB="+r+" must match."});var v=o.shape.slice(0,-2).concat([l,c]),y=t?o.as3D(f,s,l):o.as3D(f,l,s),g=r?a.as3D(m,c,u):a.as3D(m,u,c),w={transposeA:t,transposeB:r};return V.runKernelFunc(function(b,S){var E=b.batchMatMul(y,g,t,r);return S([y,g]),E},{a:y,b:g},function(b,S){var E=S,T=E[0],_=E[1];return t||r?!t&&r?{a:function(){return b.matMul(_,!1,!1)},b:function(){return b.matMul(T,!0,!1)}}:t&&!r?{a:function(){return _.matMul(b,!1,!0)},b:function(){return T.matMul(b,!1,!1)}}:{a:function(){return _.matMul(b,!0,!0)},b:function(){return b.matMul(T,!0,!0)}}:{a:function(){return b.matMul(_,!1,!0)},b:function(){return T.matMul(b,!0,!1)}}},"BatchMatMul",w).reshape(v)}}),sM=$({dot_:function(n,e){var t=L(n,"t1","dot"),r=L(e,"t2","dot");B(!(t.rank!==1&&t.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+t.rank+" and "+r.rank+"."});var i=t.rank===1?t.size:t.shape[1],o=r.rank===1?r.size:r.shape[0];return B(i===o,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."}),t.rank===1&&r.rank===1?t.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():t.rank===1&&r.rank===2?t.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():t.rank===2&&r.rank===1?t.matMul(r.as2D(-1,1)).as1D():t.matMul(r.as2D(r.shape[0],r.shape[1]))}}),uM=$({outerProduct_:function(n,e){var t=L(n,"v1","outerProduct"),r=L(e,"v2","outerProduct");return B(t.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+t.rank+" and "+r.rank+"."}),t.as2D(-1,1).matMul(r.as2D(1,-1))}}),po=$({reverse_:function(n,e){var t=L(n,"x","reverse");if(t.rank===0)return t.clone();var r=Wn(e,t.shape);return V.runKernelFunc(function(i){return i.reverse(t,r)},{$x:t},function(i){return{$x:function(){return i.reverse(r)}}}).reshapeAs(t)}}),lM=$({reverse1d_:function(n){var e=L(n,"x","reverse");return B(e.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."}),po(e,0)}}),cM=$({reverse2d_:function(n,e){var t=L(n,"x","reverse");return B(t.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+t.rank+"."}),po(t,e)}}),hM=$({reverse3d_:function(n,e){var t=L(n,"x","reverse");return B(t.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+t.rank+"."}),po(t,e)}}),dM=$({reverse4d_:function(n,e){var t=L(n,"x","reverse");return B(t.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+t.rank+"."}),po(t,e)}});function fM(n,e,t,r,i,o){var a=L(n,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),B(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),B(gr(t,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"}),o!=null&&B(dn(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var l=ic(s.shape,e,t,r,i,o),c=V.runKernelFunc(function(h,d){var f=h.maxPool(s,l);return d([s,f]),f},{x:s},function(h,d){var f=d[0],m=d[1];return{x:function(){return function(v,y,g,w,b,S,E,T){var _=L(v,"dy","maxPoolBackprop"),x=L(y,"input","maxPoolBackprop"),C=L(g,"output","maxPoolBackprop");B(x.rank===_.rank,function(){return"Rank of input ("+x.rank+") does not match rank of dy ("+_.rank+")"}),B(gr(b,S),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+S+"'"}),B(_.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+_.rank+"."}),B(x.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+x.rank+"."});var N=ic(x.shape,w,b,S,E,T);return V.runKernelFunc(function(R){return R.maxPoolBackprop(_,x,C,N)},{$dy:_,$input:x})}(h,f,m,e,t,r,i)}}});return u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}function pM(n,e,t,r,i,o){var a=L(n,"x","avgPool","float32");B(gr(t,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),B(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),o!=null&&B(dn(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var l=ic(s.shape,e,t,r,i,o),c=V.runKernelFunc(function(h){return h.avgPool(s,l)},{x:s},function(h){return{x:function(){return function(d,f,m,v,y,g){var w=L(d,"dy","avgPoolBackprop"),b=L(f,"input","avgPoolBackprop");B(b.rank===w.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+w.rank+")"}),B(gr(v,y),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+v+" and dilations '"+y+"'"});var S=b,E=w,T=!1;b.rank===3&&(T=!0,S=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),E=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),B(E.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+E.rank+"."}),B(S.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+S.rank+"."});var _=ic(S.shape,m,v,y,g),x=V.runKernelFunc(function(C){return C.avgPoolBackprop(E,S,_)},{dy4D:E,input4D:S});return T?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}(h,s,e,t,r,i)}}});return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var Ov=$({maxPool_:function(n,e,t,r,i){return fM(n,e,t,1,r,i)}}),Pv=$({avgPool_:function(n,e,t,r,i){return pM(n,e,t,1,r,i)}}),mM=$({pool_:function(n,e,t,r,i,o){i==null&&(i=[1,1]),o==null&&(o=1),r===0&&(r="valid");var a=L(n,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),B(gr(o,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"});var l,c=ic(s.shape,e,o,i,r),h=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(S,E){var T=S.map(function(C,N){return C+(C-1)*(E[N]-1)}).map(function(C){return C-1}),_=T.map(function(C){return Math.floor(C/2)}),x=T.map(function(C,N){return C-_[N]});return T.map(function(C,N){return[_[N],x[N]]})}([c.filterHeight,c.filterWidth],h):[[0,0],[0,0]];var d=h[0]===1&&h[1]===1,f=function(S,E,T){var _=T.map(function(W){return W[0]}),x=T.map(function(W){return W[1]}),C=S.concat(_,x),N=E.map(function(W,U){return(W-C[U]%W)%W}),R=x.map(function(W,U){return W+N[U]}),k=E.map(function(W,U){return[_[U],R[U]]}),D=E.map(function(W,U){return[0,N[U]]});return[k,D]}([c.inHeight,c.inWidth],h,l),m=f[0],v=f[1],y=d?r:"valid",g=d?s:mv(s,h,m),w=(t==="avg"?function(){return pM(g,e,o,1,y)}:function(){return fM(g,e,o,1,y)})(),b=d?w:dv(w,h,v);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),Mv=$({maxPool3d_:function(n,e,t,r,i,o,a){o===void 0&&(o="NDHWC");var s=L(n,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),B(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),B(o==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),B(gr(t,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+a+"'"}),i!=null&&B(dn(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=Rd(u.shape,e,t,a,r,i,o),h=V.runKernelFunc(function(d,f){var m=d.maxPool3d(u,c);return f([u,m]),m},{x:u},function(d,f){var m=f[0],v=f[1];return{x:function(){return function(y,g,w,b,S,E,T,_){var x=L(y,"dy","maxPool3dBackprop"),C=L(g,"input","maxPool3dBackprop"),N=L(w,"output","maxPool3dBackprop"),R=x,k=C,D=N,W=!1;C.rank===4&&(W=!0,R=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]),k=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),D=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3])),B(R.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+R.rank+"."}),B(k.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+k.rank+"."}),B(D.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+D.rank+"."}),E==null&&(E=[1,1,1]),B(gr(S,E),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+S+" and dilations '"+E+"'"}),_!=null&&B(dn(T),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+_+" but got pad "+T+"."});var U=Rd(k.shape,b,S,E,T,_),j=V.runKernelFunc(function(H){return H.maxPool3dBackprop(R,k,D,U)},{dy5D:R,input5D:k});return W?j.as4D(j.shape[1],j.shape[2],j.shape[3],j.shape[4]):j}(d,m,v,e,t,a,r,i)}}});return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Lv=$({avgPool3d_:function(n,e,t,r,i,o,a){o===void 0&&(o="NDHWC");var s=L(n,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),B(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),B(o==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),B(gr(t,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+t+" and dilations '"+a+"'"}),i!=null&&B(dn(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=Rd(u.shape,e,t,a,r,i,o),h=V.runKernelFunc(function(d){return d.avgPool3d(u,c)},{x:u},function(d){return{x:function(){return function(f,m,v,y,g,w,b){var S=L(f,"dy","avgPool3dBackprop"),E=L(m,"input","avgPool3dBackprop"),T=S,_=E,x=!1;E.rank===4&&(x=!0,T=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3]),_=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),B(T.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+T.rank+"."}),B(_.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+_.rank+"."}),g==null&&(g=[1,1,1]),B(gr(y,g),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+y+" and dilations '"+g+"'"}),b!=null&&B(dn(w),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+w+"."});var C=Rd(_.shape,v,y,g,w,b),N=V.runKernelFunc(function(R){return R.avgPool3dBackprop(T,_,C)},{dy5D:T,input5D:_});return x?N.as4D(N.shape[1],N.shape[2],N.shape[3],N.shape[4]):N}(d,u,e,t,a,r,i)}}});return h=h.cast(u.dtype),l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Yr=$({slice_:function(n,e,t){var r,i,o=L(n,"x","slice");if(o.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof e=="number"?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice()).forEach(function(u){B(u!==-1,function(){return"slice() does not support negative begin indexing."})}),i=(i=t==null?new Array(o.rank).fill(-1):typeof t=="number"?[t].concat(new Array(o.rank-1).fill(-1)):t.length<o.rank?t.concat(new Array(o.rank-t.length).fill(-1)):t).map(function(u,l){return u>=0?u:(B(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),o.shape[l]-r[l])}),HO(o,r,i);var a=o.shape,s={begin:r,size:i};return V.runKernelFunc(function(u){return u.slice(o,r,i)},{x:o},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],a[c]-r[c]-i[c]]);return{x:function(){return u.pad(l)}}},"Slice",s)}}),pf=$({slice1d_:function(n,e,t){var r=L(n,"x","slice1d");return B(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Yr(r,[e],[t])}}),Fv=$({slice2d_:function(n,e,t){var r=L(n,"x","slice2d");return B(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Yr(r,e,t)}}),mf=$({slice3d_:function(n,e,t){var r=L(n,"x","slice3d");return B(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Yr(r,e,t)}}),sc=$({slice4d_:function(n,e,t){var r=L(n,"x","slice4d");return B(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Yr(r,e,t)}});function gM(n,e,t,r,i){return e.rank<t.rank&&(e=e.reshape(Kr(e.shape,r))),n.rank<t.rank&&(n=n.reshape(Kr(n.shape,r))),{$x:function(){var o=n.mul(t.equal(e).cast(n.dtype));return i==null?o:o.transpose(i)}}}var zv=$({all_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=L(n,"x","all","bool"),i=Wn(e,r.shape),o=i,a=Gi(o,r.rank);a!=null&&(r=r.transpose(a),o=qi(o.length,r.rank));var s=V.runKernelFunc(function(l){return l.all(r,o)},{$x:r});if(t){var u=Kr(s.shape,i);return s.reshape(u)}return s}}),Dd=$({any_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=L(n,"x","any","bool"),i=Wn(e,r.shape),o=i,a=Gi(o,r.rank);a!=null&&(r=r.transpose(a),o=qi(o.length,r.rank));var s=V.runKernelFunc(function(l){return l.any(r,o)},{$x:r});if(t){var u=Kr(s.shape,i);return s.reshape(u)}return s}}),Od=$({argMax_:function(n,e){e===void 0&&(e=0);var t=L(n,"x","argMax");e==null&&(e=0);var r=Wn(e,t.shape),i=Gi(r,t.rank);return i!=null&&(t=t.transpose(i),r=qi(r.length,t.rank)),V.runKernelFunc(function(o,a){var s=o.argMax(t,r[0]);return a([t]),s},{$x:t},function(o,a){var s=a[0];return{$x:function(){return ct(s)}}})}}),rE=$({argMin_:function(n,e){e===void 0&&(e=0);var t=L(n,"x","argMin");e==null&&(e=0);var r=Wn(e,t.shape),i=Gi(r,t.rank);return i!=null&&(t=t.transpose(i),r=qi(r.length,t.rank)),V.runKernelFunc(function(o,a){var s=o.argMin(t,r[0]);return a([t]),s},{$x:t},function(o,a){var s=a[0];return{$x:function(){return ct(s)}}})}}),vM=$({logSumExp_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=L(n,"x","logSumExp"),i=Wn(e,r.shape),o=r.max(i,!0),a=r.sub(o).exp().sum(i).log(),s=o.reshape(a.shape).add(a);if(t){var u=Kr(s.shape,i);return s.reshape(u)}return s}}),vs=$({max_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=L(n,"x","max"),i=r,o=Wn(e,r.shape),a=o,s=Gi(a,r.rank);s!=null&&(r=r.transpose(s),a=qi(a.length,r.rank));var u=V.runKernelFunc(function(c,h){var d=c.max(r,a);return h([i,d]),d},{$x:r},function(c,h){return gM(c,h[1],h[0],o,s)});if(t){var l=Kr(u.shape,o);u=u.reshape(l)}return u}}),yn=$({mean_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=L(n,"x","mean"),i=Wn(e,r.shape),o=Ae(Gn(r.shape,i)[1]);return kc(function(a){var s=Ee(o);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(e,t),gradFunc:function(u){var l=a.shape.slice();return i.forEach(function(c){l[c]=1}),u.reshape(l).mul(yo(a.shape,"float32")).div(o)}}})(r)}}),Bv=$({min_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=L(n,"x","min"),i=r,o=Wn(e,r.shape),a=o,s=Gi(a,r.rank);s!=null&&(r=r.transpose(s),a=qi(a.length,r.rank));var u=V.runKernelFunc(function(c,h){var d=c.min(r,a);return h([i,d]),d},{$x:r},function(c,h){return gM(c,h[1],h[0],o,s)});if(t){var l=Kr(u.shape,o);u=u.reshape(l)}return u}}),gf=$({moments_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=Wn(e,(n=L(n,"x","moments")).shape),i=n.mean(r,t),o=i.shape;t||(o=Kr(i.shape,r));var a=n.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:a.mean(r,t)}}}),Pr=$({sum_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=L(n,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=Wn(e,r.shape);return kc(function(o){var a=Gi(i,o.rank),s=i,u=o;a!=null&&(u=o.transpose(a),s=qi(s.length,o.rank));var l=V.runKernelFunc(function(h){return h.sum(u,s)},{permutedX:u});if(t){var c=Kr(l.shape,i);l=l.reshape(c)}return{value:l,gradFunc:function(h){var d=o.shape.slice();return i.forEach(function(f){d[f]=1}),h.reshape(d).mul(yo(o.shape,"float32"))}}})(r)}}),jv=$({prod_:function(n,e,t){e===void 0&&(e=null),t===void 0&&(t=!1);var r=L(n,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=Wn(e,r.shape),o=Gi(i,r.rank),a=i,s=r;o!=null&&(s=r.transpose(o),a=qi(a.length,r.rank));var u=V.runKernelFunc(function(c){return c.prod(s,a)},{permutedX:s});if(t){var l=Kr(u.shape,i);u=u.reshape(l)}return u}}),Pc=$({elu_:function(n){var e=L(n,"x","elu");return V.runKernelFunc(function(t,r){var i=t.elu(e);return r([i]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return V.runKernelFunc(function(o){return o.eluDer(t,i)},{dy:t,y:i})}}})}}),Uv=$({leakyRelu_:function(n,e){e===void 0&&(e=.2);var t=L(n,"x","leakyRelu");return wo(Ee(e).mul(t),t)}}),Wv=$({prelu_:function(n,e){var t=L(n,"x","prelu"),r=L(e,"alpha","prelu");return V.runKernelFunc(function(i,o){var a=i.prelu(t,r);return o([t,r]),a},{x:t,alpha:r},function(i,o){var a=o[0],s=o[1],u=a.greater(0);return{x:function(){return oa(u,i,i.mul(s))},alpha:function(){var l=oa(u,ct(i),i.mul(a)),c=En(s.shape,i.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),As=$({relu_:function(n){var e=L(n,"x","relu");return e.dtype==="bool"?e.toInt():V.runKernelFunc(function(t,r){var i=t.relu(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){return t.mulStrict(i.step().toFloat())}}})}}),iE=$({relu6_:function(n){var e=L(n,"x","relu6");return e.dtype==="bool"?e.toInt():V.runKernelFunc(function(t,r){var i=t.relu6(e);return r([e]),i},{$x:e},function(t,r){var i=r[0],o=i.lessEqual(6).mul(i.step());return{$x:function(){return t.mulStrict(o.toFloat())}}})}}),Vv=$({selu_:function(n){var e=L(n,"x","selu");return V.runKernelFunc(function(t,r){var i=t.selu(e);return r([e]),i},{$x:e},function(t,r){var i=r[0];return{$x:function(){var o=i.greater(Ee(0)),a=Ee(x_),s=Ee(__),u=t.mul(s),l=t.mul(a).mul(i.toFloat().exp());return oa(o,u,l)}}})}}),Yt=$({transpose_:function(n,e){var t=L(n,"x","transpose");return e==null&&(e=t.shape.map(function(r,i){return i}).reverse()),B(t.rank===e.length,function(){return"Error in transpose: rank of input "+t.rank+" must match length of perm "+e+"."}),e.forEach(function(r){B(r>=0&&r<t.rank,function(){return"All entries in 'perm' must be between 0 and "+(t.rank-1)+" but got "+e})}),t.rank<=1?t.clone():V.runKernelFunc(function(r){return r.transpose(t,e)},{$x:t},function(r){var i=lv(e);return{$x:function(){return r.transpose(i)}}})}}),oE=$({localResponseNormalization_:function(n,e,t,r,i){e===void 0&&(e=5),t===void 0&&(t=1),r===void 0&&(r=1),i===void 0&&(i=.5);var o=L(n,"x","localResponseNormalization");B(o.rank===4||o.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+o.rank+"."}),B(dn(e),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."});var a=o,s=!1;o.rank===3&&(s=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=V.runKernelFunc(function(l,c){var h=l.localResponseNormalization4D(a,e,t,r,i);return c([a,h]),h},{x4D:a},function(l,c){var h=c[0],d=c[1];return{x4D:function(){return V.runKernelFunc(function(f){return f.LRNGrad(l,h,d,e,t,r,i)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),aE=$({norm_:function(n,e,t,r){e===void 0&&(e="euclidean"),t===void 0&&(t=null),r===void 0&&(r=!1);var i=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(Ee(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(n=L(n,"x","norm"),e,t),o=i.shape;if(r){var a=Wn(t,n.shape);o=Kr(i.shape,a)}return i.reshape(o)}}),yM=$({basicLSTMCell_:function(n,e,t,r,i,o){var a=L(n,"forgetBias","basicLSTMCell"),s=L(e,"lstmKernel","basicLSTMCell"),u=L(t,"lstmBias","basicLSTMCell"),l=L(r,"data","basicLSTMCell"),c=L(i,"c","basicLSTMCell"),h=L(o,"h","basicLSTMCell"),d=l.concat(h,1).matMul(s).add(u),f=d.shape[0],m=d.shape[1]/4,v=[f,m],y=d.slice([0,0],v),g=d.slice([0,m],v),w=d.slice([0,2*m],v),b=d.slice([0,3*m],v),S=y.sigmoid().mulStrict(g.tanh()).addStrict(c.mulStrict(a.add(w).sigmoid())),E=S.tanh().mulStrict(b.sigmoid());return[S,E]}}),wM=$({multiRNNCell_:function(n,e,t,r){for(var i=L(e,"data","multiRNNCell"),o=kd(t,"c","multiRNNCell"),a=kd(r,"h","multiRNNCell"),s=i,u=[],l=0;l<n.length;l++){var c=n[l](s,o[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var h=[],d=[];for(l=0;l<u.length;l+=2)h.push(u[l]),d.push(u[l+1]);return[h,d]}}),bM=$({movingAverage_:function(n,e,t,r,i){i===void 0&&(i=!0);var o=L(n,"v","movingAverage"),a=L(e,"x","movingAverage"),s=L(t,"decay","movingAverage");ZD(o,a),B(jn(o.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=Ee(1),l=u.sub(s),c=a.sub(o).mul(l);if(i){B(r!=null,function(){return"When using zeroDebias: true, step is required."});var h=L(r,"step","movingAverage");c=c.div(u.sub(oc(s,h)))}return o.add(c)}}),sE=$({stridedSlice_:function(n,e,t,r,i,o,a,s,u){if(i===void 0&&(i=0),o===void 0&&(o=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(e.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var l=L(n,"x","stridedSlice"),c=pw(s),h=l.shape.slice();c.forEach(function(y){e[y]=0,t[y]=1,h.splice(y,0,1)}),l=l.reshape(h);for(var d=0;d<l.rank;d++)e[d]=GO(i,e,r,l.shape,d),t[d]=qO(o,t,r,l.shape,d),r[d]=r[d]||1;var f=pw(u);f.forEach(function(y){t[y]=e[y]+1,r[y]=1});var m=gv(e,t,r),v=m.filter(function(y,g){return f.indexOf(g)===-1});return r.every(function(y){return y===1})?Yr(l,e,m).reshape(v):V.runKernelFunc(function(y){return y.stridedSlice(l,e,t,r)},{$x:l}).reshape(v)}}),uE=$({topk_:function(n,e,t){e===void 0&&(e=1),t===void 0&&(t=!0);var r=L(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=V.runKernelFunc(function(a){return a.topk(r,e,t)},{$x:r});return{values:o[0],indices:o[1]}}}),lE=$({scatterND_:function(n,e,t){var r=L(n,"indices","scatterND","int32"),i=L(e,"updates","scatterND");return SG(i,r,t),V.runKernelFunc(function(o){return o.scatterND(r,i,t)},{$indices:r,$updates:i})}}),vf=$({fft_:function(n){B(n.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+n.dtype+"."});var e=n.shape[n.shape.length-1],t=n.size/e,r=n.as2D(t,e);return V.runKernelFunc(function(i){return i.fft(r)},{input:n}).reshape(n.shape)}}),uc=$({ifft_:function(n){B(n.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+n.dtype+"."});var e=n.shape[n.shape.length-1],t=n.size/e,r=n.as2D(t,e);return V.runKernelFunc(function(i){return i.ifft(r)},{input:n}).reshape(n.shape)}}),yf=$({rfft_:function(n,e){B(n.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+n.dtype});var t,r=n.shape[n.shape.length-1],i=n.size/r;if(e!=null&&e<r){var o=n.shape.map(function(g){return 0}),a=n.shape.map(function(g){return g});a[n.shape.length-1]=e,t=n.slice(o,a),r=e}else if(e!=null&&e>r){var s=n.shape.map(function(g){return g});s[n.shape.length-1]=e-r,t=n.concat(St(s),n.shape.length-1),r=e}else t=n;var u=t.zerosLike(),l=Tn(t,u).as2D(i,r),c=vf(l),h=Math.floor(r/2)+1,d=Ir(c),f=li(c),m=d.split([h,r-h],d.shape.length-1),v=f.split([h,r-h],f.shape.length-1),y=t.shape.slice();return y[t.shape.length-1]=h,Tn(m[0],v[0]).reshape(y)}}),$v=$({irfft_:function(n){var e=n.shape[n.shape.length-1],t=n.size/e;if(e<=2){var r=n.as2D(t,e),i=uc(r);return Ir(i)}var o=[t,2*(e-1)],a=Ir(n).as2D(t,e),s=li(n).as2D(t,e),u=a.slice([0,1],[t,e-2]).reverse(1),l=s.slice([0,1],[t,e-2]).reverse(1).mul(Ee(-1)),c=a.concat(u,1),h=s.concat(l,1);return r=Tn(c,h).as2D(o[0],o[1]),i=uc(r),Ir(i)}}),xM=Object.freeze({fft:vf,ifft:uc,rfft:yf,irfft:$v}),Hv=$({sparseToDense_:function(n,e,t,r){r===void 0&&(r=0);var i=L(n,"sparseIndices","sparseToDense","int32"),o=L(e,"sparseValues","sparseToDense"),a=L(r,"defaultValue","sparseToDense",o.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var h=s.rank>0?s.shape[0]:1,d=s.rank>1?s.shape[1]:1;if(l.length!==d)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+d+".");var f=u.size;if(u.rank!==0&&(u.rank!==1||f!==h))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+h+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,t,a),V.runKernelFunc(function(s){return s.sparseToDense(i,o,t,a)},{$sparseIndices:i,$sparseValues:o,$defaultValue:a})}}),cE=$({gatherND_:function(n,e){var t=L(e,"indices","gatherND","int32"),r=L(n,"x","gatherND");return V.runKernelFunc(function(i){return i.gatherND(r,t)},{$x:r,$indices:t})}}),_M=$({diag_:function(n){var e=L(n,"x","diag").flatten(),t=n.shape.concat(n.shape);return V.runKernelFunc(function(r){return r.diag(e)},{$x:e}).reshape(t)}}),hE=$({dropout_:function(n,e,t,r){var i=L(n,"x","dropout");if(B(i.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."}),B(e>=0&&e<1,function(){return"rate must be a float in the range [0, 1), but got "+e+"."}),e===0)return n instanceof Nt?i.clone():i;var o=function(u,l){if(l==null)return u.shape.slice();if(jn(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],h=0;h<u.shape.length;h++)l[h]==null&&u.shape[h]!=null?c.push(u.shape[h]):c.push(l[h]);return c}return l}(i,t),a=1-e,s=Uu(o,0,1,"float32",r).add(a).floor().div(a);return i.mul(s)}});function EM(n,e,t){for(var r=1-n%2,i=new Float32Array(n),o=0;o<n;++o){var a=2*Math.PI*o/(n+r-1);i[o]=e-t*Math.cos(a)}return Or(i,"float32")}var Gv=$({hannWindow_:function(n){return EM(n,.5,.5)}}),dE=$({hammingWindow_:function(n){return EM(n,.54,.46)}}),qv=$({frame_:function(n,e,t,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var o=0,a=[];o+e<=n.size;)a.push(Yr(n,o,e)),o+=t;if(r)for(;o<n.size;){var s=o+e-n.size,u=ar([Yr(n,o,e-s),Tc([s],i)]);a.push(u),o+=t}return a.length===0?Go([],[0,e]):ar(a).as2D(a.length,e)}}),fE=$({stft_:function(n,e,t,r,i){var o;i===void 0&&(i=Gv),r==null&&(o=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var a=qv(n,e,t),s=He(a,i(e)),u=[],l=0;l<a.shape[0];l++)u.push(yf(s.slice([l,0],[1,e]),r));return ar(u)}}),CM=Object.freeze({hannWindow:Gv,hammingWindow:dE,frame:qv,stft:fE}),Xn,SM=function(n,e,t){return t===void 0&&(t=1),Ie(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h,d,f,m,v,y;return Ne(this,function(g){switch(g.label){case 0:return r=L(n,"predictions","inTopK"),i=L(e,"targets","inTopK"),B(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),B(r.rank-1===i.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank}),pt(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],B(t>0&&t<=o,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+t}),[4,r.data()];case 1:return a=g.sent(),[4,i.data()];case 2:for(s=g.sent(),u=[a.length/o,o],c=u[1],h=_d("bool",l=u[0]),d=0;d<l;d++){for(f=d*c,m=a.subarray(f,f+c),v=[],y=0;y<m.length;y++)v.push({value:m[y],index:y});for(v.sort(function(w,b){return b.value-w.value}),h[d]=0,y=0;y<t;y++)if(v[y].index===s[d]){h[d]=1;break}}return n!==r&&r.dispose(),e!==i&&i.dispose(),[2,gn(h,i.shape,"bool")]}})})};(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Xn||(Xn={}));var p7=$({absoluteDifference_:function(n,e,t,r){r===void 0&&(r=Xn.SUM_BY_NONZERO_WEIGHTS);var i=L(n,"labels","absoluteDifference"),o=L(e,"predictions","absoluteDifference"),a=null;t!=null&&(a=L(t,"weights","absoluteDifference")),pt(i.shape,o.shape,"Error in absoluteDifference: ");var s=i.sub(o).abs();return fa(s,a,r)}}),fa=$({computeWeightedLoss_:function(n,e,t){t===void 0&&(t=Xn.SUM_BY_NONZERO_WEIGHTS);var r=L(n,"losses","computeWeightedLoss"),i=null;e!=null&&(i=L(e,"weights","computeWeightedLoss"));var o=i==null?r:r.mul(i);if(t===Xn.NONE)return o;if(t===Xn.SUM)return o.sum();if(t===Xn.MEAN){if(i==null)return o.mean();var a=r.size/i.size,s=o.sum().div(i.sum());return a>1?s.div(Ee(a)):s}if(t===Xn.SUM_BY_NONZERO_WEIGHTS){if(i==null)return o.sum().div(Ee(r.size));var u=i.mul(yo(r.shape)).notEqual(Ee(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+t)}}),m7=$({cosineDistance_:function(n,e,t,r,i){i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=L(n,"labels","cosineDistance"),a=L(e,"predictions","cosineDistance"),s=null;r!=null&&(s=L(r,"weights","cosineDistance")),pt(o.shape,a.shape,"Error in cosineDistance: ");var u=Ee(1).sub(o.mul(a).sum(t,!0));return fa(u,s,i)}}),g7=$({hingeLoss_:function(n,e,t,r){r===void 0&&(r=Xn.SUM_BY_NONZERO_WEIGHTS);var i=L(n,"labels","hingeLoss"),o=L(e,"predictions","hingeLoss"),a=null;t!=null&&(a=L(t,"weights","hingeLoss")),pt(i.shape,o.shape,"Error in hingeLoss: ");var s=Ee(1);i=Ee(2).mul(i).sub(s);var u=s.sub(i.mul(o)).relu();return fa(u,a,r)}}),v7=$({huberLoss_:function(n,e,t,r,i){r===void 0&&(r=1),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=L(n,"labels","huberLoss"),a=L(e,"predictions","huberLoss"),s=null;t!=null&&(s=L(t,"weights","huberLoss")),pt(o.shape,a.shape,"Error in huberLoss: ");var u=Ee(r),l=a.sub(o).abs(),c=Rc(l,u),h=l.sub(c),d=Ee(.5).mul(c.square()).add(u.mul(h));return fa(d,s,i)}}),y7=$({logLoss_:function(n,e,t,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=L(n,"labels","logLoss"),a=L(e,"predictions","logLoss"),s=null;t!=null&&(s=L(t,"weights","logLoss")),pt(o.shape,a.shape,"Error in logLoss: ");var u=Ee(1),l=Ee(r),c=o.mul(a.add(l).log()).neg().sub(u.sub(o).mul(u.sub(a).add(l).log()));return fa(c,s,i)}}),w7=$({meanSquaredError_:function(n,e,t,r){r===void 0&&(r=Xn.SUM_BY_NONZERO_WEIGHTS);var i=L(n,"labels","meanSquaredError"),o=L(e,"predictions","meanSquaredError"),a=null;t!=null&&(a=L(t,"weights","meanSquaredError")),pt(i.shape,o.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(o);return fa(s,a,r)}}),b7=$({sigmoidCrossEntropy_:function(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=L(n,"multiClassLabels","sigmoidCrossEntropy"),a=L(e,"logits","sigmoidCrossEntropy"),s=null;if(t!=null&&(s=L(t,"weights","sigmoidCrossEntropy")),pt(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Ee(r),l=Ee(1),c=Ee(.5);o=o.mul(l.sub(u)).add(c.mul(u))}var h=function(d,f){var m=L(d,"labels","sigmoidCrossEntropyWithLogits"),v=L(f,"logits","sigmoidCrossEntropyWithLogits");pt(m.shape,v.shape,"Error in sigmoidCrossEntropyWithLogits: ");var y=v.relu(),g=v.mul(m),w=v.abs().neg().exp().log1p();return y.sub(g).add(w)}(o,a);return fa(h,s,i)}}),x7=$({softmaxCrossEntropy_:function(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=L(n,"onehotLabels","softmaxCrossEntropy"),a=L(e,"logits","softmaxCrossEntropy"),s=null;if(t!=null&&(s=L(t,"weights","softmaxCrossEntropy")),pt(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Ee(r),l=Ee(1),c=Ee(o.shape[1]);o=o.mul(l.sub(u)).add(u.div(c))}var h=function(d,f,m){if(m===void 0&&(m=-1),m===-1&&(m=f.rank-1),m!==f.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+f.rank+" and dim was "+m);return kc(function(v,y,g){var w=y.logSumExp([m],!0),b=y.toFloat().sub(w);return g([v,b]),{value:b.mul(v).neg().sum([m]),gradFunc:function(S,E){var T=E[0],_=E[1],x=Kr(S.shape,[m]);return[S.reshape(x).mul(T.toFloat().sub(_.exp())),S.reshape(x).mul(_.exp().sub(T.toFloat()))]}}})(d,f)}(o,a);return fa(h,s,i)}}),IM=Object.freeze({get Reduction(){return Xn},absoluteDifference:p7,computeWeightedLoss:fa,cosineDistance:m7,hingeLoss:g7,huberLoss:v7,logLoss:y7,meanSquaredError:w7,sigmoidCrossEntropy:b7,softmaxCrossEntropy:x7});function iN(n,e){return e===void 0&&(e=!1),V.tidy(function(){if(n.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+n.shape.length+"D Tensor.");for(var t=n.shape[0],r=n.shape[1],i=pv(t),o=n.clone(),a=Go([[1]],[1,1]),s=a.clone(),u=t>=r?r:t,l=function(h){var d,f=o,m=s,v=i;d=V.tidy(function(){var y=o.slice([h,h],[t-h,1]),g=y.norm(),w=o.slice([h,h],[1,1]),b=Go([[-1]]).where(w.greater(0),Go([[1]])),S=w.sub(b.mul(g)),E=y.div(S);s=E.shape[0]===1?a.clone():a.concat(E.slice([1,0],[E.shape[0]-1,E.shape[1]]),0);var T=b.matMul(S).div(g).neg(),_=o.slice([h,0],[t-h,r]),x=T.mul(s);if(h===0)o=_.sub(x.matMul(s.transpose().matMul(_)));else{var C=_.sub(x.matMul(s.transpose().matMul(_)));o=o.slice([0,0],[h,r]).concat(C,0)}var N=i.slice([0,h],[t,i.shape[1]-h]);if(h===0)i=N.sub(N.matMul(s).matMul(x.transpose()));else{var R=N.sub(N.matMul(s).matMul(x.transpose()));i=i.slice([0,0],[t,h]).concat(R,1)}return[s,o,i]}),s=d[0],o=d[1],i=d[2],Ze([f,m,v])},c=0;c<u;++c)l(c);return!e&&t>r&&(i=i.slice([0,0],[t,r]),o=o.slice([0,0],[r,r])),[i,o]})}var _7=$({gramSchmidt_:function(n){var e;if(Array.isArray(n)){e=!1,B(n!=null&&n.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var t=n[0].shape[0],r=function(u){B(n[u].shape[0]===t,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+n[u].shape[0]+" vs. "+t+")"})},i=1;i<n.length;++i)r(i)}else e=!0,n=qo(n,n.shape[0],0).map(function(u){return sf(u,[0])});B(n.length<=n[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+n.length+") exceeds number of dimensions ("+n[0].shape[0]+")."});var o=[],a=n,s=function(u){o.push(V.tidy(function(){var l=a[u];if(u>0)for(var c=0;c<u;++c){var h=Pr(o[c].mulStrict(l)).mul(o[c]);l=l.sub(h)}return l.div(aE(l,"euclidean"))}))};for(i=0;i<n.length;++i)s(i);return e?Ui(o,0):o}}),E7=$({qr_:function(n,e){if(e===void 0&&(e=!1),n.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+n.rank);if(n.rank===2)return iN(n,e);var t=n.shape.slice(0,n.shape.length-2).reduce(function(a,s){return a*s}),r=Iu(n.reshape([t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),i=[],o=[];return r.forEach(function(a){var s=iN(a,e),u=s[0],l=s[1];i.push(u),o.push(l)}),[Ui(i,0).reshape(n.shape),Ui(o,0).reshape(n.shape)]}}),pE=Object.freeze({gramSchmidt:_7,qr:E7});function NM(n,e,t,r,i){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY);var o=n.shape[0];return t=Math.min(t,o),B(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),B(n.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+n.rank+"'"}),B(n.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+n.shape[1]}),B(e.rank===1,function(){return"scores must be a 1D tensor"}),B(e.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]}),{maxOutputSize:t,iouThreshold:r,scoreThreshold:i}}var C7=$({resizeBilinear_:function(n,e,t){t===void 0&&(t=!1);var r=L(n,"images","resizeBilinear");B(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),B(e.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."});var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=V.runKernelFunc(function(l,c){return c([i]),l.resizeBilinear(i,a,s,t)},{batchImages:i},function(l,c){return{batchImages:function(){return V.runKernelFunc(function(h){return h.resizeBilinearBackprop(l,c[0],t)},{})}}});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),S7=$({resizeNearestNeighbor_:function(n,e,t){t===void 0&&(t=!1);var r=L(n,"images","resizeNearestNeighbor");B(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),B(e.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."}),B(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=V.runKernelFunc(function(l,c){return c([i]),l.resizeNearestNeighbor(i,a,s,t)},{batchImages:i},function(l,c){return{batchImages:function(){return V.runKernelFunc(function(h){return h.resizeNearestNeighborBackprop(l,c[0],t)},{})}}});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),I7=$({nonMaxSuppression_:function(n,e,t,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var o=L(n,"boxes","nonMaxSuppression"),a=L(e,"scores","nonMaxSuppression"),s=NM(o,a,t,r,i);return t=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,V.runKernelFunc(function(u){return u.nonMaxSuppression(o,a,t,r,i)},{$boxes:o})}}),N7=function(n,e,t,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),Ie(this,void 0,void 0,function(){var o,a,s,u,l,c,h;return Ne(this,function(d){switch(d.label){case 0:return o=L(n,"boxes","nonMaxSuppressionAsync"),a=L(e,"scores","nonMaxSuppressionAsync"),s=NM(o,a,t,r,i),t=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([o.data(),a.data()])];case 1:return u=d.sent(),l=u[0],c=u[1],h=y_(l,c,t,r,i),o!==n&&o.dispose(),a!==e&&a.dispose(),[2,h]}})})},T7=$({cropAndResize_:function(n,e,t,r,i,o){var a=L(n,"image","cropAndResize","float32"),s=L(e,"boxes","cropAndResize","float32"),u=L(t,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var l=s.shape[0];return B(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),B(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),B(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),B(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),B(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),B(i==="bilinear"||i==="nearest",function(){return"method must be bilinear or nearest, but was "+i}),V.runKernelFunc(function(c,h){return c.cropAndResize(a,s,u,r,i,o)},{$image:a,$boxes:s})}}),cu=Object.freeze({resizeBilinear:C7,resizeNearestNeighbor:S7,nonMaxSuppression:I7,nonMaxSuppressionAsync:N7,cropAndResize:T7}),mE=function(n,e){return!(n>0)&&(e==="linear"||e==="relu")},gE=function(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return n.mul(e.step());throw new Error("Gradient for activation "+t+" has not been implemented yet.")},vE=function(n,e){var t=e,r=En(n.shape,e.shape);return r.length>0&&(t=t.sum(r)),t.reshape(n.shape)},yE=function(n,e,t){if(e==="linear")return n;if(e==="relu")return As(n);if(e==="elu")return Pc(n);if(e==="relu6")return iE(n);if(e==="prelu")return Wv(n,t);throw new Error("Unknown fused activation "+e+".")},k7=$({matMul_:function(n){var e,t=n.a,r=n.b,i=n.transposeA,o=i!==void 0&&i,a=n.transposeB,s=a!==void 0&&a,u=n.bias,l=n.activation,c=l===void 0?"linear":l,h=n.preluActivationWeights;if(mE(V.state.gradientDepth,c)===!1){var d=Dv(t,r,o,s);return u!=null&&(d=ot(d,u)),yE(d,c,h)}var f=L(t,"a","fused matMul"),m=L(r,"b","fused matMul");e=fn(f,m),f=e[0],m=e[1];var v=o?f.shape[f.rank-2]:f.shape[f.rank-1],y=s?m.shape[m.rank-1]:m.shape[m.rank-2],g=o?f.shape[f.rank-1]:f.shape[f.rank-2],w=s?m.shape[m.rank-2]:m.shape[m.rank-1],b=f.shape.slice(0,-2),S=m.shape.slice(0,-2),E=Ae(b),T=Ae(S);B(f.rank>=2&&m.rank>=2&&f.rank===m.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+f.rank+" and "+m.rank+"."}),B(jn(b,S),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+S+") of Tensors with shapes "+f.shape+" and "+m.shape+" must match."}),B(v===y,function(){return"Error in fused matMul: inner shapes ("+v+") and ("+y+") of Tensors with shapes "+f.shape+" and "+m.shape+" and transposeA="+o+" and transposeB="+s+" must match."});var _,x,C=f.shape.slice(0,-2).concat([g,w]),N=o?f.as3D(E,v,g):f.as3D(E,g,v),R=s?m.as3D(T,w,y):m.as3D(T,y,w);u!=null&&st(C,(_=fn(_=L(u,"bias","fused matMul"),f)[0]).shape),h!=null&&(x=L(h,"prelu weights","fused matMul"));var k={$a:N,$b:R};return u!=null&&(k.$bias=_),h!=null&&(k.$preluActivationWeights=x),V.runKernelFunc(function(D,W){var U=D.fusedBatchMatMul({a:N,b:R,transposeA:o,transposeB:s,bias:_,activation:c,preluActivationWeights:x});return W([N,R,U]),U},k,function(D,W){var U=W[0],j=W[1],H=W[2],z=gE(D,H,c),q={};return u!=null&&(q={$bias:function(){return vE(_,z)}}),Object.assign(o||s?!o&&s?{$a:function(){return z.matMul(j,!1,!1)},$b:function(){return z.matMul(U,!0,!1)}}:o&&!s?{$a:function(){return j.matMul(z,!1,!0)},$b:function(){return U.matMul(z,!1,!1)}}:{$a:function(){return j.matMul(z,!0,!0)},$b:function(){return z.matMul(U,!0,!0)}}:{$a:function(){return z.matMul(j,!1,!0)},$b:function(){return U.matMul(z,!0,!1)}},q)}).reshape(C)}}),R7=$({conv2d_:function(n){var e=n.x,t=n.filter,r=n.strides,i=n.pad,o=n.dataFormat,a=o===void 0?"NHWC":o,s=n.dilations,u=s===void 0?[1,1]:s,l=n.dimRoundingMode,c=n.bias,h=n.activation,d=h===void 0?"linear":h,f=n.preluActivationWeights;if(d=d||"linear",mE(V.state.gradientDepth,d)===!1){var m=Hu(e,t,r,i,a,u,l);return c!=null&&(m=ot(m,c)),yE(m,d,f)}var v=L(e,"x","conv2d"),y=L(t,"filter","conv2d"),g=v,w=!1;v.rank===3&&(w=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),B(g.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."}),B(y.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+y.rank+"."}),l!=null&&B(dn(i),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."}),B(g.shape[3]===y.shape[2],function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+y.shape[2]+"."}),B(gr(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),B(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var b,S,E=Rs(g.shape,y.shape,r,u,i,l);c!=null&&(b=fn(b=L(c,"bias","fused conv2d"),v)[0],st(E.outShape,b.shape)),f!=null&&(S=L(f,"prelu weights","fused conv2d"));var T={x:g,$filter:y};c!=null&&(T.$bias=b),f!=null&&(T.$preluActivationWeights=S);var _=V.runKernelFunc(function(x,C){var N=x.fusedConv2d({input:g,filter:y,convInfo:E,bias:b,activation:d,preluActivationWeights:S});return C([y,g,N]),N},T,function(x,C){var N=C,R=N[0],k=N[1],D=N[2],W=gE(x,D,d);B(Nu(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var U={};return c!=null&&(U={$bias:function(){return vE(b,W)}}),Object.assign({x:function(){return rM(k.shape,W,R,r,i)},$filter:function(){return tE(k,W,R.shape,r,i)}},U)});return w?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),A7=$({depthwiseConv2d_:function(n){var e=n.x,t=n.filter,r=n.strides,i=n.pad,o=n.dataFormat,a=o===void 0?"NHWC":o,s=n.dilations,u=s===void 0?[1,1]:s,l=n.dimRoundingMode,c=n.bias,h=n.activation,d=h===void 0?"linear":h,f=n.preluActivationWeights;if(mE(V.state.gradientDepth,d)===!1){var m=Oc(e,t,r,i,a,u,l);return c!=null&&(m=ot(m,c)),yE(m,d,f)}var v=L(e,"x","depthwiseConv2d"),y=L(t,"filter","depthwiseConv2d"),g=v,w=!1;v.rank===3&&(w=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),B(g.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+g.rank+"."}),B(y.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+y.rank+"."}),B(g.shape[3]===y.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+g.shape[3]+") must match the inChannels dimension in filter "+y.shape[2]+"."}),u==null&&(u=[1,1]),B(gr(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&B(dn(i),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."});var b,S,E=Rs(g.shape,y.shape,r,u,i,l,!0);c!=null&&(b=fn(b=L(c,"bias","fused conv2d"),v)[0],st(E.outShape,b.shape)),f!=null&&(S=L(f,"prelu weights","fused depthwiseConv2d"));var T={x:g,$filter:y};c!=null&&(T.$bias=b),f!=null&&(T.$preluActivationWeights=S);var _=V.runKernelFunc(function(x,C){var N=x.fusedDepthwiseConv2D({input:g,filter:y,convInfo:E,bias:b,activation:d,preluActivationWeights:S});return C([g,y,N]),N},T,function(x,C){B(Nu(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var N=C[0],R=C[1],k=C[2],D=gE(x,k,d),W={};return c!=null&&(W={$bias:function(){return vE(b,D)}}),Object.assign({x:function(){return iM(N.shape,D,R,E)},$filter:function(){return oM(N,D,R.shape,E)}},W)});return w?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),lc=Object.freeze({matMul:k7,conv2d:R7,depthwiseConv2d:A7}),D7=Object.freeze({image:cu,linalg:pE,losses:IM,spectral:xM,fused:lc,signal:CM,square:E_,conv1d:kv,conv2d:Hu,conv3d:Rv,depthwiseConv2d:Oc,separableConv2d:nE,conv2dTranspose:Av,conv3dTranspose:aM,op:$,batchNormalization2d:MP,batchNormalization3d:LP,batchNormalization4d:FP,batchNormalization:zP,batchNorm:V_,batchNorm2d:$_,batchNorm3d:H_,batchNorm4d:G_,booleanMaskAsync:eM,complex:Tn,real:Ir,imag:li,concat:ar,concat1d:n_,concat2d:r_,concat3d:i_,concat4d:o_,split:qo,matMul:Dv,dot:sM,outerProduct:uM,reverse:po,reverse1d:lM,reverse2d:cM,reverse3d:hM,reverse4d:dM,maxPool:Ov,avgPool:Pv,pool:mM,maxPool3d:Mv,avgPool3d:Lv,slice:Yr,slice1d:pf,slice2d:Fv,slice3d:mf,slice4d:sc,abs:gs,acos:C_,acosh:S_,asin:I_,asinh:N_,atan:T_,atanh:k_,ceil:R_,clipByValue:vr,cos:A_,cosh:D_,erf:O_,exp:P_,expm1:M_,floor:bv,log:ia,log1p:L_,logSigmoid:NP,neg:Vu,reciprocal:F_,round:z_,rsqrt:xv,sigmoid:_v,sign:B_,isNaN:TP,isInf:kP,isFinite:RP,sin:j_,sinh:U_,softplus:cf,sqrt:hf,step:AP,tan:W_,tanh:Ev,all:zv,any:Dd,argMax:Od,argMin:rE,logSumExp:vM,max:vs,mean:yn,min:Bv,moments:gf,sum:Pr,prod:jv,equal:$u,equalStrict:KP,greater:Ac,greaterEqual:ff,greaterEqualStrict:XP,greaterStrict:YP,less:J_,lessEqual:Z_,lessEqualStrict:QP,lessStrict:JP,notEqual:ac,notEqualStrict:ZP,add:ot,addN:K_,addStrict:jP,atan2:X_,div:sr,divStrict:UP,floorDiv:Nv,maximum:wo,maximumStrict:WP,minimum:Rc,minimumStrict:VP,mod:Y_,modStrict:$P,mul:He,mulStrict:Tv,pow:oc,powStrict:HP,squaredDifference:Q_,squaredDifferenceStrict:GP,sub:Un,subStrict:qP,elu:Pc,leakyRelu:Uv,prelu:Wv,relu:As,relu6:iE,selu:Vv,logicalAnd:da,logicalNot:q_,logicalOr:Sv,logicalXor:BP,where:oa,whereAsync:Iv,buffer:qe,print:DO,batchToSpaceND:dv,cast:fv,clone:OO,cumsum:PO,depthToSpace:s_,expandDims:Ur,eye:pv,multinomial:u_,oneHot:rc,pad:ks,pad1d:MO,pad2d:LO,pad3d:FO,pad4d:zO,rand:BO,randomNormal:l_,randomGamma:jO,randomUniform:Uu,reshape:af,spaceToBatchND:mv,squeeze:sf,stack:Ui,tile:is,truncatedNormal:uf,unstack:Iu,setdiff1dAsync:c_,fill:Tc,linspace:t_,ones:yo,range:cv,scalar:Ee,tensor:gn,tensor1d:Or,tensor2d:Go,tensor3d:Zx,tensor4d:Aa,tensor5d:RO,tensor6d:AO,variable:e_,zeros:St,onesLike:Xr,zerosLike:ct,transpose:Yt,softmax:Wu,logSoftmax:yv,localResponseNormalization:oE,norm:aE,gather:Dc,unsortedSegmentSum:eE,basicLSTMCell:yM,multiRNNCell:wM,movingAverage:bM,stridedSlice:sE,topk:uE,scatterND:lE,fft:vf,ifft:uc,rfft:yf,irfft:$v,sparseToDense:Hv,gatherND:cE,diag:_M,dropout:hE,hannWindow:Gv,hammingWindow:dE,frame:qv,stft:fE,inTopKAsync:SM});function le(n,e){Array.isArray(n)||(n=[n]),n.forEach(function(t){t!=null&&B(t.dtype!=="complex64",function(){return e+" does not support complex64 tensors."})})}function g0(n,e,t,r){if(t==="linear")return n.linear(e);if(t==="relu")return n.relu(e);if(t==="elu")return n.elu(e);if(t==="relu6")return n.relu6(e);if(t==="prelu")return n.prelu(e,r);throw new Error("Activation "+t+" has not been implemented for the CPU backend.")}var O7=function(n){function e(){var t=n.call(this)||this;if(t.blockSize=48,t.firstUse=!0,te().get("IS_BROWSER")){var r=typeof OffscreenCanvas<"u"?new OffscreenCanvas(300,150):typeof document<"u"?document.createElement("canvas"):null;r!==null&&(t.fromPixels2DContext=r.getContext("2d"))}return t.data=new f_(t,V),t}return Hi(e,n),e.prototype.write=function(t,r,i){this.firstUse&&(this.firstUse=!1,te().get("IS_NODE")&&fw(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================
`));var o={};return this.data.set(o,{values:t,dtype:i}),o},e.prototype.move=function(t,r,i,o){this.data.set(t,{values:r,dtype:o})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.fromPixels=function(t,r){if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var i,o,a=t.data instanceof Uint8Array,s=typeof ImageData<"u"&&t instanceof ImageData,u=typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement,c=u?[t.videoWidth,t.videoHeight]:[t.width,t.height],h=c[0],d=c[1];if(te().get("IS_NODE")&&t.getContext==null)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(t.getContext!=null)i=t.getContext("2d").getImageData(0,0,h,d).data;else if(s||a)i=t.data;else{if(!l&&!u)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(this.fromPixels2DContext==null)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=h,this.fromPixels2DContext.canvas.height=d,this.fromPixels2DContext.drawImage(t,0,0,h,d),i=this.fromPixels2DContext.getImageData(0,0,h,d).data}if(r===4)o=new Int32Array(i);else{var f=h*d;o=new Int32Array(f*r);for(var m=0;m<f;m++)for(var v=0;v<r;++v)o[m*r+v]=i[4*m+v]}return Zx(o,[d,h,r],"int32")},e.prototype.read=function(t){return Ie(this,void 0,void 0,function(){return Ne(this,function(r){return[2,this.readSync(t)]})})},e.prototype.readSync=function(t){var r=this.data.get(t),i=r.dtype,o=r.complexTensors;return i==="complex64"?gw(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var r=this.readSync(t.dataId),i=r;if(t.dtype==="string")try{i=r.map(function(o){return Cd(o)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return qe(t.shape,t.dtype,i)},e.prototype.makeOutput=function(t,r,i){var o=this.write(t,r,i);return V.makeTensorFromDataId(o,r,i,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var r=this.data.get(t).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return Ie(this,void 0,void 0,function(){var r;return Ne(this,function(i){return r=Si(),t(),[2,{kernelMs:Si()-r}]})})},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,r){var i=this.makeOutput(null,t.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:V.keep(t.clone()),imag:V.keep(r.clone())},i},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,r,i){if(le(t,"slice"),h_(t.shape,r,i)){var o=d_(r,t.strides),a=Ae(i);return gn(this.readSync(t.dataId).subarray(o,o+a),i,t.dtype)}for(var s=qe(i,t.dtype),u=this.bufferSync(t),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(h,d){return h+r[d]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},e.prototype.stridedSlice=function(t,r,i,o){le(t,"stridedSlice");var a=gv(r,i,o);if(a.some(function(f){return f===0}))return gn([],a);for(var s=qe(a,t.dtype),u=this.bufferSync(t),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),h=new Array(c.length),d=0;d<h.length;d++)h[d]=c[d]*o[d]+r[d];s.set.apply(s,[u.get.apply(u,h)].concat(c))}return s.toTensor()},e.prototype.diag=function(t){for(var r=this.readSync(t.dataId),i=qe([t.size,t.size],t.dtype),o=i.values,a=0;a<r.length;a++)o[a*t.size+a]=r[a];return i.toTensor()},e.prototype.unstack=function(t,r){for(var i=t.shape[r],o=new Array(t.rank-1),a=0,s=0;s<t.rank;s++)s!==r&&(o[a++]=t.shape[s]);var u=new Array(t.rank).fill(0),l=t.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(t,u,l).reshape(o);return c},e.prototype.reverse=function(t,r){le(t,"reverse");for(var i=qe(t.shape,t.dtype),o=this.bufferSync(t),a=function(u){var l=i.indexToLoc(u),c=l.slice();r.forEach(function(h){return c[h]=t.shape[h]-1-c[h]}),i.set.apply(i,[o.get.apply(o,c)].concat(l))},s=0;s<i.size;s++)a(s);return i.toTensor()},e.prototype.concat=function(t,r){var i=this;if(t[0].dtype==="complex64"){var o=t.map(function(f){return Ir(f)}),a=t.map(function(f){return li(f)});return Tn(this.concat(o,r),this.concat(a,r))}var s=t.map(function(f){var m=Ae(f.shape.slice(r));return f.as2D(-1,m)}),u=Su(s.map(function(f){return f.shape}),1),l=qe(u,t[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(f){l.set(i.readSync(f.dataId),c),c+=f.size})}else{var h=0;s.forEach(function(f){for(var m=i.readSync(f.dataId),v=0,y=0;y<f.shape[0];++y)for(var g=y*u[1]+h,w=0;w<f.shape[1];++w)l[g+w]=m[v++];h+=f.shape[1]})}var d=Su(t.map(function(f){return f.shape}),r);return gn(l,d,t[0].dtype)},e.prototype.neg=function(t){return le(t,"neg"),this.multiply(Ee(-1),t)},e.prototype.add=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),function(i,o,a,s){return{real:i+a,imag:o+s}}):this.broadcastedBinaryOp(t,r,wn(t.dtype,r.dtype),function(i,o){return i+o})},e.prototype.addN=function(t){var r=this;le(t,"addN");for(var i=t.map(function(c){return r.readSync(c.dataId)}),o=qe(t[0].shape,t[0].dtype),a=o.values,s=0;s<t.length;s++)for(var u=i[s],l=0;l<a.length;l++)a[l]+=u[l];return o.toTensor()},e.prototype.subtract=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),function(i,o,a,s){return{real:i-a,imag:o-s}}):this.broadcastedBinaryOp(t,r,wn(t.dtype,r.dtype),function(i,o){return i-o})},e.prototype.pow=function(t,r){return le([t,r],"pow"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,o){return Math.pow(i,o)})},e.prototype.batchMatMul=function(t,r,i,o){le([t,r],"matMul");for(var a=i?t.shape[1]:t.shape[2],s=i?t.shape[2]:t.shape[1],u=o?r.shape[1]:r.shape[2],l=t.shape[0],c=this.readSync(t.dataId),h=this.readSync(r.dataId),d=i?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],f=d[0],m=d[1],v=d[2],y=o?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],g=y[0],w=y[1],b=y[2],S=s*u,E=qe([l,s,u],t.dtype),T=E.values,_=this.blockSize,x=0;x<l;x++)for(var C=0;C<s;C+=_)for(var N=0;N<u;N+=_)for(var R=0;R<a;R+=_)for(var k=Math.min(C+_,s),D=Math.min(N+_,u),W=Math.min(R+_,a),U=C;U<k;U++)for(var j=N;j<D;j++){for(var H=0,z=R;z<W;z++)H+=c[x*f+U*m+z*v]*h[z*g+j*w+x*b];T[x*S+(U*u+j)]+=H}return E.toTensor()},e.prototype.fusedBatchMatMul=function(t){var r=t.a,i=t.b,o=t.transposeA,a=t.transposeB,s=t.bias,u=t.activation,l=t.preluActivationWeights,c=this.batchMatMul(r,i,o,a);return s&&(c=this.add(c,s)),u&&(c=g0(this,c,u,l)),c},e.prototype.multiply=function(t,r){return t.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(t.cast("complex64"),r.cast("complex64"),function(i,o,a,s){return{real:i*a-o*s,imag:i*s+o*a}}):this.broadcastedBinaryOp(t,r,wn(t.dtype,r.dtype),function(i,o){return i*o})},e.prototype.realDivide=function(t,r){return le([t,r],"realDivide"),this.broadcastedBinaryOp(t,r,"float32",function(i,o){return i/o})},e.prototype.floorDiv=function(t,r){return le([t,r],"floorDiv"),this.broadcastedBinaryOp(t,r,"int32",function(i,o){return Math.floor(i/o)})},e.prototype.sum=function(t,r){le(t,"sum"),Cr("sum",r,t.rank);for(var i=Gn(t.shape,r),o=i[0],a=i[1],s=St(o,wn(t.dtype,"int32")),u=Ae(a),l=this.readSync(s.dataId),c=this.readSync(t.dataId),h=0;h<l.length;++h){for(var d=h*u,f=0,m=0;m<u;++m)f+=c[d+m];l[h]=f}return s},e.prototype.prod=function(t,r){le(t,"sum");for(var i=Gn(t.shape,r),o=i[0],a=i[1],s=St(o,wn(t.dtype,"int32")),u=Ae(a),l=this.readSync(s.dataId),c=this.readSync(t.dataId),h=0;h<l.length;++h){for(var d=h*u,f=1,m=0;m<u;++m)f*=c[d+m];l[h]=f}return s},e.prototype.unsortedSegmentSum=function(t,r,i){le(t,"unsortedSegmentSum");for(var o=[],a=t.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<i;++s){var u=Ee(s,"int32"),l=$u(u,r).asType("float32").mul(t).sum(0);o.push(l)}return Ui(o)},e.prototype.argMin=function(t,r){le(t,"argMin");var i=[r];Cr("argMin",i,t.rank);for(var o=Gn(t.shape,i),a=o[0],s=o[1],u=St(a,"int32"),l=Ae(s),c=this.readSync(u.dataId),h=this.readSync(t.dataId),d=0;d<c.length;++d){for(var f=d*l,m=h[f],v=0,y=0;y<l;++y){var g=h[f+y];g<m&&(m=g,v=y)}c[d]=v}return u},e.prototype.argMax=function(t,r){le(t,"argMax");var i=[r];Cr("argMax",i,t.rank);for(var o=Gn(t.shape,i),a=o[0],s=o[1],u=St(a,"int32"),l=Ae(s),c=this.readSync(u.dataId),h=this.readSync(t.dataId),d=0;d<c.length;++d){for(var f=d*l,m=h[f],v=0,y=0;y<l;++y){var g=h[f+y];g>m&&(m=g,v=y)}c[d]=v}return u},e.prototype.cumsum=function(t,r,i,o){if(le(t,"cumsum"),r!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+r);for(var a=wn(t.dtype,"int32"),s=St(t.shape,a),u=this.readSync(s.dataId),l=this.readSync(t.dataId),c=t.shape[t.rank-1],h=o?function(y,g){return y+c-g-1}:function(y,g){return y+g},d=0;d<l.length;d+=c)for(var f=0;f<c;f++){var m=h(d,f);if(f===0)u[m]=i?0:l[m];else{var v=h(d,f-1);u[m]=i?l[v]+u[v]:l[m]+u[v]}}return s},e.prototype.equal=function(t,r){return le([t,r],"equal"),this.broadcastedBinaryOp(t,r,"bool",function(i,o){return i===o?1:0})},e.prototype.notEqual=function(t,r){return le([t,r],"notEqual"),this.broadcastedBinaryOp(t,r,"bool",function(i,o){return i!==o?1:0})},e.prototype.less=function(t,r){return le([t,r],"less"),this.broadcastedBinaryOp(t,r,"bool",function(i,o){return i<o?1:0})},e.prototype.lessEqual=function(t,r){return le([t,r],"lessEqual"),this.broadcastedBinaryOp(t,r,"bool",function(i,o){return i<=o?1:0})},e.prototype.greater=function(t,r){return le([t,r],"greater"),this.broadcastedBinaryOp(t,r,"bool",function(i,o){return i>o?1:0})},e.prototype.greaterEqual=function(t,r){return le([t,r],"greaterEqual"),this.broadcastedBinaryOp(t,r,"bool",function(i,o){return i>=o?1:0})},e.prototype.logicalNot=function(t){le(t,"logicalNot");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r[o]?0:1;return this.makeOutput(i,t.shape,"bool")},e.prototype.logicalAnd=function(t,r){return le([t,r],"logicalAnd"),this.broadcastedBinaryOp(t,r,"bool",function(i,o){return i&&o})},e.prototype.logicalOr=function(t,r){return le([t,r],"logicalOr"),this.broadcastedBinaryOp(t,r,"bool",function(i,o){return i||o})},e.prototype.select=function(t,r,i){le([t,r,i],"select");for(var o=this.readSync(t.dataId),a=this.readSync(r.dataId),s=this.readSync(i.dataId),u=St(r.shape,wn(r.dtype,i.dtype)),l=this.readSync(u.dataId),c=0,h=t.rank===0||t.rank>1||r.rank===1?1:Ae(r.shape.slice(1)),d=0;d<o.length;d++)for(var f=0;f<h;f++)o[d]===1?l[c++]=a[d]:l[c++]=s[d];return u},e.prototype.where=function(t){le([t],"where");var r=this.readSync(t.dataId);return w_(t.shape,r)},e.prototype.topk=function(t,r,i){return le(t,"topk"),QO(this.readSync(t.dataId),t.shape,t.dtype,r)},e.prototype.min=function(t,r){le(t,"min"),Cr("min",r,t.rank);for(var i=Gn(t.shape,r),o=i[0],a=i[1],s=St(o,t.dtype),u=Ae(a),l=this.readSync(s.dataId),c=this.readSync(t.dataId),h=0;h<l.length;++h){for(var d=h*u,f=c[d],m=0;m<u;++m){var v=c[d+m];v<f&&(f=v)}l[h]=f}return s},e.prototype.minimum=function(t,r){return le([t,r],"minimum"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,o){return Math.min(i,o)})},e.prototype.mod=function(t,r){return le([t,r],"mod"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,o){var a=i%o;return i<0&&o<0||i>=0&&o>=0?a:(a+o)%o})},e.prototype.max=function(t,r){le(t,"max"),Cr("max",r,t.rank);for(var i=Gn(t.shape,r),o=i[0],a=i[1],s=St(o,t.dtype),u=Ae(a),l=this.readSync(s.dataId),c=this.readSync(t.dataId),h=0;h<l.length;++h){for(var d=h*u,f=c[d],m=0;m<u;++m){var v=c[d+m];v>f&&(f=v)}l[h]=f}return s},e.prototype.maximum=function(t,r){return le([t,r],"maximum"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,o){return Math.max(i,o)})},e.prototype.all=function(t,r){le(t,"all"),Cr("all",r,t.rank);for(var i=Gn(t.shape,r),o=i[0],a=i[1],s=St(o,t.dtype),u=Ae(a),l=this.readSync(s.dataId),c=this.readSync(t.dataId),h=0;h<l.length;++h){for(var d=h*u,f=c[d],m=0;m<u;++m){var v=c[d+m];f=f&&v}l[h]=f}return s},e.prototype.any=function(t,r){le(t,"any"),Cr("any",r,t.rank);for(var i=Gn(t.shape,r),o=i[0],a=i[1],s=St(o,t.dtype),u=Ae(a),l=this.readSync(s.dataId),c=this.readSync(t.dataId),h=0;h<l.length;++h){for(var d=h*u,f=c[d],m=0;m<u;++m){var v=c[d+m];f=f||v}l[h]=f}return s},e.prototype.squaredDifference=function(t,r){return le([t,r],"squaredDifference"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,o){var a=i-o;return a*a})},e.prototype.ceil=function(t){le(t,"ceil");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.ceil(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.floor=function(t){le(t,"floor");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.floor(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.sign=function(t){le(t,"x");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)r[o]<0?i[o]=-1:r[o]>0?i[o]=1:i[o]=0;return this.makeOutput(i,t.shape,"float32")},e.prototype.isNaN=function(t){le(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isNaN(r[o])&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.isInf=function(t){le(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Math.abs(r[o])===1/0&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.isFinite=function(t){le(t,"x");for(var r=this.readSync(t.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isFinite(r[o])&&(i[o]=1);return this.makeOutput(i,t.shape,"bool")},e.prototype.round=function(t){le(t,"round");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=Math.floor(r[o]);r[o]-a<.5?i[o]=Math.floor(r[o]):r[o]-a>.5?i[o]=Math.ceil(r[o]):i[o]=a%2==0?a:a+1}return this.makeOutput(i,t.shape,"float32")},e.prototype.exp=function(t){le(t,"exp");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.exp(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.expm1=function(t){le(t,"expm1");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.expm1(r[o]);return this.makeOutput(i,t.shape,"float32")},e.prototype.log=function(t){le(t,"log");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=Math.log(a)}return this.makeOutput(i,t.shape,"float32")},e.prototype.log1p=function(t){le(t,"log1p");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=Math.log1p(a)}return this.makeOutput(i,t.shape,"float32")},e.prototype.sqrt=function(t){le(t,"sqrt");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=Math.sqrt(a)}return this.makeOutput(i,t.shape,"float32")},e.prototype.rsqrt=function(t){le(t,"rsqrt");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=1/Math.sqrt(a)}return this.makeOutput(i,t.shape,"float32")},e.prototype.reciprocal=function(t){le(t,"reciprocal");for(var r=this.readSync(t.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=1/r[o];return this.makeOutput(i,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){le(t,"relu");for(var r=St(t.shape,t.dtype),i=this.readSync(r.dataId),o=this.readSync(t.dataId),a=0;a<o.length;++a)i[a]=Math.max(0,o[a]);return r},e.prototype.relu6=function(t){le(t,"relu");for(var r=St(t.shape,t.dtype),i=this.readSync(r.dataId),o=this.readSync(t.dataId),a=0;a<o.length;++a)i[a]=Math.min(Math.max(0,o[a]),6);return r},e.prototype.prelu=function(t,r){return le([t,r],"prelu"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,o){return i<0?o*i:i})},e.prototype.elu=function(t){le(t,"elu");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var a=i[o];r[o]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,t.shape,"float32")},e.prototype.eluDer=function(t,r){le([t,r],"eluDer");for(var i=new Float32Array(r.size),o=this.readSync(r.dataId),a=this.readSync(t.dataId),s=0;s<o.length;++s){var u=o[s];i[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(i,r.shape,"float32")},e.prototype.selu=function(t){le(t,"selu");for(var r=x_,i=__,o=new Float32Array(t.size),a=this.readSync(t.dataId),s=0;s<a.length;++s){var u=a[s];o[s]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(o,t.shape,"float32")},e.prototype.clip=function(t,r,i){le(t,"clip");for(var o=new Float32Array(t.size),a=this.readSync(t.dataId),s=0;s<a.length;++s){var u=a[s];o[s]=u>i?i:u<r?r:u}return this.makeOutput(o,t.shape,"float32")},e.prototype.abs=function(t){for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.abs(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<t.size;++o){var a=i[2*o],s=i[2*o+1];r[o]=Math.hypot(a,s)}return this.makeOutput(r,t.shape,"float32")},e.prototype.int=function(t){le(t,"int");for(var r=new Int32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=i[o];return this.makeOutput(r,t.shape,"int32")},e.prototype.sigmoid=function(t){le(t,"sigmoid");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=1/(1+Math.exp(-i[o]));return this.makeOutput(r,t.shape,"float32")},e.prototype.softplus=function(t){le(t,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(t.size),o=this.readSync(t.dataId),a=0;a<o.length;++a){var s=o[a]>-r,u=o[a]<r,l=Math.exp(o[a]),c=void 0;c=u?l:s?o[a]:Math.log(1+l),i[a]=c}return this.makeOutput(i,t.shape,"float32")},e.prototype.sin=function(t){le(t,"sin");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.sin(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.cos=function(t){le(t,"cos");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.cos(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.tan=function(t){le(t,"tan");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.tan(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.asin=function(t){le(t,"asin");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.asin(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.acos=function(t){le(t,"acos");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.acos(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atan=function(t){le(t,"atan");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.atan(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atan2=function(t,r){return le([t,r],"atan2"),this.broadcastedBinaryOp(t,r,t.dtype,function(i,o){return Math.atan2(i,o)})},e.prototype.sinh=function(t){le(t,"sinh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.sinh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.cosh=function(t){le(t,"cosh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.cosh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.tanh=function(t){le(t,"tanh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=WD(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.asinh=function(t){le(t,"asinh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.asinh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.acosh=function(t){le(t,"acosh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.acosh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.atanh=function(t){le(t,"atanh");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o)r[o]=Math.atanh(i[o]);return this.makeOutput(r,t.shape,"float32")},e.prototype.erf=function(t){le(t,"erf");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var a=Math.sign(i[o]),s=Math.abs(i[o]),u=1/(1+.3275911*s);r[o]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,t.shape,"float32")},e.prototype.step=function(t,r){r===void 0&&(r=0),le(t,"step");for(var i=new Float32Array(t.size),o=this.readSync(t.dataId),a=0;a<o.length;++a){var s=o[a];isNaN(s)?i[a]=NaN:i[a]=s>0?1:r}return this.makeOutput(i,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var r=t.input,i=t.filter,o=t.convInfo,a=t.bias,s=t.activation,u=t.preluActivationWeights,l=this.conv2d(r,i,o);return a&&(l=this.add(l,a)),s&&(l=g0(this,l,s,u)),l},e.prototype.conv2d=function(t,r,i){le([t,r],"conv2d");for(var o=i.filterHeight,a=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,h=i.dataFormat==="channelsLast",d=qe(i.outShape,t.dtype),f=t.strides[0],m=h?t.strides[1]:t.strides[2],v=h?t.strides[2]:1,y=h?1:t.strides[1],g=d.strides[0],w=h?d.strides[1]:d.strides[2],b=h?d.strides[2]:1,S=h?1:d.strides[1],E=this.readSync(t.dataId),T=this.readSync(r.dataId),_=d.values,x=0;x<i.batchSize;++x)for(var C=x*f,N=x*g,R=0;R<i.outHeight;++R)for(var k=N+R*w,D=R*i.strideHeight-c,W=0;W<o;W++){var U=D+W*s;if(!(U<0||U>=i.inHeight))for(var j=W*r.strides[0],H=C+U*m,z=0;z<i.outWidth;++z)for(var q=k+z*b,F=z*i.strideWidth-l,oe=0;oe<a;oe++){var Q=F+oe*u;if(!(Q<0||Q>=i.inWidth))for(var ae=H+Q*v,me=j+oe*r.strides[1],fe=0;fe<i.inChannels;++fe){for(var pe=E[ae+fe*y],Ce=0;Ce<i.outChannels;++Ce)_[q+Ce*S]+=pe*T[me+Ce];me+=i.outChannels}}}return d.toTensor()},e.prototype.conv3d=function(t,r,i){for(var o=i.filterDepth,a=i.filterHeight,s=i.filterWidth,u=i.dilationDepth,l=i.dilationHeight,c=i.dilationWidth,h=i.padInfo.front,d=i.padInfo.left,f=i.padInfo.top,m=qe(i.outShape,t.dtype),v=this.readSync(t.dataId),y=this.readSync(r.dataId),g=m.values,w=0;w<i.batchSize;++w)for(var b=w*t.strides[0],S=w*m.strides[0],E=0;E<i.outDepth;++E)for(var T=S+E*m.strides[1],_=E*i.strideDepth-h,x=0;x<o;x++){var C=_+x*u;if(!(C<0||C>=i.inDepth))for(var N=x*r.strides[0],R=b+C*t.strides[1],k=0;k<i.outHeight;++k)for(var D=T+k*m.strides[2],W=k*i.strideHeight-f,U=0;U<a;U++){var j=W+U*l;if(!(j<0||j>=i.inHeight))for(var H=N+U*r.strides[1],z=R+j*t.strides[2],q=0;q<i.outWidth;++q)for(var F=D+q*i.outChannels,oe=q*i.strideWidth-d,Q=0;Q<s;Q++){var ae=oe+Q*c;if(!(ae<0||ae>=i.inWidth))for(var me=H+Q*r.strides[2],fe=z+ae*i.inChannels,pe=me,Ce=0;Ce<i.inChannels;++Ce){for(var Me=v[fe+Ce],Te=0;Te<i.outChannels;++Te)g[F+Te]+=Me*y[pe+Te];pe+=i.outChannels}}}}return m.toTensor()},e.prototype.conv2dDerInput=function(t,r,i){le([t,r],"conv2dDerInput");for(var o=qe(i.inShape,"float32"),a=o.values,s=this.readSync(t.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],h=l[1],d=l[2],f=i.batchSize,m=i.filterHeight,v=i.filterWidth,y=i.inChannels,g=i.inHeight,w=i.inWidth,b=i.outChannels,S=i.outHeight,E=i.outWidth,T=i.strideHeight,_=i.strideWidth,x=i.dataFormat,C=m-1-i.padInfo.top,N=v-1-i.padInfo.left,R=x==="channelsLast",k=o.strides[0],D=R?o.strides[1]:o.strides[2],W=R?o.strides[2]:1,U=R?1:o.strides[1],j=t.strides[0],H=R?t.strides[1]:t.strides[2],z=R?t.strides[2]:1,q=R?1:t.strides[1],F=0;F<f;++F)for(var oe=0;oe<y;++oe)for(var Q=0;Q<g;++Q)for(var ae=Q-C,me=Math.max(0,Math.ceil(ae/T)),fe=Math.min(S,(m+ae)/T),pe=0;pe<w;++pe){for(var Ce=pe-N,Me=Math.max(0,Math.ceil(Ce/_)),Te=Math.min(E,(v+Ce)/_),Ke=0,Fe=me;Fe<fe;++Fe)for(var Xe=Fe*T-ae,ze=Me;ze<Te;++ze)for(var Be=j*F+H*Fe+z*ze,dt=c*(m-1-Xe)+h*(v-1-(ze*_-Ce))+d*oe,nt=0;nt<b;++nt)Ke+=s[Be+q*nt]*u[dt+nt];a[k*F+D*Q+W*pe+U*oe]=Ke}return o.toTensor()},e.prototype.conv3dDerInput=function(t,r,i){for(var o=qe(i.inShape,"float32"),a=o.values,s=o.strides,u=s[0],l=s[1],c=s[2],h=s[3],d=this.readSync(t.dataId),f=t.strides,m=f[0],v=f[1],y=f[2],g=f[3],w=this.readSync(r.dataId),b=r.strides,S=b[0],E=b[1],T=b[2],_=b[3],x=i.batchSize,C=i.filterDepth,N=i.filterHeight,R=i.filterWidth,k=i.inChannels,D=i.inDepth,W=i.inHeight,U=i.inWidth,j=i.outChannels,H=i.outDepth,z=i.outHeight,q=i.outWidth,F=i.strideDepth,oe=i.strideHeight,Q=i.strideWidth,ae=C-1-i.padInfo.front,me=N-1-i.padInfo.top,fe=R-1-i.padInfo.left,pe=0;pe<x;++pe)for(var Ce=0;Ce<k;++Ce)for(var Me=0;Me<D;++Me)for(var Te=Me-ae,Ke=Math.max(0,Math.ceil(Te/F)),Fe=Math.min(H,(C+Te)/F),Xe=0;Xe<W;++Xe)for(var ze=Xe-me,Be=Math.max(0,Math.ceil(ze/oe)),dt=Math.min(z,(N+ze)/oe),nt=0;nt<U;++nt){for(var rn=nt-fe,Sn=Math.max(0,Math.ceil(rn/Q)),Kt=Math.min(q,(R+rn)/Q),pn=0,xt=Ke;xt<Fe;++xt)for(var Ut=xt*F-Te,je=Be;je<dt;++je)for(var Qt=je*oe-ze,mt=Sn;mt<Kt;++mt)for(var Ue=m*pe+v*xt+y*je+g*mt,yt=S*(C-1-Ut)+E*(N-1-Qt)+T*(R-1-(mt*Q-rn))+_*Ce,Jt=0;Jt<j;++Jt)pn+=d[Ue+Jt]*w[yt+Jt];a[u*pe+l*Me+c*Xe+h*nt+Ce]=pn}return o.toTensor()},e.prototype.conv2dDerFilter=function(t,r,i){le([t,r],"conv2dDerFilter");for(var o=i.strideHeight,a=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dataFormat==="channelsLast",c=qe(i.filterShape,"float32"),h=i.padInfo.left,d=i.padInfo.top,f=this.bufferSync(t),m=this.bufferSync(r),v=0;v<s;++v)for(var y=Math.max(0,Math.ceil((d-v)/o)),g=Math.min(i.outHeight,(i.inHeight+d-v)/o),w=0;w<u;++w)for(var b=Math.max(0,Math.ceil((h-w)/a)),S=Math.min(i.outWidth,(i.inWidth+h-w)/a),E=0;E<i.inChannels;++E)for(var T=0;T<i.outChannels;++T){for(var _=0,x=0;x<i.batchSize;++x)for(var C=y;C<g;++C)for(var N=v+C*o-d,R=b;R<S;++R){var k=w+R*a-h;_+=l?f.get(x,N,k,E)*m.get(x,C,R,T):f.get(x,E,N,k)*m.get(x,T,C,R)}c.set(_,v,w,E,T)}return c.toTensor()},e.prototype.conv3dDerFilter=function(t,r,i){for(var o=i.strideDepth,a=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,h=qe(i.filterShape,"float32"),d=h.values,f=h.strides,m=f[0],v=f[1],y=f[2],g=f[3],w=this.readSync(r.dataId),b=r.strides,S=b[0],E=b[1],T=b[2],_=b[3],x=this.readSync(t.dataId),C=t.strides,N=C[0],R=C[1],k=C[2],D=C[3],W=i.padInfo.front,U=i.padInfo.left,j=i.padInfo.top,H=0;H<u;++H)for(var z=Math.max(0,Math.ceil((W-H)/o)),q=Math.min(i.outDepth,(i.inDepth+W-H)/o),F=H*m,oe=0;oe<l;++oe)for(var Q=Math.max(0,Math.ceil((j-oe)/a)),ae=Math.min(i.outHeight,(i.inHeight+j-oe)/a),me=oe*v+F,fe=0;fe<c;++fe)for(var pe=Math.max(0,Math.ceil((U-fe)/s)),Ce=Math.min(i.outWidth,(i.inWidth+U-fe)/s),Me=fe*y+me,Te=0;Te<i.inChannels;++Te)for(var Ke=Te*g+Me,Fe=0;Fe<i.outChannels;++Fe){for(var Xe=0,ze=0;ze<i.batchSize;++ze)for(var Be=ze*N,dt=ze*S,nt=z;nt<q;++nt)for(var rn=(H+nt*o-W)*R+Be,Sn=nt*E+dt,Kt=Q;Kt<ae;++Kt)for(var pn=(oe+Kt*a-j)*k+rn,xt=Kt*T+Sn,Ut=pe;Ut<Ce;++Ut){var je=Ut*_+xt;Xe+=x[(fe+Ut*s-U)*D+pn+Te]*w[je+Fe]}d[Ke+Fe]=Xe}return h.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var r=t.input,i=t.filter,o=t.convInfo,a=t.bias,s=t.activation,u=t.preluActivationWeights,l=this.depthwiseConv2D(r,i,o);return a&&(l=this.add(l,a)),s&&(l=g0(this,l,s,u)),l},e.prototype.depthwiseConv2D=function(t,r,i){le([t,r],"depthwiseConv2D");for(var o=i.filterHeight,a=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,h=i.outChannels/i.inChannels,d=qe(i.outShape,t.dtype),f=this.readSync(t.dataId),m=this.readSync(r.dataId),v=d.values,y=0;y<i.batchSize;++y)for(var g=y*t.strides[0],w=y*d.strides[0],b=0;b<i.outHeight;++b)for(var S=w+b*d.strides[1],E=b*i.strideHeight-l,T=0;T<o;++T){var _=E+T*s;if(!(_<0||_>=i.inHeight))for(var x=T*r.strides[0],C=g+_*t.strides[1],N=0;N<i.outWidth;++N)for(var R=S+N*d.strides[2],k=N*i.strideWidth-c,D=0;D<a;++D){var W=k+D*u;if(!(W<0||W>=i.inWidth))for(var U=x+D*r.strides[1],j=C+W*i.inChannels,H=R,z=U,q=0;q<i.inChannels;++q){for(var F=f[j+q],oe=0;oe<h;++oe)v[H+oe]+=F*m[z+oe];H+=h,z+=h}}}return d.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,r,i){le([t,r],"depthwiseConv2DDerInput");for(var o=qe(i.inShape,"float32"),a=o.values,s=o.strides,u=s[0],l=s[1],c=s[2],h=this.readSync(t.dataId),d=t.strides,f=d[0],m=d[1],v=d[2],y=this.readSync(r.dataId),g=r.strides,w=g[0],b=g[1],S=g[2],E=i.batchSize,T=i.filterHeight,_=i.filterWidth,x=i.inChannels,C=i.inHeight,N=i.inWidth,R=i.outChannels,k=i.outHeight,D=i.outWidth,W=i.strideHeight,U=i.strideWidth,j=T-1-i.padInfo.top,H=_-1-i.padInfo.left,z=R/x,q=0;q<E;++q)for(var F=0;F<x;++F)for(var oe=0;oe<C;++oe)for(var Q=oe-j,ae=Math.max(0,Math.ceil(Q/W)),me=Math.min(k,(T+Q)/W),fe=0;fe<N;++fe){for(var pe=fe-H,Ce=Math.max(0,Math.ceil(pe/U)),Me=Math.min(D,(_+pe)/U),Te=0,Ke=ae;Ke<me;++Ke)for(var Fe=Ke*W-Q,Xe=Ce;Xe<Me;++Xe)for(var ze=f*q+m*Ke+v*Xe,Be=w*(T-1-Fe)+b*(_-1-(Xe*U-pe))+S*F,dt=0;dt<z;++dt)Te+=h[ze+(F*z+dt)]*y[Be+dt];a[u*q+l*oe+c*fe+F]=Te}return o.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,r,i){le([t,r],"depthwiseConv2DDerFilter");for(var o=i.strideHeight,a=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=qe(i.filterShape,"float32"),c=i.padInfo.left,h=i.padInfo.top,d=i.outChannels/i.inChannels,f=this.bufferSync(t),m=this.bufferSync(r),v=0;v<s;++v)for(var y=Math.max(0,Math.ceil((h-v)/o)),g=Math.min(i.outHeight,(i.inHeight+h-v)/o),w=0;w<u;++w)for(var b=Math.max(0,Math.ceil((c-w)/a)),S=Math.min(i.outWidth,(i.inWidth+c-w)/a),E=0;E<i.outChannels;++E){for(var T=Math.trunc(E/d),_=E%d,x=0,C=0;C<i.batchSize;++C)for(var N=y;N<g;++N)for(var R=v+N*o-h,k=b;k<S;++k){var D=w+k*a-c;x+=f.get(C,R,D,T)*m.get(C,N,k,E)}l.set(x,v,w,T,_)}return l.toTensor()},e.prototype.tile=function(t,r){return le(t,"tile"),YO(this.bufferSync(t),r)},e.prototype.pad=function(t,r,i){le(t,"pad");var o=r.map(function(d,f){return d[0]+t.shape[f]+d[1]}),a=r.map(function(d){return d[0]}),s=this.bufferSync(t),u=qe(o,t.dtype);i!==0&&u.values.fill(i);for(var l=0;l<t.size;l++){var c=s.indexToLoc(l),h=c.map(function(d,f){return d+a[f]});u.set.apply(u,[s.get.apply(s,c)].concat(h))}return u.toTensor()},e.prototype.transpose=function(t,r){le(t,"transpose");for(var i=new Array(t.rank),o=0;o<i.length;o++)i[o]=t.shape[r[o]];var a=this.readSync(t.dataId),s=qe(i,t.dtype),u=this.bufferSync(t);for(o=0;o<t.size;++o){for(var l=u.indexToLoc(o),c=new Array(l.length),h=0;h<c.length;h++)c[h]=l[r[h]];var d=s.locToIndex(c);s.values[d]=a[o]}return s.toTensor()},e.prototype.gather=function(t,r,i){le([t,r],"gather");var o=t.shape.slice(),a=this.readSync(r.dataId);o[i]=a.length;for(var s=qe(o,t.dtype),u=this.bufferSync(t),l=0;l<s.size;++l){var c=s.indexToLoc(l),h=c.slice();h[i]=a[c[i]];var d=u.locToIndex(h);s.values[l]=u.values[d]}return s.toTensor()},e.prototype.batchToSpaceND=function(t,r,i){le([t],"batchToSpaceND");var o=r.reduce(function(h,d){return h*d}),a=ig(t.shape,r,o),s=og(a.length,r.length),u=ag(t.shape,r,o),l=UO(i,r.length),c=WO(u,i,r.length);return t.reshape(a).transpose(s).reshape(u).slice(l,c)},e.prototype.spaceToBatchND=function(t,r,i){le([t],"spaceToBatchND");var o=r.reduce(function(d,f){return d*f}),a=[[0,0]];a.push.apply(a,i);for(var s=1+r.length;s<t.shape.length;++s)a.push([0,0]);var u=t.pad(a),l=ig(u.shape,r,o,!1),c=og(l.length,r.length,!1),h=ag(u.shape,r,o,!1);return u.reshape(l).transpose(c).reshape(h)},e.prototype.pool=function(t,r,i){le(t,"pool");for(var o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,h=r.padInfo.top,d=r.padInfo.left,f=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(t.dataId),v=qe(r.outShape,t.dtype),y=v.values,g=r.outShape[1]*r.outShape[2]*r.outShape[3],w=r.outShape[2]*r.outShape[3],b=r.outShape[3],S=0;S<r.batchSize;++S)for(var E=S*g,T=S*t.strides[0],_=0;_<r.inChannels;++_)for(var x=0;x<r.outHeight;++x)for(var C=x*o-h,N=Math.max(0,C),R=Math.min(r.inHeight,l+C),k=E+x*w,D=0;D<r.outWidth;++D){for(var W=D*a-d,U=Math.max(0,W),j=Math.min(r.inWidth,c+W),H=f,z=0,q=0,F=N;F<R;F+=s){for(var oe=T+F*t.strides[1],Q=U;Q<j;Q+=u){var ae=m[oe+Q*t.strides[2]+_];i==="max"&&ae>H?H=ae:i==="avg"&&(z+=ae,q++)}if(isNaN(H))break}y[k+D*b+_]=i==="avg"?z/q:H}return v.toTensor()},e.prototype.maxPool=function(t,r){return this.pool(t,r,"max")},e.prototype.maxPoolPositions=function(t,r){for(var i=qe(r.outShape,"int32"),o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,h=r.padInfo.top,d=r.padInfo.left,f=this.bufferSync(t),m=0;m<r.batchSize;++m)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.outHeight;++y){for(var g=y*o-h,w=g;w<0;)w+=s;for(var b=Math.min(r.inHeight,l+g),S=0;S<r.outWidth;++S){for(var E=S*a-d,T=E;T<0;)T+=u;for(var _=Math.min(r.inWidth,c+E),x=Number.NEGATIVE_INFINITY,C=-1,N=w;N<b;N+=s)for(var R=N-g,k=T;k<_;k+=u){var D=k-E,W=f.get(m,N,k,v);W>x&&(x=W,C=R*c+D)}i.set(C,m,y,S,v)}}return i.toTensor()},e.prototype.maxPoolBackprop=function(t,r,i,o){le([r,i],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,o),s=o.strideHeight,u=o.strideWidth,l=o.dilationHeight,c=o.dilationWidth,h=o.effectiveFilterHeight,d=o.effectiveFilterWidth,f=d-1-o.padInfo.left,m=h-1-o.padInfo.top,v=qe(r.shape,"float32"),y=this.bufferSync(a),g=this.bufferSync(t),w=0;w<o.batchSize;++w)for(var b=0;b<o.inChannels;++b)for(var S=0;S<o.inHeight;++S)for(var E=0;E<o.inWidth;++E){for(var T=S-m,_=E-f,x=0,C=0;C<h;C+=l){var N=(T+C)/s;if(!(N<0||N>=o.outHeight||Math.floor(N)!==N))for(var R=0;R<d;R+=c){var k=(_+R)/u;if(!(k<0||k>=o.outWidth||Math.floor(k)!==k)){var D=h*d-1-y.get(w,N,k,b)===C*d+R?1:0;D!==0&&(x+=g.get(w,N,k,b)*D)}}}v.set(x,w,S,E,b)}return v.toTensor()},e.prototype.avgPoolBackprop=function(t,r,i){le([t,r],"avgPoolBackprop");for(var o=i.strideHeight,a=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dilationHeight,c=i.dilationWidth,h=i.effectiveFilterHeight,d=i.effectiveFilterWidth,f=d-1-i.padInfo.left,m=h-1-i.padInfo.top,v=qe(r.shape,"float32"),y=1/(s*u),g=this.bufferSync(t),w=0;w<i.batchSize;++w)for(var b=0;b<i.inChannels;++b)for(var S=0;S<i.inHeight;++S)for(var E=0;E<i.inWidth;++E){for(var T=S-m,_=E-f,x=0,C=0;C<h;C+=l){var N=(T+C)/o;if(!(N<0||N>=i.outHeight||Math.floor(N)!==N))for(var R=0;R<d;R+=c){var k=(_+R)/a;k<0||k>=i.outWidth||Math.floor(k)!==k||(x+=g.get(w,N,k,b))}}v.set(x*y,w,S,E,b)}return v.toTensor()},e.prototype.pool3d=function(t,r,i){le(t,"pool3d");for(var o=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterDepth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,m=r.padInfo.front,v=r.padInfo.top,y=r.padInfo.left,g=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=this.readSync(t.dataId),b=qe(r.outShape,t.dtype),S=b.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],T=r.outShape[2]*r.outShape[3]*r.outShape[4],_=r.outShape[3]*r.outShape[4],x=r.outShape[4],C=0;C<r.batchSize;++C)for(var N=C*E,R=C*t.strides[0],k=0;k<r.inChannels;++k)for(var D=0;D<r.outDepth;++D){for(var W=D*o-m,U=W;U<0;)U+=u;for(var j=Math.min(r.inDepth,h+W),H=N+D*T,z=0;z<r.outHeight;++z){for(var q=z*a-v,F=q;F<0;)F+=l;for(var oe=Math.min(r.inHeight,d+q),Q=H+z*_,ae=0;ae<r.outWidth;++ae){for(var me=ae*s-y,fe=me;fe<0;)fe+=c;for(var pe=Math.min(r.inWidth,f+me),Ce=Q+ae*x,Me=g,Te=0,Ke=0,Fe=U;Fe<j;Fe+=u){for(var Xe=R+Fe*t.strides[1],ze=F;ze<oe;ze+=l){for(var Be=Xe+ze*t.strides[2],dt=fe;dt<pe;dt+=c){var nt=w[Be+dt*t.strides[3]+k];if(i==="max"&&nt>Me?Me=nt:i==="avg"&&(Te+=nt,Ke++),isNaN(Me))break}if(isNaN(Me))break}if(isNaN(Me))break}S[Ce+k]=i==="avg"?Te/Ke:Me}}}return b.toTensor()},e.prototype.avgPool3d=function(t,r){return le(t,"avgPool3d"),this.pool3d(t,r,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,r,i){le([t,r],"avgPool3dBackprop");for(var o=i.strideDepth,a=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,h=i.dilationDepth,d=i.dilationHeight,f=i.dilationWidth,m=i.effectiveFilterDepth,v=i.effectiveFilterHeight,y=i.effectiveFilterWidth,g=m-1-i.padInfo.front,w=y-1-i.padInfo.left,b=v-1-i.padInfo.top,S=qe(r.shape,"float32"),E=1/(u*l*c),T=this.bufferSync(t),_=0;_<i.batchSize;++_)for(var x=0;x<i.inChannels;++x)for(var C=0;C<i.inDepth;++C)for(var N=0;N<i.inHeight;++N)for(var R=0;R<i.inWidth;++R){for(var k=C-g,D=N-b,W=R-w,U=0,j=0;j<m;j+=h){var H=(k+j)/o;if(!(H<0||H>=i.outDepth||Math.floor(H)!==H))for(var z=0;z<v;z+=d){var q=(D+z)/a;if(!(q<0||q>=i.outHeight||Math.floor(q)!==q))for(var F=0;F<y;F+=f){var oe=(W+F)/s;oe<0||oe>=i.outWidth||Math.floor(oe)!==oe||(U+=T.get(_,H,q,oe,x))}}}S.set(U*E,_,C,N,R,x)}return S.toTensor()},e.prototype.maxPool3d=function(t,r){return le(t,"maxPool3d"),this.pool3d(t,r,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,r){for(var i=qe(r.outShape,"int32"),o=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterDepth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,m=r.padInfo.front,v=r.padInfo.top,y=r.padInfo.left,g=this.bufferSync(t),w=0;w<r.batchSize;++w)for(var b=0;b<r.inChannels;++b)for(var S=0;S<r.outDepth;++S){for(var E=S*o-m,T=E;T<0;)T+=u;for(var _=Math.min(r.inDepth,h+E),x=0;x<r.outHeight;++x){for(var C=x*a-v,N=C;N<0;)N+=l;for(var R=Math.min(r.inHeight,d+C),k=0;k<r.outWidth;++k){for(var D=k*s-y,W=D;W<0;)W+=c;for(var U=Math.min(r.inWidth,f+D),j=Number.NEGATIVE_INFINITY,H=-1,z=T;z<_;z+=u)for(var q=z-E,F=N;F<R;F+=l)for(var oe=F-C,Q=W;Q<U;Q+=c){var ae=Q-D,me=g.get(w,z,F,Q,b);me>=j&&(j=me,H=q*d*f+oe*d+ae)}i.set(H,w,S,x,k,b)}}}return i.toTensor()},e.prototype.maxPool3dBackprop=function(t,r,i,o){le([r,i],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,o),s=o.strideDepth,u=o.strideHeight,l=o.strideWidth,c=o.dilationDepth,h=o.dilationHeight,d=o.dilationWidth,f=o.effectiveFilterDepth,m=o.effectiveFilterHeight,v=o.effectiveFilterWidth,y=f-1-o.padInfo.front,g=v-1-o.padInfo.left,w=m-1-o.padInfo.top,b=qe(r.shape,"float32"),S=this.bufferSync(a),E=this.bufferSync(t),T=0;T<o.batchSize;++T)for(var _=0;_<o.inChannels;++_)for(var x=0;x<o.inDepth;++x)for(var C=0;C<o.inHeight;++C)for(var N=0;N<o.inWidth;++N){for(var R=x-y,k=C-w,D=N-g,W=0,U=0;U<f;U+=c){var j=(R+U)/s;if(!(j<0||j>=o.outDepth||Math.floor(j)!==j))for(var H=0;H<m;H+=h){var z=(k+H)/u;if(!(z<0||z>=o.outHeight||Math.floor(z)!==z))for(var q=0;q<v;q+=d){var F=(D+q)/l;if(!(F<0||F>=o.outWidth||Math.floor(F)!==F)){var oe=f*m*v-1-S.get(T,j,z,F,_)===U*m*v+H*v+q?1:0;oe!==0&&(W+=E.get(T,j,z,F,_)*oe)}}}}b.set(W,T,x,C,N,_)}return b.toTensor()},e.prototype.cast=function(t,r){return g_(t,r,this)},e.prototype.reshape=function(t,r){return lg(t,r)},e.prototype.avgPool=function(t,r){return le(t,"avgPool"),this.pool(t,r,"avg").toFloat()},e.prototype.resizeBilinear=function(t,r,i,o){le(t,"resizeBilinear");for(var a=t.shape,s=a[0],u=a[1],l=a[2],c=a[3],h=this.readSync(t.dataId),d=new Float32Array(Ae([s,r,i,c])),f=[o&&r>1?u-1:u,o&&i>1?l-1:l],m=[o&&r>1?r-1:r,o&&i>1?i-1:i],v=0,y=f[0]/m[0],g=f[1]/m[1],w=0;w<s;w++)for(var b=0;b<r;b++)for(var S=y*b,E=Math.floor(S),T=S-E,_=Math.min(u-1,Math.ceil(S)),x=w*t.strides[0]+E*t.strides[1],C=w*t.strides[0]+_*t.strides[1],N=0;N<i;N++)for(var R=g*N,k=Math.floor(R),D=R-k,W=Math.min(l-1,Math.ceil(R)),U=x+k*t.strides[2],j=C+k*t.strides[2],H=x+ +W*t.strides[2],z=C+W*t.strides[2],q=0;q<c;q++){var F=h[U+q],oe=h[j+q],Q=F+(h[H+q]-F)*D,ae=Q+(oe+(h[z+q]-oe)*D-Q)*T;d[v++]=ae}return gn(d,[s,r,i,c])},e.prototype.resizeBilinearBackprop=function(t,r,i){le([t,r],"resizeBilinearBackprop");for(var o=r.shape,a=o[0],s=o[1],u=o[2],l=o[3],c=t.shape,h=c[1],d=c[2],f=new Float32Array(a*s*u*l),m=[i&&h>1?s-1:s,i&&d>1?u-1:u],v=[i&&h>1?h-1:h,i&&d>1?d-1:d],y=m[0]/v[0],g=m[1]/v[1],w=this.readSync(t.dataId),b=0,S=0;S<a;S++)for(var E=S*r.strides[0],T=0;T<h;T++)for(var _=T*y,x=Math.floor(_),C=Math.min(Math.ceil(_),s-1),N=E+x*r.strides[1],R=E+C*r.strides[1],k=_-x,D=1-k,W=0;W<d;W++)for(var U=W*g,j=Math.floor(U),H=Math.min(Math.ceil(U),u-1),z=U-j,q=1-z,F=N+j*r.strides[2],oe=N+H*r.strides[2],Q=R+j*r.strides[2],ae=R+H*r.strides[2],me=D*q,fe=D*z,pe=k*q,Ce=k*z,Me=0;Me<l;Me++){var Te=w[b++];f[F+Me]+=Te*me,f[oe+Me]+=Te*fe,f[Q+Me]+=Te*pe,f[ae+Me]+=Te*Ce}return Aa(f,[a,u,s,l],r.dtype)},e.prototype.resizeNearestNeighbor=function(t,r,i,o){le(t,"resizeNearestNeighbor");for(var a=t.shape,s=a[0],u=a[1],l=a[2],c=a[3],h=this.readSync(t.dataId),d=new Float32Array(s*r*i*c),f=[o&&r>1?u-1:u,o&&i>1?l-1:l],m=[o&&r>1?r-1:r,o&&i>1?i-1:i],v=f[0]/m[0],y=f[1]/m[1],g=0,w=0;w<s;w++)for(var b=w*t.strides[0],S=0;S<r;S++)for(var E=v*S,T=b+Math.min(u-1,o?Math.round(E):Math.floor(E))*t.strides[1],_=0;_<i;_++)for(var x=y*_,C=T+Math.min(l-1,o?Math.round(x):Math.floor(x))*t.strides[2],N=0;N<c;N++){var R=h[C+N];d[g++]=R}return gn(d,[s,r,i,c],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,r,i){le([t,r],"resizeNearestNeighborBackprop");for(var o=r.shape,a=o[0],s=o[1],u=o[2],l=o[3],c=t.shape,h=c[1],d=c[2],f=new Float32Array(a*s*u*l),m=this.readSync(t.dataId),v=[i&&h>1?s-1:s,i&&d>1?u-1:u],y=[i&&h>1?h-1:h,i&&d>1?d-1:d],g=v[0]/y[0],w=v[1]/y[1],b=1/g,S=1/w,E=2*Math.ceil(b)+2,T=2*Math.ceil(S)+2,_=0;_<a;_++)for(var x=_*r.strides[0],C=0;C<s;C++)for(var N=x+C*r.strides[1],R=Math.floor(C*b),k=Math.floor(R-E/2),D=0;D<u;D++)for(var W=N+D*r.strides[2],U=Math.floor(D*S),j=Math.floor(U-T/2),H=0;H<l;H++){for(var z=0,q=0;q<E;q++){var F=q+k;if(!(F<0||F>=h)){var oe=x+F*t.strides[1],Q=F*g;if(C===Math.min(s-1,i?Math.round(Q):Math.floor(Q)))for(var ae=0;ae<T;ae++){var me=ae+j;if(!(me<0||me>=d)){var fe=oe+me*t.strides[2],pe=me*w;D===Math.min(u-1,i?Math.round(pe):Math.floor(pe))&&(z+=m[fe+H])}}}}f[W+H]=z}return Aa(f,r.shape,r.dtype)},e.prototype.batchNormalization=function(t,r,i,o,a,s){le([t,r,i,a,s],"batchNorm");for(var u=this.readSync(t.dataId),l=this.readSync(r.dataId),c=this.readSync(i.dataId),h=a?this.readSync(a.dataId):new Float32Array([1]),d=s?this.readSync(s.dataId):new Float32Array([0]),f=new Float32Array(u.length),m=d.length,v=h.length,y=c.length,g=l.length,w=0,b=0,S=0,E=0,T=0;T<u.length;++T)f[T]=d[w++]+(u[T]-l[b++])*h[S++]/Math.sqrt(c[E++]+o),w>=m&&(w=0),b>=g&&(b=0),S>=v&&(S=0),E>=y&&(E=0);return Aa(f,t.shape)},e.prototype.localResponseNormalization4D=function(t,r,i,o,a){le(t,"localResponseNormalization4D");var s=t.shape[3],u=s-1,l=this.readSync(t.dataId),c=t.size,h=new Float32Array(c);function d(y){for(var g=y%s,w=y-g+Math.max(0,g-r),b=y-g+Math.min(g+r,u),S=0;w<=b;w++){var E=l[w];S+=E*E}return S}for(var f=0;f<c;f++){var m=d(f),v=l[f]*Math.pow(i+o*m,-a);h[f]=v}return Aa(h,t.shape)},e.prototype.LRNGrad=function(t,r,i,o,a,s,u){le(t,"LRNGrad");for(var l=t.shape[3],c=this.readSync(t.dataId),h=this.readSync(r.dataId),d=this.readSync(i.dataId),f=new Float32Array(t.size),m=t.size,v=0;v<m;v++){for(var y=v%l,g=v-y+Math.max(0,y-o),w=v-y+Math.min(l,y+o+1),b=0,S=g;S<w;S++)b+=Math.pow(h[S],2);for(b=s*b+a,S=g;S<w;S++){var E=-2*s*u*h[S]*d[v]/b;v===S&&(E+=Math.pow(b,-u)),E*=c[v],f[S]+=E}}return Aa(f,t.shape)},e.prototype.multinomial=function(t,r,i,o){le(t,"multinomial");for(var a=r?t:Wu(t),s=a.shape[0],u=a.shape[1],l=St([s,i],"int32"),c=this.readSync(l.dataId),h=this.readSync(a.dataId),d=0;d<s;++d){var f=d*u,m=new Float32Array(u-1);m[0]=h[f];for(var v=1;v<m.length;++v)m[v]=m[v-1]+h[f+v];for(var y=hv(o.toString()),g=d*i,w=0;w<i;++w){var b=y();c[g+w]=m.length;for(var S=0;S<m.length;S++)if(b<m[S]){c[g+w]=S;break}}}return l},e.prototype.oneHot=function(t,r,i,o){le(t,"oneHot");var a=new Float32Array(t.size*r);a.fill(o);for(var s=this.readSync(t.dataId),u=0;u<t.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=i);return Go(a,[t.size,r],"int32")},e.prototype.nonMaxSuppression=function(t,r,i,o,a){return le(t,"nonMaxSuppression"),y_(this.readSync(t.dataId),this.readSync(r.dataId),i,o,a)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,r){for(var i=t.shape[0],o=t.shape[1],a=qe(t.shape,"float32"),s=qe(t.shape,"float32"),u=Ir(t).as2D(i,o),l=li(t).as2D(i,o),c=0;c<i;c++)for(var h=u.slice([c,0],[1,o]),d=l.slice([c,0],[1,o]),f=Tn(h,d),m=this.readSync(this.fftImpl(f,r).dataId),v=0;v<o;v++){var y=zI(m,v);a.values[c*o+v]=y.real,s.values[c*o+v]=y.imag}return Tn(a.toTensor(),s.toTensor()).as2D(i,o)},e.prototype.fftImpl=function(t,r){var i=t.as1D(),o=i.size;if(this.isExponentOf2(o)){var a=this.fftRadix2(i,o,r).as2D(t.shape[0],t.shape[1]);return r&&(a=Tn(Ir(a).div(Ee(o)),li(a).div(Ee(o)))),a}var s=this.readSync(t.dataId),u=function(l){for(var c=new Float32Array(l.length/2),h=new Float32Array(l.length/2),d=0;d<l.length;d+=2)c[d/2]=l[d],h[d/2]=l[d+1];return{real:c,imag:h}}(this.fourierTransformByMatmul(s,o,r));return Tn(u.real,u.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return(t&t-1)==0},e.prototype.fftRadix2=function(t,r,i){if(r===1)return t;var o=this.readSync(t.dataId),a=r/2,s=function(g){for(var w=Math.ceil(g.length/4),b=new Float32Array(w),S=new Float32Array(w),E=0;E<g.length;E+=4)b[Math.floor(E/4)]=g[E],S[Math.floor(E/4)]=g[E+1];return{real:b,imag:S}}(o),u=Tn(s.real,s.imag).as1D(),l=function(g){for(var w=Math.floor(g.length/4),b=new Float32Array(w),S=new Float32Array(w),E=2;E<g.length;E+=4)b[Math.floor(E/4)]=g[E],S[Math.floor(E/4)]=g[E+1];return{real:b,imag:S}}(o),c=Tn(l.real,l.imag).as1D();u=this.fftRadix2(u,a,i),c=this.fftRadix2(c,a,i);var h=function(g,w){for(var b=new Float32Array(g/2),S=new Float32Array(g/2),E=0;E<Math.ceil(g/2);E++){var T=(w?2:-2)*Math.PI*(E/g);b[E]=Math.cos(T),S[E]=Math.sin(T)}return{real:b,imag:S}}(r,i),d=Tn(h.real,h.imag).mul(c),f=u.add(d),m=u.sub(d),v=Ir(f).concat(Ir(m)),y=li(f).concat(li(m));return Tn(v,y).as1D()},e.prototype.fourierTransformByMatmul=function(t,r,i){for(var o=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,l=0;l<r;l++){var c=OG(a*l,r,i),h=zI(t,l);s+=h.real*c.real-h.imag*c.imag,u+=h.real*c.imag+h.imag*c.real}i&&(s/=r,u/=r),DG(o,s,u,a)}return o},e.prototype.depthToSpace=function(t,r,i){B(i==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i}),B(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var o=t.shape[0],a=t.shape[1],s=t.shape[2],u=t.shape[3],l=a*r,c=s*r,h=u/(r*r),d=this.readSync(t.dataId),f=new Float32Array(o*l*c*h),m=0,v=0;v<o;++v)for(var y=0;y<l;++y)for(var g=Math.floor(y/r),w=y%r,b=0;b<c;++b)for(var S=Math.floor(b/r),E=(w*r+b%r)*h,T=0;T<h;++T){var _=T+E+u*(S+s*(g+a*v));f[m++]=d[_]}return Aa(f,[o,l,c,h])},e.prototype.broadcastedBinaryOp=function(t,r,i,o){var a=st(t.shape,r.shape),s=qe(a,i),u=this.readSync(t.dataId),l=this.readSync(r.dataId),c=nu(t.shape,a),h=nu(r.shape,a),d=s.values;if(c.length+h.length===0)for(var f=0;f<d.length;++f)d[f]=o(u[f%u.length],l[f%l.length]);else{var m=this.bufferSync(t),v=this.bufferSync(r),y=function(g){var w=s.indexToLoc(g),b=w.slice(-t.rank);c.forEach(function(_){return b[_]=0});var S=m.locToIndex(b),E=w.slice(-r.rank);h.forEach(function(_){return E[_]=0});var T=v.locToIndex(E);d[g]=o(u[S],l[T])};for(f=0;f<d.length;++f)y(f)}return s.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,r,i){var o=st(t.shape,r.shape),a=qe(o,"float32"),s=qe(o,"float32"),u=this.readSync(t.dataId),l=this.readSync(r.dataId),c=nu(t.shape,o),h=nu(r.shape,o),d=a.values,f=s.values;if(c.length+h.length===0)for(var m=0;m<d.length;m++){var v=m%u.length,y=m%l.length,g=i(u[2*v],u[2*v+1],l[2*y],l[2*y+1]);d[m]=g.real,f[m]=g.imag}else{var w=this.bufferSync(this.data.get(t.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),S=function(E){var T=a.indexToLoc(E),_=T.slice(-t.rank);c.forEach(function(k){return _[k]=0});var x=w.locToIndex(_),C=T.slice(-r.rank);h.forEach(function(k){return C[k]=0});var N=b.locToIndex(C),R=i(u[2*x],u[2*x+1],l[2*N],l[2*N+1]);d[E]=R.real,f[E]=R.imag};for(m=0;m<d.length;m++)S(m)}return this.complex(a.toTensor(),s.toTensor())},e.prototype.split=function(t,r,i){return XO(t,r,i)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,r,i,o,a,s){for(var u=t.shape,l=u[0],c=u[1],h=u[2],d=u[3],f=r.shape[0],m=o[0],v=o[1],y=qe([f,m,v,d],t.dtype),g=this.readSync(r.dataId),w=this.readSync(i.dataId),b=this.readSync(t.dataId),S=t.strides,E=y.strides,T=0;T<f;T++){var _=4*T,x=g[_],C=g[_+1],N=g[_+2],R=g[_+3],k=w[T];if(!(k>=l))for(var D=m>1?(N-x)*(c-1)/(m-1):0,W=v>1?(R-C)*(h-1)/(v-1):0,U=0;U<m;U++){var j=m>1?x*(c-1)+U*D:.5*(x+N)*(c-1);if(j<0||j>c-1)for(var H=0;H<v;H++)for(var z=0;z<d;z++){var q=z+H*E[2]+U*E[1]+T*E[0];y.values[q]=s}else if(a==="bilinear"){var F=Math.floor(j),oe=Math.ceil(j),Q=j-F;for(H=0;H<v;H++)if((Fe=v>1?C*(h-1)+H*W:.5*(C+R)*(h-1))<0||Fe>h-1)for(z=0;z<d;z++)q=z+H*E[2]+U*E[1]+T*E[0],y.values[q]=s;else{var ae=Math.floor(Fe),me=Math.ceil(Fe),fe=Fe-ae;for(z=0;z<d;z++){var pe=b[q=z+ae*S[2]+F*S[1]+k*S[0]],Ce=b[q=z+me*S[2]+F*S[1]+k*S[0]],Me=b[q=z+ae*S[2]+oe*S[1]+k*S[0]],Te=pe+(Ce-pe)*fe,Ke=Me+(b[q=z+me*S[2]+oe*S[1]+k*S[0]]-Me)*fe;q=z+H*E[2]+U*E[1]+T*E[0],y.values[q]=Te+(Ke-Te)*Q}}}else for(H=0;H<v;++H){var Fe;if((Fe=v>1?C*(h-1)+H*W:.5*(C+R)*(h-1))<0||Fe>h-1)for(z=0;z<d;z++)q=z+H*E[2]+U*E[1]+T*E[0],y.values[q]=s;else{var Xe=Math.round(Fe),ze=Math.round(j);for(z=0;z<d;z++){var Be=z+Xe*S[2]+ze*S[1]+k*S[0],dt=z+H*E[2]+U*E[1]+T*E[0];y.values[dt]=b[Be]}}}}}return y.toTensor()},e.prototype.sparseToDense=function(t,r,i,o){var a=sg(0,t,i),s=a.sliceRank,u=a.numUpdates,l=a.sliceSize,c=a.strides,h=a.outputSize;return this.scatter(t,r,i,h,l,u,s,c,o,!1)},e.prototype.gatherND=function(t,r){var i=r.shape,o=i[i.length-1],a=VO(t,r),s=a[0],u=a[1],l=a[2],c=a[3];if(u===0)return gn([],s,t.dtype);for(var h=new nc([u,l],t.dtype),d=this.readSync(r.dataId),f=this.readSync(t.dataId),m=0;m<u;m++){for(var v=[],y=0,g=0;g<o;g++){var w=d[m*o+g];y+=w*c[g],v.push(w)}if(y<0||y>=t.size/l)throw new Error("Invalid indices: "+v+" does not index into "+t.shape);for(var b=0;b<l;b++)h.values[m*l+b]=f[y*l+b]}return h.toTensor().reshape(s)},e.prototype.scatterND=function(t,r,i){var o=sg(0,t,i),a=o.sliceRank,s=o.numUpdates,u=o.sliceSize,l=o.strides,c=o.outputSize,h=Ee(0);return this.scatter(t,r,i,c,u,s,a,l,h,!0)},e.prototype.fill=function(t,r,i){var o=Ed(i=i||Ic(r),Ae(t));return o.fill(r),V.makeTensor(o,t,i,this)},e.prototype.onesLike=function(t){if(t.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var r=Ed(t.dtype,Ae(t.shape));return this.makeOutput(r,t.shape,t.dtype)},e.prototype.linspace=function(t,r,i){return v_(t,r,i)},e.prototype.scatter=function(t,r,i,o,a,s,u,l,c,h){var d=[o/a,a],f=this.readSync(t.dataId),m=this.readSync(r.dataId);if(o===0)return gn([],i,r.dtype);var v=new nc(d,r.dtype);v.values.fill(this.readSync(c.dataId)[0]);for(var y=0;y<s;y++){for(var g=[],w=0,b=0;b<u;b++){var S=f[y*u+b];g.push(S),w+=S*l[b]}if(w<0||w>=o/a)throw new Error("Invalid indices: "+g+" does not index into "+i);for(var E=0;E<a;E++)h?v.values[w*a+E]+=m[y*a+E]:v.values[w*a+E]=r.rank===0?m[0]:m[y*a+E]}return v.toTensor().reshape(i)},e}(p_);V.registerBackend("cpu",function(){return new O7},1),ew({kernelName:"Square",backendName:"cpu",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e.x,i=t;le(r,"square");for(var o=i.data.get(r.dataId).values,a=new Float32Array(o.length),s=0;s<o.length;++s){var u=o[s];a[s]=u*u}return{dataId:i.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}}),ew({kernelName:"Square",backendName:"webgl",kernelFunc:function(n){var e=n.inputs,t=n.backend,r=e.x,i=t,o=new Qe(r.shape,"return x * x;");return i.runWebGLProgram(o,[r],r.dtype)}});var P7=function(){function n(){}return n.prototype.fetch=function(e,t){return fetch(e,t)},n.prototype.now=function(){return performance.now()},n.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+t);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},n.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},n}();te().get("IS_BROWSER")&&te().setPlatform("browser",new P7);var v0,M7=function(){return require("node-fetch")},L7=function(){function n(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return n.prototype.fetch=function(e,t){return te().global.fetch!=null?te().global.fetch(e,t):(v0==null&&(v0=M7()),v0(e,t))},n.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},n.prototype.encode=function(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},n.prototype.decode=function(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)},n}();te().get("IS_NODE")&&te().setPlatform("node",new L7);var vw={float32:4,int32:4,uint16:2,uint8:1,bool:1},cg=4;function TM(n,e){for(var t={},r=0,i=function(s){var u=s.name,l=s.dtype,c=s.shape,h=Ae(c),d=void 0;if("quantization"in s){var f=s.quantization;if(f.dtype!=="uint8"&&f.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+f.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var m=vw[f.dtype],v=n.slice(r,r+h*m),y=f.dtype==="uint8"?new Uint8Array(v):new Uint16Array(v);if(l==="float32")d=Float32Array.from(y,function(T){return T*f.scale+f.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=Int32Array.from(y,function(T){return Math.round(T*f.scale+f.min)})}r+=h*m}else if(l==="string"){var g=Ae(s.shape);d=[];for(var w=0;w<g;w++){var b=new Uint32Array(n.slice(r,r+cg))[0];r+=cg;var S=new Uint8Array(n.slice(r,r+b));d.push(S),r+=b}}else{var E=vw[l];if(v=n.slice(r,r+h*E),l==="float32")d=new Float32Array(v);else if(l==="int32")d=new Int32Array(v);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=new Uint8Array(v)}r+=h*E}t[u]=gn(d,c,l)},o=0,a=e;o<a.length;o++)i(a[o]);return t}function F7(n){if(n===null)throw new Error("Invalid input value: "+JSON.stringify(n));var e=0,t=[];n.forEach(function(o){if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+o.constructor.name)});var r=new Uint8Array(e),i=0;return t.forEach(function(o){r.set(new Uint8Array(o.buffer),i),i+=o.byteLength}),r.buffer}var yw=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function oN(n){return yw?Buffer.byteLength(n):new Blob([n]).size}function wE(n){var e=0;n.forEach(function(i){e+=i.byteLength});var t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(new Uint8Array(i),r),r+=i.byteLength}),t.buffer}function aN(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);var e=n.split("/");return e[e.length-1]}function wf(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:oN(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:oN(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}var $r=function(){function n(){this.saveRouters=[],this.loadRouters=[]}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerSaveRouter=function(e){n.getInstance().saveRouters.push(e)},n.registerLoadRouter=function(e){n.getInstance().loadRouters.push(e)},n.getSaveHandlers=function(e){return n.getHandlers(e,"save")},n.getLoadHandlers=function(e,t){return n.getHandlers(e,"load",t)},n.getHandlers=function(e,t,r){var i=[];return(t==="load"?n.getInstance().loadRouters:n.getInstance().saveRouters).forEach(function(o){var a=o(e,r);a!==null&&i.push(a)}),i},n}(),Bl="://",os=function(){function n(){this.managers={}}return n.getInstance=function(){return n.instance==null&&(n.instance=new n),n.instance},n.registerManager=function(e,t){B(e!=null,function(){return"scheme must not be undefined or null."}),e.endsWith(Bl)&&(e=e.slice(0,e.indexOf(Bl))),B(e.length>0,function(){return"scheme must not be an empty string."});var r=n.getInstance();B(r.managers[e]==null,function(){return"A model store manager is already registered for scheme '"+e+"'."}),r.managers[e]=t},n.getManager=function(e){var t=this.getInstance().managers[e];if(t==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},n.getSchemes=function(){return Object.keys(this.getInstance().managers)},n}();function Jp(n){if(n.indexOf(Bl)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+os.getSchemes().join(","));return{scheme:n.split(Bl)[0],path:n.split(Bl)[1]}}function sN(n,e,t){return t===void 0&&(t=!1),Ie(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h;return Ne(this,function(d){switch(d.label){case 0:return B(n!==e,function(){return"Old path and new path are the same: '"+n+"'"}),B((r=$r.getLoadHandlers(n)).length>0,function(){return"Copying failed because no load handler is found for source URL "+n+"."}),B(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+n+"."}),i=r[0],B((o=$r.getSaveHandlers(e)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+e+"."}),B(o.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."}),a=o[0],s=Jp(n).scheme,u=Jp(n).path,l=s===Jp(n).scheme,[4,i.load()];case 1:return c=d.sent(),t&&l?[4,os.getManager(s).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,a.save(c)];case 4:return h=d.sent(),!t||l?[3,6]:[4,os.getManager(s).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var iu="models_store",$a="model_info_store";function kM(){if(!te().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var n=window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function ww(n){var e=n.result;e.createObjectStore(iu,{keyPath:"modelPath"}),e.createObjectStore($a,{keyPath:"modelPath"})}var jl=function(){function n(e){if(this.indexedDB=kM(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return n.prototype.save=function(e){return Ie(this,void 0,void 0,function(){return Ne(this,function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},n.prototype.load=function(){return Ie(this,void 0,void 0,function(){return Ne(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},n.prototype.databaseAction=function(e,t){var r=this;return new Promise(function(i,o){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return ww(a)},a.onsuccess=function(){var s=a.result;if(t==null){var u=s.transaction(iu,"readonly"),l=u.objectStore(iu).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),o(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(l.result.modelArtifacts)},l.onerror=function(v){return s.close(),o(l.error)},u.oncomplete=function(){return s.close()}}else{var c,h=wf(t),d=s.transaction($a,"readwrite"),f=d.objectStore($a),m=f.put({modelPath:r.modelPath,modelArtifactsInfo:h});m.onsuccess=function(){var v=(c=s.transaction(iu,"readwrite")).objectStore(iu).put({modelPath:r.modelPath,modelArtifacts:t,modelArtifactsInfo:h});v.onsuccess=function(){return i({modelArtifactsInfo:h})},v.onerror=function(y){var g=(f=d.objectStore($a)).delete(r.modelPath);g.onsuccess=function(){return s.close(),o(v.error)},g.onerror=function(w){return s.close(),o(v.error)}}},m.onerror=function(v){return s.close(),o(m.error)},d.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return o(a.error)}})},n.URL_SCHEME="indexeddb://",n}(),uN=function(n){return te().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(jl.URL_SCHEME)?(e=n.slice(jl.URL_SCHEME.length),new jl(e)):null;var e};$r.registerSaveRouter(uN),$r.registerLoadRouter(uN);var z7=function(){function n(){this.indexedDB=kM()}return n.prototype.listModels=function(){return Ie(this,void 0,void 0,function(){var e=this;return Ne(this,function(t){return[2,new Promise(function(r,i){var o=e.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return ww(o)},o.onsuccess=function(){var a=o.result,s=a.transaction($a,"readonly"),u=s.objectStore($a).getAll();u.onsuccess=function(){for(var l={},c=0,h=u.result;c<h.length;c++){var d=h[c];l[d.modelPath]=d.modelArtifactsInfo}r(l)},u.onerror=function(l){return a.close(),i(u.error)},s.oncomplete=function(){return a.close()}},o.onerror=function(a){return i(o.error)}})]})})},n.prototype.removeModel=function(e){return Ie(this,void 0,void 0,function(){var t=this;return Ne(this,function(r){var i;return e=(i=e).startsWith(jl.URL_SCHEME)?i.slice(jl.URL_SCHEME.length):i,[2,new Promise(function(o,a){var s=t.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return ww(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction($a,"readwrite"),h=c.objectStore($a),d=h.get(e);d.onsuccess=function(){if(d.result==null)return l.close(),a(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var f=h.delete(e),m=function(){var v=(u=l.transaction(iu,"readwrite")).objectStore(iu).delete(e);v.onsuccess=function(){return o(d.result.modelArtifactsInfo)},v.onerror=function(y){return a(d.error)}};f.onsuccess=m,f.onerror=function(v){return m(),l.close(),a(d.error)}},d.onerror=function(f){return l.close(),a(d.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return a(s.error)}})]})})},n}();if(te().getBool("IS_BROWSER"))try{os.registerManager(jl.URL_SCHEME,new z7)}catch{}var Lo="/",hl="tensorflowjs_models",RM="info",B7="model_topology",j7="weight_specs",U7="weight_data",W7="model_metadata";function AM(n){return{info:[hl,n,RM].join(Lo),topology:[hl,n,B7].join(Lo),weightSpecs:[hl,n,j7].join(Lo),weightData:[hl,n,U7].join(Lo),modelMetadata:[hl,n,W7].join(Lo)}}function V7(n){var e=n.split(Lo);if(e.length<3)throw new Error("Invalid key format: "+n);return e.slice(1,e.length-1).join(Lo)}var Ul=function(){function n(e){if(!te().getBool("IS_BROWSER")||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=AM(this.modelPath)}return n.prototype.save=function(e){return Ie(this,void 0,void 0,function(){var t,r,i;return Ne(this,function(o){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),i=wf(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,(a=e.weightData,yw?Buffer.from(a).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(a))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy})),[2,{modelArtifactsInfo:i}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}var a;return[2]})})},n.prototype.load=function(){return Ie(this,void 0,void 0,function(){var e,t,r,i,o,a,s;return Ne(this,function(u){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=i,(o=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(o),t.format=a.format,t.generatedBy=a.generatedBy,t.convertedBy=a.convertedBy),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(l){if(yw){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var h=atob(l),d=new Uint8Array(h.length),f=0;f<h.length;++f)d.set([h.charCodeAt(f)],f);return d.buffer}(s),[2,t]})})},n.URL_SCHEME="localstorage://",n}(),lN=function(n){return te().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ul.URL_SCHEME)?(e=n.slice(Ul.URL_SCHEME.length),new Ul(e)):null;var e};$r.registerSaveRouter(lN),$r.registerLoadRouter(lN);var $7=function(){function n(){B(te().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),B(window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return n.prototype.listModels=function(){return Ie(this,void 0,void 0,function(){var e,t,r,i,o,a;return Ne(this,function(s){for(e={},t=hl+Lo,r=Lo+RM,i=0;i<this.LS.length;++i)(o=this.LS.key(i)).startsWith(t)&&o.endsWith(r)&&(a=V7(o),e[a]=JSON.parse(this.LS.getItem(o)));return[2,e]})})},n.prototype.removeModel=function(e){return Ie(this,void 0,void 0,function(){var t,r;return Ne(this,function(i){var o;if(e=(o=e).startsWith(Ul.URL_SCHEME)?o.slice(Ul.URL_SCHEME.length):o,t=AM(e),this.LS.getItem(t.info)==null)throw new Error("Cannot find model at path '"+e+"'");return r=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,r]})})},n}();if(te().getBool("IS_BROWSER"))try{os.registerManager(Ul.URL_SCHEME,new $7)}catch{}var H7="model",G7=".json",q7=".weights.bin";function cN(n){return new Promise(function(e){return setTimeout(e)}).then(n)}var y0=function(){function n(e){if(!te().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(n.URL_SCHEME)&&(e=e.slice(n.URL_SCHEME.length)),e!=null&&e.length!==0||(e=H7),this.modelTopologyFileName=e+G7,this.weightDataFileName=e+q7}return n.prototype.save=function(e){return Ie(this,void 0,void 0,function(){var t,r,i,o,a,s;return Ne(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:r},o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=o,[4,cN(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),e.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=t,[4,cN(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:wf(e)}]}})})},n.URL_SCHEME="downloads://",n}(),K7=function(){function n(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return n.prototype.load=function(){return Ie(this,void 0,void 0,function(){var e,t,r=this;return Ne(this,function(i){return e=this.files[0],t=this.files.slice(1),[2,new Promise(function(o,a){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){t.length===0&&o({modelTopology:c});var h=l.weightsManifest;if(h!=null){var d;try{d=r.checkManifestAndWeightFiles(h,t)}catch(y){return void a(y)}var f=[],m=[],v=[];h.forEach(function(y){y.paths.forEach(function(g){m.push(g),v.push(null)}),f.push.apply(f,y.weights)}),h.forEach(function(y){y.paths.forEach(function(g){var w=new FileReader;w.onload=function(b){var S=b.target.result,E=m.indexOf(g);v[E]=S,v.indexOf(null)===-1&&o({modelTopology:c,weightSpecs:f,weightData:wE(v)})},w.onerror=function(b){return a("Failed to weights data from file of path '"+g+"'.")},w.readAsArrayBuffer(d[g])})})}else a(new Error("weightManifest field is missing from file "+e.name))}else a(new Error("modelTopology field is missing from file "+e.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(e)})]})})},n.prototype.checkManifestAndWeightFiles=function(e,t){for(var r=[],i=t.map(function(u){return aN(u.name)}),o={},a=0,s=e;a<s.length;a++)s[a].paths.forEach(function(u){var l=aN(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),i.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");o[u]=t[i.indexOf(l)]});if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+t.length+").");return o},n}();function hN(n,e,t,r){(function(o){B(o!=null&&Array.isArray(o)&&o.length>0,function(){return"promises must be a none empty array"})})(n),function(o,a){B(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+o}),B(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),B(a>=o,function(){return"startFraction must be no more than endFraction, but got startFraction "+o+" and endFraction "+a})}(t=t??0,r=r??1);var i=0;return Promise.all(n.map(function(o){return o.then(function(a){var s=t+ ++i/n.length*(r-t);return e(s),a}),o}))}function DM(n,e){return Ie(this,void 0,void 0,function(){var t,r,i,o,a,s,u,l,c;return Ne(this,function(h){switch(h.label){case 0:return e==null&&(e={}),t=e.fetchFunc==null?te().platform.fetch:e.fetchFunc,r=n.map(function(d){return t(d,e.requestInit,{isBinary:!0})}),i=0,o=.5,e.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=h.sent(),[3,4];case 2:return[4,hN(r,e.onProgress,i,o)];case 3:a=h.sent(),h.label=4;case 4:return s=a.map(function(d){return d.arrayBuffer()}),u=.5,l=1,e.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=h.sent(),[3,8];case 6:return[4,hN(s,e.onProgress,u,l)];case 7:c=h.sent(),h.label=8;case 8:return[2,c]}})})}function dN(n){var e=this;return function(t,r,i){return r===void 0&&(r=""),Ie(e,void 0,void 0,function(){var o,a,s,u,l,c,h,d,f,m;return Ne(this,function(v){switch(v.label){case 0:if(o=t.map(function(){return!1}),a={},s=i!=null?i.map(function(){return!1}):[],u=[],t.forEach(function(y,g){var w=0;y.weights.forEach(function(b){var S="quantization"in b?b.quantization.dtype:b.dtype,E=vw[S]*Ae(b.shape),T=function(){o[g]=!0,a[g]==null&&(a[g]=[]),a[g].push({manifestEntry:b,groupOffset:w,sizeBytes:E})};i!=null?i.forEach(function(_,x){_===b.name&&(T(),s[x]=!0)}):T(),u.push(b.name),w+=E})}),!s.every(function(y){return y}))throw l=i.filter(function(y,g){return!s[g]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=o.reduce(function(y,g,w){return g&&y.push(w),y},[]),h=[],c.forEach(function(y){t[y].paths.forEach(function(g){var w=r+(r.endsWith("/")?"":"/")+g;h.push(w)})}),[4,n(h)];case 1:return d=v.sent(),f={},m=0,c.forEach(function(y){for(var g=t[y].paths.length,w=0,b=0;b<g;b++)w+=d[m+b].byteLength;for(var S=new ArrayBuffer(w),E=new Uint8Array(S),T=0,_=0;_<g;_++){var x=new Uint8Array(d[m+_]);E.set(x,T),T+=x.byteLength}a[y].forEach(function(C){var N=TM(S.slice(C.groupOffset,C.groupOffset+C.sizeBytes),[C.manifestEntry]);for(var R in N)f[R]=N[R]}),m+=g}),[2,f]}})})}}$r.registerSaveRouter(function(n){return te().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(y0.URL_SCHEME)?(e=n.slice(y0.URL_SCHEME.length),e===void 0&&(e="model"),new y0(e)):null;var e});var OM=function(){function n(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,t.fetchFunc!=null?(B(typeof t.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=t.fetchFunc):this.fetch=te().platform.fetch,B(e!=null&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&B(e.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return n.prototype.save=function(e){return Ie(this,void 0,void 0,function(){var t,r,i,o;return Ne(this,function(a){switch(a.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],i={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:r},t.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((o=a.sent()).ok)return[2,{modelArtifactsInfo:wf(e),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}})})},n.prototype.load=function(){return Ie(this,void 0,void 0,function(){var e,t,r,i,o,a,s,u;return Ne(this,function(l){switch(l.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=l.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");l.label=2;case 2:return l.trys.push([2,4,,5]),[4,e.json()];case 3:return t=l.sent(),[3,5];case 4:throw l.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=t.modelTopology,o=t.weightsManifest,i==null&&o==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return o==null?[3,7]:[4,this.loadWeights(o)];case 6:u=l.sent(),a=u[0],s=u[1],l.label=7;case 7:return[2,{modelTopology:i,weightSpecs:a,weightData:s}]}})})},n.prototype.loadWeights=function(e){return Ie(this,void 0,void 0,function(){var t,r,i,o,a,s,u,l,c,h,d;return Ne(this,function(f){switch(f.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,r=function(m){var v=m.lastIndexOf("/"),y=m.lastIndexOf("?"),g=m.substring(0,v),w=y>v?m.substring(y):"";return[g+"/",w]}(t),i=r[0],o=r[1],a=this.weightPathPrefix||i,s=[],u=0,l=e;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return h=[],e.forEach(function(m){m.paths.forEach(function(v){h.push(a+v+o)})}),[4,DM(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return d=f.sent(),[2,[s,wE(d)]]}})})},n.URL_SCHEME_REGEX=/^https?:\/\//,n}();function bw(n){return n.match(OM.URL_SCHEME_REGEX)!=null}var fN=function(n,e){return typeof fetch>"u"?null:(Array.isArray(n)?n.every(function(t){return bw(t)}):bw(n))?xw(n,{onProgress:e}):null};function xw(n,e){return new OM(n,e)}$r.registerSaveRouter(fN),$r.registerLoadRouter(fN);var w0=function(){function n(e){this.modelArtifacts=e}return n.prototype.load=function(){return Ie(this,void 0,void 0,function(){return Ne(this,function(e){return[2,this.modelArtifacts]})})},n}(),X7=function(){function n(e){this.saveHandler=e}return n.prototype.save=function(e){return Ie(this,void 0,void 0,function(){return Ne(this,function(t){return[2,this.saveHandler(e)]})})},n}(),Hr=Object.freeze({browserFiles:function(n){return new K7(n)},browserHTTPRequest:function(n,e){return xw(n,e)},concatenateArrayBuffers:wE,decodeWeights:TM,encodeWeights:function(n,e){return Ie(this,void 0,void 0,function(){var t,r,i,o,a,s=this;return Ne(this,function(u){switch(u.label){case 0:for(t=[],r=[],i=Array.isArray(n)?n.map(function(l){return l.name}):Object.keys(n),o=function(l){var c=i[l],h=Array.isArray(n)?n[l].tensor:n[c];if(h.dtype!=="float32"&&h.dtype!=="int32"&&h.dtype!=="bool"&&h.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+h.dtype);var d={name:c,shape:h.shape,dtype:h.dtype};if(h.dtype==="string"){var f=new Promise(function(m){return Ie(s,void 0,void 0,function(){var v,y,g,w,b,S,E;return Ne(this,function(T){switch(T.label){case 0:return[4,h.bytes()];case 1:for(v=T.sent(),y=v.reduce(function(_,x){return _+x.length},0)+cg*v.length,g=new Uint8Array(y),w=0,b=0;b<v.length;b++)S=v[b],E=new Uint8Array(new Uint32Array([S.length]).buffer),g.set(E,w),w+=cg,g.set(S,w),w+=S.length;return m(g),[2]}})})});r.push(f)}else r.push(h.data());e!=null&&(d.group=e),t.push(d)},a=0;a<i.length;++a)o(a);return[4,Promise.all(r)];case 1:return[2,{data:F7(u.sent()),specs:t}]}})})},fromMemory:function(n,e,t,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new w0(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new w0({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new w0({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:r}))},getLoadHandlers:function(n,e){return $r.getLoadHandlers(n,e)},getModelArtifactsInfoForJSON:wf,getSaveHandlers:function(n){return $r.getSaveHandlers(n)},http:xw,isHTTPScheme:bw,loadWeights:function(n,e,t,r){return e===void 0&&(e=""),Ie(this,void 0,void 0,function(){return Ne(this,function(i){return[2,dN(function(o){return DM(o,{requestInit:r})})(n,e,t)]})})},registerLoadRouter:function(n){return $r.registerLoadRouter(n)},registerSaveRouter:function(n){return $r.registerSaveRouter(n)},weightsLoaderFactory:dN,withSaveHandler:function(n){return new X7(n)},copyModel:function(n,e){return Ie(this,void 0,void 0,function(){return Ne(this,function(t){return[2,sN(n,e,!1)]})})},listModels:function(){return Ie(this,void 0,void 0,function(){var n,e,t,r,i,o,a;return Ne(this,function(s){switch(s.label){case 0:n=os.getSchemes(),e={},t=0,r=n,s.label=1;case 1:return t<r.length?(i=r[t],[4,os.getManager(i).listModels()]):[3,4];case 2:for(a in o=s.sent())e[i+Bl+a]=o[a];s.label=3;case 3:return t++,[3,1];case 4:return[2,e]}})})},moveModel:function(n,e){return Ie(this,void 0,void 0,function(){return Ne(this,function(t){return[2,sN(n,e,!0)]})})},removeModel:function(n){return Ie(this,void 0,void 0,function(){var e;return Ne(this,function(t){return e=Jp(n),[2,os.getManager(e.scheme).removeModel(e.path)]})})}}),Y7=$({confusionMatrix_:function(n,e,t){var r=L(n,"labels","confusionMatrix"),i=L(e,"predictions","confusionMatrix");B(t==null||t>0&&Number.isInteger(t),function(){return"If provided, numClasses must be a positive integer, but got "+t}),B(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),B(i.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),B(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),B(t>0&&Number.isInteger(t),function(){return"numClasses is required to be a positive integer, but got "+t});var o=rc(r.asType("int32"),t),a=rc(i.asType("int32"),t);return o.transpose().matMul(a).asType("int32")}}),Q7=Object.freeze({confusionMatrix:Y7}),J7=$({fromPixels_:function(n,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var t=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(t&&t&&n.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return V.fromPixels(n,e)}}),PM=Object.freeze({toPixels:function(n,e){return Ie(this,void 0,void 0,function(){var t,r,i,o,a,s,u,l,c,h,d,f,m,v,y,g,w,b,S,E,T,_,x;return Ne(this,function(C){switch(C.label){case 0:if(t=L(n,"img","toPixels"),n instanceof Nt||(t=t.toInt()),t.rank!==2&&t.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+t.rank+".");if(r=t.shape.slice(0,2),i=r[0],o=r[1],(a=t.rank===2?1:t.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,t.data()];case 1:return s=C.sent(),u=t.min(),l=t.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=C.sent(),h=c[0],d=c[1],f=h[0],m=d[0],u.dispose(),l.dispose(),t.dtype==="float32"){if(f<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+f+" - "+m+"].")}else{if(t.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+t.dtype+". Please use float32 or int32 tensors.");if(f<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+f+" - "+m+"].")}for(v=t.dtype==="float32"?255:1,y=new Uint8ClampedArray(o*i*4),g=0;g<i*o;++g)w=void 0,b=void 0,S=void 0,E=void 0,a===1?(w=s[g]*v,b=s[g]*v,S=s[g]*v,E=255):a===3?(w=s[3*g]*v,b=s[3*g+1]*v,S=s[3*g+2]*v,E=255):a===4&&(w=s[4*g]*v,b=s[4*g+1]*v,S=s[4*g+2]*v,E=s[4*g+3]*v),y[0+(T=4*g)]=Math.round(w),y[T+1]=Math.round(b),y[T+2]=Math.round(S),y[T+3]=Math.round(E);return e!=null&&(e.width=o,e.height=i,_=e.getContext("2d"),x=new ImageData(y,o,i),_.putImageData(x,0,0)),t!==n&&t.dispose(),[2,y]}})})},fromPixels:J7}),MM=function(){function n(){}return n.prototype.getClassName=function(){return this.constructor.className},n.fromConfig=function(e,t){return new e(t)},n}(),LM=function(){function n(){this.classNameMap={}}return n.getMap=function(){return n.instance==null&&(n.instance=new n),n.instance},n.register=function(e){n.getMap().classNameMap[e.className]=[e,e.fromConfig]},n}();function Ds(n){B(n.className!=null,function(){return"Class being registered does not have the static className property defined."}),B(typeof n.className=="string",function(){return"className is required to be a string, but got type "+typeof n.className}),B(n.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),LM.register(n)}var ce=Object.freeze({Serializable:MM,SerializationMap:LM,registerClass:Ds}),Z7=.001,FM=.1;function b0(){return V.backend.floatPrecision()===32?Z7:FM}function x0(n,e,t){var r=!0;if((Kn(n)||Kn(e))&&(r=!1),Kn(n)&&Kn(e)&&(r=!0),r){var i=n.constructor.name,o=e.constructor.name;if(i!==o)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+o)}if(Array.isArray(n)&&Array.isArray(e)){var a=fo(n),s=fo(e);if(!jn(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=Kn(n)?n:ra(n),l=Kn(e)?e:ra(e);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+`.
Actual:   `+u+`.
Expected: `+l+".");for(var c=0;c<l.length;++c){var h=u[c],d=l[c];if(!t(h,d))throw new Error("Arrays differ: actual["+c+"] = "+h+", expected["+c+"] = "+d+`.
Actual:   `+u+`.
Expected: `+l+".")}}function _0(n,e,t){return!isFinite(n)&&!isFinite(e)||!(isNaN(n)||isNaN(e)||Math.abs(n-e)>t)}var e8=Object.freeze({TEST_EPSILON_FLOAT16:FM,expectArraysClose:function(n,e,t){return t==null&&(t=b0()),x0(n,e,function(r,i){return _0(r,i,t)})},testEpsilon:b0,expectPromiseToFail:function(n,e){n().then(function(){return e.fail()},function(){return e()})},expectArraysEqual:function(n,e){var t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return Va(n)||Va(n[0])||Va(e)||Va(e[0])?x0(n,t,function(r,i){return r==i}):x0(n,e,function(r,i){return _0(r,i,0)})},expectNumbersClose:function(n,e,t){if(t==null&&(t=b0()),!_0(n,e,t))throw new Error("Numbers differ: actual === "+n+", expected === "+e)},expectValuesInRange:function(n,e,t){for(var r=0;r<n.length;r++)if(n[r]<e||n[r]>t)throw new Error("Value out of range:"+n[r]+" low: "+e+", high: "+t)},expectArrayBuffersEqual:function(n,e){expect(new Float32Array(n)).toEqual(new Float32Array(e))}}),zM="1.3.1",t8=Object.freeze({gpgpu_util:Sq,webgl_util:tG,forceHalfFloat:function(){te().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:IP,setWebGLContext:tO,GPGPUContext:wP}),pa=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hi(e,n),e.prototype.minimize=function(t,r,i){r===void 0&&(r=!1);var o=this.computeGradients(t,i),a=o.value,s=o.grads;if(i!=null){var u=i.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return Ze(s),r?a:(a.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,r){return KO(t,r)},e.prototype.dispose=function(){this.iterations_!=null&&Ze(this.iterations_)},e.prototype.saveIterations=function(){return Ie(this,void 0,void 0,function(){return Ne(this,function(t){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Ee(this.iterations_,"int32")}]})})},e.prototype.getWeights=function(){return Ie(this,void 0,void 0,function(){return Ne(this,function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},e.prototype.setWeights=function(t){return Ie(this,void 0,void 0,function(){return Ne(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},e.prototype.extractIterations=function(t){return Ie(this,void 0,void 0,function(){var r;return Ne(this,function(i){switch(i.label){case 0:return r=this,[4,t[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,t.slice(1)]}})})},e}(MM);Object.defineProperty(pa,Symbol.hasInstance,{value:function(n){return n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null}});var bE=function(n){function e(t,r,i){i===void 0&&(i=null);var o=n.call(this)||this;return o.learningRate=t,o.rho=r,o.epsilon=i,o.accumulatedGrads=[],o.accumulatedUpdates=[],i==null&&(o.epsilon=V.backend.epsilon()),o}return Hi(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t)).forEach(function(i,o){var a=V.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accum_grad",variable:Z(function(){return ct(a).variable(!1)})}),r.accumulatedUpdates[o]==null&&(r.accumulatedUpdates[o]={originalName:i+"/accum_var",variable:Z(function(){return ct(a).variable(!1)})});var s=Array.isArray(t)?t[o].tensor:t[i];if(s!=null){var u=r.accumulatedGrads[o].variable,l=r.accumulatedUpdates[o].variable;Z(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),h=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),d=l.mul(r.rho).add(h.square().mul(1-r.rho));u.assign(c),l.assign(d);var f=h.mul(-r.learningRate).add(a);a.assign(f)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Ze(this.accumulatedGrads.map(function(t){return t.variable})),Ze(this.accumulatedUpdates.map(function(t){return t.variable})))},e.prototype.getWeights=function(){return Ie(this,void 0,void 0,function(){var t;return Ne(this,function(r){switch(r.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},e.prototype.setWeights=function(t){return Ie(this,void 0,void 0,function(){var r;return Ne(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),r=t.length/2,this.accumulatedGrads=t.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedUpdates=t.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,r){return new t(r.learningRate,r.rho,r.epsilon)},e.className="Adadelta",e}(pa);Ds(bE);var xE=function(n){function e(t,r){r===void 0&&(r=.1);var i=n.call(this)||this;return i.learningRate=t,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return Hi(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t)).forEach(function(i,o){var a=V.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accumulator",variable:Z(function(){return Tc(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(t)?t[o].tensor:t[i];if(s!=null){var u=r.accumulatedGrads[o].variable;Z(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(V.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(c)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&Ze(this.accumulatedGrads.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Ie(this,void 0,void 0,function(){return Ne(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(t){return Ie(this,void 0,void 0,function(){return Ne(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulatedGrads=t.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,r){return new t(r.learningRate,r.initialAccumulatorValue)},e.className="Adagrad",e}(pa);Ds(xE);var _E=function(n){function e(t,r,i,o){o===void 0&&(o=null);var a=n.call(this)||this;return a.learningRate=t,a.beta1=r,a.beta2=i,a.epsilon=o,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],Z(function(){a.accBeta1=Ee(r).variable(),a.accBeta2=Ee(i).variable()}),o==null&&(a.epsilon=V.backend.epsilon()),a}return Hi(e,n),e.prototype.applyGradients=function(t){var r=this,i=Array.isArray(t)?t.map(function(o){return o.name}):Object.keys(t);Z(function(){var o=Un(1,r.accBeta1),a=Un(1,r.accBeta2);i.forEach(function(s,u){var l=V.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Z(function(){return ct(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:Z(function(){return ct(l).variable(!1)})});var c=Array.isArray(t)?t[u].tensor:t[s];if(c!=null){var h=r.accumulatedFirstMoment[u].variable,d=r.accumulatedSecondMoment[u].variable,f=h.mul(r.beta1).add(c.mul(1-r.beta1)),m=d.mul(r.beta2).add(c.square().mul(1-r.beta2)),v=f.div(o),y=m.div(a);h.assign(f),d.assign(m);var g=v.div(y.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(g)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ze(this.accumulatedFirstMoment.map(function(t){return t.variable})),this.accumulatedSecondMoment!=null&&Ze(this.accumulatedSecondMoment.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Ie(this,void 0,void 0,function(){var t;return Ne(this,function(r){switch(r.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},e.prototype.setWeights=function(t){return Ie(this,void 0,void 0,function(){var r,i=this;return Ne(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(t)];case 1:return t=o.sent(),Z(function(){i.accBeta1.assign(oc(i.beta1,i.iterations_+1)),i.accBeta2.assign(oc(i.beta2,i.iterations_+1))}),r=t.length/2,this.accumulatedFirstMoment=t.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=t.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon)},e.className="Adam",e}(pa);Ds(_E);var EE=function(n){function e(t,r,i,o,a){o===void 0&&(o=null),a===void 0&&(a=0);var s=n.call(this)||this;return s.learningRate=t,s.beta1=r,s.beta2=i,s.epsilon=o,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],Z(function(){s.iteration=Ee(0).variable(),s.accBeta1=Ee(r).variable()}),o==null&&(s.epsilon=V.backend.epsilon()),s}return Hi(e,n),e.prototype.applyGradients=function(t){var r=this,i=Array.isArray(t)?t.map(function(o){return o.name}):Object.keys(t);Z(function(){var o=Un(1,r.accBeta1),a=sr(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach(function(s,u){var l=V.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ct(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:ct(l).variable(!1)});var c=Array.isArray(t)?t[u].tensor:t[s];if(c!=null){var h=r.accumulatedFirstMoment[u].variable,d=r.accumulatedWeightedInfNorm[u].variable,f=h.mul(r.beta1).add(c.mul(1-r.beta1)),m=d.mul(r.beta2),v=c.abs(),y=m.maximum(v);h.assign(f),d.assign(y);var g=a.div(o).mul(f.div(y.add(r.epsilon))).add(l);l.assign(g)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ze(this.accumulatedFirstMoment.map(function(t){return t.variable})),this.accumulatedWeightedInfNorm!=null&&Ze(this.accumulatedWeightedInfNorm.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Ie(this,void 0,void 0,function(){return Ne(this,function(t){throw new Error("getWeights() is not implemented for Adamax yet.")})})},e.prototype.setWeights=function(t){return Ie(this,void 0,void 0,function(){return Ne(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},e.className="Adamax",e}(pa);Ds(EE);var Kv=function(n){function e(t){var r=n.call(this)||this;return r.learningRate=t,r.setLearningRate(t),r}return Hi(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t)).forEach(function(i,o){var a=Array.isArray(t)?t[o].tensor:t[i];if(a!=null){var s=V.registeredVariables[i];Z(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=ho(Ee(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return Ie(this,void 0,void 0,function(){return Ne(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}})})},e.prototype.setWeights=function(t){return Ie(this,void 0,void 0,function(){return Ne(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:if((t=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,r){return new t(r.learningRate)},e.className="SGD",e}(pa);Ds(Kv);var CE=function(n){function e(t,r,i){i===void 0&&(i=!1);var o=n.call(this,t)||this;return o.learningRate=t,o.momentum=r,o.useNesterov=i,o.accumulations=[],o.m=Ee(o.momentum),o}return Hi(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t)).forEach(function(i,o){var a=V.registeredVariables[i];r.accumulations[o]==null&&(r.accumulations[o]={originalName:i+"/momentum",variable:Z(function(){return ct(a).variable(!1)})});var s=r.accumulations[o].variable,u=Array.isArray(t)?t[o].tensor:t[i];u!=null&&Z(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(a):r.c.mul(c).add(a),s.assign(c),a.assign(l)})}),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Ze(this.accumulations.map(function(t){return t.variable}))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return Ie(this,void 0,void 0,function(){return Ne(this,function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(t){return Ie(this,void 0,void 0,function(){return Ne(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),this.accumulations=t.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,r){return new t(r.learningRate,r.momentum,r.useNesterov)},e.className="Momentum",e}(Kv);Ds(CE);var SE=function(n){function e(t,r,i,o,a){r===void 0&&(r=.9),i===void 0&&(i=0),o===void 0&&(o=null),a===void 0&&(a=!1);var s=n.call(this)||this;return s.learningRate=t,s.decay=r,s.momentum=i,s.epsilon=o,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,o==null&&(s.epsilon=V.backend.epsilon()),s}return Hi(e,n),e.prototype.applyGradients=function(t){var r=this;(Array.isArray(t)?t.map(function(i){return i.name}):Object.keys(t)).forEach(function(i,o){var a=V.registeredVariables[i];r.accumulatedMeanSquares[o]==null&&(r.accumulatedMeanSquares[o]={originalName:i+"/rms",variable:Z(function(){return ct(a).variable(!1)})}),r.accumulatedMoments[o]==null&&(r.accumulatedMoments[o]={originalName:i+"/momentum",variable:Z(function(){return ct(a).variable(!1)})}),r.accumulatedMeanGrads[o]==null&&r.centered&&(r.accumulatedMeanGrads[o]={originalName:i+"/mg",variable:Z(function(){return ct(a).variable(!1)})});var s=Array.isArray(t)?t[o].tensor:t[i];if(s!=null){var u=r.accumulatedMeanSquares[o].variable,l=r.accumulatedMoments[o].variable;Z(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var h=r.accumulatedMeanGrads[o].variable,d=h.mul(r.decay).add(s.mul(1-r.decay)),f=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(d.square().add(r.epsilon)).sqrt()));u.assign(c),h.assign(d),l.assign(f);var m=a.sub(f);a.assign(m)}else{var v=u.mul(r.decay).add(s.square().mul(1-r.decay));f=l.mul(r.momentum).add(s.mul(r.learningRate).div(v.add(r.epsilon).sqrt())),u.assign(v),l.assign(f),m=a.sub(f),a.assign(m)}})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Ze(this.accumulatedMeanSquares.map(function(t){return t.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Ze(this.accumulatedMeanGrads.map(function(t){return t.variable})),this.accumulatedMoments!=null&&Ze(this.accumulatedMoments.map(function(t){return t.variable}))},e.prototype.getWeights=function(){return Ie(this,void 0,void 0,function(){var t;return Ne(this,function(r){switch(r.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(t.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},e.prototype.setWeights=function(t){return Ie(this,void 0,void 0,function(){var r;return Ne(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(t)];case 1:return t=i.sent(),r=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedMoments=t.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=t.slice(2*r,3*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,r){return new t(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},e.className="RMSProp",e}(pa);Ds(SE);var Bs=function(){function n(){}return n.sgd=function(e){return new Kv(e)},n.momentum=function(e,t,r){return r===void 0&&(r=!1),new CE(e,t,r)},n.rmsprop=function(e,t,r,i,o){return t===void 0&&(t=.9),r===void 0&&(r=0),i===void 0&&(i=null),o===void 0&&(o=!1),new SE(e,t,r,i,o)},n.adam=function(e,t,r,i){return e===void 0&&(e=.001),t===void 0&&(t=.9),r===void 0&&(r=.999),i===void 0&&(i=null),new _E(e,t,r,i)},n.adadelta=function(e,t,r){return e===void 0&&(e=.001),t===void 0&&(t=.95),r===void 0&&(r=null),new bE(e,t,r)},n.adamax=function(e,t,r,i,o){return e===void 0&&(e=.002),t===void 0&&(t=.9),r===void 0&&(r=.999),i===void 0&&(i=null),o===void 0&&(o=0),new EE(e,t,r,i,o)},n.adagrad=function(e,t){return t===void 0&&(t=.1),new xE(e,t)},n}(),Gs={sgd:Bs.sgd,momentum:Bs.momentum,adadelta:Bs.adadelta,adagrad:Bs.adagrad,rmsprop:Bs.rmsprop,adamax:Bs.adamax,adam:Bs.adam},n8=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:function(n){return n()};function Zp(){return new Promise(function(n){return n8(function(){return n()})})}ne=D7;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var BM=function(n,e){return(BM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])})(n,e)};function se(n,e){function t(){this.constructor=n}BM(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var E0,_h=function(){return(_h=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}).apply(this,arguments)};function $e(n,e,t,r){return new(t||(t=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(c){o(c)}}function s(l){try{u(r.throw(l))}catch(c){o(c)}}function u(l){l.done?i(l.value):new t(function(c){c(l.value)}).then(a,s)}u((r=r.apply(n,[])).next())})}function Pe(n,e){var t,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){a.label=c[1];break}if(c[0]===6&&a.label<i[1]){a.label=i[1],i=c;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(n,a)}catch(h){c=[6,h],r=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function xn(){return E0==null&&(E0=NO().epsilon()),E0}function Wi(){return"channelsLast"}var qs=function(n){function e(t){var r=n.call(this,t)||this;return Object.setPrototypeOf(r,e.prototype),r}return se(e,n),e}(Error),ro=function(n){function e(t){var r=n.call(this,t)||this;return Object.setPrototypeOf(r,e.prototype),r}return se(e,n),e}(Error),K=function(n){function e(t){var r=n.call(this,t)||this;return Object.setPrototypeOf(r,e.prototype),r}return se(e,n),e}(Error),et=function(n){function e(t){var r=n.call(this,t)||this;return Object.setPrototypeOf(r,e.prototype),r}return se(e,n),e}(Error),r8=function(n){function e(t){var r=n.call(this,t)||this;return Object.setPrototypeOf(r,e.prototype),r}return se(e,n),e}(Error);(function(n){function e(t){var r=n.call(this,t)||this;return Object.setPrototypeOf(r,e.prototype),r}return se(e,n),e})(Error);function Tu(n,e){if(Array.isArray(n)){for(var t=[],r=0;r<e;r++)t=t.concat(n);return t}return(t=new Array(e)).fill(n),t}function Zi(n,e){if(!n)throw new r8(e)}function pN(n,e){for(var t=0,r=0,i=n;r<i.length;r++)i[r]===e&&t++;return t}function cr(n){return n.length===1?n[0]:n}function Ft(n){return Array.isArray(n)?n:[n]}function Mo(n){var e=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return e[0]!=="_"?e:"private"+e}function Ys(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,function(e,t){return t.toUpperCase()})}var oi={};function IE(n){if(n==null)return null;var e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function _w(n){if(n!=null&&typeof n=="object")if(Array.isArray(n))n.forEach(function(o){return _w(o)});else for(var e=0,t=Object.keys(n);e<t.length;e++){var r=t[e],i=n[r];i!=null&&typeof i=="object"&&(Array.isArray(i)||i.type!=="ndarray"||typeof i.value!="number"?_w(i):n[r]=i.value)}}function bf(n,e,t,r,i){var o,a,s;if(e===void 0&&(e={}),t===void 0&&(t={}),r===void 0&&(r="object"),i===void 0&&(i=!1),typeof n=="string"){var u=n,l=void 0;if(u in t)l=t[u];else if(u in oi)l=oi[u];else if((l=e[u])==null)throw new K("Unknown "+r+": "+n+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return l}var c=n;if(c.className==null||c.config==null)throw new K(r+": Improper config format: "+JSON.stringify(c)+`.
'className' and 'config' must set.`);var h=c.className,d=void 0,f=void 0;if(h in t?(d=(o=t[h])[0],f=o[1]):h in oi?(d=(a=oi.className)[0],f=a[1]):h in e&&(d=(s=e[h])[0],f=s[1]),d==null)throw new K("Unknown "+r+": "+h+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(f!=null){for(var m={},v=0,y=Object.keys(oi);v<y.length;v++)m[T=y[v]]=oi[T];for(var g=0,w=Object.keys(t);g<w.length;g++)m[T=w[g]]=t[T];c.config.customObjects=m;for(var b=_h({},oi),S=0,E=Object.keys(t);S<E.length;S++){var T=E[S];oi[T]=t[T]}_w(c.config);var _=f(d,c.config,t,i);return oi=_h({},b),_}b=_h({},oi);for(var x=0,C=Object.keys(t);x<C.length;x++)T=C[x],oi[T]=t[T];return _=new d(c.config),oi=_h({},b),_}function i8(n,e){return n<e?-1:n>e?1:0}function yp(n,e){return-1*i8(n,e)}function as(n){if(n==null)return n;for(var e=[],t=0,r=n;t<r.length;t++){var i=r[t];e.indexOf(i)===-1&&e.push(i)}return e}function o8(n){if(n==null)throw new K("Invalid value in obj: "+JSON.stringify(n));for(var e in n)if(n.hasOwnProperty(e))return!1;return!0}function Mc(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new K(t+" is not a valid "+e+".  Valid values are "+n+" or null/undefined.")}function NE(n,e,t,r){return r===void 0&&(r=1/0),Zi(t>=0),Zi(r>=t),Array.isArray(n)&&n.length>=t&&n.length<=r&&n.every(function(i){return typeof i===e})}function yr(n,e){Array.isArray(n)?(De.assert(n.length>0,function(){return e+" is unexpectedly an empty array."}),n.forEach(function(t,r){return yr(t,"element "+(r+1)+" of "+e)})):De.assert(Number.isInteger(n)&&n>0,function(){return"Expected "+e+" to be a positive integer, but got "+jM(n)+"."})}function jM(n){return n===null?"null":Array.isArray(n)?"["+n.map(function(e){return jM(e)}).join(",")+"]":typeof n=="string"?'"'+n+'"':""+n}function a8(n,e){var t,r=De.now();return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var a=De.now();return a-r<e?t:(r=a,t=n.apply(void 0,i))}}function UM(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}function TE(n,e){return Z(function(){return hf(Pr(Tv(n,n),e,!0))})}var xf=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.getConfig=function(){return{}},e}(ce.Serializable),WM=function(n){function e(t){var r=n.call(this)||this;return r.defaultMaxValue=2,r.defaultAxis=0,r.maxValue=t.maxValue!=null?t.maxValue:r.defaultMaxValue,r.axis=t.axis!=null?t.axis:r.defaultAxis,r}return se(e,n),e.prototype.apply=function(t){var r=this;return Z(function(){var i=TE(t,r.axis),o=vr(i,0,r.maxValue);return He(t,sr(o,ot(xn(),i)))})},e.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},e.className="MaxNorm",e}(xf);ce.registerClass(WM);var VM=function(n){function e(t){var r=n.call(this)||this;return r.defaultAxis=0,r.axis=t.axis!=null?t.axis:r.defaultAxis,r}return se(e,n),e.prototype.apply=function(t){var r=this;return Z(function(){return sr(t,ot(xn(),TE(t,r.axis)))})},e.prototype.getConfig=function(){return{axis:this.axis}},e.className="UnitNorm",e}(xf);ce.registerClass(VM);var $M=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t){return As(t)},e.className="NonNeg",e}(xf);ce.registerClass($M);var HM=function(n){function e(t){var r=n.call(this)||this;return r.defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=t.minValue!=null?t.minValue:r.defaultMinValue,r.maxValue=t.maxValue!=null?t.maxValue:r.defaultMaxValue,r.rate=t.rate!=null?t.rate:r.defaultRate,r.axis=t.axis!=null?t.axis:r.defaultAxis,r}return se(e,n),e.prototype.apply=function(t){var r=this;return Z(function(){var i=TE(t,r.axis),o=ot(He(r.rate,vr(i,r.minValue,r.maxValue)),He(1-r.rate,i));return He(t,sr(o,ot(xn(),i)))})},e.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},e.className="MinMaxNorm",e}(xf);ce.registerClass(HM);var mN={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function kt(n){return IE(n)}function gN(n,e){return e===void 0&&(e={}),bf(n,ce.SerializationMap.getMap().classNameMap,e,"constraint")}function _n(n){return n==null?null:typeof n=="string"?gN({className:n in mN?mN[n]:n,config:{}}):n instanceof xf?n:gN(n)}function s8(n){return new WM(n)}function u8(n){return new VM(n)}function l8(){return new $M}function c8(n){return new HM(n)}var h8=Object.freeze({maxNorm:s8,unitNorm:u8,nonNeg:l8,minMaxNorm:c8}),d8=["channelsFirst","channelsLast"],f8=["valid","same","causal"],p8=["max","avg"],m8=["sum","mul","concat","ave"],al=new Map;function Cn(n){Mc(d8,"DataFormat",n)}function vi(n){Mc(f8,"PaddingMode",n)}function GM(n){Mc(p8,"PoolMode",n)}var $h=[],vN="/";function hu(n,e){$h.push(n);try{var t=e();return $h.pop(),t}catch(r){throw $h.pop(),r}}function g8(){return $h.length===0?"":$h.join(vN)+vN}function qM(n){if(!XM(n))throw new Error("Not a valid tensor name: '"+n+"'");return g8()+n}function KM(n){if(!XM(n))throw new Error("Not a valid tensor name: '"+n+"'");al.has(n)||al.set(n,0);var e=al.get(n);if(al.set(n,al.get(n)+1),e>0){var t=n+"_"+e;return al.set(t,1),t}return n}var v8=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function XM(n){return!!n.match(v8)}function y8(n){return n===parseInt(n.toString(),10)}function ss(n,e,t){e==null&&(e=0),t==null&&(t=n.length);for(var r=1,i=e;i<t;++i)r*=n[i];return r}function YM(n){return n=Array.isArray(n)?new Float32Array(n):n,Or(n)}function cc(n){return Bv(YM(n)).dataSync()[0]}function ys(n){return vs(YM(n)).dataSync()[0]}function Vi(n,e){if(e<n)throw new K("end ("+e+") < begin ("+n+") is forbidden.");for(var t=[],r=n;r<e;++r)t.push(r);return t}function _f(n,e){return n.asType(e)}function Ef(n,e){e===void 0&&(e=-1);var t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),n.reshape(t)}function w8(n,e){return Z(function(){if(n.shape.length!==2)throw new K("repeat() expects a rank-2 tensor, but received a rank-"+n.shape.length+" tensor.");return Ew(Ef(n,1),[1,e,1])})}function b8(n){var e=[ss(n.shape)];return n.reshape(e)}function x8(n){if(n.rank<=1)throw new K("batchFlatten requires a minimum rank of 2. Got rank: "+n.rank+".");var e=[n.shape[0],ss(n.shape,1)];return n.reshape(e)}function du(n,e,t){return Z(function(){switch(n.rank){case 1:return pf(n,e,t);case 2:return Fv(n,[e,0],[t,n.shape[1]]);case 3:return mf(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return sc(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return Yr(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return Yr(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new K("sliceAlongFirstAxis() received an unsupported tensor rank: "+n.rank)}})}function C0(n,e,t){return Z(function(){switch(n.rank){case 1:return pf(n,e,t);case 2:return Fv(n,[0,e],[n.shape[0],t]);case 3:return mf(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return sc(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new K("sliceAlongLastAxis() received an unsupported tensor rank: "+n.rank)}})}function wp(n,e,t,r){return Z(function(){switch(n.rank){case 1:return pf(n,e,t);case 2:switch(r){case 1:return du(n,e,t);case 2:return C0(n,e,t);default:throw new K("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return du(n,e,t);case 2:return mf(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return C0(n,e,t);default:throw new K("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return du(n,e,t);case 2:return sc(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return sc(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return C0(n,e,t);default:throw new K("The axis is not within the rank of the tensor "+r)}default:throw new K("sliceAlongLastAxis() received an unsupported tensor rank: "+n.rank)}})}function QM(n,e){var t;return e===void 0&&(e=-1),e<0&&(e=(t=n[0].rank)!==0?t:0),e===n[0].rank&&(e=-1),ar(n,e)}function yN(n,e){switch(n.rank){case 1:return n_([n,e]);case 2:return r_([n,e],0);case 3:return i_([n,e],0);case 4:return o_([n,e],0);default:throw new K("concatAlongFirstAxis() received an unsupported tensor rank: "+n.rank)}}function Ew(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new K("The length of input n ("+e.length+") does not match the number of dimensions in input x ("+n.rank+")");return is(n,e)}function Xv(n,e,t,r,i){return e===void 0&&(e=0),t===void 0&&(t=1),l_(n,e,t,r,i)}function Ko(n,e,t,r){if(n.rank<2||e.rank<2)throw new et("dot requires both inputs to be rank >= 2 but got x shape = "+n.shape+" and y shape = "+e.shape);if(e.rank>=3&&n.shape.slice(-1)[0]!==(c=e.shape.slice(-2)[0]))throw new et("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+n.shape+" and  y shape = "+e.shape);if(n.rank===2&&e.rank===2){var i=!1,o=!1;return lc.matMul({a:n,b:e,transposeA:i,transposeB:o,bias:r?Cw(n.rank,r,Wi()):null,activation:t})}var a=n.shape.slice(),s=a.pop();n=n.reshape([-1,s]);var u=e.shape.slice(),l=u.pop(),c=u.pop(),h=u.concat([l]),d=Array.from({length:e.rank},function(m,v){return v===0?e.rank-2:v<=e.rank-2?v-1:v});e=e.transpose(d).reshape([c,-1]);var f=a.concat(h);return i=!1,o=!1,lc.matMul({a:n,b:e,transposeA:i,transposeB:o,bias:r?Cw(n.rank,r,Wi()):null,activation:t}).reshape(f)}function JM(n,e,t){return Z(function(){return e=Array.isArray(e)?Or(e,"int32"):e.toInt(),Dc(n,e,t)})}function Cf(n){return Tv(n,n)}function Cw(n,e,t){var r=e.shape;if(e.rank!==1&&e.rank!==n)throw new K("Unexpected bias dimensions: "+e.rank+"; expected it to be 1 or "+n);if(n===5){if(t==="channelsFirst")return r.length===1?e.reshape([1,r[0],1,1,1]):e.reshape([1,r[3],r[0],r[1],r[2]]);if(t==="channelsLast")return r.length===1?e.reshape([1,1,1,1,r[0]]):e.reshape([1].concat(r))}else if(n===4){if(t==="channelsFirst")return r.length===1?e.reshape([1,r[0],1,1]):e.reshape([1,r[2],r[0],r[1]]);if(t==="channelsLast")return r.length===1?e.reshape([1,1,1,r[0]]):e.reshape([1].concat(r))}else if(n===3){if(t==="channelsFirst")return r.length===1?e.reshape([1,r[0],1]):e.reshape([1,r[1],r[0]]);if(t==="channelsLast")return r.length===1?e.reshape([1,1,r[0]]):e.reshape([1].concat(r))}else if(n<3)return e;throw new K("Unsupported input rank by biasAdd: "+e.rank)}function ma(n,e,t){return Z(function(){return t==null&&(t=Wi()),Cn(t),n.add(Cw(n.rank,e,t))})}function _8(n,e){if(e===void 0&&(e=1),e!==1)throw new et("Support for alpha values other than 1 ("+e+") is not implemented yet.");return Pc(n)}function E8(n){return Z(function(){return sr(n,gs(n).add(1))})}function ZM(n,e,t,r){return Z(function(){return hE(n,e,t,r)})}function C8(n){return Z(function(){var e=ot(.5,He(.2,n));return vr(e,0,1)})}function hc(n,e,t){return t===void 0&&(t=!1),t?n():e()}var S8=["fanIn","fanOut","fanAvg"],I8=["normal","uniform","truncatedNormal"];function N8(n){Mc(S8,"FanMode",n)}function T8(n){Mc(I8,"Distribution",n)}var Xi=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.fromConfigUsesCustomObjects=function(){return!1},e.prototype.getConfig=function(){return{}},e}(ce.Serializable),eL=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t,r){return St(t,r)},e.className="Zeros",e}(Xi);ce.registerClass(eL);var kE=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t,r){return yo(t,r)},e.className="Ones",e}(Xi);ce.registerClass(kE);var tL=function(n){function e(t){var r=n.call(this)||this;if(typeof t!="object")throw new K("Expected argument of type ConstantConfig but got "+t);if(t.value===void 0)throw new K("config must have value set but got "+t);return r.value=t.value,r}return se(e,n),e.prototype.apply=function(t,r){var i=this;return Z(function(){return He(Ee(i.value),yo(t,r))})},e.prototype.getConfig=function(){return{value:this.value}},e.className="Constant",e}(Xi);ce.registerClass(tL);var nL=function(n){function e(t){var r=n.call(this)||this;return r.DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=t.minval||r.DEFAULT_MINVAL,r.maxval=t.maxval||r.DEFAULT_MAXVAL,r.seed=t.seed,r}return se(e,n),e.prototype.apply=function(t,r){return Uu(t,this.minval,this.maxval,r)},e.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},e.className="RandomUniform",e}(Xi);ce.registerClass(nL);var rL=function(n){function e(t){var r=n.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=t.mean||r.DEFAULT_MEAN,r.stddev=t.stddev||r.DEFAULT_STDDEV,r.seed=t.seed,r}return se(e,n),e.prototype.apply=function(t,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new et("randomNormal does not support dType "+r+".");return Xv(t,this.mean,this.stddev,r,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="RandomNormal",e}(Xi);ce.registerClass(rL);var iL=function(n){function e(t){var r=n.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=t.mean||r.DEFAULT_MEAN,r.stddev=t.stddev||r.DEFAULT_STDDEV,r.seed=t.seed,r}return se(e,n),e.prototype.apply=function(t,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new et("truncatedNormal does not support dType "+r+".");return uf(t,this.mean,this.stddev,r,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="TruncatedNormal",e}(Xi);ce.registerClass(iL);var oL=function(n){function e(t){var r=n.call(this)||this;return r.gain=t.gain!=null?t.gain:1,r}return se(e,n),e.prototype.apply=function(t,r){var i=this;return Z(function(){if(t.length!==2||t[0]!==t[1])throw new K("Identity matrix initializer can only be used for 2D square matrices.");return He(i.gain,pv(t[0]))})},e.prototype.getConfig=function(){return{gain:this.gain}},e.className="Identity",e}(Xi);function k8(n,e){var t,r;if(e===void 0&&(e="channelsLast"),Cn(e),n.length===2)t=n[0],r=n[1];else if([3,4,5].indexOf(n.length)!==-1)if(e==="channelsFirst"){var i=ss(n,2);t=n[1]*i,r=n[0]*i}else e==="channelsLast"&&(i=ss(n,0,n.length-2),t=n[n.length-2]*i,r=n[n.length-1]*i);else{var o=ss(n);t=Math.sqrt(o),r=Math.sqrt(o)}return[t,r]}ce.registerClass(oL);var Mr=function(n){function e(t){var r=n.call(this)||this;if(t.scale<0)throw new K("scale must be a positive float. Got: "+t.scale);return r.scale=t.scale==null?1:t.scale,r.mode=t.mode==null?"fanIn":t.mode,N8(r.mode),r.distribution=t.distribution==null?"normal":t.distribution,T8(r.distribution),r.seed=t.seed,r}return se(e,n),e.prototype.apply=function(t,r){var i=k8(t),o=i[0],a=i[1],s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,o):this.mode==="fanOut"?s/=Math.max(1,a):s/=Math.max(1,(o+a)/2),this.distribution==="normal"){var u=Math.sqrt(s);if((r=r||"float32")!=="float32"&&r!=="int32")throw new et(this.getClassName()+" does not support dType "+r+".");return uf(t,0,u,r,this.seed)}var l=Math.sqrt(3*s);return Uu(t,-l,l,r)},e.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},e.className="VarianceScaling",e}(Xi);ce.registerClass(Mr);var RE=function(n){function e(t){return n.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})||this}return se(e,n),e.prototype.getClassName=function(){return Mr.className},e.className="GlorotUniform",e}(Mr);ce.registerClass(RE);var AE=function(n){function e(t){return n.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})||this}return se(e,n),e.prototype.getClassName=function(){return Mr.className},e.className="GlorotNormal",e}(Mr);ce.registerClass(AE);var DE=function(n){function e(t){return n.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})||this}return se(e,n),e.prototype.getClassName=function(){return Mr.className},e.className="HeNormal",e}(Mr);ce.registerClass(DE);var OE=function(n){function e(t){return n.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})||this}return se(e,n),e.prototype.getClassName=function(){return Mr.className},e.className="HeUniform",e}(Mr);ce.registerClass(OE);var PE=function(n){function e(t){return n.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})||this}return se(e,n),e.prototype.getClassName=function(){return Mr.className},e.className="LeCunNormal",e}(Mr);ce.registerClass(PE);var ME=function(n){function e(t){return n.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})||this}return se(e,n),e.prototype.getClassName=function(){return Mr.className},e.className="LeCunNormal",e}(Mr);ce.registerClass(ME);var aL=function(n){function e(t){var r=n.call(this)||this;if(r.DEFAULT_GAIN=1,r.gain=t.gain==null?r.DEFAULT_GAIN:t.gain,r.seed=t.seed,r.seed!=null)throw new et("Random seed is not implemented for Orthogonal Initializer yet.");return r}return se(e,n),e.prototype.apply=function(t,r){var i=this;return Z(function(){if(t.length!==2)throw new et("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+t[0]*t[1]+") elements: Slowness may result.");var o=Xv(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32"),a=pE.gramSchmidt(o);return t[0]>t[1]&&(a=a.transpose()),He(i.gain,a)})},e.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},e.className="Orthogonal",e}(Xi);ce.registerClass(aL);var wN={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function bN(n,e){return e===void 0&&(e={}),bf(n,ce.SerializationMap.getMap().classNameMap,e,"initializer")}function vt(n){return IE(n)}function Gt(n){if(typeof n=="string"){var e=n in wN?wN[n]:n;if(e==="GlorotNormal")return new AE;if(e==="GlorotUniform")return new RE;if(e==="HeNormal")return new DE;if(e==="HeUniform")return new OE;if(e==="LeCunNormal")return new PE;if(e==="LeCunUniform")return new ME;var t={};return t.className=e,t.config={},bN(t)}return n instanceof Xi?n:bN(n)}function R8(){return new eL}function A8(){return new kE}function D8(n){return new tL(n)}function O8(n){return new nL(n)}function P8(n){return new rL(n)}function M8(n){return new iL(n)}function L8(n){return new oL(n)}function F8(n){return new Mr(n)}function z8(n){return new RE(n)}function B8(n){return new AE(n)}function j8(n){return new DE(n)}function U8(n){return new OE(n)}function W8(n){return new PE(n)}function V8(n){return new ME(n)}function $8(n){return new aL(n)}var H8=Object.freeze({zeros:R8,ones:A8,constant:D8,randomUniform:O8,randomNormal:P8,truncatedNormal:M8,identity:L8,varianceScaling:F8,glorotUniform:z8,glorotNormal:B8,heNormal:j8,heUniform:U8,leCunNormal:W8,leCunUniform:V8,orthogonal:$8}),G8=0;function sL(){return G8++}var bp={};function Yv(n){return n===void 0&&(n=""),n in bp||(bp[n]=0),bp[n]+=1,n+bp[n].toString()}function Sw(n){return Array.isArray(n)&&Array.isArray(n[0])}function hg(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function Ye(n){var e;if(Array.isArray(n)){if(n.length!==1)throw new K("Expected Tensor length to be 1; got "+n.length);e=n[0]}else e=n;return e}function Mt(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return(n=n)[0];throw new K("Expected exactly 1 Shape; got "+n.length)}return n}function dg(n){for(var e=0,t=0,r=n;t<r.length;t++){var i=r[t];i.shape.length===0?e+=1:e+=i.shape.reduce(function(o,a){return o*a})}return e}var xN="Variable",uL=function(){function n(e,t,r,i,o){t===void 0&&(t="float32"),r===void 0&&(r=xN),i===void 0&&(i=!0),o===void 0&&(o=null),this.dtype=t??"float32",this.shape=e.shape,this.id=sL(),r=r??xN,this.originalName=qM(r),this.name=KM(this.originalName),this.trainable_=i,this.constraint=o,this.val=e_(e,this.trainable_,this.name,this.dtype)}return n.prototype.read=function(){return this.assertNotDisposed(),this.val},n.prototype.write=function(e){return this.assertNotDisposed(),q8(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this},n.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},n.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(n.prototype,"trainable",{get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e},enumerable:!0,configurable:!0}),n}();function q8(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function Iw(n){return n.map(function(e){return e.read()})}function LE(n){n.forEach(function(e){e[0].write(e[1])})}var Fn=function(){return function(n){this.dtype=n.dtype,this.shape=n.shape,n.shape!=null?this.ndim=n.shape.length:this.ndim=n.ndim,this.maxNDim=n.maxNDim,this.minNDim=n.minNDim,this.axes=n.axes||{}}}(),Di=function(){return function(n,e,t,r,i,o,a){this.dtype=n,this.shape=e,this.sourceLayer=t,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=sL(),o!=null&&(this.originalName=qM(o),this.name=KM(this.originalName)),this.rank=e.length}}(),K8=0,Qv=function(){function n(e,t){this.callArgs=t,this.id=K8++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(var r=0,i=e.inboundLayers;r<i.length;r++){var o=i[r];o!=null&&o.outboundNodes.push(this)}e.outboundLayer.inboundNodes.push(this)}return n.prototype.getConfig=function(){for(var e=[],t=0,r=this.inboundLayers;t<r.length;t++){var i=r[t];i!=null?e.push(i.name):e.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},n}(),X8=0,ht=function(n){function e(t){var r=n.call(this)||this;r._callHook=null,r._addedWeightNames=[],r._stateful=!1,r.id=X8++,r.activityRegularizer=null,r.inputSpec=null,r.supportsMasking=!1,r._trainableWeights=[],r._nonTrainableWeights=[],r._losses=[],r._updates=[],r._built=!1,r.inboundNodes=[],r.outboundNodes=[];var i=t.name;if(!i){var o=r.getClassName();i=Mo(o)+"_"+Yv(o)}if(r.name=i,r.trainable_=t.trainable==null||t.trainable,t.inputShape!=null||t.batchInputShape!=null){var a=void 0;if(t.batchInputShape!=null)a=t.batchInputShape;else if(t.inputShape!=null){var s=null;t.batchSize!=null&&(s=t.batchSize),a=[s].concat(t.inputShape)}r.batchInputShape=a;var u=t.dtype;u==null&&(u=t.inputDType),u==null&&(u="float32"),r.dtype=u}return t.weights!=null?r.initialWeights=t.weights:r.initialWeights=null,r._refCount=null,r.fastWeightInitDuringBuild=!1,r}return se(e,n),e.nodeKey=function(t,r){return t.name+"_ib-"+r.toString()},e.prototype.getNodeAtIndex=function(t,r){if(this.inboundNodes.length===0)throw new ro("The layer has never been called and thus has no defined "+r+".");if(this.inboundNodes.length<=t)throw new K("Asked to get "+r+" at node "+t+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[t]},e.prototype.getInputAt=function(t){return cr(this.getNodeAtIndex(t,"input").inputTensors)},e.prototype.getOutputAt=function(t){return cr(this.getNodeAtIndex(t,"output").outputTensors)},Object.defineProperty(e.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new qs("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new qs("Layer "+this.name+" is not connected, no input to return.");return cr(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){if(this.inboundNodes.length===0)throw new qs("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new qs("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return cr(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),e.prototype.calculateLosses=function(){return this.losses.map(function(t){return t()})},Object.defineProperty(e.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"built",{get:function(){return this._built},set:function(t){this._built=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this._trainableWeights.forEach(function(r){return r.trainable=t}),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(t){return t.trainable}):[]},set:function(t){this._trainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(t){return!t.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(t){this._nonTrainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},e.prototype.assertInputCompatibility=function(t){if(t=Ft(t),this.inputSpec!=null&&this.inputSpec.length!==0){var r=Ft(this.inputSpec);if(t.length!==r.length)throw new K("Layer "+this.name+" expects "+r.length+" inputs, but it received "+t.length+" input tensors. Input received: "+t);for(var i=0;i<t.length;i++){var o=t[i],a=r[i];if(a!=null){var s=o.rank;if(a.ndim!=null&&s!==a.ndim)throw new K("Input "+i+" is incompatible with layer "+this.name+": expected ndim="+a.ndim+", found ndim="+s);if(a.maxNDim!=null&&s>a.maxNDim)throw new K("Input "+i+" is incompatible with layer "+this.name+": expected max_ndim="+a.maxNDim+", found ndim="+s);if(a.minNDim!=null&&s<a.minNDim)throw new K("Input "+i+" is incompatible with layer "+this.name+": expected min_ndim="+a.minNDim+", found ndim="+s+".");if(a.dtype!=null&&o.dtype!==a.dtype)throw new K("Input "+i+" is incompatible with layer "+this.name+" : expected dtype="+a.dtype+", found dtype="+o.dtype+".");if(a.axes){var u=o.shape;for(var l in a.axes){var c=Number(l),h=a.axes[l],d=c>=0?u[c]:u[u.length+c];if(h!=null&&[h,null].indexOf(d)===-1)throw new K("Input "+i+" is incompatible with layer "+this.name+": expected axis "+c+" of input shape to have value "+h+" but got shape "+u+".")}}if(a.shape!=null)for(var f=0;f<a.shape.length;++f){var m=a.shape[f],v=o.shape[f];if(m!=null&&v!=null&&m!==v)throw new K("Input "+i+" is incompatible with layer "+this.name+": expected shape="+a.shape+", found shape="+o.shape+".")}}}}},e.prototype.call=function(t,r){return t},e.prototype.invokeCallHook=function(t,r){this._callHook!=null&&this._callHook(t,r)},e.prototype.setCallHook=function(t){this._callHook=t},e.prototype.clearCallHook=function(){this._callHook=null},e.prototype.apply=function(t,r){var i=this;r=r||{},this.assertNotDisposed();for(var o=Ft(t),a=!0,s=0,u=o;s<u.length;s++)if(!(u[s]instanceof Di)){a=!1;break}for(var l=!0,c=0,h=o;c<h.length;c++)if(h[c]instanceof Di){l=!1;break}if(a===l)throw new K("Arguments to apply() must be all SymbolicTensors or all Tensors");return hu(this.name,function(){if(!i.built){i.assertInputCompatibility(t);for(var d=[],f=0,m=Ft(t);f<m.length;f++){var v=m[f];d.push(v.shape)}i.build(cr(d)),i.built=!0,i.initialWeights&&i.setWeights(i.initialWeights),i._refCount===null&&l&&(i._refCount=1)}if(i.assertInputCompatibility(t),l){for(var y=[],g=0,w=Ft(T=i.call(t,r));g<w.length;g++){var b=w[g];o.indexOf(b)!==-1&&(b=b.clone()),y.push(b)}if(T=cr(y),i.activityRegularizer!=null)throw new et("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return T}var S=Y8(t),E=i.computeOutputShape(S),T=void 0,_=Q8(t);if(i.warnOnIncompatibleInputShape(Array.isArray(t)?S[0]:S),T=E!=null&&E.length>0&&Array.isArray(E[0])?E.map(function(x,C){return new Di(_,x,i,Ft(t),r,i.name,C)}):new Di(_,E,i,Ft(t),r,i.name),i.addInboundNode(t,T,null,null,S,E,r),i._refCount++,i.activityRegularizer!=null)throw new et("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return T})},e.prototype.warnOnIncompatibleInputShape=function(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(t)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var r=!1;this.batchInputShape.forEach(function(i,o){i!=null&&t[o]!=null&&t[o]!==i&&(r=!0)}),r&&console.warn("The shape of the input tensor ("+JSON.stringify(t)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(e.prototype,"outputShape",{get:function(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new qs("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var t=[],r=0,i=this.inboundNodes;r<i.length;r++){var o=i[r],a=JSON.stringify(o.outputShapes);t.indexOf(a)===-1&&t.push(a)}if(t.length===1){var s=this.inboundNodes[0].outputShapes;return Array.isArray(s)&&Array.isArray(s[0])&&s.length===1?s[0]:s}throw new qs("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),e.prototype.countParams=function(){if(!this.built)throw new ro("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return dg(this.weights)},e.prototype.build=function(t){this.built=!0},e.prototype.getWeights=function(t){return t===void 0&&(t=!1),Iw(t?this.trainableWeights:this.weights)},e.prototype.setWeights=function(t){var r=this;Z(function(){var i=r.weights;if(i.length!==t.length)throw new K('You called setWeights(weights) on layer "'+r.name+'" with a weight list of length '+t.length+", but the layer was expecting "+i.length+" weights. Provided weights: "+t+"...");if(i.length!==0){for(var o=[],a=Iw(i),s=0;s<a.length;++s){var u=a[s],l=i[s],c=t[s];if(!De.arraysEqual(u.shape,c.shape))throw new K("Layer weight shape "+u.shape+" not compatible with provided weight shape "+c.shape);o.push([l,c])}LE(o)}})},e.prototype.addWeight=function(t,r,i,o,a,s,u){if(this._addedWeightNames.indexOf(t)!==-1)throw new K("Duplicate weight name "+t+" for layer "+this.name);this._addedWeightNames.push(t),i==null&&(i="float32"),this.fastWeightInitDuringBuild&&(o=Gt("zeros"));var l=o.apply(r,i),c=new uL(l,i,t,s,u);return l.dispose(),a!=null&&this.addLoss(function(){return a.apply(c.read())}),s==null&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c},e.prototype.setFastWeightInitDuringBuild=function(t){this.fastWeightInitDuringBuild=t},e.prototype.addLoss=function(t){var r;t==null||Array.isArray(t)&&t.length===0||(t=Ft(t),this._losses!==void 0&&this._losses!==null&&(r=this.losses).push.apply(r,t))},e.prototype.computeOutputShape=function(t){return t},e.prototype.computeMask=function(t,r){var i=this;if(!this.supportsMasking){if(r!=null){if(!Array.isArray(r))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");r.forEach(function(o){if(o!=null)throw new TypeError("Layer "+i.name+" does not support masking, but was passed an inputMask.")})}return null}return r},e.prototype.addInboundNode=function(t,r,i,o,a,s,u){u===void 0&&(u=null);var l=Ft(t);r=Ft(r),i=Ft(i),o=Ft(o),a=hg(a),s=hg(s);for(var c=[],h=[],d=[],f=0,m=l;f<m.length;f++){var v=m[f];c.push(v.sourceLayer),h.push(v.nodeIndex),d.push(v.tensorIndex)}new Qv({outboundLayer:this,inboundLayers:c,nodeIndices:h,tensorIndices:d,inputTensors:l,outputTensors:r,inputMasks:i,outputMasks:o,inputShapes:a,outputShapes:s},u);for(var y=0;y<r.length;y++)r[y].sourceLayer=this,r[y].nodeIndex=this.inboundNodes.length-1,r[y].tensorIndex=y},e.prototype.getConfig=function(){var t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t},e.prototype.disposeWeights=function(){return this.weights.forEach(function(t){return t.dispose()}),this.weights.length},e.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Layer '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var t=0;return--this._refCount==0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}},e}(ce.Serializable);function Y8(n){for(var e=[],t=0,r=n=Ft(n);t<r.length;t++){var i=r[t];e.push(i.shape)}return cr(e)}function Q8(n){return"float32"}function lL(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];var r=e.inboundNodes[t];if(r.inboundLayers.length===0)return r.inputTensors;for(var i=[],o=0;o<r.inboundLayers.length;o++)for(var a=0,s=lL(r.inputTensors[o],r.inboundLayers[o],r.nodeIndices[o]);a<s.length;a++){var u=s[a];i.indexOf(u)===-1&&i.push(u)}return i}var _N,Sf=function(n){function e(t){var r=n.call(this,{dtype:t.dtype,name:t.name!=null?t.name:Yv("input").toString()})||this;if(t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new K("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var i=t.batchInputShape;if(i==null){if(t.inputShape==null)throw new K("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");i=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new K("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var o=t.dtype||"float32";r.batchInputShape=i,r.dtype=o,r.inputSpec=[{shape:i}];var a=new Di(r.dtype,r.batchInputShape,r,[],{},r.name);return a.nodeIndex=0,a.tensorIndex=0,new Qv({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[i],outputShapes:[i]}),r}return se(e,n),e.prototype.apply=function(t,r){throw new K("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},e.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},e.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},e.className="InputLayer",e}(ht);function cL(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new K("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));var t=n.dtype;return t==null&&(t="float32"),new Sf({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}function Ta(n){return $e(this,void 0,void 0,function(){var e,t,r,i,o,a,s,u;return Pe(this,function(l){switch(l.label){case 0:if(n==null)return[2];for(i in e=[],t=[],r=[],n)typeof(o=n[i])!="number"&&(a=o,e.push(a.data()),t.push(i),r.push(a));return e.length>0?[4,Promise.all(e)]:[3,2];case 1:for(s=l.sent(),u=0;u<s.length;++u)n[t[u]]=s[u][0];Ze(r),l.label=2;case 2:return[2]}})})}function hL(n){if(n!=null)for(var e in n){var t=n[e];typeof t!="number"&&t.dispose()}}ce.registerClass(Sf),function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"}(_N||(_N={}));var J8=125,dc=function(){function n(){this.validationData=null}return n.prototype.setParams=function(e){this.params=e},n.prototype.onEpochBegin=function(e,t){return $e(this,void 0,void 0,function(){return Pe(this,function(r){return[2]})})},n.prototype.onEpochEnd=function(e,t){return $e(this,void 0,void 0,function(){return Pe(this,function(r){return[2]})})},n.prototype.onBatchBegin=function(e,t){return $e(this,void 0,void 0,function(){return Pe(this,function(r){return[2]})})},n.prototype.onBatchEnd=function(e,t){return $e(this,void 0,void 0,function(){return Pe(this,function(r){return[2]})})},n.prototype.onTrainBegin=function(e){return $e(this,void 0,void 0,function(){return Pe(this,function(t){return[2]})})},n.prototype.onTrainEnd=function(e){return $e(this,void 0,void 0,function(){return Pe(this,function(t){return[2]})})},n.prototype.setModel=function(e){},n}(),dL=function(){function n(e,t){t===void 0&&(t=10),e==null&&(e=[]),this.callbacks=e,this.queueLength=t}return n.prototype.append=function(e){this.callbacks.push(e)},n.prototype.setParams=function(e){for(var t=0,r=this.callbacks;t<r.length;t++)r[t].setParams(e)},n.prototype.setModel=function(e){for(var t=0,r=this.callbacks;t<r.length;t++)r[t].setModel(e)},n.prototype.onEpochBegin=function(e,t){return $e(this,void 0,void 0,function(){var r,i;return Pe(this,function(o){switch(o.label){case 0:t==null&&(t={}),r=0,i=this.callbacks,o.label=1;case 1:return r<i.length?[4,i[r].onEpochBegin(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},n.prototype.onEpochEnd=function(e,t){return $e(this,void 0,void 0,function(){var r,i;return Pe(this,function(o){switch(o.label){case 0:t==null&&(t={}),r=0,i=this.callbacks,o.label=1;case 1:return r<i.length?[4,i[r].onEpochEnd(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},n.prototype.onBatchBegin=function(e,t){return $e(this,void 0,void 0,function(){var r,i;return Pe(this,function(o){switch(o.label){case 0:t==null&&(t={}),r=0,i=this.callbacks,o.label=1;case 1:return r<i.length?[4,i[r].onBatchBegin(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},n.prototype.onBatchEnd=function(e,t){return $e(this,void 0,void 0,function(){var r,i;return Pe(this,function(o){switch(o.label){case 0:t==null&&(t={}),r=0,i=this.callbacks,o.label=1;case 1:return r<i.length?[4,i[r].onBatchEnd(e,t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},n.prototype.onTrainBegin=function(e){return $e(this,void 0,void 0,function(){var t,r;return Pe(this,function(i){switch(i.label){case 0:e==null&&(e={}),t=0,r=this.callbacks,i.label=1;case 1:return t<r.length?[4,r[t].onTrainBegin(e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},n.prototype.onTrainEnd=function(e){return $e(this,void 0,void 0,function(){var t,r;return Pe(this,function(i){switch(i.label){case 0:e==null&&(e={}),t=0,r=this.callbacks,i.label=1;case 1:return t<r.length?[4,r[t].onTrainEnd(e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},n}(),Z8=function(n){function e(){return n.call(this)||this}return se(e,n),e.prototype.onEpochBegin=function(t){return $e(this,void 0,void 0,function(){return Pe(this,function(r){return this.seen=0,this.totals={},[2]})})},e.prototype.onBatchEnd=function(t,r){return $e(this,void 0,void 0,function(){var i,o,a,s,u=this;return Pe(this,function(l){for(s in r==null&&(r={}),i=r.size==null?0:r.size,this.seen+=i,o=function(c){var h=r[c];if(typeof h=="number")a.totals.hasOwnProperty(c)||(a.totals[c]=0),a.totals[c]=a.totals[c]+h*i;else{var d=void 0;c in a.totals?d=a.totals[c]:a.totals[c]=0;var f=Z(function(){return ot(u.totals[c],He(h,i))});a.totals[c]=f,d!=null&&d.dispose()}},a=this,r)o(s);return[2]})})},e.prototype.onEpochEnd=function(t,r){return $e(this,void 0,void 0,function(){var i,o,a,s,u,l=this;return Pe(this,function(c){if(r!=null)for(i=function(h){if(o.totals[h]==null)return"continue";typeof o.totals[h]=="number"?r[h]=o.totals[h]/o.seen:Z(function(){var d=He(sr(1,l.seen),l.totals[h]);r[h]=d,l.totals[h].dispose(),ho(r[h])})},o=this,a=0,s=this.params.metrics;a<s.length;a++)u=s[a],i(u);return[2]})})},e}(dc),fL=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.onTrainBegin=function(t){return $e(this,void 0,void 0,function(){return Pe(this,function(r){return this.epoch=[],this.history={},[2]})})},e.prototype.onEpochEnd=function(t,r){return $e(this,void 0,void 0,function(){var i;return Pe(this,function(o){for(i in r==null&&(r={}),this.epoch.push(t),r)this.history[i]==null&&(this.history[i]=[]),this.history[i].push(r[i]);return[2]})})},e.prototype.syncData=function(){return $e(this,void 0,void 0,function(){var t,r,i,o,a,s,u,l,c;return Pe(this,function(h){switch(h.label){case 0:for(o in t=[],r=[],i=[],this.history)for(a=this.history[o],s=0;s<a.length;++s)typeof a[s]!="number"&&(u=a[s],t.push(u.data()),r.push(o),i.push(s));return[4,Promise.all(t)];case 1:for(l=h.sent(),c=0;c<l.length;++c)this.history[r[c]][i[c]].dispose(),this.history[r[c]][i[c]]=l[c][0];return[2]}})})},e}(dc),pL=function(n){function e(t,r){var i=n.call(this)||this;if(i.currentEpoch=0,i.yieldEvery=r||"auto",i.yieldEvery==="auto"&&(i.yieldEvery=J8),i.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return De.isNumber(i.yieldEvery)&&(i.maybeWait=a8(i.maybeWait.bind(i),i.yieldEvery)),i.trainBegin=t.onTrainBegin,i.trainEnd=t.onTrainEnd,i.epochBegin=t.onEpochBegin,i.epochEnd=t.onEpochEnd,i.batchBegin=t.onBatchBegin,i.batchEnd=t.onBatchEnd,i.yield=t.onYield,i}return se(e,n),e.prototype.maybeWait=function(t,r,i){return $e(this,void 0,void 0,function(){var o;return Pe(this,function(a){switch(a.label){case 0:return o=[],this.yield==null?[3,2]:[4,Ta(i)];case 1:a.sent(),o.push(this.yield(t,r,i)),a.label=2;case 2:return o.push(Zp()),[4,Promise.all(o)];case 3:return a.sent(),[2]}})})},e.prototype.onEpochBegin=function(t,r){return $e(this,void 0,void 0,function(){return Pe(this,function(i){switch(i.label){case 0:return this.currentEpoch=t,this.epochBegin==null?[3,3]:[4,Ta(r)];case 1:return i.sent(),[4,this.epochBegin(t,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},e.prototype.onEpochEnd=function(t,r){return $e(this,void 0,void 0,function(){var i;return Pe(this,function(o){switch(o.label){case 0:return i=[],this.epochEnd==null?[3,2]:[4,Ta(r)];case 1:o.sent(),i.push(this.epochEnd(t,r)),o.label=2;case 2:return this.yieldEvery==="epoch"&&i.push(Zp()),[4,Promise.all(i)];case 3:return o.sent(),[2]}})})},e.prototype.onBatchBegin=function(t,r){return $e(this,void 0,void 0,function(){return Pe(this,function(i){switch(i.label){case 0:return this.batchBegin==null?[3,3]:[4,Ta(r)];case 1:return i.sent(),[4,this.batchBegin(t,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},e.prototype.onBatchEnd=function(t,r){return $e(this,void 0,void 0,function(){var i;return Pe(this,function(o){switch(o.label){case 0:return i=[],this.batchEnd==null?[3,2]:[4,Ta(r)];case 1:o.sent(),i.push(this.batchEnd(t,r)),o.label=2;case 2:return this.yieldEvery==="batch"?i.push(Zp()):De.isNumber(this.yieldEvery)&&i.push(this.maybeWait(this.currentEpoch,t,r)),[4,Promise.all(i)];case 3:return o.sent(),[2]}})})},e.prototype.onTrainBegin=function(t){return $e(this,void 0,void 0,function(){return Pe(this,function(r){switch(r.label){case 0:return this.trainBegin==null?[3,3]:[4,Ta(t)];case 1:return r.sent(),[4,this.trainBegin(t)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.onTrainEnd=function(t){return $e(this,void 0,void 0,function(){return Pe(this,function(r){switch(r.label){case 0:return this.trainEnd==null?[3,3]:[4,Ta(t)];case 1:return r.sent(),[4,this.trainEnd(t)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e}(dc);function mL(n,e){return n==null&&(n={}),n instanceof dc?[n]:Array.isArray(n)&&n[0]instanceof dc?n:Ft(n).map(function(t){return new pL(t,e)})}var gL=function(){function n(){}return n.registerCallbackConstructor=function(e,t){De.assert(e>=0&&Number.isInteger(e),function(){return"Verbosity level is expected to be an integer >= 0, but got "+e}),n.checkForDuplicate(t),n.constructors[e]==null&&(n.constructors[e]=[]),n.constructors[e].push(t)},n.checkForDuplicate=function(e){for(var t in n.constructors)n.constructors[+t].forEach(function(r){if(r===e)throw new K("Duplicate callback constructor.")})},n.clear=function(){n.constructors={}},n.createCallbacks=function(e){var t=[];for(var r in n.constructors){var i=+r;e>=i&&t.push.apply(t,n.constructors[i])}return t.map(function(o){return new o})},n.constructors={},n}();function vL(n,e,t,r,i,o,a,s,u){var l=new fL,c=[new Z8].concat(gL.createCallbacks(e));n!=null&&c.push.apply(c,n),c.push(l);var h=new dL(c);return h.setParams({epochs:t,initialEpoch:r,samples:i,steps:o,batchSize:a,verbose:e,doValidation:s,metrics:u}),{callbackList:h,history:l}}function Fi(n,e,t){return e===void 0&&(e={}),t===void 0&&(t=!1),bf(n,ce.SerializationMap.getMap().classNameMap,e,"layer",t)}function fg(n,e){return Z(function(){n.dtype!=="float32"&&(n=n.asType("float32"));var t=Pr(Cf(n),e,!0),r=Tc(t.shape,xn()),i=hf(wo(t,r));return sr(n,i)})}function Gu(n,e){return Z(function(){return yn(Cf(Un(e,n)),-1)})}function Jv(n,e){return Z(function(){return yn(gs(Un(e,n)),-1)})}function Lc(n,e){return Z(function(){var t=Un(n,e),r=vr(gs(n),xn(),Number.MAX_VALUE),i=gs(sr(t,r));return He(100,yn(i,-1))})}function eK(n,e){return Z(function(){var t=vr(e,xn(),Number.MAX_VALUE),r=ia(ot(1,t)),i=vr(n,xn(),Number.MAX_VALUE),o=ia(ot(1,i));return yn(Cf(Un(r,o)),-1)})}function tK(n,e){return Z(function(){var t=wo(0,Un(1,He(n,e)));return yn(Cf(t),-1)})}function nK(n,e){return Z(function(){var t=wo(0,Un(1,He(n,e)));return yn(t,-1)})}function rK(n,e){return Z(function(){var t=Pr(He(n,e),-1),r=vs(He(Un(1,n),e),-1);return wo(0,ot(1,Un(r,t)))})}function iK(n,e){return Z(function(){var t=Math.log(2),r=Un(e,n),i=Un(ot(r,cf(He(-2,r))),t);return yn(i,-1)})}function Pd(n,e,t){return t===void 0&&(t=!1),Z(function(){if(t)e=Wu(e);else{var r=Pr(e,e.shape.length-1,!0);e=sr(e,r)}return e=vr(e,xn(),1-xn()),Vu(Pr(He(n.toFloat(),ia(e)),e.shape.length-1))})}function pg(n,e){return Z(function(){var t=bv(b8(n)).toInt(),r=(e=vr(e,xn(),1-xn())).shape;return Pd(rc(t,r[r.length-1]).reshape(r),e,!1)})}function oK(n,e){if(!De.arraysEqual(n.shape,e.shape))throw new K("logits and labels must have the same shape, but got shapes "+JSON.stringify(n.shape)+" and "+JSON.stringify(e.shape));return Z(function(){var t=e.relu(),r=e.abs().neg();return t.sub(e.mul(n)).add(r.exp().log1p())})}function Zv(n,e){return Z(function(){var t;return t=vr(e,xn(),1-xn()),t=ia(sr(t,Un(1,t))),yn(oK(n,t),-1)})}function aK(n,e){return Z(function(){var t=vr(n,xn(),1),r=vr(e,xn(),1);return Pr(He(n,ia(sr(t,r))),-1)})}function sK(n,e){return Z(function(){var t=ia(ot(xn(),e));return yn(Un(e,He(n,t)),-1)})}function FE(n,e){return Z(function(){var t=fg(n,-1),r=fg(e,-1),i=He(t,r);return Vu(Pr(i,-1))})}var mg={meanSquaredError:Gu,meanAbsoluteError:Jv,meanAbsolutePercentageError:Lc,meanSquaredLogarithmicError:eK,squaredHinge:tK,hinge:nK,categoricalHinge:rK,logcosh:iK,categoricalCrossentropy:Pd,sparseCategoricalCrossentropy:pg,binaryCrossentropy:Zv,kullbackLeiblerDivergence:aK,poisson:sK,cosineProximity:FE};function S0(n){if(typeof n=="string"){if(n in mg)return mg[n];var e="Unknown loss "+n;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss "+n+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new K(e)}return n}function zE(n,e){return Z(function(){var t=He(.5,Xr(e)),r=_f(Ac(e,t),n.dtype);return yn($u(n,r),-1)})}function BE(n,e){return Z(function(){return _f($u(Od(n,-1),Od(e,-1)),"float32")})}function yL(n,e){return Z(function(){return da(n.equal(1),e.equal(1)).sum().cast("float32")})}function uK(n,e){return Z(function(){return da(n.equal(1),e.equal(0)).sum().cast("float32")})}function lK(n,e){return Z(function(){return da(n.equal(0),e.equal(1)).sum().cast("float32")})}function wL(n,e){return Z(function(){var t=yL(n,e),r=lK(n,e),i=t.add(r);return oa(Ac(i,0),t.div(i),0).cast("float32")})}function cK(n,e){return Z(function(){var t=yL(n,e),r=uK(n,e),i=t.add(r);return oa(Ac(i,0),t.div(i),0).cast("float32")})}function bL(n,e){return Zv(n,e)}function xL(n,e){return n.rank===e.rank&&(n=n.squeeze([n.rank-1])),(e=e.argMax(-1)).dtype!==n.dtype&&(e=e.asType(n.dtype)),$u(n,e).asType("float32")}var hK=Gu,dK=Gu,fK=Jv,pK=Jv,mK=Lc,gK=Lc,jE=Pd,vK=FE,_L=pg,gg={binaryAccuracy:zE,categoricalAccuracy:BE,precision:wL,categoricalCrossentropy:jE,sparseCategoricalCrossentropy:_L,mse:hK,MSE:dK,mae:fK,MAE:pK,mape:mK,MAPE:gK,cosine:vK};function yK(n){if(typeof n=="string"&&n in gg)return gg[n];if(typeof n!="string"&&n!=null)return n;throw new K("Unknown metric "+n)}function xp(n){if(Zi(n!==null,"Unknown LossOrMetricFn "+n),typeof n=="string")return n;for(var e=void 0,t=0,r=Object.keys(mg);t<r.length;t++){var i=r[t];if(mg[i]===n){e=i;break}}if(e!==void 0)return e;for(var o=0,a=Object.keys(gg);o<a.length;o++)if(i=a[o],gg[i]===n){e=i;break}return e!==void 0?e:n.name}function wK(n){var e={Adagrad:function(){return Gs.adagrad(.01)},Adadelta:function(){return Gs.adadelta(1,.95,xn())},Adam:function(){return Gs.adam(.001,.9,.999,xn())},Adamax:function(){return Gs.adamax(.002,.9,.999,xn(),0)},RMSProp:function(){return Gs.rmsprop(.001,.9,0,xn())},SGD:function(){return Gs.sgd(.01)}};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new K("Unknown Optimizer "+n)}var EN=1048576;function CN(n,e,t){if(t===void 0&&(t=!1),n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!Nw(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){var r=JSON.stringify(n);r.length>EN&&console.warn('User-defined metadata of model "'+e+'" is too large in size (length='+r.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+EN+".")}}function Nw(n){if(n===null)return!0;if(typeof n=="object"){if(Object.getPrototypeOf(n)===Object.prototype){for(var e=0,t=Object.keys(n);e<t.length;e++){var r=t[e];if(typeof r!="string"||!Nw(n[r]))return!1}return!0}if(Array.isArray(n)){for(var i=0,o=n;i<o.length;i++)if(!Nw(o[i]))return!1;return!0}return!1}var a=typeof n;return a==="string"||a==="number"||a==="boolean"}function bK(n,e,t,r){r===void 0&&(r=console.log);var i,o=_K(n),a=["Layer (type)","Output shape","Param #"];if(o?(e=e||65,t=t||[.45,.85,1]):(e=e||98,t=t||[.33,.55,.67,1]),t[t.length-1]<=1&&(t=t.map(function(d){return Math.floor(e*d)})),!o)for(var s in a.push("Receives inputs"),i=[],n.nodesByDepth)i.push.apply(i,n.nodesByDepth[s]);r("_".repeat(e)),vg(a,t,r),r("=".repeat(e));for(var u=n.layers,l=0;l<u.length;++l)o?EK(u[l],t,r):CK(u[l],t,i,r),r((l===u.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();var c=xK(n),h=dg(n.nonTrainableWeights);r("Total params: "+(c+h)),r("Trainable params: "+c),r("Non-trainable params: "+h),r("_".repeat(e))}function xK(n){return n.collectedTrainableWeights!=null?dg(n.collectedTrainableWeights):dg(n.trainableWeights)}function _K(n){var e=!0,t=[],r=[];for(var i in n.nodesByDepth)t.push(n.nodesByDepth[i]);for(var o=0,a=t;o<a.length;o++){var s=a[o];if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push.apply(r,s)}if(e)for(var u=0,l=n.layers;u<l.length;u++){for(var c=!1,h=0,d=l[u].inboundNodes;h<d.length;h++){var f=d[h];if(r.indexOf(f)!==-1){if(c){e=!1;break}c=!0}}if(!e)break}return e}function vg(n,e,t){t===void 0&&(t=console.log);for(var r="",i=0;i<n.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=n[i]).slice(0,e[i]),r+=" ".repeat(e[i]-r.length);t(r)}function EK(n,e,t){var r;try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}vg([n.name+" ("+n.getClassName()+")",r,n.countParams().toString()],e,t)}function CK(n,e,t,r){var i;try{i=JSON.stringify(n.outputShape)}catch{i="multiple"}for(var o=[],a=0,s=n.inboundNodes;a<s.length;a++){var u=s[a];if(!(t!=null&&t.length>0&&t.indexOf(u)===-1))for(var l=0;l<u.inboundLayers.length;++l){var c=u.inboundLayers[l].name,h=u.nodeIndices[l],d=u.tensorIndices[l];o.push(c+"["+h+"]["+d+"]")}}var f=n.name,m=n.getClassName(),v=o.length===0?"":o[0];for(vg([f+" ("+m+")",i,n.countParams().toString(),v],e,r),l=1;l<o.length;++l)vg(["","","",o[l]],e,r)}function EL(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function Md(n,e){if(n===null)return null;if(typeof n=="string")return Ys(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){for(var t=[],r=n.length,i=0;i<r;++i){var o=n[i];EL(e,i,o)?t.push(o):t.push(Md(o,e))}return t}for(var a={},s=0,u=Object.keys(n);s<u.length;s++){var l=u[s],c=n[l];if(l==="name"&&typeof c=="string")a[l]=c;else{var h=Ys(l);a[h]=Md(c,h)}}return a}function Tw(n,e){if(n==null)return null;if(typeof n=="string")return Mo(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){for(var t=[],r=n.length,i=0;i<r;++i){var o=n[i];EL(e,i,o)?t.push(o):t.push(Tw(o,e))}return t}for(var a={},s=0,u=Object.keys(n);s<u.length;s++){var l=u[s],c=n[l],h=Mo(l);a[h]=l!=="name"&&l!=="className"||typeof c!="string"?Tw(c,l):c}return a}var ey="1.3.1";function SK(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return fv(e,n.dtype)}catch{throw new K("The dtype of the feed ("+e.dtype+") can not be cast to the dtype of the key '"+n.name+"' ("+n.dtype+").")}}var Il=function(){function n(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof n)for(var t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(var r=0,i=e;r<i.length;r++){var o=i[r];this.add(o.key,o.value)}}}return n.prototype.add=function(e,t,r){if(this.id2Value[e.id]!=null)throw new K("Duplicate key: name="+e.name+", id="+e.id);return this.id2Value[e.id]=SK(e,t),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r),this},n.prototype.addFeed=function(e){this.add(e.key,e.value)},n.prototype.hasKey=function(e){return this.id2Value[e.id]!=null},n.prototype.names=function(){return Object.keys(this.name2Id)},n.prototype.getValue=function(e){if(e instanceof Di){if(this.id2Value[e.id]==null)throw new K("Nonexistent key: "+e.name);return this.id2Value[e.id]}var t=this.name2Id[e];if(t==null)throw new K("Feed dict has no SymbolicTensor name: "+e);return this.id2Value[t]},n.prototype.getMask=function(e){if(e instanceof Di){if(this.id2Value[e.id]==null)throw new K("Nonexistent key: "+e.name);return this.id2Mask[e.id]}var t=this.name2Id[e];if(t==null)throw new K("Feed dict has no SymbolicTensor name: "+e);return this.id2Mask[t]},n.prototype.disposeMasks=function(){this.id2Mask!=null&&Ze(this.id2Mask)},n}(),I0={},SN={};function Eh(n,e,t,r){for(var i=t!=null&&t.training,o=Array.isArray(n),a=o?n:[n],s=a.map(function(F){return F.name}),u=[],l=e.names(),c=0,h=s;c<h.length;c++){var d=h[c];l.indexOf(d)!==-1?u.push(e.getValue(d)):u.push(null)}var f,m,v=s.join(",")+"|"+e.names().join(",");if(I0[v]==null){var y=IK(a,e);f=y.sorted,m=y.recipientCounts,I0[v]=f,SN[v]=m}f=I0[v],m={},i||Object.assign(m,SN[v]);for(var g=new Il(e),w=0;w<f.length;++w){var b=f[w],S=b.sourceLayer;if(!(S instanceof Sf)){for(var E=[],T=[],_=[],x=!1,C=0,N=b.inputs;C<N.length;C++){var R=N[C],k=g.getValue(R),D=g.getMask(R);E.push(k),T.push(D),D!=null&&(x=!0),i||(m[R.name]--,m[R.name]!==0||e.hasKey(R)||s.indexOf(R.name)!==-1||k.isDisposed||R.sourceLayer.stateful===!0||_.push(k))}x&&((t=t||{}).mask=T[0]);var W=Ft(S.apply(E,t)),U=null;S.supportsMasking&&(U=S.computeMask(E,T));for(var j=TK(b),H=Array.isArray(j)?j:[j],z=0;z<H.length;++z){g.hasKey(H[z])||g.add(H[z],W[z],Array.isArray(U)?U[0]:U);var q=s.indexOf(H[z].name);q!==-1&&(u[q]=W[z])}i||Ze(_)}}return g.disposeMasks(),o?u:u[0]}function IK(n,e){De.assert(n!=null&&n.length>0,function(){return"Expected at least one fetch, got none"});var t=[],r={};if(n.length===1){var i=IN(n[0],e);t=i.sorted,r=i.recipientMap}else for(var o=new Set,a=0,s=n;a<s.length;a++){for(var u=IN(s[a],e),l=u.sorted,c=u.recipientMap,h=0,d=l;h<d.length;h++){var f=d[h];o.has(f.name)||(t.push(f),o.add(f.name))}var m=function(y){r[y]==null&&(r[y]=new Set),c[y].forEach(function(g){return r[y].add(g)})};for(var v in c)m(v)}return{sorted:t,recipientCounts:NK(r)}}function NK(n){var e={};for(var t in n)e[t]=n[t].size;return e}function IN(n,e){for(var t=new Set,r=[],i={},o=0,a=e.names();o<a.length;o++){var s=a[o];t.add(s)}var u=[],l=[];for(u.push(n);u.length>0;){var c=u[u.length-1];if(t.has(c.name))u.pop();else{var h=l[l.length-1]===u.length-1;if(c.inputs.length===0||h)u.pop(),r.push(c),t.add(c.name),h&&l.pop();else{l.push(u.length-1);for(var d=0,f=c.inputs;d<f.length;d++){var m=f[d];i[m.name]==null&&(i[m.name]=new Set),i[m.name].add(c.name),t.has(m.name)||u.push(m)}}}}return{sorted:r,recipientMap:i}}function TK(n){var e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{for(var t=null,r=0;r<n.sourceLayer.inboundNodes.length;++r)for(var i=0,o=n.sourceLayer.inboundNodes[r].outputTensors;i<o.length;i++)if(o[i].id===n.id){t=r;break}e=n.sourceLayer.getOutputAt(t)}return e}var kK=function(n){function e(t){var r=n.call(this,{})||this;if(r.containerNodes=new Set,r.name=t.name,r.name==null){var i=r.getClassName().toLowerCase();r.name=Yv(i)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(t.inputs)?r.inputs=t.inputs.slice():r.inputs=[t.inputs],Array.isArray(t.outputs)?r.outputs=t.outputs.slice():r.outputs=[t.outputs],as(r.inputs).length!==r.inputs.length)throw new K("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map(function(je){return je.name}));as(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map(function(je){return je.name})),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];for(var o=0,a=r.outputs;o<a.length;o++){var s=(N=a[o]).sourceLayer,u=N.nodeIndex,l=N.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}for(var c=0,h=r.inputs;c<h.length;c++)s=(N=h[c]).sourceLayer,u=N.nodeIndex,l=N.tensorIndex,Zi(u===0,"input layer has >1 nodes"),Zi(l===0,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(l);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var d=0;d<r.inputLayers.length;d++){if(!((s=r.inputLayers[d])instanceof Sf))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+t.inputs+". Input "+d+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var f=0,m=r.outputLayers;f<m.length;f++)s=m[f],r.outputNames.push(s.name);r.internalInputShapes=r.inputs.map(function(je){return je.shape}),r.internalOutputShapes=r.outputs.map(function(je){return je.shape});for(var v={},y={},g={},w={},b={},S=[],E=function(je,Qt,mt,Ue,yt,Jt){Ue!=null&&yt!=null&&Jt!=null||(Ue=je.sourceLayer,yt=je.nodeIndex,Jt=je.tensorIndex);var Wt=Ue.inboundNodes[yt];if(mt.indexOf(Wt)!==-1)throw new ro("The tensor "+je.name+' at layer "'+Ue.name+'" is part of a cycle.');if(Qt.indexOf(Wt)===-1){r.containerNodes.add(e.nodeKey(Ue,yt)),Ue.id in b||(b[Ue.id]=Object.keys(b).length),mt.indexOf(Wt)===-1&&mt.push(Wt);for(var In=Wt.inboundLayers.length,ur=0;ur<In;ur++){var ti=Wt.inputTensors[ur],bo=Wt.inboundLayers[ur],ga=Wt.nodeIndices[ur],ni=Wt.tensorIndices[ur];E(ti,Qt,mt,bo,ga,ni)}for(Qt.push(Wt);mt.indexOf(Wt)>=0;)mt.splice(mt.indexOf(Wt),1);S.push(Wt)}},T=[],_=[],x=0,C=r.outputs;x<C.length;x++){var N=C[x];E(N,T,_)}for(var R=0,k=S.slice().reverse();R<k.length;R++){y[(Be=k[R]).id]=Be,Be.id in v||(v[Be.id]=0);var D=v[Be.id],W=g[Be.outboundLayer.id]==null?0:g[Be.outboundLayer.id];for(D=Math.max(D,W),g[Be.outboundLayer.id]=D,w[Be.outboundLayer.id]=Be.outboundLayer,v[Be.id]=D,d=0;d<Be.inboundLayers.length;d++){var U=Be.inboundLayers[d],j=(u=Be.nodeIndices[d],U.inboundNodes[u]),H=v[j.id]==null?0:v[j.id];v[j.id]=Math.max(D+1,H),y[j.id]=j}}var z={};for(var q in v)(D=v[q])in z||(z[D]=[]),z[D].push(y[q]);var F={};for(var oe in g)(D=g[oe])in F||(F[D]=[]),F[D].push(w[oe]);var Q=Object.keys(F).map(function(je){return parseInt(je,10)}).sort(yp);r.layers=[];for(var ae=0,me=Q;ae<me.length;ae++){var fe=F[D=me[ae]];fe.sort(function(je,Qt){var mt=b[je.id],Ue=b[Qt.id];return mt<Ue?-1:mt>Ue?1:0});for(var pe=0,Ce=fe;pe<Ce.length;pe++)(s=Ce[pe])instanceof e&&r.internalContainerRefs.push(s),r.layers.push(s)}r.layersByDepth=F,Q=Object.keys(z).map(function(je){return parseInt(je,10)}).sort(yp);for(var Me=r.inputs.slice(),Te=[],Ke=0,Fe=Q;Ke<Fe.length;Ke++)for(var Xe=0,ze=z[D=Fe[Ke]];Xe<ze.length;Xe++){var Be;if((s=(Be=ze[Xe]).outboundLayer)!=null){for(var dt=0,nt=Be.inputTensors;dt<nt.length;dt++)if(N=nt[dt],Me.indexOf(N)===-1)throw new ro("Graph disconnected: cannot obtain value for tensor "+N+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+Te);for(var rn=0,Sn=Be.outputTensors;rn<Sn.length;rn++)N=Sn[rn],Me.push(N);Te.push(s.name)}}r.nodesByDepth=z;for(var Kt=r.layers.map(function(je){return je.name}),pn=function(je){var Qt=Kt.filter(function(mt){return mt===je}).length;if(Qt!==1)throw new ro('The name "'+je+'" is used '+Qt+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(Kt))},xt=0,Ut=Kt;xt<Ut.length;xt++)pn(Ut[xt]);return r.outboundNodes=[],r.inboundNodes=[],new Qv({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map(function(je){return null}),outputMasks:r.outputs.map(function(je){return null}),inputShapes:r.inputs.map(function(je){return je.shape}),outputShapes:r.outputs.map(function(je){return je.shape})}),r.built=!0,r._refCount=1,r}return se(e,n),e.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Container '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){this.assertNotDisposed();var t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(var r=0,i=this.layers;r<i.length;r++){var o=i[r];t.numDisposedVariables+=o.dispose().numDisposedVariables}for(var a=0,s=this.internalContainerRefs;a<s.length;a++){var u=s[a];t.numDisposedVariables+=u.dispose().numDisposedVariables}}return t.refCountAfterDispose=this._refCount,t},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.layers.forEach(function(r){r._trainableWeights.forEach(function(i){return i.trainable=t})}),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new K("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var t=[],r=0,i=this.layers;r<i.length;r++){var o=i[r];t=t.concat(o.trainableWeights)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],r=0,i=this.layers;r<i.length;r++){var o=i[r];t.push.apply(t,o.nonTrainableWeights)}if(!this.trainable){for(var a=[],s=0,u=this.layers;s<u.length;s++)o=u[s],a.push.apply(a,o.trainableWeights);return a.concat(t)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.loadWeights=function(t,r){r===void 0&&(r=!0);for(var i={},o=0,a=0,s=this.layers;a<s.length;a++)for(var u=0,l=s[a].weights;u<l.length;u++){var c=l[u];if(i[c.originalName]!=null)throw new K("Duplicate weight name: "+c.originalName);i[c.originalName]=c,o++}var h=[];for(var d in t){if(i[d]!=null)h.push([i[d],t[d]]);else if(r)throw new K("Provided weight data has no target variable: "+d);delete i[d]}if(r){var f=[];for(var m in i)f.push(m);if(f.length>0)throw new K(f.length+" of "+o+" weights are not set: "+f)}LE(h)},e.prototype.updatedConfig=function(){var t=this.getConfig(),r={};return r.className=this.getClassName(),r.config=t,r.kerasVersion="tfjs-layers "+ey,r.backend="TensorFlow.js",r},e.prototype.toJSON=function(t,r){r===void 0&&(r=!0);var i=Tw(this.updatedConfig());return r?JSON.stringify(i):i},e.prototype.call=function(t,r){var i=this;return Z(function(){t=Ft(t);for(var o=new Il,a=0;a<i.inputs.length;++a)o.add(i.inputs[a],t[a]);return Eh(i.outputs,o,r)})},e.prototype.computeMask=function(t,r){var i=this;return Z(function(){var o;return t=Ft(t),o=r==null?Tu(null,t.length):Ft(r),i.runInternalGraph(t,o)[1]})},e.prototype.computeOutputShape=function(t){var r=hg(t);if(r.length!==this.inputLayers.length)throw new K("Invalid inputShape argument "+t+": model has "+this.inputLayers.length+" tensor inputs.");for(var i={},o=0;o<r.length;o++){var a=this.inputLayers[o],s=r[o];i[C=a.name+"_0_0"]=s}var u=Object.keys(this.nodesByDepth).map(function(R){return parseInt(R,10)}).sort(yp);if(u.length>1)for(var l=0,c=u;l<c.length;l++)for(var h=c[l],d=0,f=this.nodesByDepth[h];d<f.length;d++){var m=f[d];if(a=m.outboundLayer,this.inputLayers.map(function(R){return R.id}).indexOf(a.id)===-1){for(var v=[],y=0;y<m.inboundLayers.length;y++){var g=m.inboundLayers[y],w=m.nodeIndices[y],b=m.tensorIndices[y],S=i[C=g.name+"_"+w+"_"+b];v.push(S)}var E=hg(a.computeOutputShape(cr(v))),T=a.inboundNodes.indexOf(m);for(y=0;y<E.length;y++)i[C=a.name+"_"+T+"_"+y]=E[y]}}var _=[],x=[];for(o=0;o<this.outputLayers.length;o++){a=this.outputLayers[o],T=this.outputLayersNodeIndices[o],b=this.outputLayersTensorIndices[o];var C=a.name+"_"+T+"_"+b;x.push(C)}for(o=0;o<x.length;o++){var N=x[o];Zi(N in i),_.push(i[N])}return cr(_)},e.prototype.runInternalGraph=function(t,r){r==null&&(r=Tu(null,t.length));for(var i={},o=0;o<this.inputs.length;++o){var a=this.inputs[o],s=t[o],u=r[o];i[a.id]=[s,u]}for(var l=0,c=Object.keys(this.nodesByDepth).map(function(F){return parseInt(F,10)}).sort(yp);l<c.length;l++)for(var h=c[l],d=0,f=this.nodesByDepth[h];d<f.length;d++){for(var m=f[d],v=m.outboundLayer,y=m.inputTensors,g=m.outputTensors,w=new Array,b=0,S=y;b<S.length;b++)(a=S[b]).id in i&&w.push(i[a.id]);if(w.length===y.length){var E={},T=void 0,_=void 0,x=void 0,C=void 0;if(m.callArgs!=null&&(E=m.callArgs),w.length===1){var N=w[0],R=N[0],k=N[1];E.mask==null&&(E.mask=k),x=Ft(v.call(R,E)),C=Ft(v.computeMask(R,k)),T=[R],_=[k]}else T=w.map(function(F){return F[0]}),_=w.map(function(F){return F[1]}),E.mask==null&&(E.mask=_),x=Ft(v.call(T,E)),C=Ft(v.computeMask(T,_));if(v.activityRegularizer)throw new et("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(o=0;o<g.length;++o)a=g[o],s=x[o],u=C[o],i[a.id]=[s,u]}}for(var D=[],W=[],U=[],j=0,H=this.outputs;j<H.length;j++){Zi((a=H[j]).id in i,"Could not compute output "+a.name+" : "+a.id);var z=i[a.id],q=z[0];u=z[1],U.push(q.shape),D.push(q),W.push(u)}return[D,W,U]},e.prototype.buildNodeConversionMap=function(t){for(var r,i={},o=0,a=this.layers;o<a.length;o++){var s=a[o];r=s instanceof e?1:0;for(var u=0;u<s.inboundNodes.length;u++){var l=e.nodeKey(s,u);this.containerNodes.has(l)&&(i[l]=r,r+=1)}}return i},e.prototype.getLayer=function(t,r){if(r!=null){if(this.layers.length<=r)throw new K("Was asked to retrieve layer at index "+r+", but model only has "+this.layers.length+" layer(s).");return this.layers[r]}if(t==null)throw new K("Provide either a layer name or layer index");for(var i=0,o=this.layers;i<o.length;i++){var a=o[i];if(a.name===t)return a}throw new K("No such layer: "+t)},e.prototype.calculateLosses=function(){var t=this;return Z(function(){for(var r=[],i=0,o=t.layers;i<o.length;i++)for(var a=o[i],s=0;s<a.inboundNodes.length;++s){var u=e.nodeKey(a,s);t.containerNodes.has(u)&&r.push.apply(r,a.calculateLosses())}return r})},e.prototype.getConfig=function(){for(var t={name:this.name},r=this.buildNodeConversionMap(this.layers),i=[],o=0,a=this.layers;o<a.length;o++){for(var s=(E=a[o]).getClassName(),u=E.getConfig(),l=[],c=0;c<E.inboundNodes.length;c++){var h=E.inboundNodes[c],d=e.nodeKey(E,c),f={};if(this.containerNodes.has(d)){if(h.callArgs)try{JSON.stringify(h.callArgs),f=h.callArgs}catch{console.warn("Layer "+E.name+" was passed non-serializable keyword arguments: "+h.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),f={}}if(h.inboundLayers.length>0){for(var m=[],v=0;v<h.inboundLayers.length;v++){var y=h.inboundLayers[v],g=h.nodeIndices[v],w=h.tensorIndices[v];(_=r[e.nodeKey(y,g)])==null&&(_=0),m.push([y.name,_,w,f])}l.push(m)}}}var b={};b.name=E.name,b.className=s,b.config=u,b.inboundNodes=l,i.push(b)}t.layers=i;var S=[];for(v=0;v<this.inputLayers.length;v++){var E=this.inputLayers[v];g=this.inputLayersNodeIndices[v],d=e.nodeKey(E,g),this.containerNodes.has(d)&&((_=r[d])!==null&&_!==void 0||(_=0),w=this.inputLayersTensorIndices[v],S.push([E.name,_,w]))}t.inputLayers=S;var T=[];for(v=0;v<this.outputLayers.length;v++)if(E=this.outputLayers[v],g=this.outputLayersNodeIndices[v],d=e.nodeKey(E,g),this.containerNodes.has(d)){var _;(_=r[d])!==null&&_!==void 0||(_=0),w=this.outputLayersTensorIndices[v],T.push([E.name,_,w])}return t.outputLayers=T,t},e.fromConfig=function(t,r,i,o){o===void 0&&(o=!1);var a={},s={};function u(j,H){j.name in s?s[j.name].push(H):s[j.name]=[H]}function l(j,H){for(var z,q=[],F=0,oe=H;F<oe.length;F++){var Q=oe[F],ae=Q[0],me=Q[1],fe=Q[2];if(z=Q[3]==null?{}:Q[3],!(ae in a))return void u(j,H);var pe=a[ae];if(pe.inboundNodes.length<=me)return void u(j,H);var Ce=pe.inboundNodes[me];q.push(Ce.outputTensors[fe])}q.length>0&&j.apply(cr(q),z)}function c(j){var H=j.name,z=Fi(j,r.customObjects!=null?r.customObjects:{});z.setFastWeightInitDuringBuild(o),a[H]=z,j.inboundNodes.forEach(function(q){if(!(q instanceof Array))throw new K("Corrupted configuration, expected array for nodeData: "+q);u(z,q)})}for(var h=r.name,d=r.layers,f=0,m=d;f<m.length;f++)c(g=m[f]);for(;!o8(s);)for(var v=0,y=d;v<y.length;v++){var g=y[v];if((U=a[g.name]).name in s){var w=s[U.name];delete s[U.name];for(var b=0,S=w;b<S.length;b++)l(U,S[b])}}for(var E=[],T=[],_=0,x=r.inputLayers;_<x.length;_++){var C=(g=x[_])[0],N=g[1],R=g[2];Zi(C in a);var k=(U=a[C]).inboundNodes[N].outputTensors;E.push(k[R])}for(var D=0,W=r.outputLayers;D<W.length;D++){C=(g=W[D])[0],N=g[1],R=g[2],Zi(C in a);var U;k=(U=a[C]).inboundNodes[N].outputTensors,T.push(k[R])}return new t({inputs:E,outputs:T,name:h})},Object.defineProperty(e.prototype,"stateful",{get:function(){if(this._stateful)throw new K("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var t=0,r=this.layers;t<r.length;t++)if(r[t].stateful)return!0;return!1},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){var t=this;Z(function(){t.layers.forEach(function(r){r.stateful&&r.resetStates()})})},e}(ht);function RK(n,e,t){var r=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(function(o){return null});if(r===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==r)throw new Error("Provided "+t+" is an array of "+n.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return n}if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){var i=[];return e.forEach(function(o){o in n?i.push(n[o]):i.push(null)}),i}throw new Error("The model has multiple ("+r+") outputs, so "+t+" must be either an array with "+r+" elements or an object with "+e+" keys. Provided "+t+" not understood: "+JSON.stringify(n))}function CL(n,e){return RK(n,e,"classWeight")}function SL(n,e,t,r){return $e(this,void 0,void 0,function(){var i,o,a,s,u;return Pe(this,function(l){switch(l.label){case 0:return t==null?[3,2]:(i=Z(function(){if(n.shape.length===1)return n.clone();if(n.shape.length===2){if(n.shape[1]>1)return n.argMax(1);if(n.shape[1]===1)return n.reshape([n.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+n.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+n.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),s=(a=Array).from,[4,i.data()]);case 1:return o=s.apply(a,[l.sent()]),Ze(i),u=[],o.forEach(function(c){if(t[c]==null)throw new Error("classWeight must contain all classes in the training data. The class "+c+" exists in the data but not in classWeight");u.push(t[c])}),[2,Or(u,"float32")];case 2:return[2,null]}})})}function AK(n,e){return He(n,e)}var DK=32;function IL(n,e){var t,r,i=e;t=i.xs,r=i.ys,De.assert(t!=null&&r!=null,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+e});var o=NN("input",n.inputNames,t),a=NN("output",n.outputNames,r),s=o[0].shape[0];De.assert(o.length===n.inputs.length,function(){return"LayersModel has "+n.inputs.length+" inputs, but the dataset provides "+o.length+" inputs.  (Expected input keys: "+JSON.stringify(n.inputNames)+")"}),De.assert(a.length===n.outputs.length,function(){return"LayersModel has "+n.outputs.length+" outputs, but the dataset provides "+a.length+" outputs.  (Expected output keys: "+JSON.stringify(n.outputNames)+")"});var u=function(d){De.assert(o[d].shape[0]===s,function(){return"Batch size mismatch: input "+n.inputNames[d]+" has "+o[d].shape[0]+"; expected  "+s+" based on input "+n.inputNames[0]+"."})};for(var l in o)u(l);var c=function(d){De.assert(a[d].shape[0]===s,function(){return"Batch size mismatch: output "+n.outputNames[d]+" has "+a[d].shape[0]+"; expected  "+s+" based on input "+n.inputNames[0]+"."})};for(var h in a)c(h);return{xs:o,ys:a}}function NN(n,e,t){if(t instanceof Nt)return[t];if(Array.isArray(t))return De.assert(t.length===e.length,function(){return"Received an array of "+t.length+" Tensors, but expected "+e.length+" to match the "+n+" keys "+e+"."}),t;for(var r=[],i=0,o=e;i<o.length;i++){var a=o[i];if(t[a]==null)throw new K("The feature data generated by the dataset lacks the required "+n+" key '"+a+"'.");r.push(t[a])}return r}function OK(n){if(n.length===3)throw new et("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}function PK(n,e,t){return $e(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h,d,f,m,v,y,g,w,b,S,E,T,_,x,C,N,R,k,D,W,U,j,H,z,q,F;return Pe(this,function(oe){switch(oe.label){case 0:if(r=t.batchesPerEpoch!=null,De.assert(n.optimizer!=null,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),De.assert(t!=null,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),De.assert(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+t.epochs}),De.assert(!r||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+t.batchesPerEpoch}),De.assert(t.validationSplit==null,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0,oe.label=1;case 1:return oe.trys.push([1,,26,27]),i=t.validationData!=null,o=void 0,a=void 0,i&&(TN(t.validationData)?De.assert(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+t.validationBatches}):(s=OK(t.validationData),o=s.xs,a=s.ys)),u=n.makeTrainFunction(),l=n.getDedupedMetricsNames(),c=void 0,c=i?l.slice().concat(l.map(function(Q){return"val_"+Q})):l.slice(),h=mL(t.callbacks,t.yieldEvery),d=t.verbose==null?1:t.verbose,f=vL(h,d,t.epochs,null,null,MK(e,t),null,i,c),m=f.callbackList,v=f.history,m.setModel(n),n.history=v,[4,m.onTrainBegin()];case 2:return oe.sent(),n.stopTraining_=!1,y=t.initialEpoch==null?0:t.initialEpoch,[4,e.iterator()];case 3:g=oe.sent(),oe.label=4;case 4:return y<t.epochs?(w={},[4,m.onEpochBegin(y)]):[3,23];case 5:return oe.sent(),b=0,S=0,r?[3,7]:[4,e.iterator()];case 6:g=oe.sent(),oe.label=7;case 7:return!r||b<t.batchesPerEpoch?[4,g.next()]:[3,21];case 8:return E=oe.sent(),r&&E.done?(console.warn("You provided `batchesPerEpoch` as "+t.batchesPerEpoch+", but your dataset iterator ran out of data after "+b+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+t.batchesPerEpoch*t.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):E.value==null?[3,15]:(T=IL(n,E.value),_=T.xs,x=T.ys,(C={}).batch=S,C.size=_[0].shape[0],[4,m.onBatchBegin(S,C)]);case 9:if(oe.sent(),N=[],t.classWeight==null)return[3,13];R=CL(t.classWeight,n.outputNames),F=0,oe.label=10;case 10:return F<R.length?(D=(k=N).push,[4,SL(x[F],null,R[F])]):[3,13];case 11:D.apply(k,[oe.sent()]),oe.label=12;case 12:return++F,[3,10];case 13:for(W=_.concat(x).concat(N),U=u(W),Ze(W),F=0;F<l.length;++F)j=l[F],H=U[F],C[j]=H,ho(H);return[4,m.onBatchEnd(S,C)];case 14:oe.sent(),hL(C),S++,b++,oe.label=15;case 15:return(r?b>=t.batchesPerEpoch:E.done)?i?(z=void 0,TN(t.validationData)?(q=Ft,[4,n.evaluateDataset(t.validationData,{batches:t.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return z=q.apply(void 0,[oe.sent()]),[3,18];case 17:z=Ft(n.evaluate(o,a,{batchSize:t.validationBatchSize==null?DK:t.validationBatchSize,verbose:0})),oe.label=18;case 18:for(F=0;F<n.metricsNames.length;++F)w["val_"+n.metricsNames[F]]=z[F];oe.label=19;case 19:return[3,21];case 20:return n.stopTraining_?[3,21]:[3,7];case 21:return[4,m.onEpochEnd(y,w)];case 22:return oe.sent(),y++,n.stopTraining_?[3,23]:[3,4];case 23:return[4,m.onTrainEnd()];case 24:return oe.sent(),[4,n.history.syncData()];case 25:return oe.sent(),[2,n.history];case 26:return n.isTraining=!1,[7];case 27:return[2]}})})}function MK(n,e){var t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function TN(n){return typeof n.iterator=="function"}function LK(n){return typeof n.next=="function"}function FK(n,e,t){return $e(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h,d;return Pe(this,function(f){switch(f.label){case 0:if(r=(t=t||{}).batches!=null,i=n.testFunction,o=[],t.verbose>0)throw new et("Verbose mode is not implemented yet.");return De.assert(!r||t.batches>0&&Number.isInteger(t.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(t.batches)}),LK(e)?(s=e,[3,3]):[3,1];case 1:return[4,e.iterator()];case 2:s=f.sent(),f.label=3;case 3:a=s,u=0,l=0,c=function(){var m;return Pe(this,function(v){switch(v.label){case 0:return[4,a.next()];case 1:return m=v.sent(),o=Z(function(){if(m.value){var y=IL(n,m.value),g=y.xs,w=y.ys,b=g.concat(w),S=Z(function(){return i(b)});if(Ze(b),l===0)for(var E=0;E<S.length;++E)o.push(Ee(0));var T=b[0].shape[0],_=function(x){var C=S[x],N=o[x];o[x]=Z(function(){return ot(o[x],He(T,C))}),l>0&&Ze(N)};for(E=0;E<S.length;++E)_(E);Ze(S),u+=T,++l}return o}),m.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+t.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},f.label=4;case 4:return!r||l<t.batches?[5,c()]:[3,6];case 5:return f.sent()==="break"?[3,6]:[3,4];case 6:for(h=0;h<o.length;++h)d=o[h],o[h]=sr(o[h],u),Ze(d);return[2,cr(o)]}})})}function kw(n){De.assert(n>0&&Number.isInteger(n),function(){return"batchSize is required to be a positive integer, but got "+n})}function Ch(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(function(r){return du(r,e,t-e)}):du(n,e,t-e)}function UE(n,e){return Z(function(){return n==null?null:Array.isArray(n)?n.map(function(t){return UE(t,e)}):JM(n,e.dtype==="int32"?e:e.toInt())})}function Rw(n,e){for(var t=[],r=0,i=null;r<n;)(i=r+e)>=n&&(i=n),t.push([r,i]),r=i;return t}function zK(n,e,t,r,i,o,a,s,u,l,c,h,d,f,m){return $e(this,void 0,void 0,function(){var v,y,g,w,b,S,E,T;return Pe(this,function(_){switch(_.label){case 0:return i==null&&(i=32),o==null&&(o=1),c==null&&(c=!0),d==null&&(d=0),v=!1,u!=null&&l!=null&&(v=!0),m!=null,(y=n.checkNumSamples(t,i,f,"steps_per_epoch"))!=null&&(g=Vi(0,y)),a==null&&(a=1),w=vL(s,a,o,d,y,f,i,v,h),b=w.callbackList,S=w.history,b.setModel(n),n.history=S,[4,b.onTrainBegin()];case 1:_.sent(),n.stopTraining_=!1,E=function(x){var C,N,R,k,D;return Pe(this,function(W){switch(W.label){case 0:return[4,b.onEpochBegin(x)];case 1:if(W.sent(),C={},f==null)return[3,2];case 2:if(c==="batch")throw new et("batch shuffling is not implemneted yet");c&&De.shuffle(g),N=Or(g),R=Rw(y,i),k=function(U){var j;return Pe(this,function(H){switch(H.label){case 0:return j={},[4,b.onBatchBegin(U,j)];case 1:return H.sent(),Z(function(){var z=R[U][0],q=R[U][1],F=du(N,z,q-z);j.batch=U,j.size=q-z;for(var oe=UE(t,F),Q=e(oe),ae=0;ae<r.length;++ae){var me=r[ae],fe=Q[ae];j[me]=fe,ho(fe)}if(U===R.length-1&&v){var pe=n.testLoop(u,l,i);for(ae=0;ae<r.length;++ae)me=r[ae],fe=pe[ae],ho(fe),C["val_"+me]=fe}}),[4,b.onBatchEnd(U,j)];case 2:return H.sent(),hL(j),n.stopTraining_?[2,"break"]:[2]}})},D=0,W.label=3;case 3:return D<R.length?[5,k(D)]:[3,6];case 4:if(W.sent()==="break")return[3,6];W.label=5;case 5:return++D,[3,3];case 6:N.dispose(),W.label=7;case 7:return[4,b.onEpochEnd(x,C)];case 8:return W.sent(),n.stopTraining_?[2,"break"]:[2]}})},T=d,_.label=2;case 2:return T<o?[5,E(T)]:[3,5];case 3:if(_.sent()==="break")return[3,5];_.label=4;case 4:return++T,[3,2];case 5:return[4,b.onTrainEnd()];case 6:return _.sent(),[4,n.history.syncData()];case 7:return _.sent(),[2,n.history]}})})}function BK(n,e,t,r){return r===void 0&&(r={}),$e(this,void 0,void 0,function(){var i,o,a,s,u,l,c,h,d,f,m,v,y,g,w,b,S,E,T,_,x,C;return Pe(this,function(N){switch(N.label){case 0:if(n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0,N.label=1;case 1:return N.trys.push([1,,7,8]),kw(h=r.batchSize==null?32:r.batchSize),d=!1,[4,n.standardizeUserData(e,t,r.sampleWeight,r.classWeight,d,h)];case 2:if(f=N.sent(),i=f[0],o=f[1],c=f[2],m=!1,v=void 0,!(r.validationData!=null&&r.validationData.length>0))return[3,4];if(m=!0,r.validationData.length!==2)throw r.validationData.length===3?new et("validationData including sample weights is not supported yet."):new K("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return a=r.validationData[0],s=r.validationData[1],y=!0,[4,n.standardizeUserData(a,s,null,null,y,h)];case 3:return g=N.sent(),u=g[0],l=g[1],v=u.concat(l),[3,5];case 4:r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1?(m=!0,w=Math.floor(i[0].shape[0]*(1-r.validationSplit)),b=i[0].shape[0],u=Ch(i,w,b),i=Ch(i,0,w),l=Ch(o,w,b),o=Ch(o,0,w),v=u.concat(l)):r.validationSteps!=null&&(m=!0),N.label=5;case 5:return S=i.concat(o).concat(c),n.checkTrainableWeightsConsistency(),E=n.makeTrainFunction(),T=n.getDedupedMetricsNames(),_=void 0,x=void 0,m?(n.makeTestFunction(),_=n.testFunction,x=T.slice().concat(T.map(function(R){return"val_"+R}))):(_=null,v=[],x=T.slice()),C=mL(r.callbacks,r.yieldEvery),[4,zK(n,E,S,T,h,r.epochs,r.verbose,C,_,v,r.shuffle,x,r.initialEpoch,null,null)];case 6:return[2,N.sent()];case 7:return n.isTraining=!1,ou(i,e),ou(o,t),ou(u,a),ou(l,s),c!=null&&Ze(c),[7];case 8:return[2]}})})}function NL(n){var e=[];n instanceof Nt&&(n=[n]);for(var t=0;t<n.length;++t){var r=n[t];if(r.rank===1)e.push(Ef(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function ou(n,e){if(n!=null){var t=[];if(e instanceof Nt)t.push(e.id);else if(Array.isArray(e))e.forEach(function(u){return t.push(u.id)});else if(e!=null)for(var r in e){var i=e[r];t.push(i.id)}var o=[];if(n instanceof Nt)t.indexOf(n.id)===-1&&o.push(n);else if(Array.isArray(n))n.forEach(function(u){t.indexOf(u.id)===-1&&o.push(u)});else if(n!=null)for(var a in n){var s=n[a];t.indexOf(s.id)===-1&&o.push(s)}o.forEach(function(u){u.isDisposed||u.dispose()})}}function jK(n){return n instanceof Nt}function Aw(n){return Array.isArray(n)}function kN(n){return!jK(n)&&!Aw(n)}function RN(n,e,t,r,i){if(i===void 0&&(i=""),e==null||e.length===0){if(n!=null){var o=!1;if(Aw(n)&&n.length>0)o=!0;else if(kN(n)){for(var a in n)if(n.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new K("Error when checking model "+i+" expected no data, but got "+n)}return[]}if(n==null)return e.map(function(y){return null});var s;if(kN(n)){n=n,s=[];for(var u=0,l=e;u<l.length;u++){var c=l[u];if(n[c]==null)throw new K('No data provided for "'+c+'". Need data for each key in: '+e);s.push(n[c])}}else if(Aw(n)){if((n=n).length!==e.length)throw new K("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+e.length+" Tensor(s), but instead got the following list of Tensor(s): "+n);s=n}else{if(n=n,e.length>1)throw new K("The model "+i+" expects "+e.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+n.shape);s=[n]}if(s=NL(s),t!=null){for(var h=0;h<e.length;++h)if(t[h]!=null){var d=s[h];if(d.shape.length!==t[h].length)throw new K("Error when checking "+i+": expected "+e[h]+" to have "+t[h].length+" dimension(s). but got array with shape "+d.shape);for(var f=0;f<t[h].length;++f)if(f!==0||r){var m=d.shape[f],v=t[h][f];if(v!=null&&v>=0&&m!==v)throw new K("Error when checking "+i+": expected "+e[h]+" to have shape ["+t[h]+"], but got array with shape ["+d.shape+"].")}}}return s}function UK(n,e,t){var r=as(n.map(function(o){return o.shape[0]}));r.sort();var i=as(e.map(function(o){return o.shape[0]}));if(i.sort(),r.length>1)throw new K("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(n.map(function(o){return o.shape})));if(i.length>1)throw new K("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(function(o){return o.shape})));if(r.length>0&&i.length>0&&!De.arraysEqual(r,i))throw new K("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+i[0]+" target sample(s).")}function WK(n,e,t){for(var r=[Gu,Zv,Pd],i=0;i<n.length;++i){var o=n[i],a=e[i],s=t[i];if(a!=null){if(a===Pd&&o.shape[o.shape.length-1]===1)throw new K("You are passing a target array of shape "+o.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(r.indexOf(a)!==-1)for(var u=o.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var h=u[c],d=l[c];if(d!=null&&h!==d)throw new K("A target Tensor with shape "+o.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}function AN(n,e,t,r,i){var o;if(r===void 0&&(r=!0),i===void 0&&(i=""),Array.isArray(n)){if(n.length!==e.length)throw new K("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+e.length+" Tensor(s), but instead got "+n.length+" Tensors(s).");o=n}else{if(e.length>1)throw new K("The model expects "+e.length+" "+i+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(n.shape)+".");o=[n]}if(t!=null){for(var a=0;a<e.length;++a)if(t[a]!=null){var s=o[a];if(s.shape.length!==t[a].length)throw new K("Error when checking "+i+": expected "+e[a]+" to have "+t[a].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var u=0;u<t[a].length;++u)if(u!==0||r){var l=s.shape[u],c=t[a][u];if(c!=null&&c!==l)throw new K("Error when checking "+i+": expected "+e[a]+" to have shape "+JSON.stringify(t[a])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}}function VK(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(function(u){return[]});var t;if(typeof n=="string"||typeof n=="function")t=[n];else{if(!Array.isArray(n)&&typeof n!="object")throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+n);t=n}if(Array.isArray(t))return e.map(function(u){return t});for(var r=[],i=0,o=e;i<o.length;i++){var a=o[i],s=t.hasOwnProperty(a)?t[a]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}var $K="layers-model",fu=function(n){function e(t){var r=n.call(this,t)||this;return r.isTraining=!1,r}return se(e,n),e.prototype.summary=function(t,r,i){if(i===void 0&&(i=console.log),!this.built)throw new K("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");bK(this,t,r,i)},e.prototype.compile=function(t){var r=this;if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=wK(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof pa))throw new K("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}var i=[];if(Array.isArray(t.loss)||typeof t.loss=="string"||typeof t.loss=="function")if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new K("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+t.loss+".");var o=t.loss;i=o.map(function(y){return S0(y)})}else{var a=S0(t.loss);this.outputs.forEach(function(y){i.push(a)})}else{for(var s in t.loss=t.loss,t.loss)if(this.outputNames.indexOf(s)===-1)throw new K('Unknown entry in loss dictionary: "'+s+'". Only expected the following keys: '+this.outputNames);for(var u=0,l=this.outputNames;u<l.length;u++){var c=l[u];t.loss[c]==null&&console.warn('Output "'+c+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+c+" during training"),i.push(S0(t.loss[c]))}}this.lossFunctions=i,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var h=0;h<this.outputs.length;++h){var d=this.internalOutputShapes[h],f=this.outputNames[h];this.feedOutputNames.push(f),this.feedOutputShapes.push(d),this.feedLossFns.push(this.lossFunctions[h])}var m=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],hu("loss",function(){for(var y=0;y<r.outputs.length;++y)if(m.indexOf(y)===-1){var g=r.lossFunctions[y];r.outputs.length>1&&(r.metricsTensors.push([g,y]),r.metricsNames.push(r.outputNames[y]+"_loss"))}});var v=VK(t.metrics,this.outputNames);hu("metric",function(){for(var y=function(w){if(m.indexOf(w)!==-1)return"continue";(function(b){for(var S,E,T,_=function(N){if(typeof N=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(N)!==-1){var R=r.internalOutputShapes[w];R[R.length-1]===1||r.lossFunctions[w]===Zv?["accuracy","acc"].indexOf(N)!==-1?E=zE:["crossentropy","ce"].indexOf(N)!==-1&&(E=bL):r.lossFunctions[w]===pg?["accuracy","acc"].indexOf(N)!==-1?E=xL:["crossentropy","ce"].indexOf(N)!==-1&&(E=_L):["accuracy","acc"].indexOf(N)!==-1?E=BE:["crossentropy","ce"].indexOf(N)!==-1&&(E=jE);var k=void 0;["accuracy","acc"].indexOf(N)!==-1?k="acc":["crossentropy","ce"].indexOf(N)!==-1&&(k="ce"),T=E,S=""+k}else{var D=yK(N);T=D,S=""+xp(N)}var W;hu(S,function(){W=T}),function(U,j,H){r.outputNames.length>1&&(j=r.outputNames[U]+"_"+j),r.metricsNames.push(j),r.metricsTensors.push([H,U])}(w,S,W)},x=0,C=b;x<C.length;x++)_(C[x])})(v[w])},g=0;g<r.outputs.length;++g)y(g)}),this.collectedTrainableWeights=this.trainableWeights},e.prototype.checkTrainableWeightsConsistency=function(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},e.prototype.evaluate=function(t,r,i){i===void 0&&(i={});var o=i.batchSize==null?32:i.batchSize;kw(o);var a=this.standardizeUserDataXY(t,r,!0,o);try{var s=a[0].concat(a[1]);this.makeTestFunction();var u=this.testFunction;return cr(this.testLoop(u,s,o,i.verbose,i.steps))}finally{ou(a[0],t),ou(a[1],r)}},e.prototype.evaluateDataset=function(t,r){return $e(this,void 0,void 0,function(){return Pe(this,function(i){return this.makeTestFunction(),[2,FK(this,t,r)]})})},e.prototype.checkNumSamples=function(t,r,i,o){var a;if(o===void 0&&(o="steps"),i!=null){if(a=null,r!=null)throw new K("If "+o+" is set, batchSize must be null or undefined.Got batchSize = "+r)}else{if(t==null)throw new K("Either the input data should have a defined shape, or "+o+" shoud be specified.");a=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return a},e.prototype.execute=function(t,r){if(Array.isArray(r)&&r.length===0)throw new K("`outputs` is an empty Array, which is not allowed.");var i=Array.isArray(r),o=i?r:[r],a=this.retrieveSymbolicTensors(o),s=new Il;if(t instanceof Nt&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new K("The number of inputs provided ("+t.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var u=0;u<this.inputs.length;++u)s.add(this.inputs[u],t[u])}else for(var l=0,c=this.inputs;l<c.length;l++){var h=c[l],d=t[h.name];if(d==null)throw new K("No value is provided for the model's input "+h.name);s.add(h,d)}var f=Eh(a,s);return i?f:f[0]},e.prototype.retrieveSymbolicTensors=function(t){for(var r=Tu(null,t.length),i=t.length,o=0,a=this.layers;o<a.length;o++){for(var s=a[o],u=Array.isArray(s.output)?s.output:[s.output],l=u.map(function(f){return f.name}),c=0;c<t.length;++c){var h=l.indexOf(t[c]);if(h!==-1&&(r[c]=u[h],i--),i===0)break}if(i===0)break}if(i>0){var d=[];throw r.forEach(function(f,m){f==null&&d.push(t[m])}),new K("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(d))}return r},e.prototype.predictLoop=function(t,r,i){var o=this;return r===void 0&&(r=32),i===void 0&&(i=!1),Z(function(){var a=o.checkNumSamples(t);if(i)throw new et("Verbose predictLoop() is not implemented yet.");for(var s=Rw(a,r),u=o.outputs.map(function(h){return[]}),l=function(h){Z(function(){var d=s[h][0],f=s[h][1],m=Ch(t,d,f),v=[];if(Array.isArray(m))for(var y=0;y<m.length;++y)v.push({key:o.inputs[y],value:m[y]});else v.push({key:o.inputs[0],value:m});var g=new Il(v);return Eh(o.outputs,g)}).forEach(function(d,f){return u[f].push(d)})},c=0;c<s.length;++c)l(c);return cr(u.map(function(h){return ar(h,0)}))})},e.prototype.predict=function(t,r){r===void 0&&(r={});var i=NL(t);AN(i,this.inputNames,this.feedInputShapes,!1);try{var o=r.batchSize==null?32:r.batchSize;return kw(o),this.predictLoop(i,o)}finally{ou(i,t)}},e.prototype.predictOnBatch=function(t){AN(t,this.inputNames,this.feedInputShapes,!0);var r=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,r)},e.prototype.standardizeUserDataXY=function(t,r,i,o){if(this.optimizer_==null)throw new ro("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var a=[],s=0;s<this.feedOutputShapes.length;++s){var u=this.feedOutputShapes[s];this.feedLossFns[s]===pg?a.push(u.slice(0,u.length-1).concat([1])):a.push(u)}if(UK(t=RN(t,this.feedInputNames,this.feedInputShapes,!1,"input"),r=RN(r,this.feedOutputNames,a,!1,"target")),WK(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&o!=null&&o>0&&t[0].shape[0]%o!=0)throw new K("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+o+". Found: "+t[0].shape[0]+" sample(s).");return[t,r]},e.prototype.standardizeUserData=function(t,r,i,o,a,s){return a===void 0&&(a=!0),$e(this,void 0,void 0,function(){var u,l,c,h,d,f,m,v;return Pe(this,function(y){switch(y.label){case 0:if(u=this.standardizeUserDataXY(t,r,a,s),l=u[0],c=u[1],i!=null)throw new Error("sample weight is not supported yet.");if(h=null,o==null)return[3,4];d=CL(o,this.outputNames),h=[],f=0,y.label=1;case 1:return f<d.length?(v=(m=h).push,[4,SL(c[f],null,d[f])]):[3,4];case 2:v.apply(m,[y.sent()]),y.label=3;case 3:return++f,[3,1];case 4:return[2,[l,c,h]]}})})},e.prototype.testLoop=function(t,r,i,o,a){var s=this;return o===void 0&&(o=0),Z(function(){var u=s.checkNumSamples(r,i,a,"steps"),l=[];if(o>0)throw new et("Verbose mode is not implemented yet.");if(a!=null)throw new et("steps mode in testLoop() is not implemented yet");for(var c=Rw(u,i),h=Or(Vi(0,u)),d=0;d<c.length;++d){var f=c[d][0],m=c[d][1],v=du(h,f,m-f),y=UE(r,v),g=t(y);if(d===0)for(var w=0;w<g.length;++w)l.push(Ee(0));for(w=0;w<g.length;++w){var b=g[w];l[w]=ot(l[w],He(m-f,b))}}for(w=0;w<l.length;++w)l[w]=sr(l[w],u);return l})},e.prototype.getDedupedMetricsNames=function(){for(var t=this.metricsNames,r=[],i=0;i<t.length;++i){var o=t[i],a=o;pN(t,o)>1&&(a+="_"+pN(t.slice(0,i),o)),r.push(a)}return r},e.prototype.makeTrainFunction=function(){var t=this;return function(r){var i=[],o=r.slice(0,t.inputs.length),a=r.slice(t.inputs.length,t.inputs.length+t.outputs.length),s=r.slice(t.inputs.length+t.outputs.length,t.inputs.length+2*t.outputs.length),u=[],l=t.collectedTrainableWeights.map(function(c){return c.read()});return[t.optimizer_.minimize(function(){for(var c=[],h=0;h<t.inputs.length;++h)c.push({key:t.inputs[h],value:o[h]});var d,f=new Il(c),m=Eh(t.outputs,f,{training:!0});for(h=0;h<t.lossFunctions.length;++h){var v=(0,t.lossFunctions[h])(a[h],m[h]);s[h]!=null&&(v=AK(v,s[h]));var y=yn(v);i.push(y),d=h===0?v:ot(d,v)}for(h=0;h<t.metricsTensors.length;++h){var g=void 0;if(t.outputs.length>1&&h<t.outputs.length)g=i[h];else{var w=t.metricsTensors[h][0],b=t.metricsTensors[h][1];g=yn(w(a[b],m[b]))}ho(g),u.push(g)}return d=yn(d),t.calculateLosses().forEach(function(S){d=ot(d,S)}),d},!0,l)].concat(u)}},e.prototype.makeTestFunction=function(){var t=this;this.testFunction=function(r){return Z(function(){for(var i,o=[],a=r.slice(0,t.inputs.length),s=r.slice(t.inputs.length,t.inputs.length+t.outputs.length),u=[],l=0;l<t.inputs.length;++l)u.push({key:t.inputs[l],value:a[l]});var c=new Il(u),h=Eh(t.outputs,c);for(l=0;l<t.lossFunctions.length;++l){var d=t.lossFunctions[l],f=yn(d(s[l],h[l]));i=l===0?f:ot(i,f),o.push(i)}for(l=0;l<t.metricsTensors.length;++l){var m=t.metricsTensors[l][0],v=t.metricsTensors[l][1],y=yn(m(s[v],h[v]));o.push(y)}return o})}},e.prototype.fit=function(t,r,i){return i===void 0&&(i={}),$e(this,void 0,void 0,function(){return Pe(this,function(o){return[2,BK(this,t,r,i)]})})},e.prototype.fitDataset=function(t,r){return $e(this,void 0,void 0,function(){return Pe(this,function(i){return[2,PK(this,t,r)]})})},e.prototype.trainOnBatch=function(t,r){return $e(this,void 0,void 0,function(){var i,o,a,s,u,l,c,h,d;return Pe(this,function(f){switch(f.label){case 0:return[4,this.standardizeUserData(t,r)];case 1:i=f.sent(),o=i[0],a=i[1],s=this.makeTrainFunction(),u=s(o.concat(a)),l=[],c=0,h=u,f.label=2;case 2:return c<h.length?[4,h[c].data()]:[3,5];case 3:d=f.sent(),l.push(d[0]),f.label=4;case 4:return c++,[3,2];case 5:return Ze(u),[2,cr(l)]}})})},e.prototype.getNamedWeights=function(t){for(var r=[],i=t!=null&&t.trainableOnly,o=i?this.trainableWeights:this.weights,a=this.getWeights(i),s=0;s<o.length;++s)i&&!o[s].trainable||r.push({name:o[s].originalName,tensor:a[s]});return r},Object.defineProperty(e.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(t){this.stopTraining_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=n.prototype.dispose.call(this);if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){var r=dw().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=r-dw().numTensors}return t},e.prototype.getLossIdentifiers=function(){var t;if(typeof this.loss=="string")t=Mo(this.loss);else if(Array.isArray(this.loss)){for(var r=0,i=this.loss;r<i.length;r++)if(typeof i[r]!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(function(c){return Mo(c)})}else{var o=Object.keys(this.loss);t={};for(var a=this.loss,s=0,u=o;s<u.length;s++){var l=u[s];if(typeof a[l]!="string")throw new Error("Serialization of non-string loss is not supported.");t[l]=Mo(a[l])}}return t},e.prototype.getMetricIdentifiers=function(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Mo(xp(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(i){return Mo(xp(i))});var t={};for(var r in this.metrics)t[r]=Mo(xp(this.metrics[r]));return t},e.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},e.prototype.loadTrainingConfig=function(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");var r,i,o=Fi(Md(t.optimizer_config));if(typeof t.loss=="string")r=Ys(t.loss);else if(Array.isArray(t.loss))r=t.loss.map(function(s){return Ys(s)});else if(t.loss!=null)for(var a in r={},t.loss)r[a]=Ys(t.loss[a]);if(Array.isArray(t.metrics))i=t.metrics.map(function(s){return Ys(s)});else if(t.metrics!=null)for(var a in i={},t.metrics)i[a]=Ys(t.metrics[a]);this.compile({loss:r,metrics:i,optimizer:o})},e.prototype.save=function(t,r){return $e(this,void 0,void 0,function(){var i,o,a,s,u,l,c,h,d,f,m,v,y,g;return Pe(this,function(w){switch(w.label){case 0:if(typeof t=="string"){if((i=Hr.getSaveHandlers(t)).length===0)throw new K("Cannot find any save handlers for URL '"+t+"'");if(i.length>1)throw new K("Found more than one ("+i.length+") save handlers for URL '"+t+"'");t=i[0]}if(t.save==null)throw new K("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,Hr.encodeWeights(this.getNamedWeights(r))];case 1:return o=w.sent(),a=!1,s=null,u=this.toJSON(s,a),l={modelTopology:u,format:$K,generatedBy:"TensorFlow.js tfjs-layers v"+ey,convertedBy:null},r!=null&&r.includeOptimizer&&this.optimizer!=null?(l.trainingConfig=this.getTrainingConfig(),c="optimizer",v=(m=Hr).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,v.apply(m,[w.sent(),c])];case 3:h=w.sent(),d=h.data,f=h.specs,(g=o.specs).push.apply(g,f),o.data=Hr.concatenateArrayBuffers([o.data,d]),w.label=4;case 4:return this.userDefinedMetadata!=null&&(y=!0,CN(this.userDefinedMetadata,this.name,y),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=o.data,l.weightSpecs=o.specs,[2,t.save(l)]}})})},e.prototype.setUserDefinedMetadata=function(t){CN(t,this.name),this.userDefinedMetadata=t},e.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},e.className="Model",e}(kK);function HK(n,e){return $e(this,void 0,void 0,function(){var t,r,i,o,a,s,u,l;return Pe(this,function(c){switch(c.label){case 0:return"modelTopology"in n||(n={modelTopology:n}),(t=(n=n).modelTopology).model_config!=null&&(t=t.model_config),r=Md(t),i=Fi(r,e),n.weightsManifest==null?[3,2]:[4,Hr.loadWeights(n.weightsManifest,n.pathPrefix,i.weights.map(function(h){return h.originalName}))];case 1:for(o=c.sent(),a={},s=0,u=i.weights;s<u.length;s++)l=u[s],a[l.originalName]=o[l.originalName];i.loadWeights(a),Ze(o),c.label=2;case 2:return[2,i]}})})}function GK(n,e){return $e(this,void 0,void 0,function(){var t;return Pe(this,function(r){if(e==null&&(e={}),typeof n=="string"){if((t=Hr.getLoadHandlers(n,e.onProgress)).length===0)t.push(Hr.browserHTTPRequest(n,e));else if(t.length>1)throw new K("Found more than one ("+t.length+") load handlers for URL '"+n+"'");n=t[0]}return[2,qK(n,void 0,e)]})})}function qK(n,e,t){return $e(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h;return Pe(this,function(d){switch(d.label){case 0:if(t==null&&(t={}),n.load==null)throw new K("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,n.load()];case 1:if(r=d.sent(),(i=r.modelTopology).model_config!=null&&(i=i.model_config),o=t.strict==null||t.strict,a=r.weightData!=null&&r.weightSpecs!=null&&o,s=Fi(Md(i),e,a),(u=r.trainingConfig)!=null&&s.loadTrainingConfig(u),r.userDefinedMetadata!=null&&s.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData==null)return[3,4];if(r.weightSpecs==null)throw new K("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return l=KK(r.weightData,r.weightSpecs),c=l.modelWeights,h=l.optimizerWeights,s.loadWeights(c,o),s.optimizer!=null&&h.length>0?[4,s.optimizer.setWeights(h)]:[3,3];case 2:d.sent(),d.label=3;case 3:Ze(c),Ze(h.map(function(f){return f.tensor})),d.label=4;case 4:return[2,s]}})})}function KK(n,e){var t=Hr.decodeWeights(n,e),r={},i=[];return e.forEach(function(o){o.group==="optimizer"?i.push({name:o.name,tensor:t[o.name]}):r[o.name]=t[o.name]}),{modelWeights:r,optimizerWeights:i}}ce.registerClass(fu);var WE=function(n){function e(t){var r=n.call(this,{inputs:[],outputs:[]})||this;if(t=t||{},r.trainable=!0,r.built=!1,r.name=t.name!=null?t.name:Yv("sequential_"),t.layers!=null)for(var i=0,o=t.layers;i<o.length;i++){var a=o[i];r.add(a)}return r}return se(e,n),e.prototype.checkShape=function(t){if(t.inboundNodes[0].outputTensors[0].shape.some(function(r){return r<0}))throw new K("Negative dimension size caused by adding layer "+t.name+" with input shape ["+t.inboundNodes[0].inputTensors[0].shape+"]")},e.prototype.add=function(t){var r,i=t instanceof e||t instanceof fu;if(i){if((r=t).outputs.length!==1)throw new K("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new K("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new K("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var o=cL({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(o)}if(i)this.outputs=r.outputs,this.inputs=r.inputs;else{if(t.inboundNodes.length!==1)throw new K("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+t.name+" which has "+t.inboundNodes.length+" pre-existing inbound connections.");if(t.inboundNodes[0].outputTensors.length!==1)throw new K("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=lL(this.outputs[0])}this.inboundNodes=[],new Qv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Tu(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(s){return s.shape}),outputShapes:this.outputs[0].shape})}else{var a=t.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1},e.prototype.pop=function(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},e.prototype.call=function(t,r){return this.model==null&&this.build(),this.model.call(t,r)},e.prototype.build=function(t){if(Mt(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new fu({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},e.prototype.countParams=function(){return this.built||this.build(),n.prototype.countParams.call(this)},e.prototype.summary=function(t,r,i){i===void 0&&(i=console.log),this.built||this.build(),n.prototype.summary.call(this,t,r,i)},e.prototype.setWeights=function(t){this.model==null&&this.build(),this.model.setWeights(t)},e.prototype.evaluate=function(t,r,i){if(i===void 0&&(i={}),!this.built)throw new ro("The model needs to be compiled before being used.");return this.model.evaluate(t,r,i)},e.prototype.evaluateDataset=function(t,r){return $e(this,void 0,void 0,function(){return Pe(this,function(i){if(!this.built)throw new ro("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(t,r)]})})},e.prototype.predict=function(t,r){return r===void 0&&(r={}),this.model==null&&this.build(),this.model.predict(t,r)},e.prototype.predictOnBatch=function(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)},e.prototype.compile=function(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(e.prototype,"optimizer",{get:function(){return this.model==null?void 0:this.model.optimizer},set:function(t){this.model.optimizer=t},enumerable:!0,configurable:!0}),e.prototype.fit=function(t,r,i){return i===void 0&&(i={}),$e(this,void 0,void 0,function(){return Pe(this,function(o){if(!this.built)throw new ro("The model needs to be compiled before being used.");return[2,this.model.fit(t,r,i)]})})},e.prototype.fitDataset=function(t,r){return $e(this,void 0,void 0,function(){return Pe(this,function(i){if(!this.built)throw new ro("The model needs to be compiled before being used.");return[2,this.model.fitDataset(t,r)]})})},e.prototype.trainOnBatch=function(t,r){return $e(this,void 0,void 0,function(){return Pe(this,function(i){return[2,this.model.trainOnBatch(t,r)]})})},e.fromConfig=function(t,r,i,o){var a;o===void 0&&(o=!1);var s={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new K("Legacy serialization format not supported yet.");a=r}else De.assert(r.layers!=null,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),a=r.layers,delete r.layers,s=r;var u=new t(s);if(!(u instanceof e))throw new et("Sequential.fromConfig called on non-Sequential input: "+u);for(var l=0,c=a;l<c.length;l++){var h=Fi(c[l],void 0,o);o&&h.setFastWeightInitDuringBuild(!0),u.add(h)}return u},Object.defineProperty(e.prototype,"stopTraining",{get:function(){if(this.model==null)throw new K("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(t){if(this.model==null)throw new K("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){for(var t=[],r=0,i=this.layers;r<i.length;r++){var o=i[r],a={};a.className=o.getClassName(),a.config=o.getConfig(),t.push(a)}return{name:this.name,layers:t}},e.className="Sequential",e}(fu);function XK(n){return new fu(n)}function YK(n){return new WE(n)}function QK(n,e){return e==null&&(e={}),GK(n,e)}function TL(n){return cL(n)}function JK(n,e){gL.registerCallbackConstructor(n,e)}ce.registerClass(WE);var ei=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.getConfig=function(){return{}},e}(ce.Serializable),ZK=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t,r){return r===void 0&&(r=1),_8(t,r)},e.className="elu",e}(ei);ce.registerClass(ZK);var eX=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t){return Vv(t)},e.className="selu",e}(ei);ce.registerClass(eX);var tX=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t){return As(t)},e.className="relu",e}(ei);ce.registerClass(tX);var nX=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t){return Z(function(){return Rc(6,As(t))})},e.className="relu6",e}(ei);ce.registerClass(nX);var rX=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t){return t},e.className="linear",e}(ei);ce.registerClass(rX);var iX=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t){return _v(t)},e.className="sigmoid",e}(ei);ce.registerClass(iX);var oX=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t){return C8(t)},e.className="hardSigmoid",e}(ei);ce.registerClass(oX);var aX=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t){return cf(t)},e.className="softplus",e}(ei);ce.registerClass(aX);var sX=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t){return E8(t)},e.className="softsign",e}(ei);ce.registerClass(sX);var uX=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t){return Ev(t)},e.className="tanh",e}(ei);ce.registerClass(uX);var kL=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t,r){return r===void 0&&(r=-1),Wu(t,r)},e.className="softmax",e}(ei);ce.registerClass(kL);var lX=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.apply=function(t,r){return r===void 0&&(r=-1),yv(t,r)},e.className="logSoftmax",e}(ei);function Qr(n){return n.getClassName()}function N0(n,e){return e===void 0&&(e={}),bf(n,ce.SerializationMap.getMap().classNameMap,e,"activation")}function ws(n){var e;return n==null?N0(e={className:"linear",config:{}}):typeof n=="string"?((e={}).className=n,e.config={},N0(e)):n instanceof ei?n:N0(n)}function VE(n){if(n!=null&&typeof n!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+n)}ce.registerClass(lX);var RL=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e}(ce.Serializable),ty=function(n){function e(t){var r=n.call(this)||this;return VE(t),r.l1=t==null||t.l1==null?.01:t.l1,r.l2=t==null||t.l2==null?.01:t.l2,r.hasL1=r.l1!==0,r.hasL2=r.l2!==0,r}return se(e,n),e.prototype.apply=function(t){var r=this;return Z(function(){var i=St([1]);return r.hasL1&&(i=ot(i,Pr(He(r.l1,gs(t))))),r.hasL2&&(i=ot(i,Pr(He(r.l2,Cf(t))))),i.asScalar()})},e.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},e.fromConfig=function(t,r){return new t({l1:r.l1,l2:r.l2})},e.className="L1L2",e}(RL);function cX(n){return VE(n),new ty({l1:n!=null?n.l1:null,l2:0})}function hX(n){return VE(n),new ty({l2:n!=null?n.l2:null,l1:0})}ce.registerClass(ty);var DN={l1l2:"L1L2"};function tt(n){return IE(n)}function ON(n,e){return e===void 0&&(e={}),bf(n,ce.SerializationMap.getMap().classNameMap,e,"regularizer")}function qt(n){return n==null?null:typeof n=="string"?ON({className:n in DN?DN[n]:n,config:{}}):n instanceof RL?n:ON(n)}var AL=function(n){function e(t){var r=n.call(this,t??{})||this;return r.supportsMasking=!0,t!=null&&(r.maxValue=t.maxValue),r}return se(e,n),e.prototype.call=function(t,r){t=Ye(t);var i=As(t);return this.maxValue!=null&&(i=vr(i,0,this.maxValue)),i},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t={maxValue:this.maxValue},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="ReLU",e}(ht);ce.registerClass(AL);var DL=function(n){function e(t){var r=n.call(this,t??{})||this;return r.DEFAULT_ALPHA=.3,t==null&&(t={}),r.alpha=t.alpha==null?r.DEFAULT_ALPHA:t.alpha,r}return se(e,n),e.prototype.call=function(t,r){var i=Ye(t);return Uv(i,this.alpha)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t={alpha:this.alpha},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="LeakyReLU",e}(ht);ce.registerClass(DL);var OL=function(n){function e(t){var r=n.call(this,t??{})||this;if(r.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),r.supportsMasking=!0,r.alphaInitializer=Gt(t.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=qt(t.alphaRegularizer),r.alphaConstraint=_n(t.alphaConstraint),t.sharedAxes==null)r.sharedAxes=null;else if(Array.isArray(t.sharedAxes))r.sharedAxes=t.sharedAxes;else{if(typeof t.sharedAxes!="number")throw new K("Expected sharedAxes to be a number or an array of numbers, but got "+t.sharedAxes);r.sharedAxes=[t.sharedAxes]}return r}return se(e,n),e.prototype.build=function(t){var r=(t=Mt(t)).slice(1);if(this.sharedAxes!=null)for(var i=0,o=this.sharedAxes;i<o.length;i++)r[(s=o[i])-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(this.sharedAxes!=null)for(var s=1;s<t.length;++s)a[s]=t[s];this.inputSpec=[new Fn({ndim:t.length,axes:a})],this.built=!0},e.prototype.call=function(t,r){return t=Ye(t),Wv(t,this.alpha.read())},e.prototype.getConfig=function(){var t={alphaInitializer:vt(this.alphaInitializer),alphaRegularizer:tt(this.alphaRegularizer),alphaConstraint:kt(this.alphaConstraint),sharedAxes:this.sharedAxes},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="PReLU",e}(ht);ce.registerClass(OL);var PL=function(n){function e(t){var r=n.call(this,t??{})||this;if(r.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==r.DEFAULT_ALPHA)throw new et("Non-default alpha value ("+t.alpha+") is not supported by the ELU layer yet.");return r.alpha=t.alpha==null?r.DEFAULT_ALPHA:t.alpha,r}return se(e,n),e.prototype.call=function(t,r){var i=Ye(t);return Pc(i)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t={alpha:this.alpha},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="ELU",e}(ht);ce.registerClass(PL);var ML=function(n){function e(t){var r=n.call(this,t??{})||this;return r.DEFAULT_THETA=1,t==null&&(t={}),r.theta=t.theta==null?r.DEFAULT_THETA:t.theta,r}return se(e,n),e.prototype.call=function(t,r){var i=Ye(t);return i.mul(_f(i.greater(this.theta),"float32"))},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t={theta:this.theta},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="ThresholdedReLU",e}(ht);ce.registerClass(ML);var LL=function(n){function e(t){var r=n.call(this,t??{})||this;return r.DEFAULT_AXIS=1,t==null&&(t={}),r.softmax=new kL().apply,r.axis=t.axis==null?r.DEFAULT_AXIS:t.axis,r}return se(e,n),e.prototype.call=function(t,r){var i=Ye(t);return this.softmax(i,this.axis)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t={axis:this.axis},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="Softmax",e}(ht);function T0(n,e,t){if(typeof n=="number")return Tu(n,e);if(n.length!==e)throw new K("The "+t+" argument must be an integer or tuple of "+e+" integers. Received: "+n.length+" elements.");for(var r=0;r<e;++r){var i=n[r];if(!y8(i))throw new K("The "+t+" argument must be an integer or tuple of "+e+" integers. Received: "+JSON.stringify(n)+" including a non-integer number "+i)}return n}function Xo(n,e,t,r,i){return i===void 0&&(i=1),n==null?n:(o=t==="same"?n:n-(e+(e-1)*(i-1))+1,Math.floor((o+r-1)/r));var o}function _p(n,e,t,r){if(n==null)return null;if(r==="valid")n=n*e+ys([t-e,0]);else{if(r!=="same")throw new K("Unsupport padding mode: "+r+".");n*=e}return n}function $E(n,e){return Z(function(){return Cn(e),e==="channelsFirst"?Yt(n,[0,2,3,1]):n})}function FL(n,e){return Z(function(){return Cn(e),e==="channelsFirst"?Yt(n,[0,2,3,4,1]):n})}function dX(n,e,t,r,i,o,a){return r===void 0&&(r=1),i===void 0&&(i="valid"),a===void 0&&(a=1),Z(function(){if(o==null&&(o=Wi()),Cn(o),n.shape.length!==3)throw new K("The input of a conv1dWithBias operation should be 3, but is "+n.shape.length+" instead.");if(e.shape.length!==3)throw new K("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(t!=null&&t.shape.length!==1)throw new K("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if(o==="channelsFirst"&&(n=Yt(n,[0,2,1])),i==="causal")throw new et("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=kv(n,e,r,i==="same"?"same":"valid","NWC",a);return t!=null&&(s=ma(s,t)),s})}function PN(n,e,t,r,i,o,a,s){return r===void 0&&(r=[1,1]),i===void 0&&(i="valid"),s===void 0&&(s=null),Z(function(){if(o==null&&(o=Wi()),Cn(o),n.rank!==3&&n.rank!==4)throw new K("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+n.rank+".");if(e.rank!==3&&e.rank!==4)throw new K("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+n.rank+".");var u=$E(n,o);if(i==="causal")throw new et("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=lc.conv2d({x:u,filter:e,strides:r,pad:i==="same"?"same":"valid",dilations:a,dataFormat:"NHWC",bias:t,activation:s}),o==="channelsFirst"&&(u=Yt(u,[0,3,1,2])),u})}function fX(n,e,t,r,i,o,a){return r===void 0&&(r=[1,1,1]),i===void 0&&(i="valid"),Z(function(){if(o==null&&(o=Wi()),Cn(o),n.rank!==4&&n.rank!==5)throw new K("conv3dWithBias expects input to be of rank 4 or 5, but received "+n.rank+".");if(e.rank!==4&&e.rank!==5)throw new K("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+n.rank+".");var s=FL(n,o);if(i==="causal")throw new et("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=Rv(s,e,r,i==="same"?"same":"valid","NDHWC",a),t!=null&&(s=ma(s,t)),o==="channelsFirst"&&(s=Yt(s,[0,4,1,2,3])),s})}ce.registerClass(LL);var zL=function(n){function e(t,r){var i=n.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",e.verifyArgs(r),i.rank=t,yr(i.rank,"rank"),i.rank!==1&&i.rank!==2&&i.rank!==3)throw new et("Convolution layer for rank other than 1, 2, or 3 ("+i.rank+") is not implemented yet.");if(i.kernelSize=T0(r.kernelSize,t,"kernelSize"),i.strides=T0(r.strides==null?1:r.strides,t,"strides"),i.padding=r.padding==null?"valid":r.padding,vi(i.padding),i.dataFormat=r.dataFormat==null?"channelsLast":r.dataFormat,Cn(i.dataFormat),i.activation=ws(r.activation),i.useBias=r.useBias==null||r.useBias,i.biasInitializer=Gt(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=_n(r.biasConstraint),i.biasRegularizer=qt(r.biasRegularizer),i.activityRegularizer=qt(r.activityRegularizer),i.dilationRate=T0(r.dilationRate==null?1:r.dilationRate,t,"dilationRate"),i.rank===1&&Array.isArray(i.dilationRate)&&i.dilationRate.length!==1)throw new K("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(i.dilationRate));if(i.rank===2){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==2)throw new K("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(i.dilationRate))}else if(i.rank===3){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==3)throw new K("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(i.dilationRate))}return i}return se(e,n),e.verifyArgs=function(t){if(Zi("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!NE(t.kernelSize,"number",1,3))throw new K("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(t.kernelSize)+".")},e.prototype.getConfig=function(){var t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Qr(this.activation),useBias:this.useBias,biasInitializer:vt(this.biasInitializer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),biasConstraint:kt(this.biasConstraint)},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e}(ht),ny=function(n){function e(t,r){var i=n.call(this,t,r)||this;return i.kernel=null,e.verifyArgs(r),i.filters=r.filters,yr(i.filters,"filters"),i.kernelInitializer=Gt(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=_n(r.kernelConstraint),i.kernelRegularizer=qt(r.kernelRegularizer),i}return se(e,n),e.prototype.build=function(t){var r;t=Mt(t);var i=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[i]==null)throw new K("The channel dimension of the input should be defined. Found "+t[i]);var o=t[i],a=this.kernelSize.concat([o,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(r={},r[i]=o,r)}],this.built=!0},e.prototype.call=function(t,r){var i=this;return Z(function(){var o;t=Ye(t);var a=i.bias==null?null:i.bias.read(),s=UM(i.activation.getClassName());if(s!=null&&i.rank===2)o=PN(t,i.kernel.read(),a,i.strides,i.padding,i.dataFormat,i.dilationRate,s);else{if(i.rank===1)o=dX(t,i.kernel.read(),a,i.strides[0],i.padding,i.dataFormat,i.dilationRate[0]);else if(i.rank===2)o=PN(t,i.kernel.read(),a,i.strides,i.padding,i.dataFormat,i.dilationRate);else{if(i.rank!==3)throw new et("convolutions greater than 3D are not implemented yet.");o=fX(t,i.kernel.read(),a,i.strides,i.padding,i.dataFormat,i.dilationRate)}i.activation!=null&&(o=i.activation.apply(o))}return o})},e.prototype.computeOutputShape=function(t){t=Mt(t);for(var r=[],i=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2),o=0;o<i.length;++o){var a=Xo(i[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);r.push(a)}var s=[t[0]];return this.dataFormat==="channelsLast"?(s=s.concat(r)).push(this.filters):(s.push(this.filters),s=s.concat(r)),s},e.prototype.getConfig=function(){var t={filters:this.filters,kernelInitializer:vt(this.kernelInitializer),kernelRegularizer:tt(this.kernelRegularizer),kernelConstraint:kt(this.kernelConstraint)},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.verifyArgs=function(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new K("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(t.filters))},e}(zL),HE=function(n){function e(t){var r=n.call(this,2,t)||this;return e.verifyArgs(t),r}return se(e,n),e.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this);return delete t.rank,t},e.verifyArgs=function(t){if(typeof t.kernelSize!="number"&&!NE(t.kernelSize,"number",1,2))throw new K("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv2D",e}(ny);ce.registerClass(HE);var BL=function(n){function e(t){var r=n.call(this,3,t)||this;return e.verifyArgs(t),r}return se(e,n),e.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this);return delete t.rank,t},e.verifyArgs=function(t){if(typeof t.kernelSize!="number"&&(!Array.isArray(t.kernelSize)||t.kernelSize.length!==1&&t.kernelSize.length!==3))throw new K("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv3D",e}(ny);ce.registerClass(BL);var jL=function(n){function e(t){var r=n.call(this,t)||this;if(r.inputSpec=[new Fn({ndim:4})],r.padding!=="same"&&r.padding!=="valid")throw new K("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+r.padding);return r}return se(e,n),e.prototype.build=function(t){var r;if((t=Mt(t)).length!==4)throw new K("Input should have rank 4; Received input shape: "+JSON.stringify(t));var i=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[i]==null)throw new K("The channel dimension of the inputs should be defined. Found `None`.");var o=t[i],a=this.kernelSize.concat([this.filters,o]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Fn({ndim:4,axes:(r={},r[i]=o,r)})],this.built=!0},e.prototype.call=function(t,r){var i=this;return Z(function(){var o=Ye(t);if(o.shape.length!==4)throw new K("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+o.shape.length);var a,s,u=o.shape,l=u[0];i.dataFormat==="channelsFirst"?(a=2,s=3):(a=1,s=2);var c=u[a],h=u[s],d=i.kernelSize[0],f=i.kernelSize[1],m=i.strides[0],v=i.strides[1],y=[l,_p(c,m,d,i.padding),_p(h,v,f,i.padding),i.filters];i.dataFormat!=="channelsLast"&&(o=Yt(o,[0,2,3,1]));var g=Av(o,i.kernel.read(),y,i.strides,i.padding);return i.dataFormat!=="channelsLast"&&(g=Yt(g,[0,3,1,2])),i.bias!=null&&(g=ma(g,i.bias.read(),i.dataFormat)),i.activation!=null&&(g=i.activation.apply(g)),g})},e.prototype.computeOutputShape=function(t){var r,i,o,a=(t=Mt(t)).slice();this.dataFormat==="channelsFirst"?(r=1,i=2,o=3):(r=3,i=1,o=2);var s=this.kernelSize[0],u=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return a[r]=this.filters,a[i]=_p(a[i],l,s,this.padding),a[o]=_p(a[o],c,u,this.padding),a},e.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this);return delete t.dilationRate,t},e.className="Conv2DTranspose",e}(HE);ce.registerClass(jL);var pX=function(n){function e(t,r){var i=n.call(this,t,r)||this;if(i.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",i.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",i.depthwiseKernel=null,i.pointwiseKernel=null,r.filters==null)throw new K("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new K("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new K("SeparableConv"+i.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(r.padding));return i.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,i.depthwiseInitializer=Gt(r.depthwiseInitializer||i.DEFAULT_DEPTHWISE_INITIALIZER),i.depthwiseRegularizer=qt(r.depthwiseRegularizer),i.depthwiseConstraint=_n(r.depthwiseConstraint),i.pointwiseInitializer=Gt(r.depthwiseInitializer||i.DEFAULT_POINTWISE_INITIALIZER),i.pointwiseRegularizer=qt(r.pointwiseRegularizer),i.pointwiseConstraint=_n(r.pointwiseConstraint),i}return se(e,n),e.prototype.build=function(t){var r;if((t=Mt(t)).length<this.rank+2)throw new K("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(t));var i=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[i]==null||t[i]<0)throw new K("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[i]));for(var o=t[i],a=this.kernelSize.concat([o,this.depthMultiplier]),s=[],u=0;u<this.rank;++u)s.push(1);s.push(o*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new Fn({ndim:this.rank+2,axes:(r={},r[i]=o,r)})],this.built=!0},e.prototype.call=function(t,r){var i=this;return Z(function(){var o;if(t=Ye(t),i.rank===1)throw new et("1D separable convolution is not implemented yet.");return i.rank===2&&(i.dataFormat==="channelsFirst"&&(t=Yt(t,[0,2,3,1])),o=nE(t,i.depthwiseKernel.read(),i.pointwiseKernel.read(),i.strides,i.padding,i.dilationRate,"NHWC")),i.useBias&&(o=ma(o,i.bias.read(),i.dataFormat)),i.activation!=null&&(o=i.activation.apply(o)),i.dataFormat==="channelsFirst"&&(o=Yt(o,[0,3,1,2])),o})},e.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this);return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=vt(this.depthwiseInitializer),t.pointwiseInitializer=vt(this.pointwiseInitializer),t.depthwiseRegularizer=tt(this.depthwiseRegularizer),t.pointwiseRegularizer=tt(this.pointwiseRegularizer),t.depthwiseConstraint=kt(this.depthwiseConstraint),t.pointwiseConstraint=kt(this.pointwiseConstraint),t},e.className="SeparableConv",e}(ny),UL=function(n){function e(t){return n.call(this,2,t)||this}return se(e,n),e.className="SeparableConv2D",e}(pX);ce.registerClass(UL);var WL=function(n){function e(t){var r=n.call(this,1,t)||this;return e.verifyArgs(t),r.inputSpec=[{ndim:3}],r}return se(e,n),e.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this);return delete t.rank,delete t.dataFormat,t},e.verifyArgs=function(t){if(typeof t.kernelSize!="number"&&!NE(t.kernelSize,"number",1,1))throw new K("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv1D",e}(ny);ce.registerClass(WL);var VL=function(n){function e(t){var r=n.call(this,t)||this;return typeof t.cropping=="number"?r.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?r.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:r.cropping=t.cropping,r.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,r.inputSpec=[{ndim:4}],r}return se(e,n),e.prototype.computeOutputShape=function(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]},e.prototype.call=function(t,r){var i=this;return Z(function(){return t=Ye(t),i.dataFormat==="channelsLast"?wp(wp(t,i.cropping[0][0],t.shape[1]-i.cropping[0][0]-i.cropping[0][1],2),i.cropping[1][0],t.shape[2]-i.cropping[1][1]-i.cropping[1][0],3):wp(wp(t,i.cropping[0][0],t.shape[2]-i.cropping[0][0]-i.cropping[0][1],3),i.cropping[1][0],t.shape[3]-i.cropping[1][1]-i.cropping[1][0],4)})},e.prototype.getConfig=function(){var t={cropping:this.cropping,dataFormat:this.dataFormat},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="Cropping2D",e}(ht);ce.registerClass(VL);var $L=function(n){function e(t){var r=n.call(this,t)||this;return r.DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=t.size==null?r.DEFAULT_SIZE:t.size,r.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,r}return se(e,n),e.prototype.computeOutputShape=function(t){if(this.dataFormat==="channelsFirst"){var r=t[2]==null?null:this.size[0]*t[2],i=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],r,i]}return r=t[1]==null?null:this.size[0]*t[1],i=t[2]==null?null:this.size[1]*t[2],[t[0],r,i,t[3]]},e.prototype.call=function(t,r){var i=this;return Z(function(){var o=Ye(t),a=o.shape;if(i.dataFormat==="channelsFirst"){o=Yt(o,[0,2,3,1]);var s=i.size[0]*a[2],u=i.size[1]*a[3],l=o.resizeNearestNeighbor([s,u]);return Yt(l,[0,3,1,2])}return s=i.size[0]*a[1],u=i.size[1]*a[2],o.resizeNearestNeighbor([s,u])})},e.prototype.getConfig=function(){var t={size:this.size,dataFormat:this.dataFormat},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="UpSampling2D",e}(ht);function mX(n,e,t,r,i,o){return t===void 0&&(t=[1,1]),r===void 0&&(r="valid"),Z(function(){i==null&&(i=Wi()),Cn(i);var a=$E(n,i);if(n.rank!==4)throw new K("Input for depthwiseConv2d is required to be 4-D, but is instead "+n.rank+"-D");if(e.rank!==4)throw new K("depthwiseKernel is required to be 4-D, but is instead "+e.rank+"-D");return a=Oc(a,e,t,r==="same"?"same":"valid","NHWC",o),i==="channelsFirst"&&(a=Yt(a,[0,3,1,2])),a})}ce.registerClass($L);var HL=function(n){function e(t){var r=n.call(this,2,t)||this;return r.depthwiseKernel=null,r.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,r.depthwiseInitializer=Gt(t.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=_n(t.depthwiseConstraint),r.depthwiseRegularizer=qt(t.depthwiseRegularizer),r}return se(e,n),e.prototype.build=function(t){if((t=Mt(t)).length<4)throw new K("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(t)+".");var r=this.dataFormat==="channelsFirst"?1:3;if(t[r]==null||t[r]<0)throw new K("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+t[r]+").");var i=t[r],o=[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",o,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,r){var i=this;return Z(function(){var o=mX(t=Ye(t),i.depthwiseKernel.read(),i.strides,i.padding,i.dataFormat,null);return i.useBias&&(o=ma(o,i.bias.read(),i.dataFormat)),i.activation!=null&&(o=i.activation.apply(o)),o})},e.prototype.computeOutputShape=function(t){t=Mt(t);var r=this.dataFormat==="channelsFirst"?t[2]:t[1],i=this.dataFormat==="channelsFirst"?t[3]:t[2],o=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,a=Xo(r,this.kernelSize[0],this.padding,this.strides[0]),s=Xo(i,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],o,a,s]:[t[0],a,s,o]},e.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this);return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=vt(this.depthwiseInitializer),t.depthwiseRegularizer=tt(this.depthwiseRegularizer),t.depthwiseConstraint=kt(this.depthwiseRegularizer),t},e.className="DepthwiseConv2D",e}(zL);ce.registerClass(HL);var GL=function(n){function e(t){var r=n.call(this,t)||this;return r.rate=Math.max(Math.min(t.rate,1),0),r.noiseShape=t.noiseShape,r.seed=t.seed,r.supportsMasking=!0,r}return se(e,n),e.prototype.getNoiseShape=function(t){if(this.noiseShape==null)return this.noiseShape;for(var r=t.shape,i=[],o=0;o<this.noiseShape.length;++o)i.push(this.noiseShape[o]==null?r[o]:this.noiseShape[o]);return i},e.prototype.call=function(t,r){var i=this;return Z(function(){i.invokeCallHook(t,r);var o=Ye(t);if(0<i.rate&&i.rate<1){var a=r.training!=null&&r.training,s=i.getNoiseShape(o);return hc(function(){return ZM(o,i.rate,s,i.seed)},function(){return o},a)}return t})},e.prototype.getConfig=function(){var t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.prototype.dispose=function(){return n.prototype.dispose.call(this)},e.className="Dropout",e}(ht);ce.registerClass(GL);var qL=function(n){function e(t){var r=n.call(this,t)||this;if(r.activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){var i=null;t.batchSize!=null&&(i=t.batchSize),r.batchInputShape=[i,t.inputDim]}return r.units=t.units,yr(r.units,"units"),r.activation=ws(t.activation),t.useBias!=null&&(r.useBias=t.useBias),r.kernelInitializer=Gt(t.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=Gt(t.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=_n(t.kernelConstraint),r.biasConstraint=_n(t.biasConstraint),r.kernelRegularizer=qt(t.kernelRegularizer),r.biasRegularizer=qt(t.biasRegularizer),r.activityRegularizer=qt(t.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return se(e,n),e.prototype.build=function(t){var r,i=(t=Mt(t))[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[i,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(r={},r[-1]=i,r)}],this.built=!0},e.prototype.computeOutputShape=function(t){var r=(t=Mt(t)).slice();return r[r.length-1]=this.units,r},e.prototype.call=function(t,r){var i=this;return Z(function(){i.invokeCallHook(t,r);var o,a=Ye(t),s=UM(i.activation.getClassName());return s!=null?o=Ko(a,i.kernel.read(),s,i.bias?i.bias.read():null):(o=Ko(a,i.kernel.read()),i.bias!=null&&(o=ma(o,i.bias.read())),i.activation!=null&&(o=i.activation.apply(o))),o})},e.prototype.getConfig=function(){var t={units:this.units,activation:Qr(this.activation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),biasInitializer:vt(this.biasInitializer),kernelRegularizer:tt(this.kernelRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:kt(this.kernelConstraint),biasConstraint:kt(this.biasConstraint)},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="Dense",e}(ht);ce.registerClass(qL);var KL=function(n){function e(t){var r=n.call(this,t||{})||this;return r.inputSpec=[{minNDim:3}],r}return se(e,n),e.prototype.computeOutputShape=function(t){for(var r=0,i=(t=Mt(t)).slice(1);r<i.length;r++)if(i[r]==null)throw new K('The shape of the input to "Flatten" is not fully defined (got '+t.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],ss(t,1)]},e.prototype.call=function(t,r){var i=this;return Z(function(){return i.invokeCallHook(t,r),x8(Ye(t))})},e.className="Flatten",e}(ht);ce.registerClass(KL);var XL=function(n){function e(t){var r=n.call(this,t)||this;return r.supportsMasking=!0,r.activation=ws(t.activation),r}return se(e,n),e.prototype.call=function(t,r){var i=this;return Z(function(){i.invokeCallHook(t,r);var o=Ye(t);return i.activation.apply(o)})},e.prototype.getConfig=function(){var t={activation:Qr(this.activation)},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="Activation",e}(ht);ce.registerClass(XL);var YL=function(n){function e(t){var r=n.call(this,t)||this;return r.n=t.n,r.inputSpec=[{ndim:2}],r}return se(e,n),e.prototype.computeOutputShape=function(t){return[t[0],this.n,t[1]]},e.prototype.call=function(t,r){var i=this;return Z(function(){return w8(t=Ye(t),i.n)})},e.prototype.getConfig=function(){var t={n:this.n},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="RepeatVector",e}(ht);ce.registerClass(YL);var QL=function(n){function e(t){var r=n.call(this,t)||this;r.targetShape=t.targetShape;for(var i=0;i<r.targetShape.length;++i)r.isUnknown(r.targetShape[i])&&(r.targetShape[i]=null);return r}return se(e,n),e.prototype.isUnknown=function(t){return t<0||t==null},e.prototype.fixUnknownDimension=function(t,r){for(var i="Total size of new array must be unchanged.",o=r.slice(),a=1,s=null,u=0;u<o.length;++u){var l=o[u];if(this.isUnknown(l)){if(s!==null)throw new K("Can only specifiy one unknown dimension.");s=u}else a*=l}var c=ss(t);if(s!==null){if(a===0||c%a!=0)throw new K(i);o[s]=c/a}else if(c!==a)throw new K(i);return o},e.prototype.computeOutputShape=function(t){for(var r=!1,i=0;i<t.length;++i)if(this.isUnknown(t[i])){r=!0;break}return r?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))},e.prototype.call=function(t,r){var i=this;return Z(function(){i.invokeCallHook(t,r);var o=Ye(t),a=o.shape,s=a.slice(0,1).concat(i.fixUnknownDimension(a.slice(1),i.targetShape));return o.reshape(s)})},e.prototype.getConfig=function(){var t={targetShape:this.targetShape},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="Reshape",e}(ht);ce.registerClass(QL);var JL=function(n){function e(t){var r=n.call(this,t)||this;if(t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+t.dims+" instead.");var i=Vi(1,t.dims.length+1);if(!De.arraysEqual(t.dims.slice().sort(),i))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=t.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new Fn({ndim:r.dims.length+1})],r}return se(e,n),e.prototype.computeOutputShape=function(t){var r=(t=Mt(t)).slice();return this.dims.forEach(function(i,o){r[o+1]=t[i]}),r},e.prototype.call=function(t,r){return Yt(Ye(t),this.dimsIncludingBatch)},e.prototype.getConfig=function(){var t={dims:this.dims},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="Permute",e}(ht);ce.registerClass(JL);var ZL=function(n){function e(t){var r=n.call(this,t??{})||this;return r.supportsMasking=!0,r.maskValue=t!=null?t.maskValue==null?0:t.maskValue:0,r}return se(e,n),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this),r={maskValue:this.maskValue};return Object.assign(r,t),r},e.prototype.computeMask=function(t,r){var i=Ye(t);return Dd(ac(i,this.maskValue),-1)},e.prototype.call=function(t,r){var i=this;return Z(function(){i.invokeCallHook(t,r);var o=Ye(t),a=Dd(ac(o,i.maskValue),-1,!0);return o.mul(a.asType(o.dtype))})},e.className="Masking",e}(ht);ce.registerClass(ZL);var eF=function(n){function e(t){var r=n.call(this,t)||this;if(r.embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){var i=null;t.batchSize!=null&&(i=t.batchSize),t.inputLength==null?r.batchInputShape=[i,null]:r.batchInputShape=[i].concat(Ft(t.inputLength))}return r.inputDim=t.inputDim,yr(r.inputDim,"inputDim"),r.outputDim=t.outputDim,yr(r.outputDim,"outputDim"),r.embeddingsInitializer=Gt(t.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=qt(t.embeddingsRegularizer),r.activityRegularizer=qt(t.activityRegularizer),r.embeddingsConstraint=_n(t.embeddingsConstraint),r.maskZero=t.maskZero,r.supportsMasking=t.maskZero,r.inputLength=t.inputLength,r}return se(e,n),e.prototype.build=function(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},e.prototype.warnOnIncompatibleInputShape=function(t){},e.prototype.computeMask=function(t,r){var i=this;return Z(function(){return i.maskZero?(t=Ye(t),ac(t,ct(t))):null})},e.prototype.computeOutputShape=function(t){if(t=Mt(t),this.inputLength==null)return t.concat([this.outputDim]);var r=Ft(this.inputLength);if(r.length!==t.length-1)throw new K('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);for(var i=0,o=0;o<r.length;++o){var a=r[o],s=t[o+1];if(a!=null&&s!=null&&a!==s)throw new K('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);a==null&&(r[i]=s),i++}return[t[0]].concat(r,[this.outputDim])},e.prototype.call=function(t,r){var i=this;return Z(function(){i.invokeCallHook(t,r);var o=Ye(t);return o.dtype!=="int32"&&(o=_f(o,"int32")),JM(i.embeddings.read(),o.as1D()).reshape(Mt(i.computeOutputShape(o.shape)))})},e.prototype.getConfig=function(){var t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:vt(this.embeddingsInitializer),embeddingsRegularizer:tt(this.embeddingsRegularizer),activityRegularizer:tt(this.activityRegularizer),embeddingsConstraint:kt(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="Embedding",e}(ht);ce.registerClass(eF);var qu=function(n){function e(t){var r=n.call(this,t||{})||this;return r.supportsMasking=!0,r}return se(e,n),e.prototype.mergeFunction=function(t){throw new et},e.prototype.computeElementwiseOpOutputShape=function(t,r){if(t==null||r==null)return null;if(t.length<r.length)return this.computeElementwiseOpOutputShape(r,t);if(r.length===0)return t;for(var i=t.slice(0,t.length-r.length),o=0;o<r.length;++o){var a=t[t.length-r.length+o],s=r[o];if(a==null||s==null||a<0||s<0)i.push(null);else if(a===1)i.push(s);else if(s===1)i.push(a);else{if(a!==s)throw new K("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(r));i.push(a)}}return i},e.prototype.build=function(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Mt(t)]),(t=t).length<2)throw new K("A merge layer should be called on an Array of at least 2 inputs. Got "+t.length+" input(s).");for(var r=[],i=0,o=t;i<o.length;i++)(u=o[i])!=null&&u[0]!==null&&r.push(u[0]);if((r=as(r)).length>1)throw new K("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(t)+".");for(var a=t[0]==null?null:t[0].slice(1),s=1;s<t.length;++s){var u=t[s]==null?null:t[s].slice(1);a=this.computeElementwiseOpOutputShape(a,u)}var l=t.map(function(c){return c.length});t.indexOf(null)===-1&&as(l).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0},e.prototype.call=function(t,r){var i=this;return Z(function(){if(t=t,i.reshapeRequired){var o=[],a=t.map(function(x){return x.rank});if(a.indexOf(null)===-1){for(var s=ys(a),u=0,l=t;u<l.length;u++){for(var c=(v=l[u]).rank,h=0;h<s-c;++h)v=Ef(v,1);o.push(v)}return i.mergeFunction(o)}for(var d=!1,f=0,m=t;f<m.length;f++){var v;if((c=(v=m[f]).rank)==null){var y=v.shape,g=y[0],w=y.slice(1).concat([g]),b=v.reshape([g].concat(ss(y.slice(1))));b=(b=Yt(b,[1,0])).reshape(w),o.push(b),d=!0}else if(c>1){var S=Vi(1,c).concat([0]);o.push(Yt(v,S)),d=!0}else o.push(v)}var E=i.mergeFunction(o),T=E.rank;if(d)if(T==null){var _=E.shape;w=[g=_[_.length-1]].concat(_.slice(0,_.length-1)),E=Yt(E.reshape([-1,g]),[1,0]).reshape(w)}else T>1&&(S=[T-1].concat(Vi(0,T-1)),E=Yt(E,S));return E}return i.mergeFunction(t)})},e.prototype.computeOutputShape=function(t){var r;r=(t=t)[0]==null?null:t[0].slice(1);for(var i=1;i<t.length;++i){var o=t[i]==null?null:t[i].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}for(var a=[],s=0,u=t;s<u.length;s++)(o=u[s])!=null&&o[0]!==null&&a.push(o[0]);return r=(a=as(a)).length===1?a.concat(r):[null].concat(r)},e.prototype.computeMask=function(t,r){return Z(function(){if(r==null)return null;if(!Array.isArray(r))throw new K("`mask` should be an Array");if(!Array.isArray(t))throw new K("`inputs` should be an Array");if(r.length!==t.length)throw new K("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+t.length+" vs "+r.length+")");if(r.every(function(a){return a==null}))return null;for(var i=(r=r.map(function(a){return a==null?a:Ur(a,0)}))[0],o=1;o<r.length-1;++o)i=da(i,r[o]);return i})},e}(ht),tF=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.mergeFunction=function(t){return Z(function(){for(var r=t[0].clone(),i=1;i<t.length;++i)r=ot(r,t[i]);return r})},e.className="Add",e}(qu);ce.registerClass(tF);var nF=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.mergeFunction=function(t){return Z(function(){for(var r=t[0].clone(),i=1;i<t.length;++i)r=He(r,t[i]);return r})},e.className="Multiply",e}(qu);ce.registerClass(nF);var rF=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.mergeFunction=function(t){return Z(function(){for(var r=t[0].clone(),i=1;i<t.length;++i)r=ot(r,t[i]);return He(1/t.length,r)})},e.className="Average",e}(qu);ce.registerClass(rF);var iF=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.mergeFunction=function(t){return Z(function(){for(var r=t[0],i=1;i<t.length;++i)r=wo(r,t[i]);return r})},e.className="Maximum",e}(qu);ce.registerClass(iF);var oF=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.mergeFunction=function(t){return Z(function(){for(var r=t[0],i=1;i<t.length;++i)r=Rc(r,t[i]);return r})},e.className="Minimum",e}(qu);ce.registerClass(oF);var aF=function(n){function e(t){var r=n.call(this,t)||this;return r.DEFAULT_AXIS=-1,t==null&&(t={}),r.axis=t.axis==null?r.DEFAULT_AXIS:t.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return se(e,n),e.prototype.build=function(t){if(!Array.isArray(t)||!Array.isArray(t[0])||t.length===1)throw new K("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var r=!0,i=0,o=t=t;i<o.length;i++)if((d=o[i])!=null){r=!1;break}if(!r){for(var a=[],s=0;s<t.length;++s){var u=t[s].slice();u.splice(this.axis,1);for(var l=!1,c=0,h=a;c<h.length;c++){var d=h[c];if(De.arraysEqual(d,u)){l=!0;break}}l||a.push(u)}if(a.length>1)throw new K("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}},e.prototype.mergeFunction=function(t){var r=this;return Z(function(){return QM(t,r.axis)})},e.prototype.computeOutputShape=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new K("A `Concatenate` layer should be called on a list of inputs.");for(var r=t,i=r[0].slice(),o=this.axis<0?i.length+this.axis:this.axis,a=0,s=r.slice(1);a<s.length;a++){var u=s[a];if(i[o]==null||u[o]==null){i[o]=null;break}i[o]+=u[o]}return i},e.prototype.computeMask=function(t,r){var i=this;if(r==null)return null;if(!Array.isArray(r))throw new K("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new K("`inputs` should be an array for Concatenate");if(r.length!==t.length)throw new K("Mismatch in the length of mask ("+r.length+") and the legnth of inputs ("+t.length+")");return Z(function(){var o=!0;if(r.forEach(function(l){l==null||(o=!1)}),o)return null;for(var a=[],s=0;s<t.length;++s)r[s]==null?a.push(Xr(t[s]).asType("bool")):r[s].rank<t[s].rank?a.push(Ur(r[s],-1)):a.push(r[s]);var u=ar(a,i.axis);return zv(u,-1,!1)})},e.prototype.getConfig=function(){var t={axis:this.axis},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="Concatenate",e}(qu);function hh(n,e){for(;n<0;)n+=e;return n}function gX(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new et("batchDot is not implemented for tensors of 4D or higher rank yet");if(De.assert(n.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+n.shape.length}),De.assert(n.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+e.shape.length}),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new et("batchDot is not implemented for complex64-type Tensors yet.");var r=n.shape.length,i=e.shape.length;t==null&&(t=[r-1,i-2]);var o=t;return Z(function(){var a,s;if(r>i){a=r-i;for(var u=[],l=0;l<a;++l)u.push(1);e=e.reshape(e.shape.concat(u))}else if(i>r){for(a=i-r,u=[],l=0;l<a;++l)u.push(1);n=n.reshape(n.shape.concat(u))}else a=0;if(n.shape.length===2&&e.shape.length===2)s=o[0]===o[1]?n.mulStrict(e).sum(o[0]):n.transpose([1,0]).mulStrict(e).sum(o[1]);else{var c=o[0]!==n.shape.length-1,h=o[1]===e.shape.length-1;s=n.matMul(e,c,h)}if(a>0){var d=void 0,f=[];for(l=d=r>i?r+i-3:r-1;l<d+a;++l)f.push(l);s=s.squeeze(f)}return s.shape.length===1&&(s=s.expandDims(1)),s})}ce.registerClass(aF);var sF=function(n){function e(t){var r=n.call(this,t)||this;return r.axes=t.axes,r.normalize=t.normalize!=null&&t.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return se(e,n),e.prototype.build=function(t){De.assert(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=t[0],i=t[1];if(r.length>3||i.length>3)throw new et("Dot layer does not support tensors of 4D or higher rank yet.");var o=this.interpretAxes(r,i);if(r[o[0]]!==i[o[1]])throw new K("Dimension incompatibility: "+r[o[0]]+" !== "+i[o[1]])},e.prototype.mergeFunction=function(t){if(t.length!==2)throw new K("A `Dot` layer must be called on exactly 2 inputs, but received "+t.length+" input(s).");var r,i=t[0],o=t[1];return r=Array.isArray(this.axes)?this.axes.map(function(a,s){return hh(a,t[s].shape.length)}):[hh(this.axes,i.shape.length),hh(this.axes,o.shape.length)],this.normalize&&(i=fg(i,r[0]),o=fg(o,r[1])),gX(i,o,r)},e.prototype.interpretAxes=function(t,r){return Array.isArray(this.axes)?this.axes:[hh(this.axes,t.length),hh(this.axes,r.length)]},e.prototype.computeOutputShape=function(t){De.assert(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=t[0].slice(),i=t[1].slice();if(r.length>3||i.length>3)throw new et("Dot layer does not support tensors of 4D or higher rank yet.");var o=this.interpretAxes(r,i);r.splice(o[0],1),i.splice(o[1],1),i.splice(0,1);var a=r.concat(i);return a.length===1&&a.push(1),a},e.prototype.computeMask=function(t,r){return null},e.prototype.getConfig=function(){var t={axes:this.axes,normalize:this.normalize},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="Dot",e}(qu);ce.registerClass(sF);var uF=function(n){function e(t){var r=n.call(this,t)||this;return r.supportsMasking=!0,r.stddev=t.stddev,r}return se(e,n),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this),r={stddev:this.stddev};return Object.assign(r,t),r},e.prototype.call=function(t,r){var i=this;return Z(function(){i.invokeCallHook(t,r);var o=Ye(t);return hc(function(){return Xv(o.shape,0,i.stddev).add(o)},function(){return o},r.training||!1)})},e.className="GaussianNoise",e}(ht);ce.registerClass(uF);var lF=function(n){function e(t){var r=n.call(this,t)||this;return r.supportsMasking=!0,r.rate=t.rate,r}return se(e,n),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,t),r},e.prototype.call=function(t,r){var i=this;return Z(function(){i.invokeCallHook(t,r);var o=Ye(t);return i.rate>0&&i.rate<1?hc(function(){var a=Math.sqrt(i.rate/(1-i.rate));return o.mul(Xv(o.shape,1,a))},function(){return o},r.training||!1):o})},e.className="GaussianDropout",e}(ht);ce.registerClass(lF);var cF=function(n){function e(t){var r=n.call(this,t)||this;return r.supportsMasking=!0,r.rate=t.rate,r.noiseShape=t.noiseShape,r}return se(e,n),e.prototype._getNoiseShape=function(t){return this.noiseShape||Ye(t).shape},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,t),r},e.prototype.call=function(t,r){var i=this;return Z(function(){if(i.rate<1&&i.rate>0){var o=i._getNoiseShape(t);return hc(function(){var a=Ye(t),s=-1.7580993408473766,u=ff(Uu(o),i.rate);u=_f(u,"float32");var l=Math.pow((1-i.rate)*(1+i.rate*Math.pow(s,2)),-.5),c=-l*s*i.rate;return a.mul(u).add(u.add(-1).mul(s)).mul(l).add(c)},function(){return Ye(t)},r.training||!1)}return t})},e.className="AlphaDropout",e}(ht);function Ld(n,e,t,r,i,o){var a;if(o===void 0&&(o=.001),n.rank===2)a=$_(n,e,t,r,i,o);else if(n.rank===3)a=H_(n,e,t,r,i,o);else{if(n.rank!==4)throw new et("batchNormalization is not implemented for array of rank "+n.rank+" yet");a=G_(n,e,t,r,i,o)}return a}function vX(n,e,t,r,i){return i===void 0&&(i=.001),Z(function(){var o=gf(n,r),a=o.mean,s=o.variance;return[Ld(n,a,s,t,e,i),a,s]})}function yX(n,e,t,r,i){return i===void 0&&(i=.001),Z(function(){for(var o=gf(n,r),a=o.mean,s=o.variance,u=[],l=0,c=Vi(0,n.rank);l<c.length;l++){var h=c[l];r.indexOf(h)!==-1?u.push(1):u.push(n.shape[h])}var d=a.reshape(u),f=s.reshape(u),m=e==null?null:e.reshape(u),v=t==null?null:t.reshape(u);return[Ld(n,d,f,v,m,i),a,s]})}function wX(n,e,t,r,i){return i===void 0&&(i=.001),De.arraysEqual(r.slice().sort(),Vi(0,n.rank-1))?vX(n,e,t,r,i):yX(n,e,t,r,i)}ce.registerClass(cF);var hF=function(n){function e(t){var r=this;return t==null&&(t={}),(r=n.call(this,t)||this).supportsMasking=!0,r.axis=t.axis==null?-1:t.axis,r.momentum=t.momentum==null?.99:t.momentum,r.epsilon=t.epsilon==null?.001:t.epsilon,r.center=t.center==null||t.center,r.scale=t.scale==null||t.scale,r.betaInitializer=Gt(t.betaInitializer||"zeros"),r.gammaInitializer=Gt(t.gammaInitializer||"ones"),r.movingMeanInitializer=Gt(t.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=Gt(t.movingVarianceInitializer||"ones"),r.betaConstraint=_n(t.betaConstraint),r.gammaConstraint=_n(t.gammaConstraint),r.betaRegularizer=qt(t.betaRegularizer),r.gammaRegularizer=qt(t.gammaRegularizer),r}return se(e,n),e.prototype.build=function(t){var r;t=Mt(t);var i=this.axis>=0?this.axis:this.axis+t.length,o=t[i];if(o==null)throw new K("Axis "+i+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(t)+".");this.inputSpec=[new Fn({ndim:t.length,axes:(r={},r[i]=o,r)})];var a=[o];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0},e.prototype.call=function(t,r){var i=this;return Z(function(){var o=r.training!=null&&r.training,a=Ye(t),s=a.shape,u=s.length,l=Vi(0,u),c=i.axis>=0?i.axis:i.axis+u;l.splice(c,1);var h=Tu(1,u);h[c]=s[c];var d=l.slice();d.sort();var f=!De.arraysEqual(d,Vi(0,u).slice(0,u-1));if(!o)return function(){if(f){var b=i.movingMean.read().reshape(h),S=i.movingVariance.read().reshape(h),E=i.center?i.beta.read().reshape(h):null,T=i.scale?i.gamma.read().reshape(h):null;return Ld(a,b,S,E,T,i.epsilon)}return Ld(a,i.movingMean.read(),i.movingVariance.read(),i.beta==null?null:i.beta.read(),i.gamma==null?null:i.gamma.read(),i.epsilon)}();var m=wX(a,i.gamma.read(),i.beta.read(),l,i.epsilon),v=m[0],y=m[1],g=m[2],w=function(b,S,E){Z(function(){var T=1-E,_=b.read(),x=_.sub(S).mul(T);b.write(_.sub(x))})};return w(i.movingMean,y,i.momentum),w(i.movingVariance,g,i.momentum),v})},e.prototype.getConfig=function(){var t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vt(this.betaInitializer),gammaInitializer:vt(this.gammaInitializer),movingMeanInitializer:vt(this.movingMeanInitializer),movingVarianceInitializer:vt(this.movingVarianceInitializer),betaRegularizer:tt(this.betaRegularizer),gammaRegularizer:tt(this.gammaRegularizer),betaConstraint:kt(this.betaConstraint),gammaConstraint:kt(this.gammaConstraint)},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="BatchNormalization",e}(ht);ce.registerClass(hF);var dF=function(n){function e(t){var r=this;if(t==null&&(t={}),(r=n.call(this,t)||this).axis=t.axis==null?-1:t.axis,typeof r.axis=="number"){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received "+r.axis)}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(r.axis));for(var i=0,o=r.axis;i<o.length;i++){var a=o[i];if(!Number.isInteger(a))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(r.axis))}}return r.epsilon=t.epsilon==null?.001:t.epsilon,r.center=t.center==null||t.center,r.scale=t.scale==null||t.scale,r.betaInitializer=Gt(t.betaInitializer||"zeros"),r.gammaInitializer=Gt(t.gammaInitializer||"ones"),r.betaRegularizer=qt(t.betaRegularizer),r.gammaRegularizer=qt(t.gammaRegularizer),r.supportsMasking=!0,r}return se(e,n),e.prototype.build=function(t){var r=(t=Mt(t)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(var i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);for(var o=0,a=this.axis;o<a.length;o++){var s=a[o];if(s<0||s>=r)throw new Error("Invalid axis: "+s)}if(this.axis.length!==as(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var u=this.axis.map(function(l){return t[l]});this.scale?this.gamma=this.addWeight("gamma",u,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",u,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},e.prototype.call=function(t,r){var i=this,o=Ye(t),a=o.shape,s=a.length;return Z(function(){for(var u=gf(o,i.axis,!0),l=u.mean,c=u.variance,h=Tu(1,s),d=0,f=i.axis;d<f.length;d++){var m=f[d];h[m]=a[m]}for(var v=function(E){return E!=null&&E.shape.length!==s&&i.axis!==[s-1]?E.reshape(h):E},y=v(i.gamma.read()),g=v(i.beta.read()),w=[],b=[],S=0;S<s;++S)i.axis.indexOf(S)!==-1?(w.push(a[S]),b.push(1)):(w.push(1),b.push(a[S]));return l=l.tile(w),c=c.tile(w),y=y.tile(b),g=g.tile(b),Ld(o,l,c,g,y,i.epsilon)})},e.prototype.getConfig=function(){var t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vt(this.betaInitializer),gammaInitializer:vt(this.gammaInitializer),betaRegularizer:tt(this.betaRegularizer),gammaRegularizer:tt(this.gammaRegularizer)},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="LayerNormalization",e}(ht);function bX(n,e,t){return Z(function(){if(n.rank!==4)throw new K("temporalPadding expects input tensor to be 4-D, but received a "+n.rank+"-D tensor.");if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new K("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=Wi()),t!=="channelsLast"&&t!=="channelsFirst")throw new K("Unknown data format: "+t+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r=t==="channelsFirst"?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]],ks(n,r)})}ce.registerClass(dF);var fF=function(n){function e(t){var r=this;if(t==null&&(t={}),(r=n.call(this,t)||this).dataFormat=t.dataFormat==null?Wi():t.dataFormat,t.padding==null)r.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")r.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new K("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+t.padding.length+" array.");var i=void 0,o=void 0;if(typeof t.padding[0]=="number")i=[t.padding[0],t.padding[0]],o=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new K("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+t.padding[0].length+" array.");if(i=t.padding[0],t.padding[1].length!==2)throw new K("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+t.padding[1].length+" array.");o=t.padding[1]}r.padding=[i,o]}return r.inputSpec=[new Fn({ndim:4})],r}return se(e,n),e.prototype.computeOutputShape=function(t){var r,i;return t=Mt(t),this.dataFormat==="channelsFirst"?(r=t[2]!=null&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,i=t[3]!=null&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],r,i]):(r=t[1]!=null&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,i=t[2]!=null&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],r,i,t[3]])},e.prototype.call=function(t,r){var i=this;return Z(function(){return bX(Ye(t),i.padding,i.dataFormat)})},e.prototype.getConfig=function(){var t={padding:this.padding,dataFormat:this.dataFormat},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="ZeroPadding2D",e}(ht);function ry(n,e,t,r,i,o){return Z(function(){var a;Cn(i),GM(o),vi(r),t==null&&(t=[1,1]),r==null&&(r="valid"),i==null&&(i=Wi()),o==null&&(o="max"),n=$E(n,i);var s=r==="same"?"same":"valid";return a=o==="max"?Ov(n,e,t,s):Pv(n,e,t,s),i==="channelsFirst"&&(a=Yt(a,[0,3,1,2])),a})}function pF(n,e,t,r,i,o){return Z(function(){var a;Cn(i),GM(o),vi(r),t==null&&(t=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Wi()),o==null&&(o="max"),n=FL(n,i);var s=r==="same"?"same":"valid";return a=o==="max"?Mv(n,e,t,s):Lv(n,e,t,s),i==="channelsFirst"&&(a=Yt(a,[0,4,1,2,3])),a})}ce.registerClass(fF);var mF=function(n){function e(t){var r=this;if(t.poolSize==null&&(t.poolSize=2),r=n.call(this,t)||this,typeof t.poolSize=="number")r.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||t.poolSize.length!==1||typeof t.poolSize[0]!="number")throw new K("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.poolSize));r.poolSize=t.poolSize}if(yr(r.poolSize,"poolSize"),t.strides==null)r.strides=r.poolSize;else if(typeof t.strides=="number")r.strides=[t.strides];else{if(!Array.isArray(t.strides)||t.strides.length!==1||typeof t.strides[0]!="number")throw new K("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.strides));r.strides=t.strides}return yr(r.strides,"strides"),r.padding=t.padding==null?"valid":t.padding,vi(r.padding),r.inputSpec=[new Fn({ndim:3})],r}return se(e,n),e.prototype.computeOutputShape=function(t){var r=Xo((t=Mt(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],r,t[2]]},e.prototype.call=function(t,r){var i=this;return Z(function(){i.invokeCallHook(t,r),t=Ef(Ye(t),2);var o=i.poolingFunction(Ye(t),[i.poolSize[0],1],[i.strides[0],1],i.padding,"channelsLast");return sf(o,[2])})},e.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e}(ht),gF=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.poolingFunction=function(t,r,i,o,a){return Cn(a),vi(o),ry(t,r,i,o,a,"max")},e.className="MaxPooling1D",e}(mF);ce.registerClass(gF);var vF=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.poolingFunction=function(t,r,i,o,a){return Cn(a),vi(o),ry(t,r,i,o,a,"avg")},e.className="AveragePooling1D",e}(mF);ce.registerClass(vF);var yF=function(n){function e(t){var r=this;if(t.poolSize==null&&(t.poolSize=[2,2]),(r=n.call(this,t)||this).poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)r.strides=r.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new K("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+t.strides.length+".");r.strides=t.strides}else r.strides=[t.strides,t.strides];return yr(r.poolSize,"poolSize"),yr(r.strides,"strides"),r.padding=t.padding==null?"valid":t.padding,r.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Cn(r.dataFormat),vi(r.padding),r.inputSpec=[new Fn({ndim:4})],r}return se(e,n),e.prototype.computeOutputShape=function(t){t=Mt(t);var r=this.dataFormat==="channelsFirst"?t[2]:t[1],i=this.dataFormat==="channelsFirst"?t[3]:t[2];return r=Xo(r,this.poolSize[0],this.padding,this.strides[0]),i=Xo(i,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],r,i]:[t[0],r,i,t[3]]},e.prototype.call=function(t,r){var i=this;return Z(function(){return i.invokeCallHook(t,r),i.poolingFunction(Ye(t),i.poolSize,i.strides,i.padding,i.dataFormat)})},e.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e}(ht),wF=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.poolingFunction=function(t,r,i,o,a){return Cn(a),vi(o),ry(t,r,i,o,a,"max")},e.className="MaxPooling2D",e}(yF);ce.registerClass(wF);var bF=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.poolingFunction=function(t,r,i,o,a){return Cn(a),vi(o),ry(t,r,i,o,a,"avg")},e.className="AveragePooling2D",e}(yF);ce.registerClass(bF);var xF=function(n){function e(t){var r=this;if(t.poolSize==null&&(t.poolSize=[2,2,2]),(r=n.call(this,t)||this).poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)r.strides=r.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new K("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+t.strides.length+".");r.strides=t.strides}else r.strides=[t.strides,t.strides,t.strides];return yr(r.poolSize,"poolSize"),yr(r.strides,"strides"),r.padding=t.padding==null?"valid":t.padding,r.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Cn(r.dataFormat),vi(r.padding),r.inputSpec=[new Fn({ndim:5})],r}return se(e,n),e.prototype.computeOutputShape=function(t){t=Mt(t);var r=this.dataFormat==="channelsFirst"?t[2]:t[1],i=this.dataFormat==="channelsFirst"?t[3]:t[2],o=this.dataFormat==="channelsFirst"?t[4]:t[3];return r=Xo(r,this.poolSize[0],this.padding,this.strides[0]),i=Xo(i,this.poolSize[1],this.padding,this.strides[1]),o=Xo(o,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],r,i,o]:[t[0],r,i,o,t[4]]},e.prototype.call=function(t,r){var i=this;return Z(function(){return i.invokeCallHook(t,r),i.poolingFunction(Ye(t),i.poolSize,i.strides,i.padding,i.dataFormat)})},e.prototype.getConfig=function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e}(ht),_F=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.poolingFunction=function(t,r,i,o,a){return Cn(a),vi(o),pF(t,r,i,o,a,"max")},e.className="MaxPooling3D",e}(xF);ce.registerClass(_F);var EF=function(n){function e(t){return n.call(this,t)||this}return se(e,n),e.prototype.poolingFunction=function(t,r,i,o,a){return Cn(a),vi(o),pF(t,r,i,o,a,"avg")},e.className="AveragePooling3D",e}(xF);ce.registerClass(EF);var CF=function(n){function e(t){var r=n.call(this,t)||this;return r.inputSpec=[new Fn({ndim:3})],r}return se(e,n),e.prototype.computeOutputShape=function(t){return[t[0],t[2]]},e.prototype.call=function(t,r){throw new et},e}(ht),SF=function(n){function e(t){return n.call(this,t||{})||this}return se(e,n),e.prototype.call=function(t,r){return Z(function(){var i=Ye(t);return yn(i,1)})},e.className="GlobalAveragePooling1D",e}(CF);ce.registerClass(SF);var IF=function(n){function e(t){return n.call(this,t||{})||this}return se(e,n),e.prototype.call=function(t,r){return Z(function(){var i=Ye(t);return vs(i,1)})},e.className="GlobalMaxPooling1D",e}(CF);ce.registerClass(IF);var NF=function(n){function e(t){var r=n.call(this,t)||this;return r.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Cn(r.dataFormat),r.inputSpec=[new Fn({ndim:4})],r}return se(e,n),e.prototype.computeOutputShape=function(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]},e.prototype.call=function(t,r){throw new et},e.prototype.getConfig=function(){var t={dataFormat:this.dataFormat},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e}(ht),TF=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.call=function(t,r){var i=this;return Z(function(){var o=Ye(t);return i.dataFormat==="channelsLast"?yn(o,[1,2]):yn(o,[2,3])})},e.className="GlobalAveragePooling2D",e}(NF);ce.registerClass(TF);var kF=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e.prototype.call=function(t,r){var i=this;return Z(function(){var o=Ye(t);return i.dataFormat==="channelsLast"?vs(o,[1,2]):vs(o,[2,3])})},e.className="GlobalMaxPooling2D",e}(NF);function RF(n,e,t,r){if(Array.isArray(n)){if(e!=null||t!=null)throw new K("When inputs is an array, neither initialState or constants should be provided");r!=null&&(t=n.slice(n.length-r,n.length),n=n.slice(0,n.length-r)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function i(o){return o==null||Array.isArray(o)?o:[o]}return{inputs:n,initialState:e=i(e),constants:t=i(t)}}function AF(n,e,t,r,i,o,a,s){return r===void 0&&(r=!1),a===void 0&&(a=!1),s===void 0&&(s=!1),Z(function(){var u=e.shape.length;if(u<3)throw new K("Input should be at least 3D, but is "+u+"D.");var l=[1,0].concat(Vi(2,u));e=Yt(e,l),o!=null,a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&((i=i.asType("bool").asType("float32")).rank===u-1&&(i=Ur(i,-1)),i=Yt(i,l)),r&&(e=po(e,0),i!=null&&(i=po(i,0)));var c,h,d=[],f=t,m=e.shape[0],v=Iu(e);i!=null&&(h=Iu(i));for(var y,g=function(b){var S=v[b],E=Z(function(){return n(S,f)});if(i==null)c=E[0],f=E[1];else{var T=Z(function(){var _=h[b],x=Xr(_).sub(_);return{output:E[0].mul(_).addStrict(f[0].mul(x)),newStates:f.map(function(C,N){return E[1][N].mul(_).addStrict(C.mul(x))})}});c=T.output,f=T.newStates}s&&d.push(c)},w=0;w<m;++w)g(w);return s&&(y=Ui(d,1)),[c,y,f]})}ce.registerClass(kF);var Ku=function(n){function e(t){var r,i=n.call(this,t)||this;if(t.cell==null)throw new K("cell property is missing for the constructor of RNN.");if((r=Array.isArray(t.cell)?new XE({cells:t.cell}):t.cell).stateSize==null)throw new K("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return i.cell=r,i.returnSequences=t.returnSequences!=null&&t.returnSequences,i.returnState=t.returnState!=null&&t.returnState,i.goBackwards=t.goBackwards!=null&&t.goBackwards,i._stateful=t.stateful!=null&&t.stateful,i.unroll=t.unroll!=null&&t.unroll,i.supportsMasking=!0,i.inputSpec=[new Fn({ndim:3})],i.stateSpec=null,i.states_=null,i.numConstants=null,i.keptStates=[],i}return se(e,n),e.prototype.getStates=function(){return this.states_==null?Vi(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(t){return null}):this.states_},e.prototype.setStates=function(t){this.states_=t},e.prototype.computeOutputShape=function(t){Sw(t)&&(t=t[0]),t=t;var r=this.cell.stateSize;Array.isArray(r)||(r=[r]);var i,o=r[0];if(i=this.returnSequences?[t[0],t[1],o]:[t[0],o],this.returnState){for(var a=[],s=0,u=r;s<u.length;s++){var l=u[s];a.push([t[0],l])}return[i].concat(a)}return i},e.prototype.computeMask=function(t,r){var i=this;return Z(function(){Array.isArray(r)&&(r=r[0]);var o=i.returnSequences?r:null;if(i.returnState){var a=i.states.map(function(s){return null});return[o].concat(a)}return o})},Object.defineProperty(e.prototype,"states",{get:function(){if(this.states_==null){for(var t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[],i=0;i<t;++i)r.push(null);return r}return this.states_},set:function(t){this.states_=t},enumerable:!0,configurable:!0}),e.prototype.build=function(t){if(this.numConstants!=null)throw new et("Constants support is not implemented in RNN yet.");Sw(t)&&(t=t[0]),t=t;var r=this.stateful?t[0]:null,i=t[t.length-1];this.inputSpec[0]=new Fn({shape:[r,null,i]});var o,a=[t[0]].concat(t.slice(2));if(this.cell.build(a),o=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!De.arraysEqual(this.stateSpec.map(function(s){return s.shape[s.shape.length-1]}),o))throw new K("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=o.map(function(s){return new Fn({shape:[null,s]})});this.stateful&&this.resetStates()},e.prototype.resetStates=function(t,r){var i=this;r===void 0&&(r=!1),Z(function(){if(!i.stateful)throw new qs("Cannot call resetStates() on an RNN Layer that is not stateful.");var o=i.inputSpec[0].shape[0];if(o==null)throw new K("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(i.states_==null)Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return St([o,c])}):i.states_=[St([o,i.cell.stateSize])];else if(t==null)Ze(i.states_),i.keptStates!=null&&(Ze(i.keptStates),i.keptStates=[]),Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return St([o,c])}):i.states_[0]=St([o,i.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==i.states_.length)throw new K("Layer "+i.name+" expects "+i.states_.length+" state(s), but it received "+t.length+" state value(s). Input received: "+t);r===!0?i.keptStates.push(i.states_.slice()):Ze(i.states_);for(var a=0;a<i.states_.length;++a){var s=t[a],u=Array.isArray(i.cell.stateSize)?i.cell.stateSize[a]:i.cell.stateSize,l=[o,u];if(!De.arraysEqual(s.shape,l))throw new K("State "+a+" is incompatible with layer "+i.name+": expected shape="+l+", received shape="+s.shape);i.states_[a]=s}}i.states_=i.states_.map(function(c){return ho(c.clone())})})},e.prototype.apply=function(t,r){var i=r==null?null:r.initialState,o=r==null?null:r.constants;r==null&&(r={});var a=RF(t,i,o,this.numConstants);t=a.inputs,i=a.initialState,o=a.constants;var s=[],u=[];if(i!=null){r.initialState=i,s=s.concat(i),this.stateSpec=[];for(var l=0,c=i;l<c.length;l++){var h=c[l];this.stateSpec.push(new Fn({shape:h.shape}))}u=u.concat(this.stateSpec)}if(o!=null&&(r.constants=o,s=s.concat(o),this.numConstants=o.length),s[0]instanceof Di){var d=[t].concat(s),f=this.inputSpec.concat(u),m=this.inputSpec;this.inputSpec=f;var v=n.prototype.apply.call(this,d,r);return this.inputSpec=m,v}return n.prototype.apply.call(this,t,r)},e.prototype.call=function(t,r){var i=this;return Z(function(){var o=r==null?null:r.mask,a=r==null?null:r.training,s=r==null?null:r.initialState;t=Ye(t),s==null&&(s=i.stateful?i.states_:i.getInitialState(t));var u=Array.isArray(i.cell.stateSize)?i.cell.stateSize.length:1;if(s.length!==u)throw new K("RNN Layer has "+u+" state(s) but was passed "+s.length+" initial state(s).");i.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var l={training:a},c=AF(function(v,y){var g=i.cell.call([v].concat(y),l);return[g[0],g.slice(1)]},t,s,i.goBackwards,o,null,i.unroll,i.returnSequences),h=c[0],d=c[1],f=c[2];i.stateful&&i.resetStates(f,a);var m=i.returnSequences?d:h;return i.returnState?[m].concat(f):m})},e.prototype.getInitialState=function(t){var r=this;return Z(function(){var i=St(t.shape);return i=Ef(i=Pr(i,[1,2])),Array.isArray(r.cell.stateSize)?r.cell.stateSize.map(function(o){return o>1?Ew(i,[1,o]):i}):r.cell.stateSize>1?[Ew(i,[1,r.cell.stateSize])]:[i]})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(t){n.prototype.setFastWeightInitDuringBuild.call(this,t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)},e.prototype.getConfig=function(){var t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();t.cell={className:this.cell.getClassName(),config:r};var i=n.prototype.getConfig.call(this);return Object.assign(t,i),t},e.fromConfig=function(t,r,i){i===void 0&&(i={});var o=Fi(r.cell,i);return new t(Object.assign(r,{cell:o}))},e.className="RNN",e}(ht);ce.registerClass(Ku);var If=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return se(e,n),e}(ht),GE=function(n){function e(t){var r=n.call(this,t)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=t.units,yr(r.units,"units"),r.activation=ws(t.activation==null?r.DEFAULT_ACTIVATION:t.activation),r.useBias=t.useBias==null||t.useBias,r.kernelInitializer=Gt(t.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Gt(t.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Gt(t.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=qt(t.kernelRegularizer),r.recurrentRegularizer=qt(t.recurrentRegularizer),r.biasRegularizer=qt(t.biasRegularizer),r.kernelConstraint=_n(t.kernelConstraint),r.recurrentConstraint=_n(t.recurrentConstraint),r.biasConstraint=_n(t.biasConstraint),r.dropout=cc([1,ys([0,t.dropout==null?0:t.dropout])]),r.recurrentDropout=cc([1,ys([0,t.recurrentDropout==null?0:t.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return se(e,n),e.prototype.build=function(t){t=Mt(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,r){var i=this;return Z(function(){if((t=t).length!==2)throw new K("SimpleRNNCell expects 2 input Tensors, got "+t.length+".");var o=t[1];t=t[0];var a,s=r.training!=null&&r.training;0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=fc(function(){return Xr(t)},i.dropout,s)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=fc(function(){return Xr(o)},i.recurrentDropout,s));var u=i.dropoutMask,l=i.recurrentDropoutMask;a=Ko(u!=null?He(t,u):t,i.kernel.read()),i.bias!=null&&(a=ma(a,i.bias.read())),l!=null&&(o=He(o,l));var c=ot(a,Ko(o,i.recurrentKernel.read()));return i.activation!=null&&(c=i.activation.apply(c)),[c,c]})},e.prototype.getConfig=function(){var t={units:this.units,activation:Qr(this.activation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),recurrentInitializer:vt(this.recurrentInitializer),biasInitializer:vt(this.biasInitializer),kernelRegularizer:tt(this.kernelRegularizer),recurrentRegularizer:tt(this.recurrentRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:kt(this.kernelConstraint),recurrentConstraint:kt(this.recurrentConstraint),biasConstraint:kt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="SimpleRNNCell",e}(If);ce.registerClass(GE);var DF=function(n){function e(t){return t.cell=new GE(t),n.call(this,t)||this}return se(e,n),e.prototype.call=function(t,r){var i=this;return Z(function(){i.cell.dropoutMask!=null&&(Ze(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ze(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var o=r==null?null:r.mask,a=r==null?null:r.training,s=r==null?null:r.initialState;return n.prototype.call.call(i,t,{mask:o,training:a,initialState:s})})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var t={units:this.units,activation:Qr(this.activation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),recurrentInitializer:vt(this.recurrentInitializer),biasInitializer:vt(this.biasInitializer),kernelRegularizer:tt(this.kernelRegularizer),recurrentRegularizer:tt(this.recurrentRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:kt(this.kernelConstraint),recurrentConstraint:kt(this.recurrentConstraint),biasConstraint:kt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=n.prototype.getConfig.call(this);return delete r.cell,Object.assign(t,r),t},e.fromConfig=function(t,r){return new t(r)},e.className="SimpleRNN",e}(Ku);ce.registerClass(DF);var qE=function(n){function e(t){var r=n.call(this,t)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=t.units,yr(r.units,"units"),r.activation=ws(t.activation===void 0?r.DEFAULT_ACTIVATION:t.activation),r.recurrentActivation=ws(t.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),r.useBias=t.useBias==null||t.useBias,r.kernelInitializer=Gt(t.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Gt(t.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Gt(t.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=qt(t.kernelRegularizer),r.recurrentRegularizer=qt(t.recurrentRegularizer),r.biasRegularizer=qt(t.biasRegularizer),r.kernelConstraint=_n(t.kernelConstraint),r.recurrentConstraint=_n(t.recurrentConstraint),r.biasConstraint=_n(t.biasConstraint),r.dropout=cc([1,ys([0,t.dropout==null?0:t.dropout])]),r.recurrentDropout=cc([1,ys([0,t.recurrentDropout==null?0:t.recurrentDropout])]),r.implementation=t.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return se(e,n),e.prototype.build=function(t){var r=(t=Mt(t))[t.length-1];this.kernel=this.addWeight("kernel",[r,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,r){var i=this;return Z(function(){if((t=t).length!==2)throw new K("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");var o=r.training!=null&&r.training,a=t[1];t=t[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=fc(function(){return Xr(t)},i.dropout,o,3)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=fc(function(){return Xr(a)},i.recurrentDropout,o,3));var s,u,l,c=i.dropoutMask,h=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(t=He(t,c[0]));var d=Ko(t,i.kernel.read());i.useBias&&(d=ma(d,i.bias.read())),0<i.recurrentDropout&&i.recurrentDropout<1&&(a=He(a,h[0]));var f=i.recurrentKernel.read(),m=qo(f,[2*i.units,i.units],f.rank-1),v=m[0],y=m[1],g=Ko(a,v),w=qo(d,3,d.rank-1),b=w[0],S=w[1],E=w[2],T=qo(g,2,g.rank-1),_=T[0],x=T[1];s=i.recurrentActivation.apply(ot(b,_)),u=i.recurrentActivation.apply(ot(S,x));var C=Ko(He(u,a),y);l=i.activation.apply(ot(E,C));var N=ot(He(s,a),He(ot(1,Vu(s)),l));return[N,N]})},e.prototype.getConfig=function(){var t={units:this.units,activation:Qr(this.activation),recurrentActivation:Qr(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),recurrentInitializer:vt(this.recurrentInitializer),biasInitializer:vt(this.biasInitializer),kernelRegularizer:tt(this.kernelRegularizer),recurrentRegularizer:tt(this.recurrentRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:kt(this.kernelConstraint),recurrentConstraint:kt(this.recurrentConstraint),biasConstraint:kt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="GRUCell",e}(If);ce.registerClass(qE);var OF=function(n){function e(t){return t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new qE(t),n.call(this,t)||this}return se(e,n),e.prototype.call=function(t,r){var i=this;return Z(function(){i.cell.dropoutMask!=null&&(Ze(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ze(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var o=r==null?null:r.mask,a=r==null?null:r.training,s=r==null?null:r.initialState;return n.prototype.call.call(i,t,{mask:o,training:a,initialState:s})})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var t={units:this.units,activation:Qr(this.activation),recurrentActivation:Qr(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),recurrentInitializer:vt(this.recurrentInitializer),biasInitializer:vt(this.biasInitializer),kernelRegularizer:tt(this.kernelRegularizer),recurrentRegularizer:tt(this.recurrentRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:kt(this.kernelConstraint),recurrentConstraint:kt(this.recurrentConstraint),biasConstraint:kt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=n.prototype.getConfig.call(this);return delete r.cell,Object.assign(t,r),t},e.fromConfig=function(t,r){return r.implmentation===0&&(r.implementation=1),new t(r)},e.className="GRU",e}(Ku);ce.registerClass(OF);var KE=function(n){function e(t){var r=n.call(this,t)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=t.units,yr(r.units,"units"),r.activation=ws(t.activation===void 0?r.DEFAULT_ACTIVATION:t.activation),r.recurrentActivation=ws(t.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),r.useBias=t.useBias==null||t.useBias,r.kernelInitializer=Gt(t.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Gt(t.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Gt(t.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=t.unitForgetBias,r.kernelRegularizer=qt(t.kernelRegularizer),r.recurrentRegularizer=qt(t.recurrentRegularizer),r.biasRegularizer=qt(t.biasRegularizer),r.kernelConstraint=_n(t.kernelConstraint),r.recurrentConstraint=_n(t.recurrentConstraint),r.biasConstraint=_n(t.biasConstraint),r.dropout=cc([1,ys([0,t.dropout==null?0:t.dropout])]),r.recurrentDropout=cc([1,ys([0,t.recurrentDropout==null?0:t.recurrentDropout])]),r.implementation=t.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return se(e,n),e.prototype.build=function(t){var r,i,o=(t=Mt(t))[t.length-1];if(this.kernel=this.addWeight("kernel",[o,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,s=this.units;i=new((r=function(u){function l(){return u!==null&&u.apply(this,arguments)||this}return se(l,u),l.prototype.apply=function(c,h){var d=a.apply([s]),f=new kE().apply([s]),m=a.apply([2*s]);return yN(yN(d,f),m)},l}(Xi)).className="CustomInit",r)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},e.prototype.call=function(t,r){var i=this;return Z(function(){var o=r.training!=null&&r.training;if((t=t).length!==3)throw new K("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");var a=t[1],s=t[2];t=t[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=fc(function(){return Xr(t)},i.dropout,o,4)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=fc(function(){return Xr(a)},i.recurrentDropout,o,4));var u,l,c,h,d=i.dropoutMask,f=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(t=He(t,d[0]));var m=Ko(t,i.kernel.read());0<i.recurrentDropout&&i.recurrentDropout<1&&(a=He(a,f[0])),m=ot(m,Ko(a,i.recurrentKernel.read())),i.useBias&&(m=ma(m,i.bias.read()));var v=qo(m,4,m.rank-1),y=v[0],g=v[1],w=v[2],b=v[3];u=i.recurrentActivation.apply(y),l=i.recurrentActivation.apply(g),c=ot(He(l,s),He(u,i.activation.apply(w))),h=i.recurrentActivation.apply(b);var S=He(h,i.activation.apply(c));return[S,S,c]})},e.prototype.getConfig=function(){var t={units:this.units,activation:Qr(this.activation),recurrentActivation:Qr(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),recurrentInitializer:vt(this.recurrentInitializer),biasInitializer:vt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:tt(this.kernelRegularizer),recurrentRegularizer:tt(this.recurrentRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:kt(this.kernelConstraint),recurrentConstraint:kt(this.recurrentConstraint),biasConstraint:kt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.className="LSTMCell",e}(If);ce.registerClass(KE);var PF=function(n){function e(t){return t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new KE(t),n.call(this,t)||this}return se(e,n),e.prototype.call=function(t,r){var i=this;return Z(function(){i.cell.dropoutMask!=null&&(Ze(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ze(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var o=r==null?null:r.mask,a=r==null?null:r.training,s=r==null?null:r.initialState;return n.prototype.call.call(i,t,{mask:o,training:a,initialState:s})})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var t={units:this.units,activation:Qr(this.activation),recurrentActivation:Qr(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),recurrentInitializer:vt(this.recurrentInitializer),biasInitializer:vt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:tt(this.kernelRegularizer),recurrentRegularizer:tt(this.recurrentRegularizer),biasRegularizer:tt(this.biasRegularizer),activityRegularizer:tt(this.activityRegularizer),kernelConstraint:kt(this.kernelConstraint),recurrentConstraint:kt(this.recurrentConstraint),biasConstraint:kt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=n.prototype.getConfig.call(this);return delete r.cell,Object.assign(t,r),t},e.fromConfig=function(t,r){return r.implmentation===0&&(r.implementation=1),new t(r)},e.className="LSTM",e}(Ku);ce.registerClass(PF);var XE=function(n){function e(t){var r=n.call(this,t)||this;return r.cells=t.cells,r}return se(e,n),Object.defineProperty(e.prototype,"stateSize",{get:function(){for(var t=[],r=0,i=this.cells.slice().reverse();r<i.length;r++){var o=i[r];Array.isArray(o.stateSize)?t.push.apply(t,o.stateSize):t.push(o.stateSize)}return t},enumerable:!0,configurable:!0}),e.prototype.call=function(t,r){var i=this;return Z(function(){for(var o=(t=t).slice(1),a=[],s=0,u=i.cells.slice().reverse();s<u.length;s++){var l=u[s];Array.isArray(l.stateSize)?a.push(o.splice(0,l.stateSize.length)):a.push(o.splice(0,1))}a.reverse();for(var c,h=[],d=0;d<i.cells.length;++d)l=i.cells[d],o=a[d],c=d===0?[t[0]].concat(o):[c[0]].concat(o),c=l.call(c,r),h.push(c.slice(1));o=[];for(var f=0,m=h.slice().reverse();f<m.length;f++){var v=m[f];o.push.apply(o,v)}return[c[0]].concat(o)})},e.prototype.build=function(t){var r;Sw(t)&&(t=t[0]),t=t,this.cells.forEach(function(i,o){hu("RNNCell_"+o,function(){i.build(t),r=Array.isArray(i.stateSize)?i.stateSize[0]:i.stateSize,t=[t[0],r]})}),this.built=!0},e.prototype.getConfig=function(){for(var t=[],r=0,i=this.cells;r<i.length;r++){var o=i[r];t.push({className:o.getClassName(),config:o.getConfig()})}var a={cells:t},s=n.prototype.getConfig.call(this);return Object.assign(a,s),a},e.fromConfig=function(t,r,i){i===void 0&&(i={});for(var o=[],a=0,s=r.cells;a<s.length;a++){var u=s[a];o.push(Fi(u,i))}return new t({cells:o})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var t=[],r=0,i=this.cells;r<i.length;r++){var o=i[r];t.push.apply(t,o.trainableWeights)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],r=0,i=this.cells;r<i.length;r++){var o=i[r];t.push.apply(t,o.nonTrainableWeights)}if(!this.trainable){for(var a=[],s=0,u=this.cells;s<u.length;s++)o=u[s],a.push.apply(a,o.trainableWeights);return a.concat(t)}return t},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){for(var t=[],r=0,i=this.cells;r<i.length;r++){var o=i[r];t.push.apply(t,o.weights)}return Iw(t)},e.prototype.setWeights=function(t){for(var r=[],i=0,o=this.cells;i<o.length;i++)for(var a=o[i],s=a.weights.length,u=t.splice(s),l=0;l<a.weights.length;++l)r.push([a.weights[l],u[l]]);LE(r)},e.className="StackedRNNCells",e}(If);function fc(n,e,t,r){function i(){return ZM(n(),e)}if(t===void 0&&(t=null),r===void 0&&(r=1),r>1){for(var o=[],a=0;a<r;a++)o.push(hc(i,n,t));return o.map(function(s){return ho(s.clone())})}return ho(hc(i,n,t).clone())}ce.registerClass(XE);var MF=function(n){function e(t){var r=n.call(this,t)||this;return r.layer=t.layer,r}return se(e,n),e.prototype.build=function(t){this.built=!0},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.layer!=null&&this.layer.trainable},set:function(t){this.layer!=null&&(this.layer.trainable=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.layer.getWeights()},e.prototype.setWeights=function(t){this.layer.setWeights(t)},e.prototype.getConfig=function(){var t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.prototype.setFastWeightInitDuringBuild=function(t){n.prototype.setFastWeightInitDuringBuild.call(this,t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)},e.fromConfig=function(t,r,i){i===void 0&&(i={});var o=Fi(r.layer,i);delete r.layer;var a={layer:o};return Object.assign(a,r),new t(a)},e}(ht),LF=function(n){function e(t){var r=n.call(this,t)||this;return r.supportsMasking=!0,r}return se(e,n),e.prototype.build=function(t){if((t=Mt(t)).length<3)throw new K("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(t));this.inputSpec=[{shape:t}];var r=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),n.prototype.build.call(this,t)},e.prototype.computeOutputShape=function(t){var r=[(t=Mt(t))[0]].concat(t.slice(2)),i=this.layer.computeOutputShape(r),o=t[1];return[i[0],o].concat(i.slice(1))},e.prototype.call=function(t,r){var i=this;return Z(function(){return AF(function(o,a){return[Ye(i.layer.call(o,r)),[]]},t=Ye(t),[],!1,null,null,!1,!0)[1]})},e.className="TimeDistributed",e}(MF);function xX(n){Mc(m8,"BidirectionalMergeMode",n)}ce.registerClass(LF);var _X="concat",FF=function(n){function e(t){var r=n.call(this,t)||this,i=t.layer.getConfig(),o={};o.className=t.layer.getClassName(),o.config=i,r.forwardLayer=Fi(o),i.goBackwards=i.goBackwards!==!0;var a={};if(a.className=t.layer.getClassName(),a.config=i,r.backwardLayer=Fi(a),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=t.mergeMode===void 0?_X:t.mergeMode,xX(r.mergeMode),t.weights)throw new et("weights support is not implemented for Bidirectional layer yet.");return r._stateful=t.layer.stateful,r.returnSequences=t.layer.returnSequences,r.returnState=t.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=t.layer.inputSpec,r.numConstants=null,r}return se(e,n),Object.defineProperty(e.prototype,"trainable",{get:function(){return this._trainable},set:function(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},e.prototype.setWeights=function(t){var r=t.length,i=Math.floor(r/2);this.forwardLayer.setWeights(t.slice(0,i)),this.backwardLayer.setWeights(t.slice(i))},e.prototype.computeOutputShape=function(t){var r,i,o,a=this.forwardLayer.computeOutputShape(t);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),a=a,this.returnState&&(o=a.slice(1)),r=a[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):i=this.mergeMode==null?[r,r.slice()]:[r],this.returnState?this.mergeMode==null?i.concat(o).concat(o.slice()):[r].concat(o).concat(o.slice()):cr(i)},e.prototype.apply=function(t,r){var i=r==null?null:r.initialState,o=r==null?null:r.constants;r==null&&(r={});var a=RF(t,i,o,this.numConstants);if(t=a.inputs,i=a.initialState,o=a.constants,Array.isArray(t)&&(i=t.slice(1),t=t[0]),(i==null||i.length===0)&&o==null)return n.prototype.apply.call(this,t,r);var s=[],u=[];if(i!=null){var l=i.length;if(l%2>0)throw new K("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=i,s.push.apply(s,i);var c=i.map(function(w){return new Fn({shape:w.shape})});this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),u.push.apply(u,c)}if(o!=null)throw new et("Support for constants in Bidirectional layers is not implemented yet.");for(var h=s[0]instanceof Di,d=0,f=s;d<f.length;d++)if(f[d]instanceof Di!==h)throw new K("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(h){var m=[t].concat(s),v=this.inputSpec.concat(u),y=this.inputSpec;this.inputSpec=v;var g=n.prototype.apply.call(this,m,r);return this.inputSpec=y,g}return n.prototype.apply.call(this,t,r)},e.prototype.call=function(t,r){var i=this;return Z(function(){if(r.mask!=null)throw new et("The support for masking is not implemented for Bidirectional layers yet.");var o,a,s,u,l=r.initialState;if(l==null)o=i.forwardLayer.call(t,r),a=i.backwardLayer.call(t,r);else{var c=l.slice(0,l.length/2),h=l.slice(l.length/2);o=i.forwardLayer.call(t,Object.assign(r,{initialState:c})),a=i.backwardLayer.call(t,Object.assign(r,{initialState:h}))}return i.returnState&&(Array.isArray(o)&&(s=o.slice(1).concat(a.slice(1))),o=o[0],a=a[0]),i.returnSequences&&(a=po(a,1)),i.mergeMode==="concat"?u=QM([o,a]):i.mergeMode==="sum"?u=ot(o,a):i.mergeMode==="ave"?u=He(.5,ot(o,a)):i.mergeMode==="mul"?u=He(o,a):i.mergeMode==null&&(u=[o,a]),i.returnState?i.mergeMode==null?u.concat(s):[u].concat(s):u})},e.prototype.resetStates=function(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},e.prototype.build=function(t){var r=this;hu(this.forwardLayer.name,function(){r.forwardLayer.build(t)}),hu(this.backwardLayer.name,function(){r.backwardLayer.build(t)}),this.built=!0},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(t){n.prototype.setFastWeightInitDuringBuild.call(this,t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)},e.prototype.getConfig=function(){var t={mergeMode:this.mergeMode},r=n.prototype.getConfig.call(this);return Object.assign(t,r),t},e.fromConfig=function(t,r){var i=Fi(r.layer);if(delete r.layer,r.numConstants!=null)throw new et("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var o=r;return o.layer=i,new t(o)},e.className="Bidirectional",e}(MF);function EX(n){return new Sf(n)}function CX(n){return new PL(n)}function SX(n){return new AL(n)}function IX(n){return new DL(n)}function NX(n){return new OL(n)}function TX(n){return new LL(n)}function kX(n){return new ML(n)}function RX(n){return new WL(n)}function AX(n){return new HE(n)}function DX(n){return new jL(n)}function OX(n){return new BL(n)}function PX(n){return new UL(n)}function MX(n){return new VL(n)}function LX(n){return new $L(n)}function FX(n){return new HL(n)}function zX(n){return new XL(n)}function BX(n){return new qL(n)}function jX(n){return new GL(n)}function UX(n){return new KL(n)}function WX(n){return new YL(n)}function VX(n){return new QL(n)}function $X(n){return new JL(n)}function HX(n){return new eF(n)}function GX(n){return new tF(n)}function qX(n){return new rF(n)}function KX(n){return new aF(n)}function XX(n){return new iF(n)}function YX(n){return new oF(n)}function QX(n){return new nF(n)}function JX(n){return new sF(n)}function ZX(n){return new hF(n)}function eY(n){return new dF(n)}function tY(n){return new fF(n)}function YE(n){return new vF(n)}function nY(n){return YE(n)}function rY(n){return YE(n)}function QE(n){return new bF(n)}function iY(n){return QE(n)}function oY(n){return QE(n)}function JE(n){return new EF(n)}function aY(n){return JE(n)}function sY(n){return JE(n)}function uY(n){return new SF(n)}function lY(n){return new TF(n)}function zF(n){return new IF(n)}function BF(n){return new kF(n)}function jF(n){return new gF(n)}function UF(n){return new wF(n)}function cY(n){return new _F(n)}function hY(n){return new OF(n)}function dY(n){return new qE(n)}function fY(n){return new PF(n)}function pY(n){return new KE(n)}function mY(n){return new DF(n)}function gY(n){return new GE(n)}function vY(n){return new Ku(n)}function yY(n){return new XE(n)}function wY(n){return new FF(n)}function bY(n){return new LF(n)}ce.registerClass(FF);var xY=zF,_Y=BF,EY=jF,CY=UF;function SY(n){return new uF(n)}function IY(n){return new lF(n)}function NY(n){return new cF(n)}function TY(n){return new ZL(n)}var kY=Object.freeze({inputLayer:EX,elu:CX,reLU:SX,leakyReLU:IX,prelu:NX,softmax:TX,thresholdedReLU:kX,conv1d:RX,conv2d:AX,conv2dTranspose:DX,conv3d:OX,separableConv2d:PX,cropping2D:MX,upSampling2d:LX,depthwiseConv2d:FX,activation:zX,dense:BX,dropout:jX,flatten:UX,repeatVector:WX,reshape:VX,permute:$X,embedding:HX,add:GX,average:qX,concatenate:KX,maximum:XX,minimum:YX,multiply:QX,dot:JX,batchNormalization:ZX,layerNormalization:eY,zeroPadding2d:tY,averagePooling1d:YE,avgPool1d:nY,avgPooling1d:rY,averagePooling2d:QE,avgPool2d:iY,avgPooling2d:oY,averagePooling3d:JE,avgPool3d:aY,avgPooling3d:sY,globalAveragePooling1d:uY,globalAveragePooling2d:lY,globalMaxPooling1d:zF,globalMaxPooling2d:BF,maxPooling1d:jF,maxPooling2d:UF,maxPooling3d:cY,gru:hY,gruCell:dY,lstm:fY,lstmCell:pY,simpleRNN:mY,simpleRNNCell:gY,rnn:vY,stackedRNNCells:yY,bidirectional:wY,timeDistributed:bY,globalMaxPool1d:xY,globalMaxPool2d:_Y,maxPool1d:EY,maxPool2d:CY,Layer:ht,RNN:Ku,RNNCell:If,input:TL,gaussianNoise:SY,gaussianDropout:IY,alphaDropout:NY,masking:TY});function RY(n,e){return zE(n,e)}function AY(n,e){return bL(n,e)}function DY(n,e){return xL(n,e)}function OY(n,e){return BE(n,e)}function PY(n,e){return jE(n,e)}function MY(n,e){return wL(n,e)}function LY(n,e){return cK(n,e)}function FY(n,e){return FE(n,e)}function zY(n,e){return Jv(n,e)}function BY(n,e){return Lc(n,e)}function jY(n,e){return Lc(n,e)}function UY(n,e){return Lc(n,e)}function WY(n,e){return Gu(n,e)}function VY(n,e){return Gu(n,e)}function $Y(n,e){return Gu(n,e)}var HY=Object.freeze({binaryAccuracy:RY,binaryCrossentropy:AY,sparseCategoricalAccuracy:DY,categoricalAccuracy:OY,categoricalCrossentropy:PY,precision:MY,recall:LY,cosineProximity:FY,meanAbsoluteError:zY,meanAbsolutePercentageError:BY,MAPE:jY,mape:UY,meanSquaredError:WY,MSE:VY,mse:$Y}),GY=Object.freeze({modelFromJSON:HK});function qY(n){return new ty(n)}function KY(n){return cX(n)}function XY(n){return hX(n)}var YY=Object.freeze({l1l2:qY,l1:KY,l2:XY}),WF=function(n){function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.model=null,t}return se(e,n),e.prototype.setModel=function(t){if(!(t instanceof fu))throw new Error("model must be a LayersModel, not some other Container");this.model=t},e}(dc);function Ep(n,e){return n<e}function MN(n,e){return n>e}var VF=function(n){function e(t){var r=n.call(this)||this;if(t==null&&(t={}),t.restoreBestWeights)throw new et("restoreBestWeights = True is not implemented in EarlyStopping yet.");return r.monitor=t.monitor||"val_loss",r.minDelta=Math.abs(t.minDelta||0),r.patience=t.patience||0,r.verbose=t.verbose||0,r.mode=t.mode||"auto",r.baseline=t.baseline,["auto","min","max"].indexOf(r.mode)===-1&&(console.warn("EarlyStopping mode '"+r.mode+"' is invalid. Falling back to mode 'auto'."),r.mode="auto"),r.mode==="min"?r.monitorFunc=Ep:r.mode==="max"||r.monitor.indexOf("acc")!==-1?r.monitorFunc=MN:r.monitorFunc=Ep,r.monitorFunc===Ep&&(r.minDelta*=-1),r}return se(e,n),e.prototype.onTrainBegin=function(t){return $e(this,void 0,void 0,function(){return Pe(this,function(r){return this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===Ep?1/0:-1/0,[2]})})},e.prototype.onEpochEnd=function(t,r){return $e(this,void 0,void 0,function(){var i;return Pe(this,function(o){switch(o.label){case 0:return[4,Ta(r)];case 1:return o.sent(),(i=this.getMonitorValue(r))==null?[2]:(this.monitorFunc(i-this.minDelta,this.best)?(this.best=i,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)),[2])}})})},e.prototype.onTrainEnd=function(t){return $e(this,void 0,void 0,function(){return Pe(this,function(r){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},e.prototype.getMonitorValue=function(t){t==null&&(t={});var r=t[this.monitor];return r==null&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(t)),r},e}(WF);function QY(n){return new VF(n)}var JY={earlyStopping:QY};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Oo,LN,Dw=function(){return(Dw=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}).apply(this,arguments)};function ku(n,e,t,r){return new(t||(t=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(c){o(c)}}function s(l){try{u(r.throw(l))}catch(c){o(c)}}function u(l){l.done?i(l.value):new t(function(c){c(l.value)}).then(a,s)}u((r=r.apply(n,[])).next())})}function Ru(n,e){var t,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){a.label=c[1];break}if(c[0]===6&&a.label<i[1]){a.label=i[1],i=c;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(n,a)}catch(h){c=[6,h],r=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(Oo||(Oo={})),function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))}(LN||(LN={}));var ZE={};function ZY(n,e){var t={tfOpName:n,category:"custom",inputs:[],attrs:[],customExecutor:e};ZE[n]=t}function $F(n){return ZE[n]}function eQ(n){delete ZE[n]}function P(n,e,t,r){var i=e.inputParams[n];if(i&&i.inputIndexStart!==void 0){var o=i.inputIndexStart,a=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?o+1:i.inputIndexEnd;if(i.type==="tensor")return hr(e.inputNames[i.inputIndexStart],t,r);if(i.type==="tensors")return e.inputNames.slice(o,a).map(function(l){return hr(l,t,r)});var s=Array.prototype.slice.call(hr(e.inputNames.slice(o)[0],t,r).dataSync());return i.type==="number"?s[0]:s}var u=e.attrParams[n];return u&&u.value}function hr(n,e,t){var r=Hh(n),i=r[0],o=r[1],a=t.currentContextIds.find(function(s){return!!e[yg(i,s)]});return a!==void 0?e[yg(i,a)][o]:void 0}function tQ(n,e,t){return e[yg(n,t.currentContextId)]}function em(n,e){var t=Hh(n),r=t[0],i=t[1];return[yg(r,e&&e.currentContextId),i]}function yg(n,e){return e?n+"-"+e:n}function Hh(n){var e=n.lastIndexOf(":");return e===-1?[n,0]:[n.substring(0,e),Number(n.substring(e+1))]}function k0(n,e){for(var t=[],r=0;r<n.length;r+=e)t.push(n.slice(r,r+e));return t}var nQ=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],rQ=Object.freeze({json:nQ}),iQ=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],oQ=Object.freeze({json:iQ}),aQ=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],sQ=Object.freeze({json:aQ}),uQ=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],lQ=Object.freeze({json:uQ}),cQ=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],hQ=Object.freeze({json:cQ}),dQ=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],fQ=Object.freeze({json:dQ}),pQ=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],mQ=Object.freeze({json:pQ}),gQ=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],vQ=Object.freeze({json:gQ}),yQ=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],wQ=Object.freeze({json:yQ}),bQ=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],xQ=Object.freeze({json:bQ}),_Q=[{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],EQ=Object.freeze({json:_Q}),CQ=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],SQ=Object.freeze({json:CQ}),IQ=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],NQ=Object.freeze({json:IQ}),TQ=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],kQ=Object.freeze({json:TQ}),RQ=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],AQ=Object.freeze({json:RQ}),DQ=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],OQ=Object.freeze({json:DQ}),PQ=function(){function n(){var e=[rQ,oQ,sQ,lQ,hQ,fQ,mQ,xQ,wQ,vQ,EQ,SQ,NQ,kQ,AQ,OQ],t=[].concat.apply([],e.map(function(r){return r.json}));this.opMappers=t.reduce(function(r,i){return r[i.tfOpName]=i,r},{})}return Object.defineProperty(n,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),n.prototype.transformGraph=function(e){var t=this,r=[],i=[],o=e.node.reduce(function(l,c){return l[c.name]=t.mapNode(c),c.op==="Placeholder"&&r.push(l[c.name]),c.op==="Const"&&i.push(l[c.name]),l},{}),a=[],s=[],u=Object.keys(o);return u.forEach(function(l){var c=o[l];c.inputNames.forEach(function(h){var d=em(h)[0];c.inputs.push(o[d]),o[d].children.push(c)}),c.inputs.length===0&&a.push(c)}),u.forEach(function(l){var c=o[l];c.children.length===0&&s.push(c)}),{nodes:o,inputs:a,outputs:s,weights:i,placeholders:r}},n.prototype.mapNode=function(e){var t=$F(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});var r={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(function(i){return i.startsWith("^")?i.substr(1):i}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return t.inputs!=null&&(r.inputParams=t.inputs.reduce(function(i,o){return i[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},i},{})),t.attrs!=null&&(r.attrParams=t.attrs.reduce(function(i,o){var a=o.type,s=void 0;switch(o.type){case"string":(s=Ow(e.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Ow(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":(s=jw(e.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=jw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":(s=Mw(e.attr,o.tfName,o.defaultValue||0))===void 0&&o.tfDeprecatedName&&(s=Mw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":(s=Bw(e.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Bw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":(s=Pw(e.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Pw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":(s=Ww(e.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Ww(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":(s=zw(e.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=zw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":(s=Uw(e.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Uw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":(s=Lw(e.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Lw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":(s=Fw(e.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Fw(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+o.type+" for op: "+e.op)}return i[o.name]={value:s,type:a},i},{})),r},n}();function MQ(n){var e=te().global;if(e.atob!==void 0)return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function HF(n,e){var t=Array.isArray(n)?String.fromCharCode.apply(null,n):MQ(n);return e?t:t.toLowerCase()}function Ow(n,e,t,r){r===void 0&&(r=!1);var i=n[e];return i!=null?HF(i.s,r):t}function Pw(n,e,t){var r=n[e];return r?r.b:t}function Mw(n,e,t){var r=n[e]||{},i=r.i!=null?r.i:r.f!=null?r.f:t;return typeof i=="number"?i:parseInt(i,10)}function GF(n){switch(typeof n=="string"&&(n=Oo[n]),n){case Oo.DT_FLOAT:return"float32";case Oo.DT_INT32:case Oo.DT_INT64:return"int32";case Oo.DT_BOOL:return"bool";case Oo.DT_DOUBLE:return"float32";case Oo.DT_STRING:return"string";default:return null}}function Lw(n,e,t){var r=n[e];return r&&r.type?GF(r.type):t}function Fw(n,e,t){var r=n[e];return r&&r.list&&r.list.type?r.list.type.map(function(i){return GF(i)}):t}function qF(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(function(e){return typeof e.size=="number"?e.size:parseInt(e.size,10)}):[]}function zw(n,e,t){var r=n[e];return r&&r.shape?qF(r.shape):t}function Bw(n,e,t){var r=n[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(function(i){return typeof i=="number"?i:parseInt(i,10)}):t}function jw(n,e,t,r){r===void 0&&(r=!1);var i=n[e];return i&&i.list&&i.list.s?i.list.s.map(function(o){return HF(o,r)}):t}function Uw(n,e,t){var r=n[e];return r&&r.list&&r.list.shape?r.list.shape.map(function(i){return qF(i)}):t}function Ww(n,e,t){var r=n[e];return r&&r.list&&r.list.b?r.list.b:t}var LQ=function(){function n(e,t,r){var i=this;this.node=e,this.tensorMap=t,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(function(o){return i.getInput(o)}),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce(function(o,a){return o[a]=i.getAttr(a),o},{}))}return n.prototype.getInput=function(e){return hr(e,this.tensorMap,this.context)},n.prototype.getAttr=function(e,t){var r=this.node.rawAttrs[e];if(r.tensor!=null)return hr(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return Mw(this.node.rawAttrs,e,t);if(r.s!=null)return Ow(this.node.rawAttrs,e,t);if(r.b!=null)return Pw(this.node.rawAttrs,e,t);if(r.shape!=null)return zw(this.node.rawAttrs,e,t);if(r.type!=null)return Lw(this.node.rawAttrs,e,t);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return Bw(this.node.rawAttrs,e,t);if(r.list.s!=null)return jw(this.node.rawAttrs,e,t);if(r.list.shape!=null)return Uw(this.node.rawAttrs,e,t);if(r.list.b!=null)return Ww(this.node.rawAttrs,e,t);if(r.list.type!=null)return Fw(this.node.rawAttrs,e,t)}return t},n}(),FQ=function(n,e,t){switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[ot(P("a",n,e,t),P("b",n,e,t))];case"AddN":return[K_(P("tensors",n,e,t))];case"FloorMod":case"Mod":return[Y_(P("a",n,e,t),P("b",n,e,t))];case"Mul":return[He(P("a",n,e,t),P("b",n,e,t))];case"RealDiv":case"Div":return[sr(P("a",n,e,t),P("b",n,e,t))];case"FloorDiv":return[Nv(P("a",n,e,t),P("b",n,e,t))];case"Sub":return[Un(P("a",n,e,t),P("b",n,e,t))];case"Minimum":return[Rc(P("a",n,e,t),P("b",n,e,t))];case"Maximum":return[wo(P("a",n,e,t),P("b",n,e,t))];case"Pow":return[oc(P("a",n,e,t),P("b",n,e,t))];case"SquaredDifference":return[Q_(P("a",n,e,t),P("b",n,e,t))];default:throw TypeError("Node type "+n.op+" is not implemented")}},zQ=function(n,e,t){switch(n.op){case"Abs":case"ComplexAbs":return[gs(P("x",n,e,t))];case"Acos":return[C_(P("x",n,e,t))];case"Acosh":return[S_(P("x",n,e,t))];case"Asin":return[I_(P("x",n,e,t))];case"Asinh":return[N_(P("x",n,e,t))];case"Atan":return[T_(P("x",n,e,t))];case"Atan2":return[X_(P("x",n,e,t),P("y",n,e,t))];case"Atanh":return[k_(P("x",n,e,t))];case"Ceil":return[R_(P("x",n,e,t))];case"Complex":return[Tn(P("real",n,e,t),P("imag",n,e,t))];case"Cos":return[A_(P("x",n,e,t))];case"Cosh":return[D_(P("x",n,e,t))];case"Elu":return[Pc(P("x",n,e,t))];case"Erf":return[O_(P("x",n,e,t))];case"Exp":return[P_(P("x",n,e,t))];case"Expm1":return[M_(P("x",n,e,t))];case"Floor":return[bv(P("x",n,e,t))];case"Log":return[ia(P("x",n,e,t))];case"Log1p":return[L_(P("x",n,e,t))];case"Imag":return[li(P("x",n,e,t))];case"Neg":return[Vu(P("x",n,e,t))];case"Reciprocal":return[F_(P("x",n,e,t))];case"Real":return[Ir(P("x",n,e,t))];case"Relu":return[As(P("x",n,e,t))];case"Round":return[z_(P("x",n,e,t))];case"Selu":return[Vv(P("x",n,e,t))];case"Sigmoid":return[_v(P("x",n,e,t))];case"Sin":return[j_(P("x",n,e,t))];case"Sign":return[B_(P("x",n,e,t))];case"Sinh":return[U_(P("x",n,e,t))];case"Softplus":return[cf(P("x",n,e,t))];case"Sqrt":return[hf(P("x",n,e,t))];case"Square":return[E_(P("x",n,e,t))];case"Tanh":return[Ev(P("x",n,e,t))];case"Tan":return[W_(P("x",n,e,t))];case"Relu6":case"ClipByValue":return[vr(P("x",n,e,t),P("clipValueMin",n,e,t),P("clipValueMax",n,e,t))];case"Rsqrt":return[xv(hr(n.inputNames[0],e,t))];case"Prod":return[jv(P("x",n,e,t),P("axes",n,e,t))];case"LeakyRelu":return[Uv(P("x",n,e,t),P("alpha",n,e,t))];default:throw TypeError("Node type "+n.op+" is not implemented")}},BQ=function(){function n(e,t,r,i,o,a,s){this.name=e,this.dtype=t,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=o,this.dynamicSize=a,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=n.nextId++}return Object.defineProperty(n.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),n.prototype.clearAndClose=function(){this.tensors.forEach(function(e){return e.tensor.dispose()}),this.tensors=[],this.closed_=!0},n.prototype.size=function(){return this.tensors.length},n.prototype.read=function(e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||e>=this.tensors.length)throw new Error("Tried to read from index "+e+", but array size is: "+this.tensors.length);var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+e+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor},n.prototype.readMany=function(e){var t=this;return e.map(function(r){return t.read(r)})},n.prototype.write=function(e,t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index "+e+", but array is not resizeable and size is: "+this.maxSize);var r=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+`,
          because the value dtype is `+t.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=t.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,t.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+e+"."),r&&r.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been read.");if(r&&r.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been written.");r.tensor=t,r.written=!0,this.tensors[e]=r},n.prototype.writeMany=function(e,t){var r=this;if(e.length!==t.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+e.length+" is not the same as tensors size: "+t.length+".");e.forEach(function(i,o){return r.write(i,t[o])})},n.prototype.gather=function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+t);if(!e){e=[];for(var r=0;r<this.size();r++)e.push(r)}if(e.length===0)return gn([],[0].concat(this.elementShape));var i=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: "),Ui(i,0)},n.prototype.concat=function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+e);if(this.size()===0)return gn([],[0].concat(this.elementShape));for(var t=[],r=0;r<this.size();r++)t.push(r);var i=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+i[0].shape+")"),ar(i,0)},n.prototype.scatter=function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+e.length+" vs. "+t.shape[0]);var r=Math.max.apply(Math,e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error("Max index must be < array size ("+r+"  vs. "+this.maxSize+")");this.writeMany(e,Iu(t,0))},n.prototype.split=function(e,t){var r=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);var i=0,o=e.map(function(c){return i+=c});if(i!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+i+", and tensor's shape is: "+t.shape);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+e.length+"), and the TensorArray is not marked as dynamically resizeable");var a=i===0?0:t.size/i,s=[];Z(function(){t=t.reshape([1,i,a]);for(var c=0;c<e.length;++c){var h=[0,c===0?0:o[c-1],0],d=[1,e[c],a];s[c]=Yr(t,h,d).reshape(r.elementShape)}return s});for(var u=[],l=0;l<e.length;l++)u[l]=l;this.writeMany(u,s)},n.prototype.assertShapesMatchAllowUndefinedSize=function(e,t,r){r===void 0&&(r=""),De.assert(this.shapesEqualAllowUndefinedSize(e,t),function(){return r+" Shapes "+e+" and "+t+" must match"})},n.prototype.shapesEqualAllowUndefinedSize=function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==-1&&t[r]!==-1&&e[r]!==t[r])return!1;return!0},n.nextId=0,n}();function jQ(n,e,t){return ku(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,h,d,f,m,v,y,g,w,b,S,E,T,_,x,C,N,R,k,D,W,U,j,H,z,q,F,oe;return Ru(this,function(Q){switch(Q.label){case 0:switch(n.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[P("pred",n,e,t).clone()]];case 2:return r=P("pred",n,e,t),i=P("data",n,e,t),[4,r.data()];case 3:return[2,Q.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(o=n.inputNames.find(function(ae){return hr(ae,e,t)!==void 0}))?[hr(o,e,t).clone()]:void 0];case 5:return a=P("frameName",n,e,t),s=P("tensor",n,e,t),t.enterFrame(a),[2,[s.clone()]];case 6:return u=P("tensor",n,e,t),t.exitFrame(),[2,[u.clone()]];case 7:return l=P("tensor",n,e,t),t.nextIteration(),[2,[l.clone()]];case 8:return c=P("size",n,e,t),h=P("dtype",n,e,t),d=P("elementShape",n,e,t),f=P("dynamicSize",n,e,t),m=P("clearAfterRead",n,e,t),v=P("identicalElementShapes",n,e,t),y=P("name",n,e,t),g=new BQ(y,h,c,d,v,f,m),t.addTensorArray(g),[2,[Ee(g.id),Ee(1)]];case 9:return w=P("tensorArrayId",n,e,t),b=P("index",n,e,t),S=P("tensor",n,e,t),t.getTensorArray(w).write(b,S),[2,[Ee(1)]];case 10:return E=P("tensorArrayId",n,e,t),T=P("index",n,e,t),[2,[t.getTensorArray(E).read(T)]];case 11:return _=P("tensorArrayId",n,e,t),x=P("indices",n,e,t),C=P("dtype",n,e,t),[2,[t.getTensorArray(_).gather(x,C)]];case 12:return N=P("tensorArrayId",n,e,t),R=P("indices",n,e,t),k=P("tensor",n,e,t),t.getTensorArray(N).scatter(R,k),[2,[Ee(1)]];case 13:return D=P("tensorArrayId",n,e,t),W=t.getTensorArray(D),U=P("dtype",n,e,t),[2,[W.concat(U)]];case 14:return j=P("tensorArrayId",n,e,t),H=P("tensor",n,e,t),z=P("lengths",n,e,t),t.getTensorArray(j).split(z,H),[2,[Ee(1)]];case 15:return q=P("tensorArrayId",n,e,t),F=t.getTensorArray(q),[2,[Ee(F.size(),"int32")]];case 16:return oe=P("tensorArrayId",n,e,t),t.getTensorArray(oe).clearAndClose(),[2,[]];case 17:throw TypeError("Node type "+n.op+" is not implemented")}})})}var UQ=function(n,e,t){var r,i;switch(n.op){case"Conv1D":var o=P("stride",n,e,t),a=P("pad",n,e,t),s=P("dataFormat",n,e,t).toUpperCase(),u=P("dilation",n,e,t);return[kv(P("x",n,e,t),P("filter",n,e,t),o,a,s,u)];case"Conv2D":o=P("strides",n,e,t),a=P("pad",n,e,t),s=P("dataFormat",n,e,t).toUpperCase();var l=P("dilations",n,e,t);return[Hu(P("x",n,e,t),P("filter",n,e,t),[o[1],o[2]],a,s,[l[1],l[2]])];case"_FusedConv2D":var c=(r=P("fusedOps",n,e,t))[0],h=r[1],d=c==="biasadd",f=h==="prelu",m=c==="fusedbatchnorm",v=P("numArgs",n,e,t);if(d){if(f&&v!==2)throw new Error("Fused Conv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!f&&v!==1)throw new Error("Fused Conv2d with BiasAdd must have one extra argument: bias.")}if(m)throw new Error("Fused Conv2d with FusedBatchNorm is not supported.");o=P("strides",n,e,t),a=P("pad",n,e,t),s=P("dataFormat",n,e,t).toUpperCase(),l=P("dilations",n,e,t);var y=(i=P("args",n,e,t))[0],g=i[1];return[lc.conv2d({x:P("x",n,e,t),filter:P("filter",n,e,t),strides:[o[1],o[2]],pad:a,dataFormat:s,dilations:[l[1],l[2]],bias:y,activation:h,preluActivationWeights:g})];case"Conv2DBackpropInput":case"Conv2dTranspose":var w=P("outputShape",n,e,t);return o=P("strides",n,e,t),a=P("pad",n,e,t),[Av(P("x",n,e,t),P("filter",n,e,t),w,[o[1],o[2]],a)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return o=P("strides",n,e,t),a=P("pad",n,e,t),l=P("dilations",n,e,t),s=P("dataFormat",n,e,t).toUpperCase(),[Oc(P("input",n,e,t),P("filter",n,e,t),[o[1],o[2]],a,s,[l[1],l[2]])];case"Conv3D":return o=P("strides",n,e,t),a=P("pad",n,e,t),s=P("dataFormat",n,e,t).toUpperCase(),l=P("dilations",n,e,t),[Rv(P("x",n,e,t),P("filter",n,e,t),[o[1],o[2],o[3]],a,s,[l[1],l[2],l[3]])];case"AvgPool":o=P("strides",n,e,t),a=P("pad",n,e,t);var b=P("kernelSize",n,e,t);return[Pv(P("x",n,e,t),[b[1],b[2]],[o[1],o[2]],a)];case"MaxPool":return o=P("strides",n,e,t),a=P("pad",n,e,t),b=P("kernelSize",n,e,t),[Ov(P("x",n,e,t),[b[1],b[2]],[o[1],o[2]],a)];case"AvgPool3D":return o=P("strides",n,e,t),a=P("pad",n,e,t),b=P("kernelSize",n,e,t),[Lv(P("x",n,e,t),[b[1],b[2],b[3]],[o[1],o[2],o[3]],a)];case"MaxPool3D":return o=P("strides",n,e,t),a=P("pad",n,e,t),b=P("kernelSize",n,e,t),[Mv(P("x",n,e,t),[b[1],b[2],b[3]],[o[1],o[2],o[3]],a)];default:throw TypeError("Node type "+n.op+" is not implemented")}},WQ=function(n,e,t){switch(n.op){case"Fill":var r=P("shape",n,e,t),i=P("dtype",n,e,t),o=P("value",n,e,t);return[Tc(r,o,i)];case"LinSpace":var a=P("start",n,e,t),s=P("stop",n,e,t),u=P("num",n,e,t);return[t_(a,s,u)];case"Multinomial":var l=P("logits",n,e,t),c=P("numSamples",n,e,t),h=P("seed",n,e,t);return[u_(l,c,h)];case"OneHot":var d=P("indices",n,e,t),f=P("depth",n,e,t),m=P("onValue",n,e,t),v=P("offValue",n,e,t);return[rc(d,f,m,v)];case"Ones":return[yo(P("shape",n,e,t),P("dtype",n,e,t))];case"OnesLike":return[Xr(P("x",n,e,t))];case"RandomUniform":return[Uu(P("shape",n,e,t),P("minval",n,e,t),P("maxval",n,e,t),P("dtype",n,e,t))];case"Range":a=P("start",n,e,t);var y=P("stop",n,e,t),g=P("step",n,e,t);return[cv(a,y,g,P("dtype",n,e,t))];case"TruncatedNormal":r=P("shape",n,e,t);var w=P("mean",n,e,t),b=P("stdDev",n,e,t);return h=P("seed",n,e,t),[uf(r,w,b,P("dtype",n,e,t),h)];case"Zeros":return[St(P("shape",n,e,t),P("dtype",n,e,t))];case"ZerosLike":return[ct(P("x",n,e,t))];default:throw TypeError("Node type "+n.op+" is not implemented")}};function VQ(n,e,t){return ku(this,void 0,void 0,function(){var r,i,o,a,s;return Ru(this,function(u){switch(u.label){case 0:switch(n.op){case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,3];case"ListDiff":return[3,5]}return[3,6];case 1:return r=P("boxes",n,e,t),i=P("scores",n,e,t),o=P("maxOutputSize",n,e,t),a=P("iouThreshold",n,e,t),s=P("scoreThreshold",n,e,t),[4,cu.nonMaxSuppressionAsync(r,i,o,a,s)];case 2:return[2,[u.sent()]];case 3:return[4,Iv(P("condition",n,e,t).asType("bool"))];case 4:return[2,[u.sent()]];case 5:return[2,c_(P("x",n,e,t),P("y",n,e,t))];case 6:throw TypeError("Node type "+n.op+" is not implemented")}})})}var $Q=function(n,e,t){switch(n.op){case"TopKV2":var r=P("x",n,e,t),i=P("k",n,e,t),o=P("sorted",n,e,t),a=uE(r,i,o);return[a.values,a.indices];default:throw TypeError("Node type "+n.op+" is not implemented")}},HQ=function(n,e,t){switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":var r=P("default",n,e,t);return[hr(n.name,e,t)||r];case"Placeholder":return[hr(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[P("x",n,e,t).clone()];case"IdentityN":return P("x",n,e,t).map(function(l){return l.clone()});case"Snapshot":return[P("x",n,e,t).clone()];case"Shape":return[Or(P("x",n,e,t).shape,"int32")];case"ShapeN":return P("x",n,e,t).map(function(l){return Or(l.shape)});case"Size":return[Ee(P("x",n,e,t).size,"int32")];case"Rank":return[Ee(P("x",n,e,t).rank,"int32")];case"NoOp":return[];case"Print":var i=P("x",n,e,t),o=P("data",n,e,t),a=P("message",n,e,t),s=P("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(a);for(var u=0;u<o.length;u++)console.log(Array.prototype.slice.call(o[u].dataSync()).slice(0,s));return[i];default:throw TypeError("Node type "+n.op+" is not implemented")}},GQ=function(n,e,t){switch(n.op){case"ResizeBilinear":var r=P("images",n,e,t),i=P("size",n,e,t),o=P("alignCorners",n,e,t);return[cu.resizeBilinear(r,[i[0],i[1]],o)];case"ResizeNearestNeighbor":return r=P("images",n,e,t),i=P("size",n,e,t),o=P("alignCorners",n,e,t),[cu.resizeNearestNeighbor(r,[i[0],i[1]],o)];case"CropAndResize":var a=P("image",n,e,t),s=P("boxes",n,e,t),u=P("boxInd",n,e,t),l=P("cropSize",n,e,t),c=P("method",n,e,t),h=P("extrapolationValue",n,e,t);return[cu.cropAndResize(a,s,u,l,c,h)];default:throw TypeError("Node type "+n.op+" is not implemented")}},qQ=function(n,e,t){switch(n.op){case"Equal":return[$u(P("a",n,e,t),P("b",n,e,t))];case"NotEqual":return[ac(P("a",n,e,t),P("b",n,e,t))];case"Greater":return[Ac(P("a",n,e,t),P("b",n,e,t))];case"GreaterEqual":return[ff(P("a",n,e,t),P("b",n,e,t))];case"Less":return[J_(P("a",n,e,t),P("b",n,e,t))];case"LessEqual":return[Z_(P("a",n,e,t),P("b",n,e,t))];case"LogicalAnd":return[da(P("a",n,e,t),P("b",n,e,t))];case"LogicalNot":return[q_(P("a",n,e,t))];case"LogicalOr":return[Sv(P("a",n,e,t),P("b",n,e,t))];case"Select":return[oa(P("condition",n,e,t),P("a",n,e,t),P("b",n,e,t))];default:throw TypeError("Node type "+n.op+" is not implemented")}},KQ=function(n,e,t){switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[Dv(P("a",n,e,t),P("b",n,e,t),P("transposeA",n,e,t),P("transposeB",n,e,t))];case"Transpose":return[Yt(P("x",n,e,t),P("perm",n,e,t))];default:throw TypeError("Node type "+n.op+" is not implemented")}},XQ=function(n,e,t){switch(n.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[V_(P("x",n,e,t),P("mean",n,e,t),P("variance",n,e,t),P("offset",n,e,t),P("scale",n,e,t),P("epsilon",n,e,t))];case"LRN":return[oE(P("x",n,e,t),P("radius",n,e,t),P("bias",n,e,t),P("alpha",n,e,t),P("beta",n,e,t))];case"Softmax":return[Wu(P("x",n,e,t))];case"LogSoftmax":return[yv(P("x",n,e,t))];case"SparseToDense":return[Hv(P("sparseIndices",n,e,t),P("outputShape",n,e,t),P("sparseValues",n,e,t),P("defaultValue",n,e,t))];default:throw TypeError("Node type "+n.op+" is not implemented")}},YQ=function(n,e,t){switch(n.op){case"Max":var r=P("axis",n,e,t),i=P("keepDims",n,e,t);return[vs(P("x",n,e,t),r,i)];case"Mean":return r=P("axis",n,e,t),i=P("keepDims",n,e,t),[yn(P("x",n,e,t),r,i)];case"Min":return r=P("axis",n,e,t),i=P("keepDims",n,e,t),[Bv(P("x",n,e,t),r,i)];case"Sum":return r=P("axis",n,e,t),i=P("keepDims",n,e,t),[Pr(P("x",n,e,t),r,i)];case"All":return r=P("axis",n,e,t),i=P("keepDims",n,e,t),[zv(P("x",n,e,t),r,i)];case"Any":return r=P("axis",n,e,t),i=P("keepDims",n,e,t),[Dd(P("x",n,e,t),r,i)];case"ArgMax":return r=P("axis",n,e,t),[Od(P("x",n,e,t),r)];case"ArgMin":return r=P("axis",n,e,t),[rE(P("x",n,e,t),r)];case"Prod":return r=P("axis",n,e,t),i=P("keepDims",n,e,t),[jv(P("x",n,e,t),r,i)];default:throw TypeError("Node type "+n.op+" is not implemented")}},QQ=function(n,e,t){switch(n.op){case"ConcatV2":case"Concat":var r=P("axis",n,e,t),i=P("tensors",n,e,t);return[ar(i,r)];case"GatherV2":case"Gather":r=P("axis",n,e,t);var o=P("x",n,e,t),a=P("indices",n,e,t);return[Dc(o,a.asType("int32"),r)];case"ReverseV2":case"Reverse":return r=P("axis",n,e,t),o=P("x",n,e,t),[po(o,r)];case"Slice":var s=P("begin",n,e,t),u=P("size",n,e,t);return[Yr(P("x",n,e,t),s,u)];case"StridedSlice":s=P("begin",n,e,t);var l=P("end",n,e,t),c=P("strides",n,e,t),h=P("beginMask",n,e,t),d=P("endMask",n,e,t),f=P("ellipsisMask",n,e,t),m=P("newAxisMask",n,e,t),v=P("shrinkAxisMask",n,e,t),y=P("x",n,e,t);if(s.length===1&&y.shape.length>1)for(var g=1;g<y.shape.length;g++)s.push(0),l.push(y.shape[g]),c.push(c[0]);return[sE(y,s,l,c,h,d,f,m,v)];case"Pack":return Z(function(){var C=P("axis",n,e,t),N=P("tensors",n,e,t),R=N[0].shape,k=N[0].squeeze().shape,D=N.map(function(W){var U=De.arraysEqual(W.shape,R);if(!U&&!De.arraysEqual(W.squeeze().shape,k))throw new Error("the input tensors shape does not match");return U?W:W.reshape(R)});return[Ui(D,C)]});case"Unpack":return Z(function(){var C=P("axis",n,e,t),N=P("tensor",n,e,t);return Iu(N,C)});case"Tile":var w=P("reps",n,e,t);return[is(P("x",n,e,t),w)];case"Split":case"SplitV":r=P("axis",n,e,t);var b=P("numOrSizeSplits",n,e,t);return qo(P("x",n,e,t),b,r);case"ScatterNd":a=P("indices",n,e,t);var S=P("values",n,e,t),E=P("shape",n,e,t);return[lE(a,S,E)];case"GatherNd":var T=P("x",n,e,t);return a=P("indices",n,e,t),[cE(T,a)];case"SparseToDense":a=P("sparseIndices",n,e,t),E=P("outputShape",n,e,t);var _=P("sparseValues",n,e,t),x=P("defaultValue",n,e,t);return[Hv(a,_,E,_.dtype===x.dtype?x:x.asType(_.dtype))];default:throw TypeError("Node type "+n.op+" is not implemented")}},JQ=function(n,e,t){switch(n.op){case"FFT":return[vf(P("x",n,e,t))];case"IFFT":return[uc(P("x",n,e,t))];case"RFFT":return[yf(P("x",n,e,t))];case"IRFFT":return[$v(P("x",n,e,t))];default:throw TypeError("Node type "+n.op+" is not implemented")}},ZQ=function(n,e,t){switch(n.op){case"Cast":return[fv(P("x",n,e,t),P("dtype",n,e,t))];case"ExpandDims":var r=P("axis",n,e,t);return[Ur(P("x",n,e,t),r)];case"Squeeze":return r=P("axis",n,e,t),[sf(P("x",n,e,t),r)];case"Reshape":return[af(P("x",n,e,t),P("shape",n,e,t))];case"PadV2":case"Pad":return[ks(P("x",n,e,t),k0(P("padding",n,e,t),2),P("constantValue",n,e,t))];case"SpaceToBatchND":var i=P("blockShape",n,e,t),o=k0(P("paddings",n,e,t),2);return[mv(P("x",n,e,t),i,o)];case"BatchToSpaceND":i=P("blockShape",n,e,t);var a=k0(P("crops",n,e,t),2);return[dv(P("x",n,e,t),i,a)];case"DepthToSpace":var s=P("blockSize",n,e,t),u=P("dataFormat",n,e,t).toUpperCase();return[s_(P("x",n,e,t),s,u)];default:throw TypeError("Node type "+n.op+" is not implemented")}};function FN(n,e,t){var r=function(i,o,a){switch(i.category){case"arithmetic":return FQ(i,o,a);case"basic_math":return zQ(i,o,a);case"control":return jQ(i,o,a);case"convolution":return UQ(i,o,a);case"creation":return WQ(i,o,a);case"dynamic":return VQ(i,o,a);case"evaluation":return $Q(i,o,a);case"image":return GQ(i,o,a);case"graph":return HQ(i,o,a);case"logical":return qQ(i,o,a);case"matrices":return KQ(i,o,a);case"normalization":return XQ(i,o,a);case"reduction":return YQ(i,o,a);case"slice_join":return QQ(i,o,a);case"spectral":return JQ(i,o,a);case"transformation":return ZQ(i,o,a);case"custom":var s=$F(i.op);if(s&&s.customExecutor)return s.customExecutor(new LQ(i,o,a));throw TypeError("Custom op "+i.op+" is not registered.");default:throw TypeError("Unknown op '"+i.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(n,e,t);return r instanceof Promise?r.then(function(i){return[].concat(i)}):[].concat(r)}var zN=function(){function n(e,t){this.weightMap=e,this.tensorArrayMap=t,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return n.prototype.newFrame=function(e,t){return{id:e,frameName:t,iterationId:0}},Object.defineProperty(n.prototype,"currentContext",{get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),n.prototype.generateCurrentContextIds=function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var r=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e},n.prototype.contextIdforContexts=function(e){return e?e.map(function(t){return t.id===0&&t.iterationId===0?"":t.frameName+"-"+t.iterationId}).join("/"):""},n.prototype.enterFrame=function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},n.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},n.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},n.prototype.getWeight=function(e){return this.weightMap[e]},n.prototype.addTensorArray=function(e){this.tensorArrayMap[e.id]=e},n.prototype.getTensorArray=function(e){return this.tensorArrayMap[e]},n}();function BN(n,e,t){for(var r=new Set,i=[],o=null,a=null,s=new Set,u=e.slice();u.length>0;){var l=u.pop();(KF(l)||rJ(l))&&o==null&&(a=(o=l).children.map(function(c){return c.name}).filter(function(c){return r.has(c)})),r.add(l.name),t[l.name]==null&&n[l.name]==null&&(l.inputs.length!==0?l.inputs.forEach(function(c){s.has(c.name)||(s.add(c.name),u.push(c))}):i.push(l.name))}return{inputs:n,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:o,syncInputs:a}}function eJ(n,e,t){var r=t.usedNodes,i=t.inputs,o=[];Object.keys(i).map(function(l){return n.nodes[l]}).forEach(function(l){r.has(l.name)&&o.push(l)}),n.weights.forEach(function(l){r.has(l.name)&&o.push(l)});for(var a=new Set,s=[];o.length>0;){var u=o.pop();a.add(u.name),e[u.name]||s.push(u),u.children.forEach(function(l){!a.has(l.name)&&r.has(l.name)&&l.inputs.every(function(c){return a.has(c.name)})&&o.push(l)})}return s}var tJ=["Switch","Merge","Enter","Exit","NextIteration"],nJ=["NonMaxSuppressionV2","NonMaxSuppressionV3","Where"];function KF(n){return tJ.indexOf(n.op)>=0}function rJ(n){return nJ.indexOf(n.op)>=0}var iJ=function(){function n(e){this.graph=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this.placeholders=e.placeholders,this._outputs=e.outputs}return Object.defineProperty(n.prototype,"weightMap",{get:function(){return this._weightMap},set:function(e){var t=Object.keys(e).map(function(r){return e[r].map(function(i){return i.id})});this.weightIds=[].concat.apply([],t),this._weightMap=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputs",{get:function(){return this.placeholders.map(function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"outputs",{get:function(){return this._outputs.map(function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputNodes",{get:function(){return this.placeholders.map(function(e){return e.name})},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"outputNodes",{get:function(){return this.outputs.map(function(e){return e.name})},enumerable:!0,configurable:!0}),n.prototype.getCompilationKey=function(e,t){var r=e.map(function(o){return o.name}).sort(),i=t.map(function(o){return o.name}).sort();return r.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)},n.prototype.compile=function(e,t){var r=BN(e,t,this.weightMap),i=r.missingInputs,o=r.dynamicNode,a=r.syncInputs;if(o!=null)throw new Error("This execution contains the node '"+o.name+"', which has the dynamic op '"+o.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+a+"]");if(i.length>0){var s=t.map(function(l){return l.name}),u=Object.keys(e);throw new Error("Cannot compute the outputs ["+s+"] from the provided inputs ["+u+"]. Missing the following inputs: ["+i+"]")}return eJ(this.graph,this.weightMap,r)},n.prototype.execute=function(e,t){var r=this,i=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),this.checkOutputs(t);var o=i.map(function(c){return r.graph.nodes[c]}),a=t.map(function(c){return r.graph.nodes[Hh(c)[0]]}),s=this.getCompilationKey(o,a),u=this.compiledMap.get(s);u==null&&(u=this.compile(e,a),this.compiledMap.set(s,u));var l={};return Z(function(){var c=new zN(r._weightMap,l),h=Dw({},r.weightMap);Object.keys(e).forEach(function(g){h[g]=[e[g]]});for(var d=r.getFrozenTensorIds(h),f={},m=0;m<u.length;m++){var v=u[m];if(!h[v.name]){var y=FN(v,h,c);if(y instanceof Promise)throw new Error("The execution of the op '"+v.op+"' returned a promise. Please use model.executeAsync() instead.");h[v.name]=y,r.checkTensorForDisposal(v.name,v,h,c,d,t,f)}}return t.map(function(g){return hr(g,h,c)})})},n.prototype.getFrozenTensorIds=function(e){var t=[].concat.apply([],Object.keys(e).map(function(r){return e[r]}).map(function(r){return r.map(function(i){return i.id})}));return new Set(t)},n.prototype.checkTensorForDisposal=function(e,t,r,i,o,a,s){t.category!=="control"&&a.indexOf(e)===-1&&(r[e].forEach(function(u){u!=null&&(s[u.id]=(s[u.id]||0)+t.children.length)}),t.inputs.forEach(function(u){if(u.category!=="control"){var l=tQ(u.name,r,i);l!=null&&l.forEach(function(c){if(c&&!o.has(c.id)){var h=s[c.id];h===1?(c.dispose(),delete s[c.id]):h!=null&&s[c.id]--}})}}))},n.prototype.executeAsync=function(e,t){return ku(this,void 0,void 0,function(){var r,i,o,a,s,u,l=this;return Ru(this,function(c){switch(c.label){case 0:return this.checkInputs(e),this.checkInputShapeAndType(e),this.checkOutputs(t),r={},i=new zN(this._weightMap,r),[4,this.executeWithControlFlow(e,i,t)];case 1:return o=c.sent(),a=t.map(function(h){return hr(h,o,i)}),s=new Set(a.map(function(h){return h.id})),u=new Set(Object.keys(e).map(function(h){return e[h].id})),Object.keys(o).forEach(function(h){o[h].forEach(function(d){!d||d.isDisposed||s.has(d.id)||u.has(d.id)||l.weightIds.indexOf(d.id)!==-1||d.dispose()})}),[2,a]}})})},n.prototype.executeWithControlFlow=function(e,t,r){return ku(this,void 0,void 0,function(){var i,o,a,s,u,l,c,h,d,f,m,v,y,g,w,b,S=this;return Ru(this,function(E){switch(E.label){case 0:i=Object.keys(e),o=i.map(function(T){return S.graph.nodes[T]}),a=r.map(function(T){return S.graph.nodes[Hh(T)[0]]}),s=BN(e,a,this.weightMap),u=s.usedNodes,l=s.missingInputs,c=s.dynamicNode,h=s.syncInputs,d=o.concat(this.graph.weights).map(function(T){return{node:T,contexts:t.currentContext}}),f=Dw({},this.weightMap),Object.keys(e).forEach(function(T){f[T]=[e[T]]}),m={},v=this.getFrozenTensorIds(f),y={},E.label=1;case 1:return d.length>0?(g=this.processStack(o,d,t,f,y,v,r,m,u),[4,Promise.all(g)]):[3,3];case 2:return E.sent(),[3,1];case 3:if(c==null&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(w=a.filter(function(T){return!KF(T)&&!hr(T.name,f,t)}).map(function(T){return T.name})).length>0)throw b="",c!=null&&(b="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+h+"]"),new Error("Cannot compute the outputs ["+w+"] from the provided inputs ["+i+"]. Consider providing the following inputs: ["+l+"]. "+b);return[2,f]}})})},n.prototype.processStack=function(e,t,r,i,o,a,s,u,l){for(var c=this,h=[],d=function(){var m=t.pop();r.currentContext=m.contexts;var v="";if(m.node.op==="Enter"&&P("isConstant",m.node,i,r)&&(v=em(m.node.name,r)[0]),e.indexOf(m.node)===-1){var y=FN(m.node,i,r);v||(v=em(m.node.name,r)[0]);var g=r.currentContext;y instanceof Promise?h.push(y.then(function(w){return i[v]=w,r.currentContext=g,c.checkTensorForDisposal(v,m.node,i,r,a,s,u),c.processChildNodes(m.node,t,r,i,o,l),w})):(i[v]=y,f.checkTensorForDisposal(v,m.node,i,r,a,s,u),f.processChildNodes(m.node,t,r,i,o,l))}else f.processChildNodes(m.node,t,r,i,o,l)},f=this;t.length>0;)d();return h},n.prototype.processChildNodes=function(e,t,r,i,o,a){e.children.forEach(function(s){var u=em(s.name,r)[0];!o[u]&&a.has(s.name)&&(s.op==="Merge"?s.inputNames.some(function(l){return!!hr(l,i,r)})&&(o[u]=!0,t.push({contexts:r.currentContext,node:s})):s.inputNames.every(function(l){return!!hr(l,i,r)})&&(o[u]=!0,t.push({contexts:r.currentContext,node:s})))})},n.prototype.dispose=function(){var e=this;Object.keys(this.weightMap).forEach(function(t){return e.weightMap[t].forEach(function(r){return r.dispose()})})},n.prototype.checkInputShapeAndType=function(e){var t=this;Object.keys(e).forEach(function(r){var i=e[r],o=t.graph.nodes[r];if(o.attrParams.shape&&o.attrParams.shape.value){var a=o.attrParams.shape.value,s=a.length===i.shape.length&&i.shape.every(function(u,l){return a[l]===-1||a[l]===u});De.assert(s,function(){return"The shape of dict['"+o.name+"'] provided in model.execute(dict) must be ["+a+"], but was ["+i.shape+"]"})}o.attrParams.dtype&&o.attrParams.dtype.value&&De.assert(i.dtype===o.attrParams.dtype.value,function(){return"The dtype of dict['"+o.name+"'] provided in model.execute(dict) must be "+o.attrParams.dtype.value+", but was "+i.dtype})})},n.prototype.checkInputs=function(e){var t=this,r=Object.keys(e).filter(function(i){return!t.graph.nodes[i]});if(r.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+r+"] that are not part of graph")},n.prototype.checkOutputs=function(e){var t=this;e.forEach(function(r){var i=Hh(r)[0];if(!t.graph.nodes[i])throw new Error("The output '"+r+"' is not found in the graph")})},n}(),oJ="?tfjs-format=file",aJ="model.json",XF=function(){function n(e,t){t===void 0&&(t={}),this.modelUrl=e,this.loadOptions=t,this.version="n/a",t==null&&(this.loadOptions={})}return Object.defineProperty(n.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),n.prototype.findIOHandler=function(){var e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=Hr.browserHTTPRequest(e,this.loadOptions);else{var t=Hr.getLoadHandlers(e,this.loadOptions.onProgress);if(t.length===0)t.push(Hr.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one ("+t.length+") load handlers for URL '"+[e]+"'");this.handler=t[0]}},n.prototype.load=function(){return ku(this,void 0,void 0,function(){var e,t,r;return Ru(this,function(i){switch(i.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return e=i.sent(),t=e.modelTopology,this.version=t.versions.producer+"."+t.versions.minConsumer,r=Hr.decodeWeights(e.weightData,e.weightSpecs),this.executor=new iJ(PQ.Instance.transformGraph(t)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),[2,!0]}})})},n.prototype.predict=function(e,t){return this.execute(e,this.outputNodes)},n.prototype.normalizeInputs=function(e){if(!(e instanceof Nt||Array.isArray(e)))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+e.length+" input tensors.");return this.inputNodes.reduce(function(t,r,i){return t[r]=e[i],t},{})},n.prototype.normalizeOutputs=function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]},n.prototype.execute=function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var r=this.executor.execute(e,t);return r.length>1?r:r[0]},n.prototype.executeAsync=function(e,t){return ku(this,void 0,void 0,function(){var r;return Ru(this,function(i){switch(i.label){case 0:return e=this.normalizeInputs(e),t=this.normalizeOutputs(t),[4,this.executor.executeAsync(e,t)];case 1:return[2,(r=i.sent()).length>1?r:r[0]]}})})},n.prototype.convertTensorMapToTensorsMap=function(e){return Object.keys(e).reduce(function(t,r){return t[r]=[e[r]],t},{})},n.prototype.dispose=function(){this.executor.dispose()},n}();function sJ(n,e){return e===void 0&&(e={}),ku(this,void 0,void 0,function(){var t;return Ru(this,function(r){switch(r.label){case 0:if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return e==null&&(e={}),e.fromTFHub&&n.load==null&&(n.endsWith("/")||(n+="/"),n=""+n+aJ+oJ),[4,(t=new XF(n,e)).load()];case 1:return r.sent(),[2,t]}})})}var YF="1.3.1";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var QF=function(n,e){return(QF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])})(n,e)};function _t(n,e){function t(){this.constructor=n}QF(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function ye(n,e,t,r){return new(t||(t=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(c){o(c)}}function s(l){try{u(r.throw(l))}catch(c){o(c)}}function u(l){l.done?i(l.value):new t(function(c){c(l.value)}).then(a,s)}u((r=r.apply(n,[])).next())})}function we(n,e){var t,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){a.label=c[1];break}if(c[0]===6&&a.label<i[1]){a.label=i[1],i=c;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(n,a)}catch(h){c=[6,h],r=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function Xu(n,e){return n(e={exports:{}},e.exports),e.exports}var uJ=Xu(function(n){(function(e,t,r){function i(a,s){return s.c=a.c,s.s0=a.s0,s.s1=a.s1,s.s2=a.s2,s}function o(a,s){var u=new function(h){var d,f=this,m=(d=4022871197,function(v){v=v.toString();for(var y=0;y<v.length;y++){var g=.02519603282416938*(d+=v.charCodeAt(y));g-=d=g>>>0,d=(g*=d)>>>0,d+=4294967296*(g-=d)}return 23283064365386963e-26*(d>>>0)});f.next=function(){var v=2091639*f.s0+23283064365386963e-26*f.c;return f.s0=f.s1,f.s1=f.s2,f.s2=v-(f.c=0|v)},f.c=1,f.s0=m(" "),f.s1=m(" "),f.s2=m(" "),f.s0-=m(h),f.s0<0&&(f.s0+=1),f.s1-=m(h),f.s1<0&&(f.s1+=1),f.s2-=m(h),f.s2<0&&(f.s2+=1),m=null}(a),l=s&&s.state,c=u.next;return c.int32=function(){return 4294967296*u.next()|0},c.double=function(){return c()+11102230246251565e-32*(2097152*c()|0)},c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}t&&t.exports?t.exports=o:this.alea=o})(0,n)}),lJ=Xu(function(n){(function(e,t,r){function i(a,s){return s.x=a.x,s.y=a.y,s.z=a.z,s.w=a.w,s}function o(a,s){var u=new function(h){var d=this,f="";d.x=0,d.y=0,d.z=0,d.w=0,d.next=function(){var v=d.x^d.x<<11;return d.x=d.y,d.y=d.z,d.z=d.w,d.w^=d.w>>>19^v^v>>>8},h===(0|h)?d.x=h:f+=h;for(var m=0;m<f.length+64;m++)d.x^=0|f.charCodeAt(m),d.next()}(a),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var h=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(h===0);return h},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}t&&t.exports?t.exports=o:this.xor128=o})(0,n)}),cJ=Xu(function(n){(function(e,t,r){function i(a,s){return s.x=a.x,s.y=a.y,s.z=a.z,s.w=a.w,s.v=a.v,s.d=a.d,s}function o(a,s){var u=new function(h){var d=this,f="";d.next=function(){var v=d.x^d.x>>>2;return d.x=d.y,d.y=d.z,d.z=d.w,d.w=d.v,(d.d=d.d+362437|0)+(d.v=d.v^d.v<<4^v^v<<1)|0},d.x=0,d.y=0,d.z=0,d.w=0,d.v=0,h===(0|h)?d.x=h:f+=h;for(var m=0;m<f.length+64;m++)d.x^=0|f.charCodeAt(m),m==f.length&&(d.d=d.x<<10^d.x>>>4),d.next()}(a),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var h=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(h===0);return h},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}t&&t.exports?t.exports=o:this.xorwow=o})(0,n)}),hJ=Xu(function(n){(function(e,t,r){function i(a,s){return s.x=a.x.slice(),s.i=a.i,s}function o(a,s){a==null&&(a=+new Date);var u=new function(h){var d=this;d.next=function(){var f,m,v=d.x,y=d.i;return f=v[y],m=(f^=f>>>7)^f<<24,m^=(f=v[y+1&7])^f>>>10,m^=(f=v[y+3&7])^f>>>3,m^=(f=v[y+4&7])^f<<7,f=v[y+7&7],m^=(f^=f<<13)^f<<9,v[y]=m,d.i=y+1&7,m},function(f,m){var v,y=[];if(m===(0|m))y[0]=m;else for(m=""+m,v=0;v<m.length;++v)y[7&v]=y[7&v]<<15^m.charCodeAt(v)+y[v+1&7]<<13;for(;y.length<8;)y.push(0);for(v=0;v<8&&y[v]===0;++v);for(v==8?y[7]=-1:y[v],f.x=y,f.i=0,v=256;v>0;--v)f.next()}(d,h)}(a),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var h=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(h===0);return h},c.int32=u.next,c.quick=c,l&&(l.x&&i(l,u),c.state=function(){return i(u,{})}),c}t&&t.exports?t.exports=o:this.xorshift7=o})(0,n)}),dJ=Xu(function(n){(function(e,t,r){function i(a,s){return s.i=a.i,s.w=a.w,s.X=a.X.slice(),s}function o(a,s){a==null&&(a=+new Date);var u=new function(h){var d=this;d.next=function(){var f,m,v=d.w,y=d.X,g=d.i;return d.w=v=v+1640531527|0,m=y[g+34&127],f=y[g=g+1&127],m^=m<<13,f^=f<<17,m^=m>>>15,f^=f>>>12,m=y[g]=m^f,d.i=g,m+(v^v>>>16)|0},function(f,m){var v,y,g,w,b,S=[],E=128;for(m===(0|m)?(y=m,m=null):(m+="\0",y=0,E=Math.max(E,m.length)),g=0,w=-32;w<E;++w)m&&(y^=m.charCodeAt((w+32)%m.length)),w===0&&(b=y),y^=y<<10,y^=y>>>15,y^=y<<4,y^=y>>>13,w>=0&&(b=b+1640531527|0,g=(v=S[127&w]^=y+b)==0?g+1:0);for(g>=128&&(S[127&(m&&m.length||0)]=-1),g=127,w=512;w>0;--w)y=S[g+34&127],v=S[g=g+1&127],y^=y<<13,v^=v<<17,y^=y>>>15,v^=v>>>12,S[g]=y^v;f.w=b,f.X=S,f.i=g}(d,h)}(a),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var h=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(h===0);return h},c.int32=u.next,c.quick=c,l&&(l.X&&i(l,u),c.state=function(){return i(u,{})}),c}t&&t.exports?t.exports=o:this.xor4096=o})(0,n)}),fJ=Xu(function(n){(function(e,t,r){function i(a,s){return s.a=a.a,s.b=a.b,s.c=a.c,s.d=a.d,s}function o(a,s){var u=new function(h){var d=this,f="";d.next=function(){var v=d.b,y=d.c,g=d.d,w=d.a;return v=v<<25^v>>>7^y,y=y-g|0,g=g<<24^g>>>8^w,w=w-v|0,d.b=v=v<<20^v>>>12^y,d.c=y=y-g|0,d.d=g<<16^y>>>16^w,d.a=w-v|0},d.a=0,d.b=0,d.c=-1640531527,d.d=1367130551,h===Math.floor(h)?(d.a=h/4294967296|0,d.b=0|h):f+=h;for(var m=0;m<f.length+20;m++)d.b^=0|f.charCodeAt(m),d.next()}(a),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var h=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(h===0);return h},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}t&&t.exports?t.exports=o:this.tychei=o})(0,n)}),Ks=Xu(function(n){(function(e,t){var r,i=this,o=256,a=6,s="random",u=t.pow(o,a),l=t.pow(2,52),c=2*l,h=o-1;function d(y,g,w){var b=[],S=m(function _(x,C){var N,R=[],k=typeof x;if(C&&k=="object")for(N in x)try{R.push(_(x[N],C-1))}catch{}return R.length?R:k=="string"?x:x+"\0"}((g=g==1?{entropy:!0}:g||{}).entropy?[y,v(e)]:y??function(){try{var _;return r&&(_=r.randomBytes)?_=_(o):(_=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(_)),v(_)}catch{var x=i.navigator,C=x&&x.plugins;return[+new Date,i,C,i.screen,v(e)]}}(),3),b),E=new function(_){var x,C=_.length,N=this,R=0,k=N.i=N.j=0,D=N.S=[];for(C||(_=[C++]);R<o;)D[R]=R++;for(R=0;R<o;R++)D[R]=D[k=h&k+_[R%C]+(x=D[R])],D[k]=x;(N.g=function(W){for(var U,j=0,H=N.i,z=N.j,q=N.S;W--;)U=q[H=h&H+1],j=j*o+q[h&(q[H]=q[z=h&z+U])+(q[z]=U)];return N.i=H,N.j=z,j})(o)}(b),T=function(){for(var _=E.g(a),x=u,C=0;_<l;)_=(_+C)*o,x*=o,C=E.g(1);for(;_>=c;)_/=2,x/=2,C>>>=1;return(_+C)/x};return T.int32=function(){return 0|E.g(4)},T.quick=function(){return E.g(4)/4294967296},T.double=T,m(v(E.S),e),(g.pass||w||function(_,x,C,N){return N&&(N.S&&f(N,E),_.state=function(){return f(E,{})}),C?(t[s]=_,x):_})(T,S,"global"in g?g.global:this==t,g.state)}function f(y,g){return g.i=y.i,g.j=y.j,g.S=y.S.slice(),g}function m(y,g){for(var w,b=y+"",S=0;S<b.length;)g[h&S]=h&(w^=19*g[h&S])+b.charCodeAt(S++);return v(g)}function v(y){return String.fromCharCode.apply(0,y)}if(t["seed"+s]=d,m(t.random(),e),n.exports){n.exports=d;try{r=require("crypto")}catch{}}})([],Math)});Ks.alea=uJ,Ks.xor128=lJ,Ks.xorwow=cJ,Ks.xorshift7=hJ,Ks.xor4096=dJ,Ks.tychei=fJ;var pJ=Ks,JF=pJ.alea;function mJ(n,e){return wg(n,e)}function wg(n,e,t,r){if(t===void 0&&(t=new Map),r===void 0&&(r=new Set),n==null)return null;if(r.has(n))throw new Error("Circular references are not supported.");if(t.has(n))return t.get(n);var i=e(n);if(i.recurse&&i.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(pc(n)){var o=Array.isArray(n)?[]:{};for(var a in r.add(n),n){var s=wg(n[a],e,t,r);o[a]=s}return r.delete(n),o}throw new Error("Can't recurse into non-iterable type: "+n)}return t.set(n,i.value),i.value}function gJ(n,e){return e===void 0&&(e=e3),ZF(n,e)}function ZF(n,e,t){t===void 0&&(t=new Set);var r=n[0];if(t.has(r))throw new Error("Circular references are not supported.");var i=e(n);if(i.recurse&&i.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(pc(r)){var o=Array.isArray(r)?[]:{};t.add(r);var a=function(u){var l=ZF(n.map(function(c){return c[u]}),e,t);o[u]=l};for(var s in r)a(s);return t.delete(r),o}throw new Error("Can't recurse into non-iterable type: "+r)}return i.value}function e3(n){return n===null?null:pc(n[0])?{value:null,recurse:!0}:{value:n,recurse:!1}}function t3(n,e){return ye(this,void 0,void 0,function(){var t,r,i,o,a,s;return we(this,function(u){switch(u.label){case 0:t=new Map,wg(n,e,t),r=0,i=Array.from(t.keys()),u.label=1;case 1:return r<i.length?(o=i[r],(a=t.get(o))instanceof Promise?[4,a]:[3,3]):[3,4];case 2:s=u.sent(),t.set(o,s),u.label=3;case 3:return r++,[3,1];case 4:return[2,wg(n,e,t)]}})})}function pc(n){return n!=null&&!ArrayBuffer.isView(n)&&(Array.isArray(n)||typeof n=="object"&&!(n instanceof Nt))}function vJ(n){return n==null||yJ(n)||Array.isArray(n)||typeof n=="object"&&n instanceof Nt||De.isTypedArray(n)}function yJ(n){return n===null||typeof n!="object"&&typeof n!="function"}function wJ(n){return mJ(n,bJ)}function bJ(n){return n instanceof Nt?{value:n.clone(),recurse:!1}:pc(n)?{value:null,recurse:!0}:{value:n,recurse:!1}}var n3=function(){function n(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}return n.prototype.wrap=function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity},n.prototype.get=function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]},n.prototype.set=function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t},n.prototype.length=function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e},n.prototype.isFull=function(){return this.length()===this.capacity},n.prototype.isEmpty=function(){return this.length()===0},n.prototype.push=function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)},n.prototype.pushAll=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this.push(i)}},n.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e},n.prototype.unshift=function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)},n.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e},n.prototype.shuffleExcise=function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),r=this.get(t);return this.set(t,this.pop()),r},n}(),xJ=function(n){function e(){return n.call(this,e.INITIAL_CAPACITY)||this}return _t(e,n),e.prototype.isFull=function(){return!1},e.prototype.push=function(t){n.prototype.isFull.call(this)&&this.expand(),n.prototype.push.call(this,t)},e.prototype.unshift=function(t){n.prototype.isFull.call(this)&&this.expand(),n.prototype.unshift.call(this,t)},e.prototype.expand=function(){for(var t=2*this.capacity,r=new Array(t),i=this.length(),o=0;o<i;o++)r[o]=this.get(this.wrap(this.begin+o));this.data=r,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=i},e.INITIAL_CAPACITY=32,e}(n3);function r3(n){return new CJ(n)}function eC(n){return new SJ(n)}function _J(n,e){return new i3(n,e)}function EJ(n,e){return e===void 0&&(e=Ha.FAIL),new PJ(n,e)}var Ha,On=function(){function n(){}return n.prototype.toArray=function(){return ye(this,void 0,void 0,function(){var e,t;return we(this,function(r){switch(r.label){case 0:return e=[],[4,this.next()];case 1:t=r.sent(),r.label=2;case 2:return t.done?[3,4]:(e.push(t.value),[4,this.next()]);case 3:return t=r.sent(),[3,2];case 4:return[2,e]}})})},n.prototype.toArrayForTest=function(){return ye(this,void 0,void 0,function(){var e,t,r;return we(this,function(i){switch(i.label){case 0:return e=this.prefetch(100),t=[],[4,e.next()];case 1:r=i.sent(),i.label=2;case 2:return r.done?[3,4]:(t.push(r.value),[4,e.next()]);case 3:return r=i.sent(),[3,2];case 4:return[2,t]}})})},n.prototype.resolveFully=function(){return ye(this,void 0,void 0,function(){var e;return we(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:e=t.sent(),t.label=2;case 2:return e.done?[3,4]:[4,this.next()];case 3:return e=t.sent(),[3,2];case 4:return[2]}})})},n.prototype.resolveWhile=function(e){return ye(this,void 0,void 0,function(){var t,r;return we(this,function(i){switch(i.label){case 0:return[4,this.next()];case 1:t=i.sent(),r=e(t.value),i.label=2;case 2:return t.done||!r?[3,4]:[4,this.next()];case 3:return t=i.sent(),r=e(t.value),[3,2];case 4:return[2]}})})},n.prototype.handleErrors=function(e){return new DJ(this,e)},n.prototype.filter=function(e){return new RJ(this,e)},n.prototype.map=function(e){return new AJ(this,e)},n.prototype.mapAsync=function(e){return new jN(this,e)},n.prototype.serialMapAsync=function(e){return new jN(this,e).serial()},n.prototype.flatmap=function(e){return new OJ(this,e)},n.prototype.forEachAsync=function(e){return ye(this,void 0,void 0,function(){return we(this,function(t){return[2,this.map(e).resolveFully()]})})},n.prototype.serialForEach=function(e){return ye(this,void 0,void 0,function(){return we(this,function(t){return[2,this.serialMapAsync(e).resolveWhile(function(r){return r===!0})]})})},n.prototype.rowMajorBatch=function(e,t){return t===void 0&&(t=!0),new kJ(this,e,t)},n.prototype.columnMajorBatch=function(e,t,r){return t===void 0&&(t=!0),r===void 0&&(r=e3),this.rowMajorBatch(e,t).map(function(i){return gJ(i,r)})},n.prototype.concatenate=function(e,t){return new i3(r3([this,e]),t)},n.prototype.take=function(e){return e<0||e==null?this:new TJ(this,e)},n.prototype.skip=function(e){return e<0||e==null?this:new NJ(this,e)},n.prototype.prefetch=function(e){return new o3(this,e)},n.prototype.shuffle=function(e,t){return new MJ(this,e,t)},n.prototype.serial=function(){return new IJ(this)},n}(),CJ=function(n){function e(t){var r=n.call(this)||this;return r.items=t,r.trav=0,r}return _t(e,n),e.prototype.summary=function(){return"Array of "+this.items.length+" items"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t;return we(this,function(r){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(t=this.items[this.trav],this.trav++,[2,{value:wJ(t),done:!1}])})})},e}(On),SJ=function(n){function e(t){var r=n.call(this)||this;return r.nextFn=t,r}return _t(e,n),e.prototype.summary=function(){return"Function call"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){try{return[2,this.nextFn()]}catch(r){throw r.message="Error thrown while iterating through a dataset: "+r.message,r}return[2]})})},e}(On),IJ=function(n){function e(t){var r=n.call(this)||this;return r.upstream=t,r.lastRead=Promise.resolve({value:null,done:!1}),r}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t=this;return we(this,function(r){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){return[2,this.upstream.next()]})})},e}(On),NJ=function(n){function e(t,r){var i=n.call(this)||this;return i.upstream=t,i.maxCount=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t=this;return we(this,function(r){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return ye(this,void 0,void 0,function(){var t;return we(this,function(r){switch(r.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(t=r.sent()).done?[2,t]:(Ze(t.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},e}(On),TJ=function(n){function e(t,r){var i=n.call(this)||this;return i.upstream=t,i.maxCount=r,i.count=0,i}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> Take"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},e}(On),kJ=function(n){function e(t,r,i){i===void 0&&(i=!0);var o=n.call(this)||this;return o.upstream=t,o.batchSize=r,o.enableSmallLastBatch=i,o.lastRead=Promise.resolve({value:null,done:!1}),o}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t=this;return we(this,function(r){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return ye(this,void 0,void 0,function(){var t,r;return we(this,function(i){switch(i.label){case 0:t=[],i.label=1;case 1:return t.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(r=i.sent()).done?this.enableSmallLastBatch&&t.length>0?[2,{value:t,done:!1}]:[2,{value:null,done:!0}]:(t.push(r.value),[3,1]);case 3:return[2,{value:t,done:!1}]}})})},e}(On),RJ=function(n){function e(t,r){var i=n.call(this)||this;return i.upstream=t,i.predicate=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t=this;return we(this,function(r){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return ye(this,void 0,void 0,function(){var t;return we(this,function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(t=r.sent()).done||this.predicate(t.value)?[2,t]:(Ze(t.value),[3,0]);case 2:return[2]}})})},e}(On),AJ=function(n){function e(t,r){var i=n.call(this)||this;return i.upstream=t,i.transform=r,i}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> Map"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t,r,i,o,a,s,u;return we(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((t=l.sent()).done)return[2,{value:null,done:!0}];for(r=co.getTensorsInContainer(t.value),i=this.transform(t.value),o=co.getTensorsInContainer(i),a=0,s=r;a<s.length;a++)u=s[a],co.isTensorInList(u,o)||u.dispose();return[2,{value:i,done:!1}]}})})},e}(On),DJ=function(n){function e(t,r){var i=n.call(this)||this;return i.upstream=t,i.handler=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t=this;return we(this,function(r){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return ye(this,void 0,void 0,function(){var t;return we(this,function(r){switch(r.label){case 0:r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handler(t)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},e}(On),jN=function(n){function e(t,r){var i=n.call(this)||this;return i.upstream=t,i.transform=r,i}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t,r,i,o,a,s,u;return we(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:return(t=l.sent()).done?[2,{value:null,done:!0}]:(r=co.getTensorsInContainer(t.value),[4,this.transform(t.value)]);case 2:for(i=l.sent(),o=co.getTensorsInContainer(i),a=0,s=r;a<s.length;a++)u=s[a],co.isTensorInList(u,o)||u.dispose();return[2,{value:i,done:!1}]}})})},e}(On),tC=function(n){function e(){var t=n.call(this)||this;return t.outputQueue=new xJ,t.lastRead=Promise.resolve({value:null,done:!1}),t}return _t(e,n),e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t=this;return we(this,function(r){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){switch(t.label){case 0:return this.outputQueue.length()!==0?[3,2]:[4,this.pump()];case 1:return t.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},e}(On),OJ=function(n){function e(t,r){var i=n.call(this)||this;return i.upstream=t,i.transform=r,i}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},e.prototype.pump=function(){return ye(this,void 0,void 0,function(){var t,r,i,o,a,s,u;return we(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((t=l.sent()).done)return[2,!1];for(r=co.getTensorsInContainer(t.value),i=this.transform(t.value),o=co.getTensorsInContainer(i),this.outputQueue.pushAll(i),a=0,s=r;a<s.length;a++)u=s[a],co.isTensorInList(u,o)||u.dispose();return[2,!0]}})})},e}(tC),i3=function(n){function e(t,r){var i=n.call(this)||this;return i.baseErrorHandler=r,i.lastRead=null,i.iterator=null,i.moreIterators=t,i}return _t(e,n),e.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},e.prototype.next=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},e.prototype.readFromChain=function(t){return ye(this,void 0,void 0,function(){var r,i;return we(this,function(o){switch(o.label){case 0:return[4,t];case 1:return o.sent(),this.iterator!=null?[3,3]:[4,this.moreIterators.next()];case 2:if((r=o.sent()).done)return[2,{value:null,done:!0}];this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),o.label=3;case 3:return[4,this.iterator.next()];case 4:return(i=o.sent()).done?(this.iterator=null,[2,this.readFromChain(t)]):[2,i]}})})},e}(On);(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(Ha||(Ha={}));var PJ=function(n){function e(t,r){r===void 0&&(r=Ha.FAIL);var i=n.call(this)||this;return i.iterators=t,i.mismatchMode=r,i.count=0,i.currentPromise=null,i}return _t(e,n),e.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},e.prototype.nextState=function(t){return ye(this,void 0,void 0,function(){function r(s){return s instanceof On?{value:s.next().then(function(u){return i++,u.done&&o++,u.value}),recurse:!1}:{value:null,recurse:!0}}var i,o,a;return we(this,function(s){switch(s.label){case 0:return[4,t];case 1:return s.sent(),i=0,o=0,[4,t3(this.iterators,r)];case 2:if(a=s.sent(),i===o)return[2,{value:null,done:!0}];if(o>0)switch(this.mismatchMode){case Ha.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case Ha.SHORTEST:return[2,{value:null,done:!0}];case Ha.LONGEST:}return this.count++,[2,{value:a,done:!1}]}})})},e.prototype.next=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},e}(On),o3=function(n){function e(t,r){var i=n.call(this)||this;return i.upstream=t,i.bufferSize=r,i.buffer=new n3(r),i}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},e.prototype.refill=function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}},e.prototype.next=function(){return this.refill(),this.buffer.shift()},e}(On),MJ=function(n){function e(t,r,i){var o=n.call(this,t,r)||this;return o.upstream=t,o.windowSize=r,o.upstreamExhausted=!1,o.random=JF(i||De.now().toString()),o.lastRead=Promise.resolve({value:null,done:!1}),o}return _t(e,n),e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t=this;return we(this,function(r){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.randomInt=function(t){return Math.floor(this.random()*t)},e.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},e.prototype.serialNext=function(){return ye(this,void 0,void 0,function(){var t,r;return we(this,function(i){switch(i.label){case 0:this.upstreamExhausted||this.refill(),i.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(t=this.chooseIndex(),[4,this.buffer.shuffleExcise(t)]);case 2:return(r=i.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,r]);case 3:return[2,{value:null,done:!0}]}})})},e}(o3),Nf=function(){function n(){this.size=null}return n.prototype.batch=function(e,t){var r=this;t===void 0&&(t=!0);var i=this;return De.assert(e>0,function(){return`batchSize needs to be positive, but it is
      `+e}),Er(function(){return ye(r,void 0,void 0,function(){return we(this,function(o){switch(o.label){case 0:return[4,i.iterator()];case 1:return[2,o.sent().columnMajorBatch(e,t,zJ)]}})})},this.size===1/0||this.size==null?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e))},n.prototype.concatenate=function(e){var t=this,r=this;return Er(function(){return ye(t,void 0,void 0,function(){var i,o;return we(this,function(a){switch(a.label){case 0:return[4,r.iterator()];case 1:return o=(i=a.sent()).concatenate,[4,e.iterator()];case 2:return[2,o.apply(i,[a.sent()])]}})})},this.size===1/0||e.size===1/0?1/0:this.size!=null&&e.size!=null?this.size+e.size:null)},n.prototype.filter=function(e){var t=this,r=this;return Er(function(){return ye(t,void 0,void 0,function(){return we(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().filter(function(o){return Z(function(){return e(o)})})]}})})},this.size===1/0?1/0:null)},n.prototype.forEachAsync=function(e){return ye(this,void 0,void 0,function(){return we(this,function(t){switch(t.label){case 0:return[4,this.iterator()];case 1:return[2,t.sent().forEachAsync(e)]}})})},n.prototype.forEach=function(e){return ye(this,void 0,void 0,function(){return we(this,function(t){return uv("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(e)]})})},n.prototype.map=function(e){var t=this,r=this;return Er(function(){return ye(t,void 0,void 0,function(){return we(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().map(function(o){return Z(function(){return e(o)})})]}})})},this.size)},n.prototype.mapAsync=function(e){var t=this,r=this;return Er(function(){return ye(t,void 0,void 0,function(){return we(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().mapAsync(e)]}})})},this.size)},n.prototype.prefetch=function(e){var t=this;if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var r=this;return Er(function(){return ye(t,void 0,void 0,function(){return we(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().prefetch(e)]}})})},this.size)},n.prototype.repeat=function(e){var t=this,r=this;return Er(function(){return ye(t,void 0,void 0,function(){var i=this;return we(this,function(o){return[2,_J(eC(function(){return ye(i,void 0,void 0,function(){var a;return we(this,function(s){switch(s.label){case 0:return a={},[4,r.iterator()];case 1:return[2,(a.value=s.sent(),a.done=!1,a)]}})})}).take(e))]})})},this.size!=null&&e>0?this.size*e:e===0?0:this.size!=null&&(e===void 0||e<0)?1/0:null)},n.prototype.skip=function(e){var t=this,r=this;return Er(function(){return ye(t,void 0,void 0,function(){return we(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().skip(e)]}})})},this.size!=null&&e>=0&&this.size>=e?this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?0:null)},n.prototype.shuffle=function(e,t,r){var i=this;if(r===void 0&&(r=!0),e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var o=this,a=JF(t||De.now().toString());return Er(function(){return ye(i,void 0,void 0,function(){var s;return we(this,function(u){switch(u.label){case 0:return s=a.int32(),r&&(s+=a.int32()),[4,o.iterator()];case 1:return[2,u.sent().shuffle(e,s.toString())]}})})},this.size)},n.prototype.take=function(e){var t=this,r=this;return Er(function(){return ye(t,void 0,void 0,function(){return we(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().take(e)]}})})},this.size!=null&&this.size>e?e:this.size!=null&&this.size<=e?this.size:null)},n.prototype.toArray=function(){return ye(this,void 0,void 0,function(){return we(this,function(e){switch(e.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,e.sent().toArray()]}})})},n.prototype.toArrayForTest=function(){return ye(this,void 0,void 0,function(){return we(this,function(e){switch(e.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,e.sent().toArrayForTest()]}})})},n.MAX_BUFFER_SIZE=1e4,n}();function Er(n,e){return e===void 0&&(e=null),new(function(t){function r(){var i=t!==null&&t.apply(this,arguments)||this;return i.size=e,i}return _t(r,t),r.prototype.iterator=function(){return ye(this,void 0,void 0,function(){return we(this,function(i){return[2,n()]})})},r}(Nf))}function LJ(n){var e=this;return Er(function(){return ye(e,void 0,void 0,function(){return we(this,function(t){return[2,r3(n)]})})},n.length)}function FJ(n){var e,t=this;if(!pc(n))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(n))for(var r=0;r<n.length;r++)e=e==null?n[r].size:Math.min(e,n[r].size);else if(n instanceof Object)for(var i in n)e=e==null?n[i].size:Math.min(e,n[i].size);return Er(function(){return ye(t,void 0,void 0,function(){return we(this,function(o){switch(o.label){case 0:return[4,t3(n,function(a){if(a instanceof Nf)return{value:a.iterator(),recurse:!1};if(pc(a))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})];case 1:return[2,EJ(o.sent(),Ha.SHORTEST)]}})})},e)}function zJ(n){return n===null?null:vJ(n[0])?{value:BJ(n),recurse:!1}:{value:null,recurse:!0}}function BJ(n){if(n.length===0)throw new Error("Can't make a batch of zero elements.");return n[0]instanceof Nt?Ui(n):gn(n)}var a3=function(n){function e(t){var r=n.call(this)||this;return r.input=t,r}return _t(e,n),e.prototype.iterator=function(){return ye(this,void 0,void 0,function(){var t,r;return we(this,function(i){switch(i.label){case 0:return[4,this.input.iterator()];case 1:return t=i.sent(),r=t.decodeUTF8(),[2,r.split(`
`).map(function(o){return o.endsWith("\r")&&(o=o.slice(0,-1)),o})]}})})},e}(Nf),Cp='"',dh=Symbol("out"),UN=Symbol("field"),Sp=Symbol("quote"),R0=Symbol("quoteafterquote"),WN=Symbol("quoteinquote"),s3=function(n){function e(t,r){var i=n.call(this)||this;return i.input=t,i.hasHeader=!0,i.fullColumnNames=null,i.columnNamesValidated=!1,i.columnConfigs=null,i.configuredColumnsOnly=!1,i.delimiter=",",i.delimWhitespace=!1,i.base=new a3(t),r||(r={}),i.hasHeader=r.hasHeader!==!1,i.fullColumnNames=r.columnNames,i.columnConfigs=r.columnConfigs,i.configuredColumnsOnly=r.configuredColumnsOnly,r.delimWhitespace?(De.assert(r.delimiter==null,function(){return"Delimiter should not be provided when delimWhitespace is true."}),i.delimWhitespace=!0,i.delimiter=" "):i.delimiter=r.delimiter?r.delimiter:",",i}return _t(e,n),e.prototype.columnNames=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){switch(t.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:t.sent(),t.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},e.prototype.setColumnNames=function(){return ye(this,void 0,void 0,function(){var t,r,i,o,a,s,u=this;return we(this,function(l){switch(l.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(t=l.sent(),!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&t&&De.assert(t.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+u.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=t),r=this.fullColumnNames.reduce(function(c,h){return c[h]=c[h]+1||1,c},{}),i=Object.keys(r).filter(function(c){return r[c]>1}),De.assert(i.length===0,function(){return"Duplicate column names found: "+i.toString()}),this.columnConfigs){for(o=0,a=Object.keys(this.columnConfigs);o<a.length;o++)if(s=a[o],this.fullColumnNames.indexOf(s)===-1)throw new Error('The key "'+s+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},e.prototype.maybeReadHeaderLine=function(){return ye(this,void 0,void 0,function(){var t,r;return we(this,function(i){switch(i.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,i.sent().next()];case 2:if((t=i.sent()).done)throw new Error("No data was found for CSV parsing.");return r=t.value,[2,this.parseRow(r,!1)];case 3:return[2,null]}})})},e.prototype.iterator=function(){return ye(this,void 0,void 0,function(){var t,r=this;return we(this,function(i){switch(i.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:i.sent(),i.label=2;case 2:return[4,this.base.iterator()];case 3:return t=i.sent(),this.hasHeader&&(t=t.skip(1)),[2,t.map(function(o){return r.makeDataElement(o)})]}})})},e.prototype.makeDataElement=function(t){for(var r=this.parseRow(t),i={},o={},a=0;a<this.fullColumnNames.length;a++){var s=this.fullColumnNames[a],u=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||u){var l=r[a],c=null;if(l==="")if(u&&u.default!==void 0)c=u.default;else{if(u&&(u.required||u.isLabel))throw new Error("Required column "+s+" is empty in this line: "+t);c=void 0}else{var h=Number(l);if(isNaN(h))c=u&&u.dtype==="bool"?this.getBoolean(l):l;else if(u&&u.dtype)switch(u.dtype){case"float32":c=h;break;case"int32":c=Math.floor(h);break;case"bool":c=this.getBoolean(l);break;default:c=h}else c=h}u&&u.isLabel?o[s]=c:i[s]=c}}return Object.keys(o).length===0?i:{xs:i,ys:o}},e.prototype.getBoolean=function(t){return t==="1"||t.toLowerCase()==="true"?1:0},e.prototype.parseRow=function(t,r){r===void 0&&(r=!0);for(var i=[],o=0,a=t.length,s=dh,u=0;u<a;u++)switch(s){case dh:switch(t.charAt(u)){case Cp:o=u+1,s=Sp;break;case this.delimiter:if(o=u+1,this.delimiter===" "&&this.delimWhitespace)break;i.push(""),s=dh;break;default:s=UN,o=u}break;case UN:switch(t.charAt(u)){case this.delimiter:i.push(t.substring(o,u)),s=dh,o=u+1}break;case Sp:switch(t.charAt(u)){case Cp:s=R0}break;case R0:switch(t.charAt(u)){case this.delimiter:i.push(t.substring(o,u-1)),s=dh,o=u+1;break;case Cp:s=Sp;break;default:s=WN}break;case WN:switch(t.charAt(u)){case Cp:s=Sp}}if(s===R0?i.push(t.substring(o,a-1)):i.push(t.substring(o)),r&&i.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+i);return i},e}(Nf),jJ=function(n){function e(t){var r=n.call(this)||this;r.microphoneConfig=t,r.isClosed=!1,r.fftSize=t.fftSize||1024;var i=Math.log2(r.fftSize);if(r.fftSize<0||i<4||i>14||!Number.isInteger(i))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+r.fftSize);if(r.numFrames=t.numFramesPerSpectrogram||43,r.sampleRateHz=t.sampleRateHz,r.columnTruncateLength=t.columnTruncateLength||r.fftSize,r.audioTrackConstraints=t.audioTrackConstraints,r.smoothingTimeConstant=t.smoothingTimeConstant||0,r.includeSpectrogram=t.includeSpectrogram!==!1,r.includeWaveform=t.includeWaveform===!0,!r.includeSpectrogram&&!r.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return r}return _t(e,n),e.prototype.summary=function(){return"microphone"},e.create=function(t){return t===void 0&&(t={}),ye(this,void 0,void 0,function(){var r;return we(this,function(i){switch(i.label){case 0:if(te().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(r=new e(t)).start()];case 1:return i.sent(),[2,r]}})})},e.prototype.start=function(){return ye(this,void 0,void 0,function(){var t,r,i,o;return we(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=this,[4,navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})];case 1:return t.stream=a.sent(),[3,3];case 2:throw r=a.sent(),new Error("Error thrown while initializing video stream: "+r.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(i=window.AudioContext||window.webkitAudioContext,this.audioContext=new i,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return o=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,o.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t,r,i,o,a;return we(this,function(s){switch(s.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return i=s.sent(),this.includeSpectrogram&&(o=this.flattenQueue(i.freqDataQueue),t=this.getTensorFromAudioDataArray(o,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(a=this.flattenQueue(i.timeDataQueue),r=this.getTensorFromAudioDataArray(a,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:t,waveform:r},done:!1}]}})})},e.prototype.capture=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}})})},e.prototype.getAudioData=function(){return ye(this,void 0,void 0,function(){var t,r,i,o=this;return we(this,function(a){return t=[],r=[],i=0,[2,new Promise(function(s){var u=setInterval(function(){o.includeSpectrogram&&(o.analyser.getFloatFrequencyData(o.freqData),o.freqData[0]===-1/0&&s({freqDataQueue:t,timeDataQueue:r}),t.push(o.freqData.slice(0,o.columnTruncateLength))),o.includeWaveform&&(o.analyser.getFloatTimeDomainData(o.timeData),r.push(o.timeData.slice())),++i===o.numFrames&&(clearInterval(u),s({freqDataQueue:t,timeDataQueue:r}))},o.fftSize/o.sampleRateHz*1e3)})]})})},e.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},e.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},e.prototype.getSampleRate=function(){return this.sampleRateHz},e.prototype.flattenQueue=function(t){var r=t[0].length,i=new Float32Array(t.length*r);return t.forEach(function(o,a){return i.set(o,a*r)}),i},e.prototype.getTensorFromAudioDataArray=function(t,r){var i=new Float32Array(De.sizeFromShape(r));return i.set(t,i.length-t.length),gn(i,r)},e}(On),UJ=function(n){function e(t,r){var i=n.call(this)||this;if(i.webcamVideoElement=t,i.webcamConfig=r,i.isClosed=!0,i.resize=!1,i.needToResize())if(i.resize=!0,i.cropSize=[i.webcamConfig.resizeHeight,i.webcamConfig.resizeWidth],i.cropBoxInd=Or([0],"int32"),i.webcamConfig.centerCrop){var o=1*i.webcamConfig.resizeWidth/i.webcamVideoElement.width,a=1*i.webcamConfig.resizeHeight/i.webcamVideoElement.height,s=(1-o)/2,u=(1-a)/2,l=s+o,c=a+u;i.cropBox=Go([u,s,c,l],[1,4])}else i.cropBox=Go([0,0,1,1],[1,4]);return i}return _t(e,n),e.prototype.summary=function(){return"webcam"},e.create=function(t,r){return r===void 0&&(r={}),ye(this,void 0,void 0,function(){var i;return we(this,function(o){switch(o.label){case 0:if(te().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!r.resizeWidth||!r.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=r.resizeWidth,t.height=r.resizeHeight}return[4,(i=new e(t,r)).start()];case 1:return o.sent(),[2,i]}})})},e.prototype.start=function(){return ye(this,void 0,void 0,function(){var t,r,i=this;return we(this,function(o){switch(o.label){case 0:this.webcamConfig.facingMode&&De.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",function(){return"Invalid webcam facing mode: "+i.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),o.label=1;case 1:return o.trys.push([1,3,,4]),t=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return t.stream=o.sent(),[3,4];case 3:throw(r=o.sent()).message="Error thrown while initializing video stream: "+r.message,r;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(a){console.log(a),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(a){i.webcamVideoElement.onloadedmetadata=function(){a()}})]}})})},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t;return we(this,function(r){if(this.isClosed)return[2,{value:null,done:!0}];try{t=PM.fromPixels(this.webcamVideoElement)}catch(i){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(i))}if(!this.resize)return[2,{value:t,done:!1}];try{return[2,{value:this.cropAndResizeFrame(t),done:!1}]}catch(i){throw new Error("Error thrown cropping the video: "+i.message)}finally{t.dispose()}return[2]})})},e.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},e.prototype.cropAndResizeFrame=function(t){var r=this;return Z(function(){var i,o=t.toFloat().expandDims(0),a=(i=cu.cropAndResize(o,r.cropBox,r.cropBoxInd,r.cropSize,"bilinear")).shape;return i.reshape(a.slice(1))})},e.prototype.capture=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}})})},e.prototype.stop=function(){this.stream.getTracks().forEach(function(t){return t.stop()});try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0},e.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},e}(On),u3=function(){return function(){}}(),l3=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return _t(e,n),e.prototype.split=function(t){return new WJ(this,t)},e}(On),WJ=function(n){function e(t,r){var i=n.call(this)||this;return i.upstream=t,i.impl=new VJ(t,r),i}return _t(e,n),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){return[2,this.impl.next()]})})},e}(l3),VJ=function(n){function e(t,r){var i=n.call(this)||this;return i.upstream=t,i.separator=r,i.carryover="",i}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},e.prototype.pump=function(){return ye(this,void 0,void 0,function(){var t,r,i,o,a;return we(this,function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((t=s.sent()).done)return this.carryover===""?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((r=t.value.split(this.separator))[0]=this.carryover+r[0],i=0,o=r.slice(0,-1);i<o.length;i++)a=o[i],this.outputQueue.push(a);return this.carryover=r[r.length-1],[2,!0]}})})},e}(tC),$J=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return _t(e,n),e.prototype.decodeUTF8=function(){return new HJ(this)},e}(On),HJ=function(n){function e(t){var r=n.call(this)||this;return r.upstream=t,r.impl=new GJ(t),r}return _t(e,n),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){return[2,this.impl.next()]})})},e}(l3),GJ=function(n){function e(t){var r=n.call(this)||this;if(r.upstream=t,te().get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var i=require("string_decoder").StringDecoder;r.decoder=new i("utf8")}return r}return _t(e,n),e.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},e.prototype.pump=function(){return ye(this,void 0,void 0,function(){var t,r,i;return we(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:return(t=o.sent()).done?[2,!1]:(r=t.value,i=te().get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(Buffer.from(r.buffer)),this.outputQueue.push(i),[2,!0])}})})},e}(tC),c3=function(n){function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;return i.file=t,i.options=r,De.assert(t instanceof Uint8Array||!!te().get("IS_BROWSER")&&(t instanceof File||t instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),i.offset=r.offset||0,i.chunkSize=r.chunkSize||1048576,i}return _t(e,n),e.prototype.summary=function(){return"FileChunks "+this.file},e.prototype.next=function(){return ye(this,void 0,void 0,function(){var t,r,i=this;return we(this,function(o){switch(o.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(t=new Promise(function(a,s){var u=i.offset+i.chunkSize;if(i.file instanceof Uint8Array)a(new Uint8Array(i.file.slice(i.offset,u)));else{var l=new FileReader;l.onload=function(h){var d=l.result;if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),!(d instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));a(d)},l.onabort=function(h){return s(new Error("Aborted"))},l.onerror=function(h){return s(new Error(h.type))};var c=i.file.slice(i.offset,u);l.readAsArrayBuffer(c)}i.offset=u}),r={},[4,t]);case 1:return[2,(r.value=o.sent(),r.done=!1,r)]}})})},e}($J);function qJ(n,e){return e===void 0&&(e={}),ye(this,void 0,void 0,function(){var t,r,i,o,a;return we(this,function(s){switch(s.label){case 0:return typeof n=="string"?t=n:(t=n.url,r=KJ(n)),[4,De.fetch(t,r)];case 1:return(i=s.sent()).ok?(a=Uint8Array.bind,[4,i.arrayBuffer()]):[3,3];case 2:return o=new(a.apply(Uint8Array,[void 0,s.sent()])),[2,new c3(o,e)];case 3:throw new Error(i.statusText)}})})}var KJ=function(n){return{method:n.method,headers:n.headers,body:n.body,mode:n.mode,credentials:n.credentials,cache:n.cache,redirect:n.redirect,referrer:n.referrer,integrity:n.integrity}};function h3(n){return typeof n=="string"&&n.substr(0,7)==="file://"}var d3=function(n){function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;return i.input=t,i.options=r,i}return _t(e,n),e.prototype.iterator=function(){return ye(this,void 0,void 0,function(){var t;return we(this,function(r){return h3(this.input)&&te().get("IS_NODE")&&(t=require("fs"),this.input=t.readFileSync(this.input.substr(7))),[2,new c3(this.input,this.options)]})})},e}(u3),f3=function(n){function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;return i.url=t,i.fileOptions=r,i}return _t(e,n),e.prototype.iterator=function(){return ye(this,void 0,void 0,function(){return we(this,function(t){return h3(this.url)?[2,new d3(this.url,this.fileOptions).iterator()]:[2,qJ(this.url,this.fileOptions)]})})},e}(u3);function XJ(n,e){return e===void 0&&(e={}),new s3(new f3(n),e)}function YJ(n){var e=this,t=eC(n);return Er(function(){return ye(e,void 0,void 0,function(){return we(this,function(r){return[2,t]})})})}function QJ(n){var e=this;return Er(function(){return ye(e,void 0,void 0,function(){var t;return we(this,function(r){switch(r.label){case 0:return[4,n()];case 1:return t=r.sent(),[2,eC(function(){return t.next()})]}})})})}function JJ(n,e){return ye(this,void 0,void 0,function(){return we(this,function(t){return[2,UJ.create(n,e)]})})}function ZJ(n){return ye(this,void 0,void 0,function(){return we(this,function(e){return[2,jJ.create(n)]})})}var p3="1.3.1";const eZ=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:s3,Dataset:Nf,FileDataSource:d3,TextLineDataset:a3,URLDataSource:f3,array:LJ,csv:XJ,func:YJ,generator:QJ,microphone:ZJ,version_data:p3,webcam:JJ,zip:FJ},Symbol.toStringTag,{value:"Module"}));var tZ="1.3.1",nZ={"tfjs-core":zM,"tfjs-data":p3,"tfjs-layers":ey,"tfjs-converter":YF,tfjs:tZ};const rZ=Object.freeze(Object.defineProperty({__proto__:null,AdadeltaOptimizer:bE,AdagradOptimizer:xE,AdamOptimizer:_E,AdamaxOptimizer:EE,Callback:WF,CallbackList:dL,CustomCallback:pL,DataStorage:f_,get ENV(){return Vx},EarlyStopping:VF,Environment:BD,GraphModel:XF,History:fL,InputSpec:Fn,KernelBackend:p_,LayerVariable:uL,LayersModel:fu,MomentumOptimizer:CE,Optimizer:pa,RMSPropOptimizer:SE,RNN:Ku,get Rank(){return rw},get Reduction(){return Xn},SGDOptimizer:Kv,Sequential:WE,SymbolicTensor:Di,Tensor:Nt,TensorBuffer:nc,Variable:Sd,abs:gs,acos:C_,acosh:S_,add:ot,addN:K_,addStrict:jP,all:zv,any:Dd,argMax:Od,argMin:rE,asin:I_,asinh:N_,atan:T_,atan2:X_,atanh:k_,avgPool:Pv,avgPool3d:Lv,backend:NO,backend_util:AG,basicLSTMCell:yM,batchNorm:V_,batchNorm2d:$_,batchNorm3d:H_,batchNorm4d:G_,batchNormalization:zP,batchNormalization2d:MP,batchNormalization3d:LP,batchNormalization4d:FP,batchToSpaceND:dv,booleanMaskAsync:eM,browser:PM,buffer:qe,callbacks:JY,cast:fv,ceil:R_,clipByValue:vr,clone:OO,complex:Tn,concat:ar,concat1d:n_,concat2d:r_,concat3d:i_,concat4d:o_,constraints:h8,conv1d:kv,conv2d:Hu,conv2dTranspose:Av,conv3d:Rv,conv3dTranspose:aM,cos:A_,cosh:D_,cumsum:PO,customGrad:kc,data:eZ,deprecationWarn:uv,depthToSpace:s_,depthwiseConv2d:Oc,deregisterOp:eQ,diag:_M,disableDeprecationWarnings:iG,dispose:Ze,disposeVariables:oG,div:sr,divStrict:UP,dot:sM,dropout:hE,elu:Pc,enableDebugMode:rG,enableProdMode:nG,engine:aG,env:te,equal:$u,equalStrict:KP,erf:O_,exp:P_,expandDims:Ur,expm1:M_,eye:pv,fft:vf,fill:Tc,findBackend:fG,findBackendFactory:pG,floor:bv,floorDiv:Nv,frame:qv,fused:lc,gather:Dc,gatherND:cE,getBackend:hG,getKernel:jD,getKernelsForBackend:Z1,grad:NG,grads:TG,greater:Ac,greaterEqual:ff,greaterEqualStrict:XP,greaterStrict:YP,hammingWindow:dE,hannWindow:Gv,ifft:uc,imag:li,image:cu,inTopKAsync:SM,initializers:H8,input:TL,io:Hr,irfft:$v,isFinite:RP,isInf:kP,isNaN:TP,keep:ho,layers:kY,leakyRelu:Uv,less:J_,lessEqual:Z_,lessEqualStrict:QP,lessStrict:JP,linalg:pE,linspace:t_,loadGraphModel:sJ,loadLayersModel:QK,localResponseNormalization:oE,log:ia,log1p:L_,logSigmoid:NP,logSoftmax:yv,logSumExp:vM,logicalAnd:da,logicalNot:q_,logicalOr:Sv,logicalXor:BP,losses:IM,matMul:Dv,math:Q7,max:vs,maxPool:Ov,maxPool3d:Mv,maximum:wo,maximumStrict:WP,mean:yn,memory:dw,metrics:HY,min:Bv,minimum:Rc,minimumStrict:VP,mod:Y_,modStrict:$P,model:XK,models:GY,moments:gf,movingAverage:bM,mul:He,mulStrict:Tv,multiRNNCell:wM,multinomial:u_,neg:Vu,nextFrame:Zp,norm:aE,notEqual:ac,notEqualStrict:ZP,oneHot:rc,ones:yo,onesLike:Xr,op:$,outerProduct:uM,pad:ks,pad1d:MO,pad2d:LO,pad3d:FO,pad4d:zO,pool:mM,pow:oc,powStrict:HP,prelu:Wv,print:DO,prod:jv,profile:sG,rand:BO,randomGamma:jO,randomNormal:l_,randomUniform:Uu,range:cv,ready:cG,real:Ir,reciprocal:F_,registerBackend:mG,registerCallbackConstructor:JK,registerKernel:ew,registerOp:ZY,regularizers:YY,relu:As,relu6:iE,removeBackend:dG,reshape:af,reverse:po,reverse1d:lM,reverse2d:cM,reverse3d:hM,reverse4d:dM,rfft:yf,round:z_,rsqrt:xv,scalar:Ee,scatterND:lE,selu:Vv,separableConv2d:nE,sequential:YK,serialization:ce,setBackend:lG,setPlatform:gG,setdiff1dAsync:c_,sigmoid:_v,sign:B_,signal:CM,sin:j_,sinh:U_,slice:Yr,slice1d:pf,slice2d:Fv,slice3d:mf,slice4d:sc,slice_util:IG,softmax:Wu,softplus:cf,spaceToBatchND:mv,sparseToDense:Hv,spectral:xM,split:qo,sqrt:hf,square:E_,squaredDifference:Q_,squaredDifferenceStrict:GP,squeeze:sf,stack:Ui,step:AP,stft:fE,stridedSlice:sE,sub:Un,subStrict:qP,sum:Pr,tan:W_,tanh:Ev,tensor:gn,tensor1d:Or,tensor2d:Go,tensor3d:Zx,tensor4d:Aa,tensor5d:RO,tensor6d:AO,tensor_util:co,test_util:e8,tidy:Z,tile:is,time:uG,topk:uE,train:Gs,transpose:Yt,truncatedNormal:uf,unregisterKernel:G9,unsortedSegmentSum:eE,unstack:Iu,util:De,valueAndGrad:kG,valueAndGrads:RG,variable:e_,variableGrads:KO,version:nZ,version_converter:YF,version_core:zM,version_layers:ey,webgl:t8,where:oa,whereAsync:Iv,zeros:St,zerosLike:ct},Symbol.toStringTag,{value:"Module"})),Fd=Vw(rZ);var Au={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Au,"__esModule",{value:!0});Au.cropTensor=Au.capture=void 0;var au=Fd;function iZ(n,e){return au.tidy(function(){var t=au.browser.fromPixels(n),r=m3(t,e),i=r.expandDims(0);return i.toFloat().div(au.scalar(127)).sub(au.scalar(1))})}Au.capture=iZ;function m3(n,e,t){var r=Math.min(n.shape[0],n.shape[1]),i=n.shape[0]/2,o=i-r/2,a=n.shape[1]/2,s=a-r/2;if(e&&!t){var u=n.slice([o,s,0],[r,r,3]);u=u.reshape([r*r,1,3]);var l=[.2989,.587,.114];return u=au.mul(u,l),u=u.reshape([r,r,3]),u=au.sum(u,-1),u=au.expandDims(u,-1),u}return n.slice([o,s,0],[r,r,3])}Au.cropTensor=m3;var Oi={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Oi,"__esModule",{value:!0});Oi.cropTo=Oi.resizeMinTo=Oi.resizeMaxTo=Oi.resize=void 0;var iy=function(){return document.createElement("canvas")};function nC(n,e,t){t===void 0&&(t=iy()),t.width=n.width*e,t.height=n.height*e;var r=t.getContext("2d");return r.drawImage(n,0,0,t.width,t.height),t}Oi.resize=nC;function oZ(n,e,t){t===void 0&&(t=iy());var r=Math.max(n.width,n.height);return nC(n,e/r,t)}Oi.resizeMaxTo=oZ;function aZ(n,e,t){t===void 0&&(t=iy());var r=Math.min(n.width,n.height);return nC(n,e/r,t)}Oi.resizeMinTo=aZ;function sZ(n,e,t,r){t===void 0&&(t=!1),r===void 0&&(r=iy());var i=n.width,o=n.height;n instanceof HTMLVideoElement&&(i=n.videoWidth,o=n.videoHeight);var a=Math.min(i,o),s=e/a,u=Math.ceil(i*s),l=Math.ceil(o*s),c=u-e,h=l-e;r.width=r.height=e;var d=r.getContext("2d");return d.drawImage(n,~~(c/2)*-1,~~(h/2)*-1,u,l),t&&(d.scale(-1,1),d.drawImage(r,e*-1,0)),r}Oi.cropTo=sZ;var Tf={};/** @license See the LICENSE file. */Object.defineProperty(Tf,"__esModule",{value:!0});Tf.version=void 0;var uZ="0.8.4-alpha2";Tf.version=uZ;(function(n){/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=en&&en.__awaiter||function(_,x,C,N){function R(k){return k instanceof C?k:new C(function(D){D(k)})}return new(C||(C=Promise))(function(k,D){function W(H){try{j(N.next(H))}catch(z){D(z)}}function U(H){try{j(N.throw(H))}catch(z){D(z)}}function j(H){H.done?k(H.value):R(H.value).then(W,U)}j((N=N.apply(_,x||[])).next())})},t=en&&en.__generator||function(_,x){var C={label:0,sent:function(){if(k[0]&1)throw k[1];return k[1]},trys:[],ops:[]},N,R,k,D;return D={next:W(0),throw:W(1),return:W(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function W(j){return function(H){return U([j,H])}}function U(j){if(N)throw new TypeError("Generator is already executing.");for(;C;)try{if(N=1,R&&(k=j[0]&2?R.return:j[0]?R.throw||((k=R.return)&&k.call(R),0):R.next)&&!(k=k.call(R,j[1])).done)return k;switch(R=0,k&&(j=[j[0]&2,k.value]),j[0]){case 0:case 1:k=j;break;case 4:return C.label++,{value:j[1],done:!1};case 5:C.label++,R=j[1],j=[0];continue;case 7:j=C.ops.pop(),C.trys.pop();continue;default:if(k=C.trys,!(k=k.length>0&&k[k.length-1])&&(j[0]===6||j[0]===2)){C=0;continue}if(j[0]===3&&(!k||j[1]>k[0]&&j[1]<k[3])){C.label=j[1];break}if(j[0]===6&&C.label<k[1]){C.label=k[1],k=j;break}if(k&&C.label<k[2]){C.label=k[2],C.ops.push(j);break}k[2]&&C.ops.pop(),C.trys.pop();continue}j=x.call(_,C)}catch(H){j=[6,H],R=0}finally{N=k=0}if(j[0]&5)throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.loadFromFiles=n.load=n.loadTruncatedMobileNet=n.CustomMobileNet=n.getTopKClasses=n.IMAGE_SIZE=void 0;var r=Fd,i=Fd,o=Au,a=Oi,s=Tf,u=1,l="conv_pw_13_relu",c="out_relu",h=.25,d=.35;n.IMAGE_SIZE=224;var f=function(_){return _.packageVersion=_.packageVersion||s.version,_.packageName=_.packageName||"@teachablemachine/image",_.timeStamp=_.timeStamp||new Date().toISOString(),_.userMetadata=_.userMetadata||{},_.modelName=_.modelName||"untitled",_.labels=_.labels||[],_.imageSize=_.imageSize||n.IMAGE_SIZE,_},m=function(_){return!!_&&Array.isArray(_.labels)},v=function(_,x){if(_===1){if(x!==.25&&x!==.5&&x!==.75&&x!==1)return console.warn("Invalid alpha. Options are: 0.25, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",h.toFixed(2)),h}else if(x!==.35&&x!==.5&&x!==.75&&x!==1)return console.warn("Invalid alpha. Options are: 0.35, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",d.toFixed(2)),d;return x},y=function(_){if(_=_||{},_.checkpointUrl&&_.trainingLayer)return(_.alpha||_.version)&&console.warn("Checkpoint URL passed to modelOptions, alpha options are ignored"),[_.checkpointUrl,_.trainingLayer];if(_.version=_.version||u,_.version===1){_.alpha=_.alpha||h,_.alpha=v(_.version,_.alpha),console.log("Loading mobilenet "+_.version+" and alpha "+_.alpha);var x=_.alpha.toFixed(2);return x==="1.00"&&(x="1.0"),["https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_"+x+"_"+n.IMAGE_SIZE+"/model.json",l]}else{if(_.version===2)return _.alpha=_.alpha||d,_.alpha=v(_.version,_.alpha),console.log("Loading mobilenet "+_.version+" and alpha "+_.alpha),["https://storage.googleapis.com/teachable-machine-models/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_"+_.alpha.toFixed(2)+"_"+n.IMAGE_SIZE+"_no_top/model.json",c];throw new Error("MobileNet V"+_.version+" doesn't exist")}},g=function(_){return e(void 0,void 0,void 0,function(){var x,C;return t(this,function(N){switch(N.label){case 0:return typeof _!="string"?[3,3]:[4,fetch(_)];case 1:return C=N.sent(),[4,C.json()];case 2:return x=N.sent(),[3,4];case 3:if(m(_))x=_;else throw new Error("Invalid Metadata provided");N.label=4;case 4:return[2,f(x)]}})})};function w(_,x,C){return C===void 0&&(C=3),e(this,void 0,void 0,function(){var N;return t(this,function(R){switch(R.label){case 0:return[4,x.data()];case 1:return N=R.sent(),[2,r.tidy(function(){C=Math.min(C,N.length);for(var k=[],D=0;D<N.length;D++)k.push({value:N[D],index:D});k.sort(function(H,z){return z.value-H.value});for(var W=new Float32Array(C),U=new Int32Array(C),D=0;D<C;D++)W[D]=k[D].value,U[D]=k[D].index;for(var j=[],D=0;D<U.length;D++)j.push({className:_[U[D]],probability:W[D]});return j})]}})})}n.getTopKClasses=w;var b=function(){function _(x,C){this.model=x,this._metadata=f(C)}return Object.defineProperty(_,"EXPECTED_IMAGE_SIZE",{get:function(){return n.IMAGE_SIZE},enumerable:!1,configurable:!0}),_.prototype.getMetadata=function(){return this._metadata},_.prototype.getTotalClasses=function(){var x=this.model.output,C=x.shape[1];return C},_.prototype.getClassLabels=function(){return this._metadata.labels},_.prototype.predictTopK=function(x,C,N){return C===void 0&&(C=10),N===void 0&&(N=!1),e(this,void 0,void 0,function(){var R,k,D,W=this;return t(this,function(U){switch(U.label){case 0:return R=a.cropTo(x,this._metadata.imageSize,N),k=r.tidy(function(){var j=o.capture(R,W._metadata.grayscale);return W.model.predict(j)}),[4,w(this._metadata.labels,k,C)];case 1:return D=U.sent(),i.dispose(k),[2,D]}})})},_.prototype.predict=function(x,C){return C===void 0&&(C=!1),e(this,void 0,void 0,function(){var N,R,k,D,W,U=this;return t(this,function(j){switch(j.label){case 0:return N=a.cropTo(x,this._metadata.imageSize,C),R=r.tidy(function(){var H=o.capture(N,U._metadata.grayscale);return U.model.predict(H)}),[4,R.data()];case 1:for(k=j.sent(),D=[],W=0;W<k.length;W++)D.push({className:this._metadata.labels[W],probability:k[W]});return i.dispose(R),[2,D]}})})},_.prototype.dispose=function(){this.truncatedModel.dispose()},_}();n.CustomMobileNet=b;function S(_){return e(this,void 0,void 0,function(){var x,C,N,R,k,D,W,k,D,W;return t(this,function(U){switch(U.label){case 0:return x=y(_),C=x[0],N=x[1],[4,r.loadLayersModel(C)];case 1:return R=U.sent(),_&&_.version===1?(k=R.getLayer(N),D=r.model({inputs:R.inputs,outputs:k.output}),W=r.sequential(),W.add(D),W.add(r.layers.flatten()),[2,W]):(k=R.getLayer(N),D=r.model({inputs:R.inputs,outputs:k.output}),W=r.sequential(),W.add(D),W.add(r.layers.globalAveragePooling2d({})),[2,W])}})})}n.loadTruncatedMobileNet=S;function E(_,x){return e(this,void 0,void 0,function(){var C,N,R;return t(this,function(k){switch(k.label){case 0:return[4,r.loadLayersModel(_)];case 1:return C=k.sent(),x?[4,g(x)]:[3,3];case 2:return R=k.sent(),[3,4];case 3:R=null,k.label=4;case 4:return N=R,[2,new b(C,N)]}})})}n.load=E;function T(_,x,C){return e(this,void 0,void 0,function(){var N,R,k,D;return t(this,function(W){switch(W.label){case 0:return[4,r.loadLayersModel(r.io.browserFiles([_,x]))];case 1:return N=W.sent(),[4,new Response(C).json()];case 2:return R=W.sent(),C?[4,g(R)]:[3,4];case 3:return D=W.sent(),[3,5];case 4:D=null,W.label=5;case 5:return k=D,[2,new b(N,k)]}})})}n.loadFromFiles=T})(Wx);var mc={},rC={exports:{}};rC.exports;(function(n){(function(e,t,r){function i(u){var l=this,c=s();l.next=function(){var h=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=h-(l.c=h|0)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(u),l.s0<0&&(l.s0+=1),l.s1-=c(u),l.s1<0&&(l.s1+=1),l.s2-=c(u),l.s2<0&&(l.s2+=1),c=null}function o(u,l){return l.c=u.c,l.s0=u.s0,l.s1=u.s1,l.s2=u.s2,l}function a(u,l){var c=new i(u),h=l&&l.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&o(h,c),d.state=function(){return o(c,{})}),d}function s(){var u=4022871197,l=function(c){c=c.toString();for(var h=0;h<c.length;h++){u+=c.charCodeAt(h);var d=.02519603282416938*u;u=d>>>0,d-=u,d*=u,u=d>>>0,d-=u,u+=d*4294967296}return(u>>>0)*23283064365386963e-26};return l}t&&t.exports?t.exports=a:this.alea=a})(en,n)})(rC);var lZ=rC.exports,iC={exports:{}};iC.exports;(function(n){(function(e,t,r){function i(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var h=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^h^h>>>8},s===(s|0)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,u.next()}function o(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new i(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var d=l.next()>>>11,f=(l.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=l.next,h.quick=h,c&&(typeof c=="object"&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.xor128=a})(en,n)})(iC);var cZ=iC.exports,oC={exports:{}};oC.exports;(function(n){(function(e,t,r){function i(s){var u=this,l="";u.next=function(){var h=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(h^h<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(s|0)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new i(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var d=l.next()>>>11,f=(l.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=l.next,h.quick=h,c&&(typeof c=="object"&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.xorwow=a})(en,n)})(oC);var hZ=oC.exports,aC={exports:{}};aC.exports;(function(n){(function(e,t,r){function i(s){var u=this;u.next=function(){var c=u.x,h=u.i,d,f;return d=c[h],d^=d>>>7,f=d^d<<24,d=c[h+1&7],f^=d^d>>>10,d=c[h+3&7],f^=d^d>>>3,d=c[h+4&7],f^=d^d<<7,d=c[h+7&7],d=d^d<<13,f^=d^d<<9,c[h]=f,u.i=h+1&7,f};function l(c,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}l(u,s)}function o(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var d=l.next()>>>11,f=(l.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=l.next,h.quick=h,c&&(c.x&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.xorshift7=a})(en,n)})(aC);var dZ=aC.exports,sC={exports:{}};sC.exports;(function(n){(function(e,t,r){function i(s){var u=this;u.next=function(){var c=u.w,h=u.X,d=u.i,f,m;return u.w=c=c+1640531527|0,m=h[d+34&127],f=h[d=d+1&127],m^=m<<13,f^=f<<17,m^=m>>>15,f^=f>>>12,m=h[d]=m^f,u.i=d,m+(c^c>>>16)|0};function l(c,h){var d,f,m,v,y,g=[],w=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,w=Math.max(w,h.length)),m=0,v=-32;v<w;++v)h&&(f^=h.charCodeAt((v+32)%h.length)),v===0&&(y=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,v>=0&&(y=y+1640531527|0,d=g[v&127]^=f+y,m=d==0?m+1:0);for(m>=128&&(g[(h&&h.length||0)&127]=-1),m=127,v=4*128;v>0;--v)f=g[m+34&127],d=g[m=m+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[m]=f^d;c.w=y,c.X=g,c.i=m}l(u,s)}function o(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var d=l.next()>>>11,f=(l.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=l.next,h.quick=h,c&&(c.X&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.xor4096=a})(en,n)})(sC);var fZ=sC.exports,uC={exports:{}};uC.exports;(function(n){(function(e,t,r){function i(s){var u=this,l="";u.next=function(){var h=u.b,d=u.c,f=u.d,m=u.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^m,m=m-h|0,u.b=h=h<<20^h>>>12^d,u.c=d=d-f|0,u.d=f<<16^d>>>16^m,u.a=m-h|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=s|0):l+=s;for(var c=0;c<l.length+20;c++)u.b^=l.charCodeAt(c)|0,u.next()}function o(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new i(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var d=l.next()>>>11,f=(l.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=l.next,h.quick=h,c&&(typeof c=="object"&&o(c,l),h.state=function(){return o(l,{})}),h}t&&t.exports?t.exports=a:this.tychei=a})(en,n)})(uC);var pZ=uC.exports,g3={exports:{}};const mZ={},gZ=Object.freeze(Object.defineProperty({__proto__:null,default:mZ},Symbol.toStringTag,{value:"Module"})),vZ=Vw(gZ);(function(n){(function(e,t){var r=(0,eval)("this"),i=256,o=6,a=52,s="random",u=t.pow(i,o),l=t.pow(2,a),c=l*2,h=i-1,d;function f(S,E,T){var _=[];E=E==!0?{entropy:!0}:E||{};var x=g(y(E.entropy?[S,b(e)]:S??w(),3),_),C=new m(_),N=function(){for(var R=C.g(o),k=u,D=0;R<l;)R=(R+D)*i,k*=i,D=C.g(1);for(;R>=c;)R/=2,k/=2,D>>>=1;return(R+D)/k};return N.int32=function(){return C.g(4)|0},N.quick=function(){return C.g(4)/4294967296},N.double=N,g(b(C.S),e),(E.pass||T||function(R,k,D,W){return W&&(W.S&&v(W,C),R.state=function(){return v(C,{})}),D?(t[s]=R,k):R})(N,x,"global"in E?E.global:this==t,E.state)}t["seed"+s]=f;function m(S){var E,T=S.length,_=this,x=0,C=_.i=_.j=0,N=_.S=[];for(T||(S=[T++]);x<i;)N[x]=x++;for(x=0;x<i;x++)N[x]=N[C=h&C+S[x%T]+(E=N[x])],N[C]=E;(_.g=function(R){for(var k,D=0,W=_.i,U=_.j,j=_.S;R--;)k=j[W=h&W+1],D=D*i+j[h&(j[W]=j[U=h&U+k])+(j[U]=k)];return _.i=W,_.j=U,D})(i)}function v(S,E){return E.i=S.i,E.j=S.j,E.S=S.S.slice(),E}function y(S,E){var T=[],_=typeof S,x;if(E&&_=="object")for(x in S)try{T.push(y(S[x],E-1))}catch{}return T.length?T:_=="string"?S:S+"\0"}function g(S,E){for(var T=S+"",_,x=0;x<T.length;)E[h&x]=h&(_^=E[h&x]*19)+T.charCodeAt(x++);return b(E)}function w(){try{var S;return d&&(S=d.randomBytes)?S=S(i):(S=new Uint8Array(i),(r.crypto||r.msCrypto).getRandomValues(S)),b(S)}catch{var E=r.navigator,T=E&&E.plugins;return[+new Date,r,T,r.screen,b(e)]}}function b(S){return String.fromCharCode.apply(0,S)}if(g(t.random(),e),n.exports){n.exports=f;try{d=vZ}catch{}}})([],Math)})(g3);var yZ=g3.exports,wZ=lZ,bZ=cZ,xZ=hZ,_Z=dZ,EZ=fZ,CZ=pZ,Yu=yZ;Yu.alea=wZ;Yu.xor128=bZ;Yu.xorwow=xZ;Yu.xorshift7=_Z;Yu.xor4096=EZ;Yu.tychei=CZ;var SZ=Yu;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var IZ=en&&en.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ro=en&&en.__awaiter||function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function s(c){try{l(r.next(c))}catch(h){a(h)}}function u(c){try{l(r.throw(c))}catch(h){a(h)}}function l(c){c.done?o(c.value):i(c.value).then(s,u)}l((r=r.apply(n,e||[])).next())})},Ao=en&&en.__generator||function(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){t.label=l[1];break}if(l[0]===6&&t.label<o[1]){t.label=o[1],o=l;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(l);break}o[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(c){l=[6,c],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(mc,"__esModule",{value:!0});mc.createTeachable=mc.TeachableMobileNet=void 0;var $n=Fd,NZ=Fd,TZ=Au,v3=Wx,kZ=SZ,RZ=.15,AZ=function(n){return typeof n.dataId=="object"&&typeof n.shape=="object"};function DZ(n,e){var t=new Array(e).fill(0);return t[n]=1,t}function A0(n,e){for(var t,r=n.length,i=n.slice(),o=r-1;o>0;o-=1){var a=void 0;e?a=Math.floor(e()*(o+1)):a=Math.floor(Math.random()*(o+1)),t=[i[a],i[o]],i[o]=t[0],i[a]=t[1]}return i}var y3=function(n){IZ(e,n);function e(t,r){var i=n.call(this,$n.sequential(),r)||this;return i.totalSamples=0,i.examples=[],i.truncatedModel=t,i}return Object.defineProperty(e.prototype,"asSequentialModel",{get:function(){return this.model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!1,configurable:!0}),e.prototype.addExample=function(t,r){return Ro(this,void 0,void 0,function(){var i,o,a;return Ao(this,function(s){return i=AZ(r)?r:TZ.capture(r,this._metadata.grayscale),o=this.truncatedModel.predict(i),a=o.dataSync(),i.dispose(),o.dispose(),this.examples[t].push(a),this.totalSamples++,[2]})})},e.prototype.predict=function(t,r){return r===void 0&&(r=!1),Ro(this,void 0,void 0,function(){return Ao(this,function(i){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,n.prototype.predict.call(this,t,r)]})})},e.prototype.predictTopK=function(t,r,i){return r===void 0&&(r=10),i===void 0&&(i=!1),Ro(this,void 0,void 0,function(){return Ao(this,function(o){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,n.prototype.predictTopK.call(this,t,r,i)]})})},e.prototype.prepare=function(){for(var t in this.examples)if(t.length===0)throw new Error("Add some examples before training");var r=this.convertToTfDataset();this.trainDataset=r.trainDataset,this.validationDataset=r.validationDataset},e.prototype.convertToTfDataset=function(){for(var t=0;t<this.examples.length;t++)this.examples[t]=A0(this.examples[t],this.seed);for(var r=[],i=[],o=function(h){var d=DZ(h,a.numClasses),f=a.examples[h].length,m=Math.ceil(RZ*f),v=f-m,y=a.examples[h].slice(0,v).map(function(w){return{data:w,label:d}}),g=a.examples[h].slice(v).map(function(w){return{data:w,label:d}});r=r.concat(y),i=i.concat(g)},a=this,t=0;t<this.examples.length;t++)o(t);r=A0(r,this.seed),i=A0(i,this.seed);var s=$n.data.array(r.map(function(h){return h.data})),u=$n.data.array(i.map(function(h){return h.data})),l=$n.data.array(r.map(function(h){return h.label})),c=$n.data.array(i.map(function(h){return h.label}));return{trainDataset:$n.data.zip({xs:s,ys:l}),validationDataset:$n.data.zip({xs:u,ys:c})}},e.prototype.save=function(t,r){return Ro(this,void 0,void 0,function(){return Ao(this,function(i){return[2,this.model.save(t,r)]})})},e.prototype.train=function(t,r){return r===void 0&&(r={}),Ro(this,void 0,void 0,function(){var i,o,a,s,u,l,c,h,d,f=this;return Ao(this,function(m){switch(m.label){case 0:if(i=r.onTrainEnd||function(){},r.onTrainEnd=function(v){f.__stopTrainingResolve&&(f.__stopTrainingResolve(),f.__stopTrainingResolve=null),i(v)},this.isPrepared||this.prepare(),o=this.getLabels().length,NZ.util.assert(o===this.numClasses,function(){return"Can not train, has "+o+" labels and "+f.numClasses+" classes"}),a=this.truncatedModel.outputs[0].shape.slice(1),s=$n.util.sizeFromShape(a),this.seed?u=$n.initializers.varianceScaling({seed:3.14}):u=$n.initializers.varianceScaling({}),this.trainingModel=$n.sequential({layers:[$n.layers.dense({inputShape:[s],units:t.denseUnits,activation:"relu",kernelInitializer:u,useBias:!0}),$n.layers.dense({kernelInitializer:u,useBias:!1,activation:"softmax",units:this.numClasses})]}),l=$n.train.adam(t.learningRate),this.trainingModel.compile({optimizer:l,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(t.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return c=this.trainDataset.batch(t.batchSize),h=this.validationDataset.batch(t.batchSize),[4,this.trainingModel.fitDataset(c,{epochs:t.epochs,validationData:h,callbacks:r})];case 1:return m.sent(),d=$n.sequential(),d.add(this.truncatedModel),d.add(this.trainingModel),this.model=d,l.dispose(),[2,this.model]}})})},e.prototype.prepareDataset=function(){for(var t=0;t<this.numClasses;t++)this.examples[t]=[]},e.prototype.setLabel=function(t,r){this._metadata.labels[t]=r},e.prototype.setLabels=function(t){this._metadata.labels=t,this.prepareDataset()},e.prototype.getLabel=function(t){return this._metadata.labels[t]},e.prototype.getLabels=function(){return this._metadata.labels},e.prototype.setName=function(t){this._metadata.modelName=t},e.prototype.getName=function(){return this._metadata.modelName},e.prototype.stopTraining=function(){var t=this,r=new Promise(function(i,o){t.trainingModel.stopTraining=!0,t.__stopTrainingResolve=i});return r},e.prototype.dispose=function(){this.trainingModel.dispose(),n.prototype.dispose.call(this)},e.prototype.calculateAccuracyPerClass=function(){return Ro(this,void 0,void 0,function(){var t,r,i,o,a,s,u,l,c,h,b,d,f,m,v,y,g,w,b,S=this;return Ao(this,function(E){switch(E.label){case 0:return t=this.validationDataset.mapAsync(function(T){return Ro(S,void 0,void 0,function(){return Ao(this,function(_){return[2,T.xs]})})}),r=this.validationDataset.mapAsync(function(T){return Ro(S,void 0,void 0,function(){return Ao(this,function(_){return[2,T.ys]})})}),i=Math.min(r.size,32),o=Math.ceil(r.size/i),a=t.batch(i),s=r.batch(i),[4,a.iterator()];case 1:return u=E.sent(),[4,s.iterator()];case 2:l=E.sent(),c=[],h=[],b=0,E.label=3;case 3:return b<o?[4,u.next()]:[3,7];case 4:return d=E.sent(),f=this.trainingModel.predict(d.value),m=f.argMax(1),c.push(m),[4,l.next()];case 5:v=E.sent(),y=v.value.argMax(1),h.push(y),d.value.dispose(),f.dispose(),v.value.dispose(),E.label=6;case 6:return b++,[3,3];case 7:if(g=$n.concat(h),w=$n.concat(c),o!==1)for(b=0;b<c.length;b++)c[b].dispose(),h[b].dispose();return[2,{reference:g,predictions:w}]}})})},e.prototype.setSeed=function(t){this.seed=kZ(t)},e}(v3.CustomMobileNet);mc.TeachableMobileNet=y3;function OZ(n,e){return Ro(this,void 0,void 0,function(){var t;return Ao(this,function(r){switch(r.label){case 0:return[4,v3.loadTruncatedMobileNet(e)];case 1:return t=r.sent(),[2,new y3(t,n)]}})})}mc.createTeachable=OZ;var oy={};function tm(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tm=function(t){return typeof t}:tm=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tm(n)}function lC(n,e,t){var r=t.value;if(typeof r!="function")throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(tm(r)));var i=!1;return{configurable:!0,get:function(){if(i||this===n.prototype||this.hasOwnProperty(e)||typeof r!="function")return r;var a=r.bind(this);return i=!0,Object.defineProperty(this,e,{configurable:!0,get:function(){return a},set:function(u){r=u,delete this[e]}}),i=!1,a},set:function(a){r=a}}}function w3(n){var e;return typeof Reflect<"u"&&typeof Reflect.ownKeys=="function"?e=Reflect.ownKeys(n.prototype):(e=Object.getOwnPropertyNames(n.prototype),typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(n.prototype)))),e.forEach(function(t){if(t!=="constructor"){var r=Object.getOwnPropertyDescriptor(n.prototype,t);typeof r.value=="function"&&Object.defineProperty(n.prototype,t,lC(n,t,r))}}),n}function PZ(){return arguments.length===1?w3.apply(void 0,arguments):lC.apply(void 0,arguments)}const MZ=Object.freeze(Object.defineProperty({__proto__:null,boundClass:w3,boundMethod:lC,default:PZ},Symbol.toStringTag,{value:"Module"})),LZ=Vw(MZ);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Sa=en&&en.__decorate||function(n,e,t,r){var i=arguments.length,o=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(a=n[s])&&(o=(i<3?a(o):i>3?a(e,t,o):a(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},FZ=en&&en.__awaiter||function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function s(c){try{l(r.next(c))}catch(h){a(h)}}function u(c){try{l(r.throw(c))}catch(h){a(h)}}function l(c){c.done?o(c.value):i(c.value).then(s,u)}l((r=r.apply(n,e||[])).next())})},zZ=en&&en.__generator||function(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){t.label=l[1];break}if(l[0]===6&&t.label<o[1]){t.label=o[1],o=l;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(l);break}o[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(c){l=[6,c],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(oy,"__esModule",{value:!0});oy.Webcam=void 0;var Ia=LZ,BZ=Oi,D0={facingMode:"user",frameRate:24},jZ=function(n){return n.facingMode=n.facingMode||D0.facingMode,n.frameRate=n.frameRate||D0.frameRate,n.aspectRatio=n.aspectRatio||D0.aspectRatio,n},UZ=function(){function n(e,t,r){e===void 0&&(e=400),t===void 0&&(t=400),r===void 0&&(r=!1),this.width=e,this.height=t,this.flip=r}return n.prototype.getWebcam=function(e){if(e===void 0&&(e={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");e.width=640;var t=jZ(e),r=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:t}).then(function(i){return r.srcObject=i,r.addEventListener("loadedmetadata",function(o){var a=r.videoWidth,s=r.videoHeight;r.width=a,r.height=s}),r},function(){return Promise.reject("Could not open your camera. You may have denied access.")})},n.prototype.setup=function(e){return e===void 0&&(e={}),FZ(this,void 0,void 0,function(){var t;return zZ(this,function(r){switch(r.label){case 0:return this.webcam?[3,2]:(t=this,[4,this.getWebcam(e)]);case 1:t.webcam=r.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),r.label=2;case 2:return[2]}})})},n.prototype.play=function(){var e=this.webcam.play();return e},n.prototype.pause=function(){this.webcam.pause()},n.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},n.prototype.update=function(){this.renderCameraToCanvas()},n.prototype.stopStreamedVideo=function(e){var t=e.srcObject,r=t.getTracks();r.forEach(function(i){i.stop()}),e.srcObject=null},n.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var e=this.canvas.getContext("2d");if(this.webcam.videoWidth!==0){var t=BZ.cropTo(this.webcam,this.width,this.flip);e.drawImage(t,0,0)}}},Sa([Ia.default],n.prototype,"getWebcam",null),Sa([Ia.default],n.prototype,"setup",null),Sa([Ia.default],n.prototype,"play",null),Sa([Ia.default],n.prototype,"pause",null),Sa([Ia.default],n.prototype,"stop",null),Sa([Ia.default],n.prototype,"update",null),Sa([Ia.default],n.prototype,"stopStreamedVideo",null),Sa([Ia.default],n.prototype,"renderCameraToCanvas",null),n}();oy.Webcam=UZ;(function(n){/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(n,"__esModule",{value:!0});var e=Wx;Object.defineProperty(n,"IMAGE_SIZE",{enumerable:!0,get:function(){return e.IMAGE_SIZE}}),Object.defineProperty(n,"CustomMobileNet",{enumerable:!0,get:function(){return e.CustomMobileNet}}),Object.defineProperty(n,"load",{enumerable:!0,get:function(){return e.load}}),Object.defineProperty(n,"loadFromFiles",{enumerable:!0,get:function(){return e.loadFromFiles}}),Object.defineProperty(n,"loadTruncatedMobileNet",{enumerable:!0,get:function(){return e.loadTruncatedMobileNet}});var t=mc;Object.defineProperty(n,"TeachableMobileNet",{enumerable:!0,get:function(){return t.TeachableMobileNet}}),Object.defineProperty(n,"createTeachable",{enumerable:!0,get:function(){return t.createTeachable}});var r=oy;Object.defineProperty(n,"Webcam",{enumerable:!0,get:function(){return r.Webcam}});var i=Tf;Object.defineProperty(n,"version",{enumerable:!0,get:function(){return i.version}})})(FD);const WZ=()=>{const[n,e]=X.useState(null),[t,r]=X.useState(!1),i=X.useRef(null),o="/models/";let a;const s=async()=>{try{r(!0),console.log("Loading model..."),a=await FD.load(o+"model.json",o+"metadata.json"),console.log("Model loaded successfully!"),r(!1)}catch(d){console.error("Error loading model:",d),r(!1)}},u=async d=>{const f=d.target.files[0];if(!f)return;const m=URL.createObjectURL(f);i.current.src=m,console.log("Image uploaded: ",f.name),a||await s();try{const v=await a.predict(i.current);console.log("Prediction result: ",v);const y=v.reduce((g,w)=>g.probability>w.probability?g:w);console.log("Highest prediction: ",y),e(y.className)}catch(v){console.error("Error during prediction: ",v)}},l=ua(ca);function c(){Yd(l).then(()=>{alert("sign out succesfully")}).then(h("/"))}let h=gi();return X.useEffect(()=>{s()},[]),O.jsxs("div",{className:"fresh-main",children:[O.jsx("div",{className:"featurs-nav",children:O.jsxs("nav",{className:"landing-nav-main",children:[O.jsx("div",{className:"landing-logo",children:"StockSense"}),O.jsxs("ul",{className:"nav-links-main",children:[O.jsx("li",{children:O.jsx(cn,{to:"/Main",children:"Home"})}),O.jsx("li",{children:O.jsx(cn,{to:"/aboutus",children:"About Us"})}),O.jsx("li",{children:O.jsx(cn,{to:"/features",children:"Features"})}),O.jsx("li",{children:O.jsx(cn,{onClick:c,children:"Logout"})})]})]})}),O.jsx("div",{className:"freshcheck-page",children:O.jsxs("div",{className:"fresh-container",children:[O.jsx("h1",{children:"Fruit Freshness Checker"}),O.jsx("input",{type:"file",accept:"image/*",onChange:u}),O.jsx("img",{ref:i,alt:"Uploaded",style:{maxWidth:"300px",marginTop:"20px"}}),t&&O.jsx("p",{children:"Loading model..."}),n&&O.jsxs("p",{children:["Prediction: ",O.jsx("strong",{children:n})]})]})}),O.jsx(av,{})]})},sl=({children:n})=>{const[e,t]=X.useState(!0),[r,i]=X.useState(null),o=ua();return X.useEffect(()=>{const a=YV(o,s=>{i(s),t(!1)});return()=>a()},[o]),e?O.jsx("div",{children:"Loading..."}):r?n:O.jsx(Pj,{to:"/"})},VZ=()=>{const[n,e]=X.useState(!1),[t,r]=X.useState(""),[i,o]=X.useState(""),[a,s]=X.useState([]),[u,l]=X.useState(),c=gi();X.useEffect(()=>{const f=ec(eg,"inventory"),m=kD(f,v=>{const y=v.val();if(y){const g=Object.keys(y).map(w=>({id:w,...y[w]}));s(g)}else s([])});return()=>m()},[]);const h=async()=>{if(!i||!t){alert("Please select a fruit and enter quantity!");return}e(!0);try{const f=await fetch(`/predict/${t}/${i}`);if(!f.ok)throw new Error("Network response was not ok");const m=await f.json();e(!1),l(m.predicted_price)}catch(f){e(!1),console.error("Error fetching prediction:",f),alert("There was an error fetching the prediction.")}};function d(){const f=ua(ca);Yd(f).then(()=>{alert("Signed out successfully"),c("/")})}return X.useEffect(()=>{console.log("Inventory state updated:",a)},[a]),O.jsxs("div",{className:"predict-main",children:[O.jsx("div",{className:"featurs-nav",children:O.jsxs("nav",{className:"landing-nav-main",children:[O.jsx("div",{className:"landing-logo",children:"StockSense"}),O.jsxs("ul",{className:"nav-links-main",children:[O.jsx("li",{children:O.jsx(cn,{to:"/Main",children:"Home"})}),O.jsx("li",{children:O.jsx(cn,{to:"/aboutus",children:"About Us"})}),O.jsx("li",{children:O.jsx(cn,{to:"/features",children:"Features"})}),O.jsx("li",{children:O.jsx(cn,{onClick:d,children:"Logout"})})]})]})}),O.jsxs("div",{className:"predict-container",children:[O.jsx("div",{className:"predict-heading",children:O.jsx("h2",{children:"Predict Price"})}),O.jsxs("div",{className:"predict-form",children:[O.jsxs("div",{className:"predict-input",children:["Select item:",O.jsxs("select",{name:"option-select",value:i,onChange:f=>o(f.target.value),children:[O.jsx("option",{value:"",children:"Choose an item"}),a.length>0?a.map((f,m)=>O.jsx("option",{value:f.itemsname,children:f.itemsname},m)):O.jsx("option",{children:"No items available"})]}),"Quantity:",O.jsx("input",{type:"number",value:t,onChange:f=>r(f.target.value),placeholder:"Enter the Quantity"})]}),O.jsx("div",{className:"display_prediction",children:u}),O.jsxs("div",{className:"predict-buttons",children:[O.jsx("button",{className:"Cancel-predict",onClick:()=>{o(""),r("")},children:"Cancel"}),O.jsx("button",{className:"price-predict",onClick:h,children:n?O.jsx("div",{className:"spinner"}):"Predict Price"})]})]})]})]})},$Z=()=>{const n=gi(),e=ua(ca);function t(){Yd(e).then(()=>{alert("Signed out successfully"),n("/")})}function r(){n("/features")}return O.jsxs("div",{className:"About-main",children:[O.jsxs("nav",{className:"landing-nav-main",children:[O.jsx("div",{className:"landing-logo",children:"StockSense"}),O.jsxs("ul",{className:"nav-links-main",children:[O.jsx("li",{children:O.jsx(cn,{to:"/Main",children:"Home"})}),O.jsx("li",{children:O.jsx(cn,{to:"/about",children:"About Us"})}),O.jsx("li",{children:O.jsx(cn,{onClick:r,children:"Features"})}),O.jsx("li",{children:O.jsx(cn,{onClick:t,children:"Logout"})})]})]}),O.jsxs("div",{className:"about-container",children:[O.jsxs("div",{className:"about-heading",children:[O.jsx("h1",{children:"About Our Inventory Management System"}),O.jsx("h3",{children:"Empowering businesses with smart inventory solutions for better management and growth"})]}),O.jsxs("div",{className:"about-our",children:[O.jsxs("div",{className:"part1 part",children:[O.jsx("h2",{children:"Our Mission"}),O.jsx("p",{children:"To provide businesses with powerful, user-friendly inventory management tools that streamline operations, reduce costs, and drive sustainable growth. We're committed to making inventory management accessible to businesses of all sizes."})]}),O.jsxs("div",{className:"part2 part",children:[O.jsx("h2",{children:"Our Vision"}),O.jsx("p",{children:"To become the leading inventory management solution globally, known for innovation, reliability, and exceptional customer service. We envision a future where every business can efficiently manage their inventory with ease."})]})]}),O.jsxs("div",{className:"boxes",children:[O.jsxs("div",{className:"box1 box",children:[O.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-building2 w-12 h-12 text-blue-600",children:[O.jsx("path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"}),O.jsx("path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"}),O.jsx("path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"}),O.jsx("path",{d:"M10 6h4"}),O.jsx("path",{d:"M10 10h4"}),O.jsx("path",{d:"M10 14h4"}),O.jsx("path",{d:"M10 18h4"})]}),O.jsx("h2",{children:"Modern Solution"}),O.jsx("p",{children:"Built with the latest technology for optimal performance and reliability"})]}),O.jsxs("div",{className:"box2 box",children:[O.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-users w-12 h-12 text-blue-600",children:[O.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),O.jsx("circle",{cx:"9",cy:"7",r:"4"}),O.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),O.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),O.jsx("h2",{children:"User-Friendly"}),O.jsx("p",{children:"Intuitive interface designed for users of all technical backgrounds"})]}),O.jsxs("div",{className:"box3 box",children:[O.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-target w-12 h-12 text-blue-600",children:[O.jsx("circle",{cx:"12",cy:"12",r:"10"}),O.jsx("circle",{cx:"12",cy:"12",r:"6"}),O.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),O.jsx("h2",{children:"Accurate Tracking"}),O.jsx("p",{children:"Real-time inventory tracking with advanced analytics and reporting"})]}),O.jsxs("div",{className:"box4 box",children:[O.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-award w-12 h-12 text-blue-600",children:[O.jsx("path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526"}),O.jsx("circle",{cx:"12",cy:"8",r:"6"})]}),O.jsx("h2",{children:"Premium Support"}),O.jsx("p",{children:"Dedicated customer support team available to help you succeed"})]})]})]})]})};function HZ(){const n=oU([{path:"/",element:O.jsx(V9,{})},{path:"/about",element:O.jsx($Z,{})},{path:"/predict",element:O.jsx(VZ,{})},{path:"/signup",element:O.jsx($9,{})},{path:"/Main",element:O.jsx(sl,{children:O.jsx(z9,{})})},{path:"/check",element:O.jsx(sl,{children:O.jsx(WZ,{})})},{path:"/retrive",element:O.jsx(sl,{children:O.jsx(H9,{})})},{path:"/features",element:O.jsx(sl,{children:O.jsx(B9,{})})},{path:"/additems",element:O.jsx(sl,{children:O.jsx(j9,{})})},{path:"/display",element:O.jsx(sl,{children:O.jsx(U9,{})})}]);return O.jsx(vU,{router:n})}nR(document.getElementById("root")).render(O.jsx(X.StrictMode,{children:O.jsx(HZ,{})}));
